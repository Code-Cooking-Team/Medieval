var JN=Object.defineProperty;var eO=(n,e,t)=>e in n?JN(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var O=(n,e,t)=>(eO(n,typeof e!="symbol"?e+"":e,t),t);function tO(n,e){return e.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(i){if(i!=="default"&&!(i in n)){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}})}),Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}const nO=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}};nO();var Ma=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Cv={},nE={exports:{}},Zi={},J={exports:{}},ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uf=Symbol.for("react.element"),iO=Symbol.for("react.portal"),rO=Symbol.for("react.fragment"),sO=Symbol.for("react.strict_mode"),oO=Symbol.for("react.profiler"),aO=Symbol.for("react.provider"),lO=Symbol.for("react.context"),cO=Symbol.for("react.forward_ref"),uO=Symbol.for("react.suspense"),fO=Symbol.for("react.memo"),dO=Symbol.for("react.lazy"),vS=Symbol.iterator;function hO(n){return n===null||typeof n!="object"?null:(n=vS&&n[vS]||n["@@iterator"],typeof n=="function"?n:null)}var iE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rE=Object.assign,sE={};function Lc(n,e,t){this.props=n,this.context=e,this.refs=sE,this.updater=t||iE}Lc.prototype.isReactComponent={};Lc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Lc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function oE(){}oE.prototype=Lc.prototype;function rx(n,e,t){this.props=n,this.context=e,this.refs=sE,this.updater=t||iE}var sx=rx.prototype=new oE;sx.constructor=rx;rE(sx,Lc.prototype);sx.isPureReactComponent=!0;var yS=Array.isArray,aE=Object.prototype.hasOwnProperty,ox={current:null},lE={key:!0,ref:!0,__self:!0,__source:!0};function cE(n,e,t){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)aE.call(e,i)&&!lE.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var c=Array(a),f=0;f<a;f++)c[f]=arguments[f+2];r.children=c}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:Uf,type:n,key:s,ref:o,props:r,_owner:ox.current}}function pO(n,e){return{$$typeof:Uf,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function ax(n){return typeof n=="object"&&n!==null&&n.$$typeof===Uf}function mO(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var xS=/\/+/g;function c0(n,e){return typeof n=="object"&&n!==null&&n.key!=null?mO(""+n.key):e.toString(36)}function jh(n,e,t,i,r){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case Uf:case iO:o=!0}}if(o)return o=n,r=r(o),n=i===""?"."+c0(o,0):i,yS(r)?(t="",n!=null&&(t=n.replace(xS,"$&/")+"/"),jh(r,e,t,"",function(f){return f})):r!=null&&(ax(r)&&(r=pO(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(xS,"$&/")+"/")+n)),e.push(r)),1;if(o=0,i=i===""?".":i+":",yS(n))for(var a=0;a<n.length;a++){s=n[a];var c=i+c0(s,a);o+=jh(s,e,t,c,r)}else if(c=hO(n),typeof c=="function")for(n=c.call(n),a=0;!(s=n.next()).done;)s=s.value,c=i+c0(s,a++),o+=jh(s,e,t,c,r);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Gd(n,e,t){if(n==null)return n;var i=[],r=0;return jh(n,i,"","",function(s){return e.call(t,s,r++)}),i}function gO(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var wi={current:null},Xh={transition:null},vO={ReactCurrentDispatcher:wi,ReactCurrentBatchConfig:Xh,ReactCurrentOwner:ox};function uE(){throw Error("act(...) is not supported in production builds of React.")}ft.Children={map:Gd,forEach:function(n,e,t){Gd(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Gd(n,function(){e++}),e},toArray:function(n){return Gd(n,function(e){return e})||[]},only:function(n){if(!ax(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};ft.Component=Lc;ft.Fragment=rO;ft.Profiler=oO;ft.PureComponent=rx;ft.StrictMode=sO;ft.Suspense=uO;ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vO;ft.act=uE;ft.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=rE({},n.props),r=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=ox.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(c in e)aE.call(e,c)&&!lE.hasOwnProperty(c)&&(i[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)i.children=t;else if(1<c){a=Array(c);for(var f=0;f<c;f++)a[f]=arguments[f+2];i.children=a}return{$$typeof:Uf,type:n.type,key:r,ref:s,props:i,_owner:o}};ft.createContext=function(n){return n={$$typeof:lO,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:aO,_context:n},n.Consumer=n};ft.createElement=cE;ft.createFactory=function(n){var e=cE.bind(null,n);return e.type=n,e};ft.createRef=function(){return{current:null}};ft.forwardRef=function(n){return{$$typeof:cO,render:n}};ft.isValidElement=ax;ft.lazy=function(n){return{$$typeof:dO,_payload:{_status:-1,_result:n},_init:gO}};ft.memo=function(n,e){return{$$typeof:fO,type:n,compare:e===void 0?null:e}};ft.startTransition=function(n){var e=Xh.transition;Xh.transition={};try{n()}finally{Xh.transition=e}};ft.unstable_act=uE;ft.useCallback=function(n,e){return wi.current.useCallback(n,e)};ft.useContext=function(n){return wi.current.useContext(n)};ft.useDebugValue=function(){};ft.useDeferredValue=function(n){return wi.current.useDeferredValue(n)};ft.useEffect=function(n,e){return wi.current.useEffect(n,e)};ft.useId=function(){return wi.current.useId()};ft.useImperativeHandle=function(n,e,t){return wi.current.useImperativeHandle(n,e,t)};ft.useInsertionEffect=function(n,e){return wi.current.useInsertionEffect(n,e)};ft.useLayoutEffect=function(n,e){return wi.current.useLayoutEffect(n,e)};ft.useMemo=function(n,e){return wi.current.useMemo(n,e)};ft.useReducer=function(n,e,t){return wi.current.useReducer(n,e,t)};ft.useRef=function(n){return wi.current.useRef(n)};ft.useState=function(n){return wi.current.useState(n)};ft.useSyncExternalStore=function(n,e,t){return wi.current.useSyncExternalStore(n,e,t)};ft.useTransition=function(){return wi.current.useTransition()};ft.version="18.3.1";J.exports=ft;var dn=J.exports,dp=tO({__proto__:null,default:dn},[J.exports]),fE={exports:{}},dE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e($,Y){var Z=$.length;$.push(Y);e:for(;0<Z;){var he=Z-1>>>1,me=$[he];if(0<r(me,Y))$[he]=Y,$[Z]=me,Z=he;else break e}}function t($){return $.length===0?null:$[0]}function i($){if($.length===0)return null;var Y=$[0],Z=$.pop();if(Z!==Y){$[0]=Z;e:for(var he=0,me=$.length,we=me>>>1;he<we;){var De=2*(he+1)-1,Be=$[De],ce=De+1,yt=$[ce];if(0>r(Be,Z))ce<me&&0>r(yt,Be)?($[he]=yt,$[ce]=Z,he=ce):($[he]=Be,$[De]=Z,he=De);else if(ce<me&&0>r(yt,Z))$[he]=yt,$[ce]=Z,he=ce;else break e}}return Y}function r($,Y){var Z=$.sortIndex-Y.sortIndex;return Z!==0?Z:$.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],f=[],h=1,d=null,p=3,g=!1,_=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S($){for(var Y=t(f);Y!==null;){if(Y.callback===null)i(f);else if(Y.startTime<=$)i(f),Y.sortIndex=Y.expirationTime,e(c,Y);else break;Y=t(f)}}function E($){if(y=!1,S($),!_)if(t(c)!==null)_=!0,K(b);else{var Y=t(f);Y!==null&&ae(E,Y.startTime-$)}}function b($,Y){_=!1,y&&(y=!1,v(A),A=-1),g=!0;var Z=p;try{for(S(Y),d=t(c);d!==null&&(!(d.expirationTime>Y)||$&&!W());){var he=d.callback;if(typeof he=="function"){d.callback=null,p=d.priorityLevel;var me=he(d.expirationTime<=Y);Y=n.unstable_now(),typeof me=="function"?d.callback=me:d===t(c)&&i(c),S(Y)}else i(c);d=t(c)}if(d!==null)var we=!0;else{var De=t(f);De!==null&&ae(E,De.startTime-Y),we=!1}return we}finally{d=null,p=Z,g=!1}}var T=!1,C=null,A=-1,F=5,U=-1;function W(){return!(n.unstable_now()-U<F)}function ne(){if(C!==null){var $=n.unstable_now();U=$;var Y=!0;try{Y=C(!0,$)}finally{Y?re():(T=!1,C=null)}}else T=!1}var re;if(typeof w=="function")re=function(){w(ne)};else if(typeof MessageChannel!="undefined"){var V=new MessageChannel,ie=V.port2;V.port1.onmessage=ne,re=function(){ie.postMessage(null)}}else re=function(){x(ne,0)};function K($){C=$,T||(T=!0,re())}function ae($,Y){A=x(function(){$(n.unstable_now())},Y)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_continueExecution=function(){_||g||(_=!0,K(b))},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function($){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var Z=p;p=Y;try{return $()}finally{p=Z}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function($,Y){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Z=p;p=$;try{return Y()}finally{p=Z}},n.unstable_scheduleCallback=function($,Y,Z){var he=n.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?he+Z:he):Z=he,$){case 1:var me=-1;break;case 2:me=250;break;case 5:me=1073741823;break;case 4:me=1e4;break;default:me=5e3}return me=Z+me,$={id:h++,callback:Y,priorityLevel:$,startTime:Z,expirationTime:me,sortIndex:-1},Z>he?($.sortIndex=Z,e(f,$),t(c)===null&&$===t(f)&&(y?(v(A),A=-1):y=!0,ae(E,Z-he))):($.sortIndex=me,e(c,$),_||g||(_=!0,K(b))),$},n.unstable_shouldYield=W,n.unstable_wrapCallback=function($){var Y=p;return function(){var Z=p;p=Y;try{return $.apply(this,arguments)}finally{p=Z}}}})(dE);fE.exports=dE;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yO=J.exports,Ki=fE.exports;function _e(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hE=new Set,cf={};function ja(n,e){uc(n,e),uc(n+"Capture",e)}function uc(n,e){for(cf[n]=e,n=0;n<e.length;n++)hE.add(e[n])}var Ks=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),Rv=Object.prototype.hasOwnProperty,xO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_S={},wS={};function _O(n){return Rv.call(wS,n)?!0:Rv.call(_S,n)?!1:xO.test(n)?wS[n]=!0:(_S[n]=!0,!1)}function wO(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function SO(n,e,t,i){if(e===null||typeof e=="undefined"||wO(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Si(n,e,t,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Kn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Kn[n]=new Si(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Kn[e]=new Si(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Kn[n]=new Si(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Kn[n]=new Si(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Kn[n]=new Si(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Kn[n]=new Si(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Kn[n]=new Si(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Kn[n]=new Si(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Kn[n]=new Si(n,5,!1,n.toLowerCase(),null,!1,!1)});var lx=/[\-:]([a-z])/g;function cx(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(lx,cx);Kn[e]=new Si(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(lx,cx);Kn[e]=new Si(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(lx,cx);Kn[e]=new Si(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Kn[n]=new Si(n,1,!1,n.toLowerCase(),null,!1,!1)});Kn.xlinkHref=new Si("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Kn[n]=new Si(n,1,!1,n.toLowerCase(),null,!0,!0)});function ux(n,e,t,i){var r=Kn.hasOwnProperty(e)?Kn[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(SO(e,t,r,i)&&(t=null),i||r===null?_O(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var to=yO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wd=Symbol.for("react.element"),Bl=Symbol.for("react.portal"),zl=Symbol.for("react.fragment"),fx=Symbol.for("react.strict_mode"),Pv=Symbol.for("react.profiler"),pE=Symbol.for("react.provider"),mE=Symbol.for("react.context"),dx=Symbol.for("react.forward_ref"),Lv=Symbol.for("react.suspense"),Iv=Symbol.for("react.suspense_list"),hx=Symbol.for("react.memo"),Ao=Symbol.for("react.lazy"),gE=Symbol.for("react.offscreen"),SS=Symbol.iterator;function pu(n){return n===null||typeof n!="object"?null:(n=SS&&n[SS]||n["@@iterator"],typeof n=="function"?n:null)}var nn=Object.assign,u0;function Hu(n){if(u0===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);u0=e&&e[1]||""}return`
`+u0+n}var f0=!1;function d0(n,e){if(!n||f0)return"";f0=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(f){var i=f}Reflect.construct(n,[],e)}else{try{e.call()}catch(f){i=f}n.call(e.prototype)}else{try{throw Error()}catch(f){i=f}n()}}catch(f){if(f&&i&&typeof f.stack=="string"){for(var r=f.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var c=`
`+r[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=a);break}}}finally{f0=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Hu(n):""}function MO(n){switch(n.tag){case 5:return Hu(n.type);case 16:return Hu("Lazy");case 13:return Hu("Suspense");case 19:return Hu("SuspenseList");case 0:case 2:case 15:return n=d0(n.type,!1),n;case 11:return n=d0(n.type.render,!1),n;case 1:return n=d0(n.type,!0),n;default:return""}}function Fv(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case zl:return"Fragment";case Bl:return"Portal";case Pv:return"Profiler";case fx:return"StrictMode";case Lv:return"Suspense";case Iv:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case mE:return(n.displayName||"Context")+".Consumer";case pE:return(n._context.displayName||"Context")+".Provider";case dx:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case hx:return e=n.displayName||null,e!==null?e:Fv(n.type)||"Memo";case Ao:e=n._payload,n=n._init;try{return Fv(n(e))}catch{}}return null}function bO(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fv(e);case 8:return e===fx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function $o(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function vE(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function TO(n){var e=vE(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t!="undefined"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Vd(n){n._valueTracker||(n._valueTracker=TO(n))}function yE(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=vE(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function hp(n){if(n=n||(typeof document!="undefined"?document:void 0),typeof n=="undefined")return null;try{return n.activeElement||n.body}catch{return n.body}}function Dv(n,e){var t=e.checked;return nn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t!=null?t:n._wrapperState.initialChecked})}function MS(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=$o(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function xE(n,e){e=e.checked,e!=null&&ux(n,"checked",e,!1)}function Nv(n,e){xE(n,e);var t=$o(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Ov(n,e.type,t):e.hasOwnProperty("defaultValue")&&Ov(n,e.type,$o(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function bS(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Ov(n,e,t){(e!=="number"||hp(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Gu=Array.isArray;function Jl(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+$o(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function kv(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(_e(91));return nn({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function TS(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(_e(92));if(Gu(t)){if(1<t.length)throw Error(_e(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:$o(t)}}function _E(n,e){var t=$o(e.value),i=$o(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function ES(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function wE(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bv(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?wE(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var $d,SE=function(n){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for($d=$d||document.createElement("div"),$d.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=$d.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function uf(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Yu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},EO=["Webkit","ms","Moz","O"];Object.keys(Yu).forEach(function(n){EO.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Yu[e]=Yu[n]})});function ME(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Yu.hasOwnProperty(n)&&Yu[n]?(""+e).trim():e+"px"}function bE(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=ME(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var AO=nn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zv(n,e){if(e){if(AO[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(_e(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(_e(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(_e(61))}if(e.style!=null&&typeof e.style!="object")throw Error(_e(62))}}function Uv(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hv=null;function px(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Gv=null,ec=null,tc=null;function AS(n){if(n=Wf(n)){if(typeof Gv!="function")throw Error(_e(280));var e=n.stateNode;e&&(e=im(e),Gv(n.stateNode,n.type,e))}}function TE(n){ec?tc?tc.push(n):tc=[n]:ec=n}function EE(){if(ec){var n=ec,e=tc;if(tc=ec=null,AS(n),e)for(n=0;n<e.length;n++)AS(e[n])}}function AE(n,e){return n(e)}function CE(){}var h0=!1;function RE(n,e,t){if(h0)return n(e,t);h0=!0;try{return AE(n,e,t)}finally{h0=!1,(ec!==null||tc!==null)&&(CE(),EE())}}function ff(n,e){var t=n.stateNode;if(t===null)return null;var i=im(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(_e(231,e,typeof t));return t}var Wv=!1;if(Ks)try{var mu={};Object.defineProperty(mu,"passive",{get:function(){Wv=!0}}),window.addEventListener("test",mu,mu),window.removeEventListener("test",mu,mu)}catch{Wv=!1}function CO(n,e,t,i,r,s,o,a,c){var f=Array.prototype.slice.call(arguments,3);try{e.apply(t,f)}catch(h){this.onError(h)}}var Ku=!1,pp=null,mp=!1,Vv=null,RO={onError:function(n){Ku=!0,pp=n}};function PO(n,e,t,i,r,s,o,a,c){Ku=!1,pp=null,CO.apply(RO,arguments)}function LO(n,e,t,i,r,s,o,a,c){if(PO.apply(this,arguments),Ku){if(Ku){var f=pp;Ku=!1,pp=null}else throw Error(_e(198));mp||(mp=!0,Vv=f)}}function Xa(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,(e.flags&4098)!==0&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function PE(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function CS(n){if(Xa(n)!==n)throw Error(_e(188))}function IO(n){var e=n.alternate;if(!e){if(e=Xa(n),e===null)throw Error(_e(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return CS(r),n;if(s===i)return CS(r),e;s=s.sibling}throw Error(_e(188))}if(t.return!==i.return)t=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===t){o=!0,t=r,i=s;break}if(a===i){o=!0,i=r,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,i=r;break}if(a===i){o=!0,i=s,t=r;break}a=a.sibling}if(!o)throw Error(_e(189))}}if(t.alternate!==i)throw Error(_e(190))}if(t.tag!==3)throw Error(_e(188));return t.stateNode.current===t?n:e}function LE(n){return n=IO(n),n!==null?IE(n):null}function IE(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=IE(n);if(e!==null)return e;n=n.sibling}return null}var FE=Ki.unstable_scheduleCallback,RS=Ki.unstable_cancelCallback,FO=Ki.unstable_shouldYield,DO=Ki.unstable_requestPaint,hn=Ki.unstable_now,NO=Ki.unstable_getCurrentPriorityLevel,mx=Ki.unstable_ImmediatePriority,DE=Ki.unstable_UserBlockingPriority,gp=Ki.unstable_NormalPriority,OO=Ki.unstable_LowPriority,NE=Ki.unstable_IdlePriority,Jp=null,ms=null;function kO(n){if(ms&&typeof ms.onCommitFiberRoot=="function")try{ms.onCommitFiberRoot(Jp,n,void 0,(n.current.flags&128)===128)}catch{}}var Wr=Math.clz32?Math.clz32:UO,BO=Math.log,zO=Math.LN2;function UO(n){return n>>>=0,n===0?32:31-(BO(n)/zO|0)|0}var jd=64,Xd=4194304;function Wu(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function vp(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~r;a!==0?i=Wu(a):(s&=o,s!==0&&(i=Wu(s)))}else o=t&~r,o!==0?i=Wu(o):s!==0&&(i=Wu(s));if(i===0)return 0;if(e!==0&&e!==i&&(e&r)===0&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if((i&4)!==0&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-Wr(e),r=1<<t,i|=n[t],e&=~r;return i}function HO(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function GO(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-Wr(s),a=1<<o,c=r[o];c===-1?((a&t)===0||(a&i)!==0)&&(r[o]=HO(a,e)):c<=e&&(n.expiredLanes|=a),s&=~a}}function $v(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function OE(){var n=jd;return jd<<=1,(jd&4194240)===0&&(jd=64),n}function p0(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Hf(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Wr(e),n[e]=t}function WO(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-Wr(t),s=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~s}}function gx(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-Wr(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var Nt=0;function kE(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var BE,vx,zE,UE,HE,jv=!1,qd=[],ko=null,Bo=null,zo=null,df=new Map,hf=new Map,Po=[],VO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function PS(n,e){switch(n){case"focusin":case"focusout":ko=null;break;case"dragenter":case"dragleave":Bo=null;break;case"mouseover":case"mouseout":zo=null;break;case"pointerover":case"pointerout":df.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":hf.delete(e.pointerId)}}function gu(n,e,t,i,r,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Wf(e),e!==null&&vx(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function $O(n,e,t,i,r){switch(e){case"focusin":return ko=gu(ko,n,e,t,i,r),!0;case"dragenter":return Bo=gu(Bo,n,e,t,i,r),!0;case"mouseover":return zo=gu(zo,n,e,t,i,r),!0;case"pointerover":var s=r.pointerId;return df.set(s,gu(df.get(s)||null,n,e,t,i,r)),!0;case"gotpointercapture":return s=r.pointerId,hf.set(s,gu(hf.get(s)||null,n,e,t,i,r)),!0}return!1}function GE(n){var e=Ta(n.target);if(e!==null){var t=Xa(e);if(t!==null){if(e=t.tag,e===13){if(e=PE(t),e!==null){n.blockedOn=e,HE(n.priority,function(){zE(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function qh(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Xv(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);Hv=i,t.target.dispatchEvent(i),Hv=null}else return e=Wf(t),e!==null&&vx(e),n.blockedOn=t,!1;e.shift()}return!0}function LS(n,e,t){qh(n)&&t.delete(e)}function jO(){jv=!1,ko!==null&&qh(ko)&&(ko=null),Bo!==null&&qh(Bo)&&(Bo=null),zo!==null&&qh(zo)&&(zo=null),df.forEach(LS),hf.forEach(LS)}function vu(n,e){n.blockedOn===e&&(n.blockedOn=null,jv||(jv=!0,Ki.unstable_scheduleCallback(Ki.unstable_NormalPriority,jO)))}function pf(n){function e(r){return vu(r,n)}if(0<qd.length){vu(qd[0],n);for(var t=1;t<qd.length;t++){var i=qd[t];i.blockedOn===n&&(i.blockedOn=null)}}for(ko!==null&&vu(ko,n),Bo!==null&&vu(Bo,n),zo!==null&&vu(zo,n),df.forEach(e),hf.forEach(e),t=0;t<Po.length;t++)i=Po[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<Po.length&&(t=Po[0],t.blockedOn===null);)GE(t),t.blockedOn===null&&Po.shift()}var nc=to.ReactCurrentBatchConfig,yp=!0;function XO(n,e,t,i){var r=Nt,s=nc.transition;nc.transition=null;try{Nt=1,yx(n,e,t,i)}finally{Nt=r,nc.transition=s}}function qO(n,e,t,i){var r=Nt,s=nc.transition;nc.transition=null;try{Nt=4,yx(n,e,t,i)}finally{Nt=r,nc.transition=s}}function yx(n,e,t,i){if(yp){var r=Xv(n,e,t,i);if(r===null)b0(n,e,i,xp,t),PS(n,i);else if($O(r,n,e,t,i))i.stopPropagation();else if(PS(n,i),e&4&&-1<VO.indexOf(n)){for(;r!==null;){var s=Wf(r);if(s!==null&&BE(s),s=Xv(n,e,t,i),s===null&&b0(n,e,i,xp,t),s===r)break;r=s}r!==null&&i.stopPropagation()}else b0(n,e,i,null,t)}}var xp=null;function Xv(n,e,t,i){if(xp=null,n=px(i),n=Ta(n),n!==null)if(e=Xa(n),e===null)n=null;else if(t=e.tag,t===13){if(n=PE(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return xp=n,null}function WE(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(NO()){case mx:return 1;case DE:return 4;case gp:case OO:return 16;case NE:return 536870912;default:return 16}default:return 16}}var Io=null,xx=null,Yh=null;function VE(){if(Yh)return Yh;var n,e=xx,t=e.length,i,r="value"in Io?Io.value:Io.textContent,s=r.length;for(n=0;n<t&&e[n]===r[n];n++);var o=t-n;for(i=1;i<=o&&e[t-i]===r[s-i];i++);return Yh=r.slice(n,1<i?1-i:void 0)}function Kh(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Yd(){return!0}function IS(){return!1}function Qi(n){function e(t,i,r,s,o){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Yd:IS,this.isPropagationStopped=IS,this}return nn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Yd)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Yd)},persist:function(){},isPersistent:Yd}),e}var Ic={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_x=Qi(Ic),Gf=nn({},Ic,{view:0,detail:0}),YO=Qi(Gf),m0,g0,yu,em=nn({},Gf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wx,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==yu&&(yu&&n.type==="mousemove"?(m0=n.screenX-yu.screenX,g0=n.screenY-yu.screenY):g0=m0=0,yu=n),m0)},movementY:function(n){return"movementY"in n?n.movementY:g0}}),FS=Qi(em),KO=nn({},em,{dataTransfer:0}),ZO=Qi(KO),QO=nn({},Gf,{relatedTarget:0}),v0=Qi(QO),JO=nn({},Ic,{animationName:0,elapsedTime:0,pseudoElement:0}),ek=Qi(JO),tk=nn({},Ic,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),nk=Qi(tk),ik=nn({},Ic,{data:0}),DS=Qi(ik),rk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ok={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ak(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=ok[n])?!!e[n]:!1}function wx(){return ak}var lk=nn({},Gf,{key:function(n){if(n.key){var e=rk[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Kh(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?sk[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wx,charCode:function(n){return n.type==="keypress"?Kh(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Kh(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),ck=Qi(lk),uk=nn({},em,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),NS=Qi(uk),fk=nn({},Gf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wx}),dk=Qi(fk),hk=nn({},Ic,{propertyName:0,elapsedTime:0,pseudoElement:0}),pk=Qi(hk),mk=nn({},em,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),gk=Qi(mk),vk=[9,13,27,32],Sx=Ks&&"CompositionEvent"in window,Zu=null;Ks&&"documentMode"in document&&(Zu=document.documentMode);var yk=Ks&&"TextEvent"in window&&!Zu,$E=Ks&&(!Sx||Zu&&8<Zu&&11>=Zu),OS=String.fromCharCode(32),kS=!1;function jE(n,e){switch(n){case"keyup":return vk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function XE(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Ul=!1;function xk(n,e){switch(n){case"compositionend":return XE(e);case"keypress":return e.which!==32?null:(kS=!0,OS);case"textInput":return n=e.data,n===OS&&kS?null:n;default:return null}}function _k(n,e){if(Ul)return n==="compositionend"||!Sx&&jE(n,e)?(n=VE(),Yh=xx=Io=null,Ul=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $E&&e.locale!=="ko"?null:e.data;default:return null}}var wk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function BS(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!wk[n.type]:e==="textarea"}function qE(n,e,t,i){TE(i),e=_p(e,"onChange"),0<e.length&&(t=new _x("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var Qu=null,mf=null;function Sk(n){sA(n,0)}function tm(n){var e=Wl(n);if(yE(e))return n}function Mk(n,e){if(n==="change")return e}var YE=!1;if(Ks){var y0;if(Ks){var x0="oninput"in document;if(!x0){var zS=document.createElement("div");zS.setAttribute("oninput","return;"),x0=typeof zS.oninput=="function"}y0=x0}else y0=!1;YE=y0&&(!document.documentMode||9<document.documentMode)}function US(){Qu&&(Qu.detachEvent("onpropertychange",KE),mf=Qu=null)}function KE(n){if(n.propertyName==="value"&&tm(mf)){var e=[];qE(e,mf,n,px(n)),RE(Sk,e)}}function bk(n,e,t){n==="focusin"?(US(),Qu=e,mf=t,Qu.attachEvent("onpropertychange",KE)):n==="focusout"&&US()}function Tk(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return tm(mf)}function Ek(n,e){if(n==="click")return tm(e)}function Ak(n,e){if(n==="input"||n==="change")return tm(e)}function Ck(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Yr=typeof Object.is=="function"?Object.is:Ck;function gf(n,e){if(Yr(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!Rv.call(e,r)||!Yr(n[r],e[r]))return!1}return!0}function HS(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function GS(n,e){var t=HS(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=HS(t)}}function ZE(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?ZE(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function QE(){for(var n=window,e=hp();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=hp(n.document)}return e}function Mx(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Rk(n){var e=QE(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&ZE(t.ownerDocument.documentElement,t)){if(i!==null&&Mx(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!n.extend&&s>i&&(r=i,i=s,s=r),r=GS(t,s);var o=GS(t,i);r&&o&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),s>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Pk=Ks&&"documentMode"in document&&11>=document.documentMode,Hl=null,qv=null,Ju=null,Yv=!1;function WS(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Yv||Hl==null||Hl!==hp(i)||(i=Hl,"selectionStart"in i&&Mx(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Ju&&gf(Ju,i)||(Ju=i,i=_p(qv,"onSelect"),0<i.length&&(e=new _x("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=Hl)))}function Kd(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Gl={animationend:Kd("Animation","AnimationEnd"),animationiteration:Kd("Animation","AnimationIteration"),animationstart:Kd("Animation","AnimationStart"),transitionend:Kd("Transition","TransitionEnd")},_0={},JE={};Ks&&(JE=document.createElement("div").style,"AnimationEvent"in window||(delete Gl.animationend.animation,delete Gl.animationiteration.animation,delete Gl.animationstart.animation),"TransitionEvent"in window||delete Gl.transitionend.transition);function nm(n){if(_0[n])return _0[n];if(!Gl[n])return n;var e=Gl[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in JE)return _0[n]=e[t];return n}var eA=nm("animationend"),tA=nm("animationiteration"),nA=nm("animationstart"),iA=nm("transitionend"),rA=new Map,VS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yo(n,e){rA.set(n,e),ja(e,[n])}for(var w0=0;w0<VS.length;w0++){var S0=VS[w0],Lk=S0.toLowerCase(),Ik=S0[0].toUpperCase()+S0.slice(1);Yo(Lk,"on"+Ik)}Yo(eA,"onAnimationEnd");Yo(tA,"onAnimationIteration");Yo(nA,"onAnimationStart");Yo("dblclick","onDoubleClick");Yo("focusin","onFocus");Yo("focusout","onBlur");Yo(iA,"onTransitionEnd");uc("onMouseEnter",["mouseout","mouseover"]);uc("onMouseLeave",["mouseout","mouseover"]);uc("onPointerEnter",["pointerout","pointerover"]);uc("onPointerLeave",["pointerout","pointerover"]);ja("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ja("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ja("onBeforeInput",["compositionend","keypress","textInput","paste"]);ja("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ja("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ja("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vu));function $S(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,LO(i,e,void 0,n),n.currentTarget=null}function sA(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],c=a.instance,f=a.currentTarget;if(a=a.listener,c!==s&&r.isPropagationStopped())break e;$S(r,a,f),s=c}else for(o=0;o<i.length;o++){if(a=i[o],c=a.instance,f=a.currentTarget,a=a.listener,c!==s&&r.isPropagationStopped())break e;$S(r,a,f),s=c}}}if(mp)throw n=Vv,mp=!1,Vv=null,n}function Wt(n,e){var t=e[ey];t===void 0&&(t=e[ey]=new Set);var i=n+"__bubble";t.has(i)||(oA(e,n,2,!1),t.add(i))}function M0(n,e,t){var i=0;e&&(i|=4),oA(t,n,i,e)}var Zd="_reactListening"+Math.random().toString(36).slice(2);function vf(n){if(!n[Zd]){n[Zd]=!0,hE.forEach(function(t){t!=="selectionchange"&&(Fk.has(t)||M0(t,!1,n),M0(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Zd]||(e[Zd]=!0,M0("selectionchange",!1,e))}}function oA(n,e,t,i){switch(WE(e)){case 1:var r=XO;break;case 4:r=qO;break;default:r=yx}t=r.bind(null,e,t,n),r=void 0,!Wv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function b0(n,e,t,i,r){var s=i;if((e&1)===0&&(e&2)===0&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Ta(a),o===null)return;if(c=o.tag,c===5||c===6){i=s=o;continue e}a=a.parentNode}}i=i.return}RE(function(){var f=s,h=px(t),d=[];e:{var p=rA.get(n);if(p!==void 0){var g=_x,_=n;switch(n){case"keypress":if(Kh(t)===0)break e;case"keydown":case"keyup":g=ck;break;case"focusin":_="focus",g=v0;break;case"focusout":_="blur",g=v0;break;case"beforeblur":case"afterblur":g=v0;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=FS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=ZO;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=dk;break;case eA:case tA:case nA:g=ek;break;case iA:g=pk;break;case"scroll":g=YO;break;case"wheel":g=gk;break;case"copy":case"cut":case"paste":g=nk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=NS}var y=(e&4)!==0,x=!y&&n==="scroll",v=y?p!==null?p+"Capture":null:p;y=[];for(var w=f,S;w!==null;){S=w;var E=S.stateNode;if(S.tag===5&&E!==null&&(S=E,v!==null&&(E=ff(w,v),E!=null&&y.push(yf(w,E,S)))),x)break;w=w.return}0<y.length&&(p=new g(p,_,null,t,h),d.push({event:p,listeners:y}))}}if((e&7)===0){e:{if(p=n==="mouseover"||n==="pointerover",g=n==="mouseout"||n==="pointerout",p&&t!==Hv&&(_=t.relatedTarget||t.fromElement)&&(Ta(_)||_[Zs]))break e;if((g||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,g?(_=t.relatedTarget||t.toElement,g=f,_=_?Ta(_):null,_!==null&&(x=Xa(_),_!==x||_.tag!==5&&_.tag!==6)&&(_=null)):(g=null,_=f),g!==_)){if(y=FS,E="onMouseLeave",v="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(y=NS,E="onPointerLeave",v="onPointerEnter",w="pointer"),x=g==null?p:Wl(g),S=_==null?p:Wl(_),p=new y(E,w+"leave",g,t,h),p.target=x,p.relatedTarget=S,E=null,Ta(h)===f&&(y=new y(v,w+"enter",_,t,h),y.target=S,y.relatedTarget=x,E=y),x=E,g&&_)t:{for(y=g,v=_,w=0,S=y;S;S=hl(S))w++;for(S=0,E=v;E;E=hl(E))S++;for(;0<w-S;)y=hl(y),w--;for(;0<S-w;)v=hl(v),S--;for(;w--;){if(y===v||v!==null&&y===v.alternate)break t;y=hl(y),v=hl(v)}y=null}else y=null;g!==null&&jS(d,p,g,y,!1),_!==null&&x!==null&&jS(d,x,_,y,!0)}}e:{if(p=f?Wl(f):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var b=Mk;else if(BS(p))if(YE)b=Ak;else{b=Tk;var T=bk}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(b=Ek);if(b&&(b=b(n,f))){qE(d,b,t,h);break e}T&&T(n,p,f),n==="focusout"&&(T=p._wrapperState)&&T.controlled&&p.type==="number"&&Ov(p,"number",p.value)}switch(T=f?Wl(f):window,n){case"focusin":(BS(T)||T.contentEditable==="true")&&(Hl=T,qv=f,Ju=null);break;case"focusout":Ju=qv=Hl=null;break;case"mousedown":Yv=!0;break;case"contextmenu":case"mouseup":case"dragend":Yv=!1,WS(d,t,h);break;case"selectionchange":if(Pk)break;case"keydown":case"keyup":WS(d,t,h)}var C;if(Sx)e:{switch(n){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Ul?jE(n,t)&&(A="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(A="onCompositionStart");A&&($E&&t.locale!=="ko"&&(Ul||A!=="onCompositionStart"?A==="onCompositionEnd"&&Ul&&(C=VE()):(Io=h,xx="value"in Io?Io.value:Io.textContent,Ul=!0)),T=_p(f,A),0<T.length&&(A=new DS(A,n,null,t,h),d.push({event:A,listeners:T}),C?A.data=C:(C=XE(t),C!==null&&(A.data=C)))),(C=yk?xk(n,t):_k(n,t))&&(f=_p(f,"onBeforeInput"),0<f.length&&(h=new DS("onBeforeInput","beforeinput",null,t,h),d.push({event:h,listeners:f}),h.data=C))}sA(d,e)})}function yf(n,e,t){return{instance:n,listener:e,currentTarget:t}}function _p(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=ff(n,t),s!=null&&i.unshift(yf(n,s,r)),s=ff(n,e),s!=null&&i.push(yf(n,s,r))),n=n.return}return i}function hl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function jS(n,e,t,i,r){for(var s=e._reactName,o=[];t!==null&&t!==i;){var a=t,c=a.alternate,f=a.stateNode;if(c!==null&&c===i)break;a.tag===5&&f!==null&&(a=f,r?(c=ff(t,s),c!=null&&o.unshift(yf(t,c,a))):r||(c=ff(t,s),c!=null&&o.push(yf(t,c,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var Dk=/\r\n?/g,Nk=/\u0000|\uFFFD/g;function XS(n){return(typeof n=="string"?n:""+n).replace(Dk,`
`).replace(Nk,"")}function Qd(n,e,t){if(e=XS(e),XS(n)!==e&&t)throw Error(_e(425))}function wp(){}var Kv=null,Zv=null;function Qv(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Jv=typeof setTimeout=="function"?setTimeout:void 0,Ok=typeof clearTimeout=="function"?clearTimeout:void 0,qS=typeof Promise=="function"?Promise:void 0,kk=typeof queueMicrotask=="function"?queueMicrotask:typeof qS!="undefined"?function(n){return qS.resolve(null).then(n).catch(Bk)}:Jv;function Bk(n){setTimeout(function(){throw n})}function T0(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),pf(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);pf(e)}function Uo(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function YS(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Fc=Math.random().toString(36).slice(2),fs="__reactFiber$"+Fc,xf="__reactProps$"+Fc,Zs="__reactContainer$"+Fc,ey="__reactEvents$"+Fc,zk="__reactListeners$"+Fc,Uk="__reactHandles$"+Fc;function Ta(n){var e=n[fs];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Zs]||t[fs]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=YS(n);n!==null;){if(t=n[fs])return t;n=YS(n)}return e}n=t,t=n.parentNode}return null}function Wf(n){return n=n[fs]||n[Zs],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Wl(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(_e(33))}function im(n){return n[xf]||null}var ty=[],Vl=-1;function Ko(n){return{current:n}}function Vt(n){0>Vl||(n.current=ty[Vl],ty[Vl]=null,Vl--)}function Ht(n,e){Vl++,ty[Vl]=n.current,n.current=e}var jo={},oi=Ko(jo),Li=Ko(!1),Oa=jo;function fc(n,e){var t=n.type.contextTypes;if(!t)return jo;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function Ii(n){return n=n.childContextTypes,n!=null}function Sp(){Vt(Li),Vt(oi)}function KS(n,e,t){if(oi.current!==jo)throw Error(_e(168));Ht(oi,e),Ht(Li,t)}function aA(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(_e(108,bO(n)||"Unknown",r));return nn({},t,i)}function Mp(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||jo,Oa=oi.current,Ht(oi,n),Ht(Li,Li.current),!0}function ZS(n,e,t){var i=n.stateNode;if(!i)throw Error(_e(169));t?(n=aA(n,e,Oa),i.__reactInternalMemoizedMergedChildContext=n,Vt(Li),Vt(oi),Ht(oi,n)):Vt(Li),Ht(Li,t)}var Vs=null,rm=!1,E0=!1;function lA(n){Vs===null?Vs=[n]:Vs.push(n)}function Hk(n){rm=!0,lA(n)}function Zo(){if(!E0&&Vs!==null){E0=!0;var n=0,e=Nt;try{var t=Vs;for(Nt=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}Vs=null,rm=!1}catch(r){throw Vs!==null&&(Vs=Vs.slice(n+1)),FE(mx,Zo),r}finally{Nt=e,E0=!1}}return null}var $l=[],jl=0,bp=null,Tp=0,mr=[],gr=0,ka=null,$s=1,js="";function va(n,e){$l[jl++]=Tp,$l[jl++]=bp,bp=n,Tp=e}function cA(n,e,t){mr[gr++]=$s,mr[gr++]=js,mr[gr++]=ka,ka=n;var i=$s;n=js;var r=32-Wr(i)-1;i&=~(1<<r),t+=1;var s=32-Wr(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,$s=1<<32-Wr(e)+r|t<<r|i,js=s+n}else $s=1<<s|t<<r|i,js=n}function bx(n){n.return!==null&&(va(n,1),cA(n,1,0))}function Tx(n){for(;n===bp;)bp=$l[--jl],$l[jl]=null,Tp=$l[--jl],$l[jl]=null;for(;n===ka;)ka=mr[--gr],mr[gr]=null,js=mr[--gr],mr[gr]=null,$s=mr[--gr],mr[gr]=null}var qi=null,ji=null,Zt=!1,Ur=null;function uA(n,e){var t=xr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function QS(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,qi=n,ji=Uo(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,qi=n,ji=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ka!==null?{id:$s,overflow:js}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=xr(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,qi=n,ji=null,!0):!1;default:return!1}}function ny(n){return(n.mode&1)!==0&&(n.flags&128)===0}function iy(n){if(Zt){var e=ji;if(e){var t=e;if(!QS(n,e)){if(ny(n))throw Error(_e(418));e=Uo(t.nextSibling);var i=qi;e&&QS(n,e)?uA(i,t):(n.flags=n.flags&-4097|2,Zt=!1,qi=n)}}else{if(ny(n))throw Error(_e(418));n.flags=n.flags&-4097|2,Zt=!1,qi=n}}}function JS(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;qi=n}function Jd(n){if(n!==qi)return!1;if(!Zt)return JS(n),Zt=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Qv(n.type,n.memoizedProps)),e&&(e=ji)){if(ny(n))throw fA(),Error(_e(418));for(;e;)uA(n,e),e=Uo(e.nextSibling)}if(JS(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(_e(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){ji=Uo(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}ji=null}}else ji=qi?Uo(n.stateNode.nextSibling):null;return!0}function fA(){for(var n=ji;n;)n=Uo(n.nextSibling)}function dc(){ji=qi=null,Zt=!1}function Ex(n){Ur===null?Ur=[n]:Ur.push(n)}var Gk=to.ReactCurrentBatchConfig;function xu(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(_e(309));var i=t.stateNode}if(!i)throw Error(_e(147,n));var r=i,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(_e(284));if(!t._owner)throw Error(_e(290,n))}return n}function eh(n,e){throw n=Object.prototype.toString.call(e),Error(_e(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function eM(n){var e=n._init;return e(n._payload)}function dA(n){function e(v,w){if(n){var S=v.deletions;S===null?(v.deletions=[w],v.flags|=16):S.push(w)}}function t(v,w){if(!n)return null;for(;w!==null;)e(v,w),w=w.sibling;return null}function i(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function r(v,w){return v=Vo(v,w),v.index=0,v.sibling=null,v}function s(v,w,S){return v.index=S,n?(S=v.alternate,S!==null?(S=S.index,S<w?(v.flags|=2,w):S):(v.flags|=2,w)):(v.flags|=1048576,w)}function o(v){return n&&v.alternate===null&&(v.flags|=2),v}function a(v,w,S,E){return w===null||w.tag!==6?(w=F0(S,v.mode,E),w.return=v,w):(w=r(w,S),w.return=v,w)}function c(v,w,S,E){var b=S.type;return b===zl?h(v,w,S.props.children,E,S.key):w!==null&&(w.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Ao&&eM(b)===w.type)?(E=r(w,S.props),E.ref=xu(v,w,S),E.return=v,E):(E=ip(S.type,S.key,S.props,null,v.mode,E),E.ref=xu(v,w,S),E.return=v,E)}function f(v,w,S,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==S.containerInfo||w.stateNode.implementation!==S.implementation?(w=D0(S,v.mode,E),w.return=v,w):(w=r(w,S.children||[]),w.return=v,w)}function h(v,w,S,E,b){return w===null||w.tag!==7?(w=Ia(S,v.mode,E,b),w.return=v,w):(w=r(w,S),w.return=v,w)}function d(v,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return w=F0(""+w,v.mode,S),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Wd:return S=ip(w.type,w.key,w.props,null,v.mode,S),S.ref=xu(v,null,w),S.return=v,S;case Bl:return w=D0(w,v.mode,S),w.return=v,w;case Ao:var E=w._init;return d(v,E(w._payload),S)}if(Gu(w)||pu(w))return w=Ia(w,v.mode,S,null),w.return=v,w;eh(v,w)}return null}function p(v,w,S,E){var b=w!==null?w.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return b!==null?null:a(v,w,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Wd:return S.key===b?c(v,w,S,E):null;case Bl:return S.key===b?f(v,w,S,E):null;case Ao:return b=S._init,p(v,w,b(S._payload),E)}if(Gu(S)||pu(S))return b!==null?null:h(v,w,S,E,null);eh(v,S)}return null}function g(v,w,S,E,b){if(typeof E=="string"&&E!==""||typeof E=="number")return v=v.get(S)||null,a(w,v,""+E,b);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Wd:return v=v.get(E.key===null?S:E.key)||null,c(w,v,E,b);case Bl:return v=v.get(E.key===null?S:E.key)||null,f(w,v,E,b);case Ao:var T=E._init;return g(v,w,S,T(E._payload),b)}if(Gu(E)||pu(E))return v=v.get(S)||null,h(w,v,E,b,null);eh(w,E)}return null}function _(v,w,S,E){for(var b=null,T=null,C=w,A=w=0,F=null;C!==null&&A<S.length;A++){C.index>A?(F=C,C=null):F=C.sibling;var U=p(v,C,S[A],E);if(U===null){C===null&&(C=F);break}n&&C&&U.alternate===null&&e(v,C),w=s(U,w,A),T===null?b=U:T.sibling=U,T=U,C=F}if(A===S.length)return t(v,C),Zt&&va(v,A),b;if(C===null){for(;A<S.length;A++)C=d(v,S[A],E),C!==null&&(w=s(C,w,A),T===null?b=C:T.sibling=C,T=C);return Zt&&va(v,A),b}for(C=i(v,C);A<S.length;A++)F=g(C,v,A,S[A],E),F!==null&&(n&&F.alternate!==null&&C.delete(F.key===null?A:F.key),w=s(F,w,A),T===null?b=F:T.sibling=F,T=F);return n&&C.forEach(function(W){return e(v,W)}),Zt&&va(v,A),b}function y(v,w,S,E){var b=pu(S);if(typeof b!="function")throw Error(_e(150));if(S=b.call(S),S==null)throw Error(_e(151));for(var T=b=null,C=w,A=w=0,F=null,U=S.next();C!==null&&!U.done;A++,U=S.next()){C.index>A?(F=C,C=null):F=C.sibling;var W=p(v,C,U.value,E);if(W===null){C===null&&(C=F);break}n&&C&&W.alternate===null&&e(v,C),w=s(W,w,A),T===null?b=W:T.sibling=W,T=W,C=F}if(U.done)return t(v,C),Zt&&va(v,A),b;if(C===null){for(;!U.done;A++,U=S.next())U=d(v,U.value,E),U!==null&&(w=s(U,w,A),T===null?b=U:T.sibling=U,T=U);return Zt&&va(v,A),b}for(C=i(v,C);!U.done;A++,U=S.next())U=g(C,v,A,U.value,E),U!==null&&(n&&U.alternate!==null&&C.delete(U.key===null?A:U.key),w=s(U,w,A),T===null?b=U:T.sibling=U,T=U);return n&&C.forEach(function(ne){return e(v,ne)}),Zt&&va(v,A),b}function x(v,w,S,E){if(typeof S=="object"&&S!==null&&S.type===zl&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Wd:e:{for(var b=S.key,T=w;T!==null;){if(T.key===b){if(b=S.type,b===zl){if(T.tag===7){t(v,T.sibling),w=r(T,S.props.children),w.return=v,v=w;break e}}else if(T.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Ao&&eM(b)===T.type){t(v,T.sibling),w=r(T,S.props),w.ref=xu(v,T,S),w.return=v,v=w;break e}t(v,T);break}else e(v,T);T=T.sibling}S.type===zl?(w=Ia(S.props.children,v.mode,E,S.key),w.return=v,v=w):(E=ip(S.type,S.key,S.props,null,v.mode,E),E.ref=xu(v,w,S),E.return=v,v=E)}return o(v);case Bl:e:{for(T=S.key;w!==null;){if(w.key===T)if(w.tag===4&&w.stateNode.containerInfo===S.containerInfo&&w.stateNode.implementation===S.implementation){t(v,w.sibling),w=r(w,S.children||[]),w.return=v,v=w;break e}else{t(v,w);break}else e(v,w);w=w.sibling}w=D0(S,v.mode,E),w.return=v,v=w}return o(v);case Ao:return T=S._init,x(v,w,T(S._payload),E)}if(Gu(S))return _(v,w,S,E);if(pu(S))return y(v,w,S,E);eh(v,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,w!==null&&w.tag===6?(t(v,w.sibling),w=r(w,S),w.return=v,v=w):(t(v,w),w=F0(S,v.mode,E),w.return=v,v=w),o(v)):t(v,w)}return x}var hc=dA(!0),hA=dA(!1),Ep=Ko(null),Ap=null,Xl=null,Ax=null;function Cx(){Ax=Xl=Ap=null}function Rx(n){var e=Ep.current;Vt(Ep),n._currentValue=e}function ry(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function ic(n,e){Ap=n,Ax=Xl=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&e)!==0&&(Pi=!0),n.firstContext=null)}function Mr(n){var e=n._currentValue;if(Ax!==n)if(n={context:n,memoizedValue:e,next:null},Xl===null){if(Ap===null)throw Error(_e(308));Xl=n,Ap.dependencies={lanes:0,firstContext:n}}else Xl=Xl.next=n;return e}var Ea=null;function Px(n){Ea===null?Ea=[n]:Ea.push(n)}function pA(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,Px(e)):(t.next=r.next,r.next=t),e.interleaved=t,Qs(n,i)}function Qs(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Co=!1;function Lx(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mA(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Xs(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Ho(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,(wt&2)!==0){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Qs(n,t)}return r=i.interleaved,r===null?(e.next=e,Px(i)):(e.next=r.next,r.next=e),i.interleaved=e,Qs(n,t)}function Zh(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,gx(n,t)}}function tM(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Cp(n,e,t,i){var r=n.updateQueue;Co=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var c=a,f=c.next;c.next=null,o===null?s=f:o.next=f,o=c;var h=n.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=f:a.next=f,h.lastBaseUpdate=c))}if(s!==null){var d=r.baseState;o=0,h=f=c=null,a=s;do{var p=a.lane,g=a.eventTime;if((i&p)===p){h!==null&&(h=h.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var _=n,y=a;switch(p=e,g=t,y.tag){case 1:if(_=y.payload,typeof _=="function"){d=_.call(g,d,p);break e}d=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=y.payload,p=typeof _=="function"?_.call(g,d,p):_,p==null)break e;d=nn({},d,p);break e;case 2:Co=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,p=r.effects,p===null?r.effects=[a]:p.push(a))}else g={eventTime:g,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(f=h=g,c=d):h=h.next=g,o|=p;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;p=a,a=p.next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}while(1);if(h===null&&(c=d),r.baseState=c,r.firstBaseUpdate=f,r.lastBaseUpdate=h,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);za|=o,n.lanes=o,n.memoizedState=d}}function nM(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(_e(191,r));r.call(i)}}}var Vf={},gs=Ko(Vf),_f=Ko(Vf),wf=Ko(Vf);function Aa(n){if(n===Vf)throw Error(_e(174));return n}function Ix(n,e){switch(Ht(wf,e),Ht(_f,n),Ht(gs,Vf),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Bv(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Bv(e,n)}Vt(gs),Ht(gs,e)}function pc(){Vt(gs),Vt(_f),Vt(wf)}function gA(n){Aa(wf.current);var e=Aa(gs.current),t=Bv(e,n.type);e!==t&&(Ht(_f,n),Ht(gs,t))}function Fx(n){_f.current===n&&(Vt(gs),Vt(_f))}var en=Ko(0);function Rp(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if((e.flags&128)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var A0=[];function Dx(){for(var n=0;n<A0.length;n++)A0[n]._workInProgressVersionPrimary=null;A0.length=0}var Qh=to.ReactCurrentDispatcher,C0=to.ReactCurrentBatchConfig,Ba=0,tn=null,Tn=null,Dn=null,Pp=!1,ef=!1,Sf=0,Wk=0;function ei(){throw Error(_e(321))}function Nx(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Yr(n[t],e[t]))return!1;return!0}function Ox(n,e,t,i,r,s){if(Ba=s,tn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Qh.current=n===null||n.memoizedState===null?Xk:qk,n=t(i,r),ef){s=0;do{if(ef=!1,Sf=0,25<=s)throw Error(_e(301));s+=1,Dn=Tn=null,e.updateQueue=null,Qh.current=Yk,n=t(i,r)}while(ef)}if(Qh.current=Lp,e=Tn!==null&&Tn.next!==null,Ba=0,Dn=Tn=tn=null,Pp=!1,e)throw Error(_e(300));return n}function kx(){var n=Sf!==0;return Sf=0,n}function os(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dn===null?tn.memoizedState=Dn=n:Dn=Dn.next=n,Dn}function br(){if(Tn===null){var n=tn.alternate;n=n!==null?n.memoizedState:null}else n=Tn.next;var e=Dn===null?tn.memoizedState:Dn.next;if(e!==null)Dn=e,Tn=n;else{if(n===null)throw Error(_e(310));Tn=n,n={memoizedState:Tn.memoizedState,baseState:Tn.baseState,baseQueue:Tn.baseQueue,queue:Tn.queue,next:null},Dn===null?tn.memoizedState=Dn=n:Dn=Dn.next=n}return Dn}function Mf(n,e){return typeof e=="function"?e(n):e}function R0(n){var e=br(),t=e.queue;if(t===null)throw Error(_e(311));t.lastRenderedReducer=n;var i=Tn,r=i.baseQueue,s=t.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,c=null,f=s;do{var h=f.lane;if((Ba&h)===h)c!==null&&(c=c.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),i=f.hasEagerState?f.eagerState:n(i,f.action);else{var d={lane:h,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};c===null?(a=c=d,o=i):c=c.next=d,tn.lanes|=h,za|=h}f=f.next}while(f!==null&&f!==s);c===null?o=i:c.next=a,Yr(i,e.memoizedState)||(Pi=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=c,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do s=r.lane,tn.lanes|=s,za|=s,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function P0(n){var e=br(),t=e.queue;if(t===null)throw Error(_e(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do s=n(s,o.action),o=o.next;while(o!==r);Yr(s,e.memoizedState)||(Pi=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,i]}function vA(){}function yA(n,e){var t=tn,i=br(),r=e(),s=!Yr(i.memoizedState,r);if(s&&(i.memoizedState=r,Pi=!0),i=i.queue,Bx(wA.bind(null,t,i,n),[n]),i.getSnapshot!==e||s||Dn!==null&&Dn.memoizedState.tag&1){if(t.flags|=2048,bf(9,_A.bind(null,t,i,r,e),void 0,null),On===null)throw Error(_e(349));(Ba&30)!==0||xA(t,e,r)}return r}function xA(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=tn.updateQueue,e===null?(e={lastEffect:null,stores:null},tn.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function _A(n,e,t,i){e.value=t,e.getSnapshot=i,SA(e)&&MA(n)}function wA(n,e,t){return t(function(){SA(e)&&MA(n)})}function SA(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Yr(n,t)}catch{return!0}}function MA(n){var e=Qs(n,1);e!==null&&Vr(e,n,1,-1)}function iM(n){var e=os();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mf,lastRenderedState:n},e.queue=n,n=n.dispatch=jk.bind(null,tn,n),[e.memoizedState,n]}function bf(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=tn.updateQueue,e===null?(e={lastEffect:null,stores:null},tn.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function bA(){return br().memoizedState}function Jh(n,e,t,i){var r=os();tn.flags|=n,r.memoizedState=bf(1|e,t,void 0,i===void 0?null:i)}function sm(n,e,t,i){var r=br();i=i===void 0?null:i;var s=void 0;if(Tn!==null){var o=Tn.memoizedState;if(s=o.destroy,i!==null&&Nx(i,o.deps)){r.memoizedState=bf(e,t,s,i);return}}tn.flags|=n,r.memoizedState=bf(1|e,t,s,i)}function rM(n,e){return Jh(8390656,8,n,e)}function Bx(n,e){return sm(2048,8,n,e)}function TA(n,e){return sm(4,2,n,e)}function EA(n,e){return sm(4,4,n,e)}function AA(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function CA(n,e,t){return t=t!=null?t.concat([n]):null,sm(4,4,AA.bind(null,e,n),t)}function zx(){}function RA(n,e){var t=br();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Nx(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function PA(n,e){var t=br();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Nx(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function LA(n,e,t){return(Ba&21)===0?(n.baseState&&(n.baseState=!1,Pi=!0),n.memoizedState=t):(Yr(t,e)||(t=OE(),tn.lanes|=t,za|=t,n.baseState=!0),e)}function Vk(n,e){var t=Nt;Nt=t!==0&&4>t?t:4,n(!0);var i=C0.transition;C0.transition={};try{n(!1),e()}finally{Nt=t,C0.transition=i}}function IA(){return br().memoizedState}function $k(n,e,t){var i=Wo(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},FA(n))DA(e,t);else if(t=pA(n,e,t,i),t!==null){var r=gi();Vr(t,n,i,r),NA(t,e,i)}}function jk(n,e,t){var i=Wo(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(FA(n))DA(e,r);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(r.hasEagerState=!0,r.eagerState=a,Yr(a,o)){var c=e.interleaved;c===null?(r.next=r,Px(e)):(r.next=c.next,c.next=r),e.interleaved=r;return}}catch{}finally{}t=pA(n,e,r,i),t!==null&&(r=gi(),Vr(t,n,i,r),NA(t,e,i))}}function FA(n){var e=n.alternate;return n===tn||e!==null&&e===tn}function DA(n,e){ef=Pp=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function NA(n,e,t){if((t&4194240)!==0){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,gx(n,t)}}var Lp={readContext:Mr,useCallback:ei,useContext:ei,useEffect:ei,useImperativeHandle:ei,useInsertionEffect:ei,useLayoutEffect:ei,useMemo:ei,useReducer:ei,useRef:ei,useState:ei,useDebugValue:ei,useDeferredValue:ei,useTransition:ei,useMutableSource:ei,useSyncExternalStore:ei,useId:ei,unstable_isNewReconciler:!1},Xk={readContext:Mr,useCallback:function(n,e){return os().memoizedState=[n,e===void 0?null:e],n},useContext:Mr,useEffect:rM,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Jh(4194308,4,AA.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Jh(4194308,4,n,e)},useInsertionEffect:function(n,e){return Jh(4,2,n,e)},useMemo:function(n,e){var t=os();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=os();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=$k.bind(null,tn,n),[i.memoizedState,n]},useRef:function(n){var e=os();return n={current:n},e.memoizedState=n},useState:iM,useDebugValue:zx,useDeferredValue:function(n){return os().memoizedState=n},useTransition:function(){var n=iM(!1),e=n[0];return n=Vk.bind(null,n[1]),os().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=tn,r=os();if(Zt){if(t===void 0)throw Error(_e(407));t=t()}else{if(t=e(),On===null)throw Error(_e(349));(Ba&30)!==0||xA(i,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,rM(wA.bind(null,i,s,n),[n]),i.flags|=2048,bf(9,_A.bind(null,i,s,t,e),void 0,null),t},useId:function(){var n=os(),e=On.identifierPrefix;if(Zt){var t=js,i=$s;t=(i&~(1<<32-Wr(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=Sf++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Wk++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},qk={readContext:Mr,useCallback:RA,useContext:Mr,useEffect:Bx,useImperativeHandle:CA,useInsertionEffect:TA,useLayoutEffect:EA,useMemo:PA,useReducer:R0,useRef:bA,useState:function(){return R0(Mf)},useDebugValue:zx,useDeferredValue:function(n){var e=br();return LA(e,Tn.memoizedState,n)},useTransition:function(){var n=R0(Mf)[0],e=br().memoizedState;return[n,e]},useMutableSource:vA,useSyncExternalStore:yA,useId:IA,unstable_isNewReconciler:!1},Yk={readContext:Mr,useCallback:RA,useContext:Mr,useEffect:Bx,useImperativeHandle:CA,useInsertionEffect:TA,useLayoutEffect:EA,useMemo:PA,useReducer:P0,useRef:bA,useState:function(){return P0(Mf)},useDebugValue:zx,useDeferredValue:function(n){var e=br();return Tn===null?e.memoizedState=n:LA(e,Tn.memoizedState,n)},useTransition:function(){var n=P0(Mf)[0],e=br().memoizedState;return[n,e]},useMutableSource:vA,useSyncExternalStore:yA,useId:IA,unstable_isNewReconciler:!1};function Br(n,e){if(n&&n.defaultProps){e=nn({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function sy(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:nn({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var om={isMounted:function(n){return(n=n._reactInternals)?Xa(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=gi(),r=Wo(n),s=Xs(i,r);s.payload=e,t!=null&&(s.callback=t),e=Ho(n,s,r),e!==null&&(Vr(e,n,r,i),Zh(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=gi(),r=Wo(n),s=Xs(i,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Ho(n,s,r),e!==null&&(Vr(e,n,r,i),Zh(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=gi(),i=Wo(n),r=Xs(t,i);r.tag=2,e!=null&&(r.callback=e),e=Ho(n,r,i),e!==null&&(Vr(e,n,i,t),Zh(e,n,i))}};function sM(n,e,t,i,r,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!gf(t,i)||!gf(r,s):!0}function OA(n,e,t){var i=!1,r=jo,s=e.contextType;return typeof s=="object"&&s!==null?s=Mr(s):(r=Ii(e)?Oa:oi.current,i=e.contextTypes,s=(i=i!=null)?fc(n,r):jo),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=om,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=s),e}function oM(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&om.enqueueReplaceState(e,e.state,null)}function oy(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs={},Lx(n);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Mr(s):(s=Ii(e)?Oa:oi.current,r.context=fc(n,s)),r.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(sy(n,e,s,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&om.enqueueReplaceState(r,r.state,null),Cp(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function mc(n,e){try{var t="",i=e;do t+=MO(i),i=i.return;while(i);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:r,digest:null}}function L0(n,e,t){return{value:n,source:null,stack:t!=null?t:null,digest:e!=null?e:null}}function ay(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Kk=typeof WeakMap=="function"?WeakMap:Map;function kA(n,e,t){t=Xs(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){Fp||(Fp=!0,vy=i),ay(n,e)},t}function BA(n,e,t){t=Xs(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){ay(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){ay(n,e),typeof i!="function"&&(Go===null?Go=new Set([this]):Go.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function aM(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new Kk;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=uB.bind(null,n,e,t),e.then(n,n))}function lM(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function cM(n,e,t,i,r){return(n.mode&1)===0?(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Xs(-1,1),e.tag=2,Ho(t,e,1))),t.lanes|=1),n):(n.flags|=65536,n.lanes=r,n)}var Zk=to.ReactCurrentOwner,Pi=!1;function fi(n,e,t,i){e.child=n===null?hA(e,null,t,i):hc(e,n.child,t,i)}function uM(n,e,t,i,r){t=t.render;var s=e.ref;return ic(e,r),i=Ox(n,e,t,i,s,r),t=kx(),n!==null&&!Pi?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Js(n,e,r)):(Zt&&t&&bx(e),e.flags|=1,fi(n,e,i,r),e.child)}function fM(n,e,t,i,r){if(n===null){var s=t.type;return typeof s=="function"&&!Xx(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,zA(n,e,s,i,r)):(n=ip(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,(n.lanes&r)===0){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:gf,t(o,i)&&n.ref===e.ref)return Js(n,e,r)}return e.flags|=1,n=Vo(s,i),n.ref=e.ref,n.return=e,e.child=n}function zA(n,e,t,i,r){if(n!==null){var s=n.memoizedProps;if(gf(s,i)&&n.ref===e.ref)if(Pi=!1,e.pendingProps=i=s,(n.lanes&r)!==0)(n.flags&131072)!==0&&(Pi=!0);else return e.lanes=n.lanes,Js(n,e,r)}return ly(n,e,t,i,r)}function UA(n,e,t){var i=e.pendingProps,r=i.children,s=n!==null?n.memoizedState:null;if(i.mode==="hidden")if((e.mode&1)===0)e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ht(Yl,$i),$i|=t;else{if((t&1073741824)===0)return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Ht(Yl,$i),$i|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:t,Ht(Yl,$i),$i|=i}else s!==null?(i=s.baseLanes|t,e.memoizedState=null):i=t,Ht(Yl,$i),$i|=i;return fi(n,e,r,t),e.child}function HA(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function ly(n,e,t,i,r){var s=Ii(t)?Oa:oi.current;return s=fc(e,s),ic(e,r),t=Ox(n,e,t,i,s,r),i=kx(),n!==null&&!Pi?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Js(n,e,r)):(Zt&&i&&bx(e),e.flags|=1,fi(n,e,t,r),e.child)}function dM(n,e,t,i,r){if(Ii(t)){var s=!0;Mp(e)}else s=!1;if(ic(e,r),e.stateNode===null)ep(n,e),OA(e,t,i),oy(e,t,i,r),i=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,f=t.contextType;typeof f=="object"&&f!==null?f=Mr(f):(f=Ii(t)?Oa:oi.current,f=fc(e,f));var h=t.getDerivedStateFromProps,d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||c!==f)&&oM(e,o,i,f),Co=!1;var p=e.memoizedState;o.state=p,Cp(e,i,o,r),c=e.memoizedState,a!==i||p!==c||Li.current||Co?(typeof h=="function"&&(sy(e,t,h,i),c=e.memoizedState),(a=Co||sM(e,t,a,i,p,c,f))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=c),o.props=i,o.state=c,o.context=f,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,mA(n,e),a=e.memoizedProps,f=e.type===e.elementType?a:Br(e.type,a),o.props=f,d=e.pendingProps,p=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=Mr(c):(c=Ii(t)?Oa:oi.current,c=fc(e,c));var g=t.getDerivedStateFromProps;(h=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||p!==c)&&oM(e,o,i,c),Co=!1,p=e.memoizedState,o.state=p,Cp(e,i,o,r);var _=e.memoizedState;a!==d||p!==_||Li.current||Co?(typeof g=="function"&&(sy(e,t,g,i),_=e.memoizedState),(f=Co||sM(e,t,f,i,p,_,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,_,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,_,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=_),o.props=i,o.state=_,o.context=c,i=f):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),i=!1)}return cy(n,e,t,i,s,r)}function cy(n,e,t,i,r,s){HA(n,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&ZS(e,t,!1),Js(n,e,s);i=e.stateNode,Zk.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&o?(e.child=hc(e,n.child,null,s),e.child=hc(e,null,a,s)):fi(n,e,a,s),e.memoizedState=i.state,r&&ZS(e,t,!0),e.child}function GA(n){var e=n.stateNode;e.pendingContext?KS(n,e.pendingContext,e.pendingContext!==e.context):e.context&&KS(n,e.context,!1),Ix(n,e.containerInfo)}function hM(n,e,t,i,r){return dc(),Ex(r),e.flags|=256,fi(n,e,t,i),e.child}var uy={dehydrated:null,treeContext:null,retryLane:0};function fy(n){return{baseLanes:n,cachePool:null,transitions:null}}function WA(n,e,t){var i=e.pendingProps,r=en.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),Ht(en,r&1),n===null)return iy(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((e.mode&1)===0?e.lanes=1:n.data==="$!"?e.lanes=8:e.lanes=1073741824,null):(o=i.children,n=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},(i&1)===0&&s!==null?(s.childLanes=0,s.pendingProps=o):s=cm(o,i,0,null),n=Ia(n,i,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=fy(t),e.memoizedState=uy,n):Ux(e,o));if(r=n.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return Qk(n,e,o,i,a,r,t);if(s){s=i.fallback,o=e.mode,r=n.child,a=r.sibling;var c={mode:"hidden",children:i.children};return(o&1)===0&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=c,e.deletions=null):(i=Vo(r,c),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Vo(a,s):(s=Ia(s,o,t,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=n.child.memoizedState,o=o===null?fy(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=uy,i}return s=n.child,n=s.sibling,i=Vo(s,{mode:"visible",children:i.children}),(e.mode&1)===0&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function Ux(n,e){return e=cm({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function th(n,e,t,i){return i!==null&&Ex(i),hc(e,n.child,null,t),n=Ux(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function Qk(n,e,t,i,r,s,o){if(t)return e.flags&256?(e.flags&=-257,i=L0(Error(_e(422))),th(n,e,o,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=cm({mode:"visible",children:i.children},r,0,null),s=Ia(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,(e.mode&1)!==0&&hc(e,n.child,null,o),e.child.memoizedState=fy(o),e.memoizedState=uy,s);if((e.mode&1)===0)return th(n,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(_e(419)),i=L0(s,i,void 0),th(n,e,o,i)}if(a=(o&n.childLanes)!==0,Pi||a){if(i=On,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=(r&(i.suspendedLanes|o))!==0?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Qs(n,r),Vr(i,n,r,-1))}return jx(),i=L0(Error(_e(421))),th(n,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=fB.bind(null,n),r._reactRetry=e,null):(n=s.treeContext,ji=Uo(r.nextSibling),qi=e,Zt=!0,Ur=null,n!==null&&(mr[gr++]=$s,mr[gr++]=js,mr[gr++]=ka,$s=n.id,js=n.overflow,ka=e),e=Ux(e,i.children),e.flags|=4096,e)}function pM(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),ry(n.return,e,t)}function I0(n,e,t,i,r){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=t,s.tailMode=r)}function VA(n,e,t){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(fi(n,e,i.children,t),i=en.current,(i&2)!==0)i=i&1|2,e.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&pM(n,t,e);else if(n.tag===19)pM(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(Ht(en,i),(e.mode&1)===0)e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&Rp(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),I0(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&Rp(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}I0(e,!0,t,null,s);break;case"together":I0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ep(n,e){(e.mode&1)===0&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Js(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),za|=e.lanes,(t&e.childLanes)===0)return null;if(n!==null&&e.child!==n.child)throw Error(_e(153));if(e.child!==null){for(n=e.child,t=Vo(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Vo(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function Jk(n,e,t){switch(e.tag){case 3:GA(e),dc();break;case 5:gA(e);break;case 1:Ii(e.type)&&Mp(e);break;case 4:Ix(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Ht(Ep,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Ht(en,en.current&1),e.flags|=128,null):(t&e.child.childLanes)!==0?WA(n,e,t):(Ht(en,en.current&1),n=Js(n,e,t),n!==null?n.sibling:null);Ht(en,en.current&1);break;case 19:if(i=(t&e.childLanes)!==0,(n.flags&128)!==0){if(i)return VA(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ht(en,en.current),i)break;return null;case 22:case 23:return e.lanes=0,UA(n,e,t)}return Js(n,e,t)}var $A,dy,jA,XA;$A=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};dy=function(){};jA=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,Aa(gs.current);var s=null;switch(t){case"input":r=Dv(n,r),i=Dv(n,i),s=[];break;case"select":r=nn({},r,{value:void 0}),i=nn({},i,{value:void 0}),s=[];break;case"textarea":r=kv(n,r),i=kv(n,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=wp)}zv(t,i);var o;t=null;for(f in r)if(!i.hasOwnProperty(f)&&r.hasOwnProperty(f)&&r[f]!=null)if(f==="style"){var a=r[f];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(cf.hasOwnProperty(f)?s||(s=[]):(s=s||[]).push(f,null));for(f in i){var c=i[f];if(a=r!=null?r[f]:void 0,i.hasOwnProperty(f)&&c!==a&&(c!=null||a!=null))if(f==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(s||(s=[]),s.push(f,t)),t=c;else f==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(f,c)):f==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(f,""+c):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(cf.hasOwnProperty(f)?(c!=null&&f==="onScroll"&&Wt("scroll",n),s||a===c||(s=[])):(s=s||[]).push(f,c))}t&&(s=s||[]).push("style",t);var f=s;(e.updateQueue=f)&&(e.flags|=4)}};XA=function(n,e,t,i){t!==i&&(e.flags|=4)};function _u(n,e){if(!Zt)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function ti(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function eB(n,e,t){var i=e.pendingProps;switch(Tx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ti(e),null;case 1:return Ii(e.type)&&Sp(),ti(e),null;case 3:return i=e.stateNode,pc(),Vt(Li),Vt(oi),Dx(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(Jd(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&(e.flags&256)===0||(e.flags|=1024,Ur!==null&&(_y(Ur),Ur=null))),dy(n,e),ti(e),null;case 5:Fx(e);var r=Aa(wf.current);if(t=e.type,n!==null&&e.stateNode!=null)jA(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(_e(166));return ti(e),null}if(n=Aa(gs.current),Jd(e)){i=e.stateNode,t=e.type;var s=e.memoizedProps;switch(i[fs]=e,i[xf]=s,n=(e.mode&1)!==0,t){case"dialog":Wt("cancel",i),Wt("close",i);break;case"iframe":case"object":case"embed":Wt("load",i);break;case"video":case"audio":for(r=0;r<Vu.length;r++)Wt(Vu[r],i);break;case"source":Wt("error",i);break;case"img":case"image":case"link":Wt("error",i),Wt("load",i);break;case"details":Wt("toggle",i);break;case"input":MS(i,s),Wt("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Wt("invalid",i);break;case"textarea":TS(i,s),Wt("invalid",i)}zv(t,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Qd(i.textContent,a,n),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Qd(i.textContent,a,n),r=["children",""+a]):cf.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Wt("scroll",i)}switch(t){case"input":Vd(i),bS(i,s,!0);break;case"textarea":Vd(i),ES(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=wp)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=wE(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=o.createElement(t,{is:i.is}):(n=o.createElement(t),t==="select"&&(o=n,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):n=o.createElementNS(n,t),n[fs]=e,n[xf]=i,$A(n,e,!1,!1),e.stateNode=n;e:{switch(o=Uv(t,i),t){case"dialog":Wt("cancel",n),Wt("close",n),r=i;break;case"iframe":case"object":case"embed":Wt("load",n),r=i;break;case"video":case"audio":for(r=0;r<Vu.length;r++)Wt(Vu[r],n);r=i;break;case"source":Wt("error",n),r=i;break;case"img":case"image":case"link":Wt("error",n),Wt("load",n),r=i;break;case"details":Wt("toggle",n),r=i;break;case"input":MS(n,i),r=Dv(n,i),Wt("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=nn({},i,{value:void 0}),Wt("invalid",n);break;case"textarea":TS(n,i),r=kv(n,i),Wt("invalid",n);break;default:r=i}zv(t,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?bE(n,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&SE(n,c)):s==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&uf(n,c):typeof c=="number"&&uf(n,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(cf.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Wt("scroll",n):c!=null&&ux(n,s,c,o))}switch(t){case"input":Vd(n),bS(n,i,!1);break;case"textarea":Vd(n),ES(n);break;case"option":i.value!=null&&n.setAttribute("value",""+$o(i.value));break;case"select":n.multiple=!!i.multiple,s=i.value,s!=null?Jl(n,!!i.multiple,s,!1):i.defaultValue!=null&&Jl(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=wp)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ti(e),null;case 6:if(n&&e.stateNode!=null)XA(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(_e(166));if(t=Aa(wf.current),Aa(gs.current),Jd(e)){if(i=e.stateNode,t=e.memoizedProps,i[fs]=e,(s=i.nodeValue!==t)&&(n=qi,n!==null))switch(n.tag){case 3:Qd(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Qd(i.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[fs]=e,e.stateNode=i}return ti(e),null;case 13:if(Vt(en),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Zt&&ji!==null&&(e.mode&1)!==0&&(e.flags&128)===0)fA(),dc(),e.flags|=98560,s=!1;else if(s=Jd(e),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(_e(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(_e(317));s[fs]=e}else dc(),(e.flags&128)===0&&(e.memoizedState=null),e.flags|=4;ti(e),s=!1}else Ur!==null&&(_y(Ur),Ur=null),s=!0;if(!s)return e.flags&65536?e:null}return(e.flags&128)!==0?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,(e.mode&1)!==0&&(n===null||(en.current&1)!==0?Cn===0&&(Cn=3):jx())),e.updateQueue!==null&&(e.flags|=4),ti(e),null);case 4:return pc(),dy(n,e),n===null&&vf(e.stateNode.containerInfo),ti(e),null;case 10:return Rx(e.type._context),ti(e),null;case 17:return Ii(e.type)&&Sp(),ti(e),null;case 19:if(Vt(en),s=e.memoizedState,s===null)return ti(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)_u(s,!1);else{if(Cn!==0||n!==null&&(n.flags&128)!==0)for(n=e.child;n!==null;){if(o=Rp(n),o!==null){for(e.flags|=128,_u(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)s=t,n=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Ht(en,en.current&1|2),e.child}n=n.sibling}s.tail!==null&&hn()>gc&&(e.flags|=128,i=!0,_u(s,!1),e.lanes=4194304)}else{if(!i)if(n=Rp(o),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),_u(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Zt)return ti(e),null}else 2*hn()-s.renderingStartTime>gc&&t!==1073741824&&(e.flags|=128,i=!0,_u(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=hn(),e.sibling=null,t=en.current,Ht(en,i?t&1|2:t&1),e):(ti(e),null);case 22:case 23:return $x(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&(e.mode&1)!==0?($i&1073741824)!==0&&(ti(e),e.subtreeFlags&6&&(e.flags|=8192)):ti(e),null;case 24:return null;case 25:return null}throw Error(_e(156,e.tag))}function tB(n,e){switch(Tx(e),e.tag){case 1:return Ii(e.type)&&Sp(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return pc(),Vt(Li),Vt(oi),Dx(),n=e.flags,(n&65536)!==0&&(n&128)===0?(e.flags=n&-65537|128,e):null;case 5:return Fx(e),null;case 13:if(Vt(en),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(_e(340));dc()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Vt(en),null;case 4:return pc(),null;case 10:return Rx(e.type._context),null;case 22:case 23:return $x(),null;case 24:return null;default:return null}}var nh=!1,ri=!1,nB=typeof WeakSet=="function"?WeakSet:Set,ke=null;function ql(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){ln(n,e,i)}else t.current=null}function hy(n,e,t){try{t()}catch(i){ln(n,e,i)}}var mM=!1;function iB(n,e){if(Kv=yp,n=QE(),Mx(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,c=-1,f=0,h=0,d=n,p=null;t:for(;;){for(var g;d!==t||r!==0&&d.nodeType!==3||(a=o+r),d!==s||i!==0&&d.nodeType!==3||(c=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(g=d.firstChild)!==null;)p=d,d=g;for(;;){if(d===n)break t;if(p===t&&++f===r&&(a=o),p===s&&++h===i&&(c=o),(g=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=g}t=a===-1||c===-1?null:{start:a,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(Zv={focusedElem:n,selectionRange:t},yp=!1,ke=e;ke!==null;)if(e=ke,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,ke=n;else for(;ke!==null;){e=ke;try{var _=e.alternate;if((e.flags&1024)!==0)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var y=_.memoizedProps,x=_.memoizedState,v=e.stateNode,w=v.getSnapshotBeforeUpdate(e.elementType===e.type?y:Br(e.type,y),x);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_e(163))}}catch(E){ln(e,e.return,E)}if(n=e.sibling,n!==null){n.return=e.return,ke=n;break}ke=e.return}return _=mM,mM=!1,_}function tf(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var s=r.destroy;r.destroy=void 0,s!==void 0&&hy(e,t,s)}r=r.next}while(r!==i)}}function am(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function py(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function qA(n){var e=n.alternate;e!==null&&(n.alternate=null,qA(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[fs],delete e[xf],delete e[ey],delete e[zk],delete e[Uk])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function YA(n){return n.tag===5||n.tag===3||n.tag===4}function gM(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||YA(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function my(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=wp));else if(i!==4&&(n=n.child,n!==null))for(my(n,e,t),n=n.sibling;n!==null;)my(n,e,t),n=n.sibling}function gy(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(gy(n,e,t),n=n.sibling;n!==null;)gy(n,e,t),n=n.sibling}var $n=null,zr=!1;function go(n,e,t){for(t=t.child;t!==null;)KA(n,e,t),t=t.sibling}function KA(n,e,t){if(ms&&typeof ms.onCommitFiberUnmount=="function")try{ms.onCommitFiberUnmount(Jp,t)}catch{}switch(t.tag){case 5:ri||ql(t,e);case 6:var i=$n,r=zr;$n=null,go(n,e,t),$n=i,zr=r,$n!==null&&(zr?(n=$n,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):$n.removeChild(t.stateNode));break;case 18:$n!==null&&(zr?(n=$n,t=t.stateNode,n.nodeType===8?T0(n.parentNode,t):n.nodeType===1&&T0(n,t),pf(n)):T0($n,t.stateNode));break;case 4:i=$n,r=zr,$n=t.stateNode.containerInfo,zr=!0,go(n,e,t),$n=i,zr=r;break;case 0:case 11:case 14:case 15:if(!ri&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&((s&2)!==0||(s&4)!==0)&&hy(t,e,o),r=r.next}while(r!==i)}go(n,e,t);break;case 1:if(!ri&&(ql(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){ln(t,e,a)}go(n,e,t);break;case 21:go(n,e,t);break;case 22:t.mode&1?(ri=(i=ri)||t.memoizedState!==null,go(n,e,t),ri=i):go(n,e,t);break;default:go(n,e,t)}}function vM(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new nB),e.forEach(function(i){var r=dB.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function Ir(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:$n=a.stateNode,zr=!1;break e;case 3:$n=a.stateNode.containerInfo,zr=!0;break e;case 4:$n=a.stateNode.containerInfo,zr=!0;break e}a=a.return}if($n===null)throw Error(_e(160));KA(s,o,r),$n=null,zr=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(f){ln(r,e,f)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ZA(e,n),e=e.sibling}function ZA(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Ir(e,n),ns(n),i&4){try{tf(3,n,n.return),am(3,n)}catch(y){ln(n,n.return,y)}try{tf(5,n,n.return)}catch(y){ln(n,n.return,y)}}break;case 1:Ir(e,n),ns(n),i&512&&t!==null&&ql(t,t.return);break;case 5:if(Ir(e,n),ns(n),i&512&&t!==null&&ql(t,t.return),n.flags&32){var r=n.stateNode;try{uf(r,"")}catch(y){ln(n,n.return,y)}}if(i&4&&(r=n.stateNode,r!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&xE(r,s),Uv(a,o);var f=Uv(a,s);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];h==="style"?bE(r,d):h==="dangerouslySetInnerHTML"?SE(r,d):h==="children"?uf(r,d):ux(r,h,d,f)}switch(a){case"input":Nv(r,s);break;case"textarea":_E(r,s);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?Jl(r,!!s.multiple,g,!1):p!==!!s.multiple&&(s.defaultValue!=null?Jl(r,!!s.multiple,s.defaultValue,!0):Jl(r,!!s.multiple,s.multiple?[]:"",!1))}r[xf]=s}catch(y){ln(n,n.return,y)}}break;case 6:if(Ir(e,n),ns(n),i&4){if(n.stateNode===null)throw Error(_e(162));r=n.stateNode,s=n.memoizedProps;try{r.nodeValue=s}catch(y){ln(n,n.return,y)}}break;case 3:if(Ir(e,n),ns(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{pf(e.containerInfo)}catch(y){ln(n,n.return,y)}break;case 4:Ir(e,n),ns(n);break;case 13:Ir(e,n),ns(n),r=n.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(Wx=hn())),i&4&&vM(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(ri=(f=ri)||h,Ir(e,n),ri=f):Ir(e,n),ns(n),i&8192){if(f=n.memoizedState!==null,(n.stateNode.isHidden=f)&&!h&&(n.mode&1)!==0)for(ke=n,h=n.child;h!==null;){for(d=ke=h;ke!==null;){switch(p=ke,g=p.child,p.tag){case 0:case 11:case 14:case 15:tf(4,p,p.return);break;case 1:ql(p,p.return);var _=p.stateNode;if(typeof _.componentWillUnmount=="function"){i=p,t=p.return;try{e=i,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(y){ln(i,t,y)}}break;case 5:ql(p,p.return);break;case 22:if(p.memoizedState!==null){xM(d);continue}}g!==null?(g.return=p,ke=g):xM(d)}h=h.sibling}e:for(h=null,d=n;;){if(d.tag===5){if(h===null){h=d;try{r=d.stateNode,f?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=ME("display",o))}catch(y){ln(n,n.return,y)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=f?"":d.memoizedProps}catch(y){ln(n,n.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ir(e,n),ns(n),i&4&&vM(n);break;case 21:break;default:Ir(e,n),ns(n)}}function ns(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(YA(t)){var i=t;break e}t=t.return}throw Error(_e(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(uf(r,""),i.flags&=-33);var s=gM(n);gy(n,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=gM(n);my(n,a,o);break;default:throw Error(_e(161))}}catch(c){ln(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function rB(n,e,t){ke=n,QA(n)}function QA(n,e,t){for(var i=(n.mode&1)!==0;ke!==null;){var r=ke,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||nh;if(!o){var a=r.alternate,c=a!==null&&a.memoizedState!==null||ri;a=nh;var f=ri;if(nh=o,(ri=c)&&!f)for(ke=r;ke!==null;)o=ke,c=o.child,o.tag===22&&o.memoizedState!==null?_M(r):c!==null?(c.return=o,ke=c):_M(r);for(;s!==null;)ke=s,QA(s),s=s.sibling;ke=r,nh=a,ri=f}yM(n)}else(r.subtreeFlags&8772)!==0&&s!==null?(s.return=r,ke=s):yM(n)}}function yM(n){for(;ke!==null;){var e=ke;if((e.flags&8772)!==0){var t=e.alternate;try{if((e.flags&8772)!==0)switch(e.tag){case 0:case 11:case 15:ri||am(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!ri)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:Br(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&nM(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}nM(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var f=e.alternate;if(f!==null){var h=f.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&pf(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_e(163))}ri||e.flags&512&&py(e)}catch(p){ln(e,e.return,p)}}if(e===n){ke=null;break}if(t=e.sibling,t!==null){t.return=e.return,ke=t;break}ke=e.return}}function xM(n){for(;ke!==null;){var e=ke;if(e===n){ke=null;break}var t=e.sibling;if(t!==null){t.return=e.return,ke=t;break}ke=e.return}}function _M(n){for(;ke!==null;){var e=ke;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{am(4,e)}catch(c){ln(e,t,c)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(c){ln(e,r,c)}}var s=e.return;try{py(e)}catch(c){ln(e,s,c)}break;case 5:var o=e.return;try{py(e)}catch(c){ln(e,o,c)}}}catch(c){ln(e,e.return,c)}if(e===n){ke=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ke=a;break}ke=e.return}}var sB=Math.ceil,Ip=to.ReactCurrentDispatcher,Hx=to.ReactCurrentOwner,Sr=to.ReactCurrentBatchConfig,wt=0,On=null,yn=null,Xn=0,$i=0,Yl=Ko(0),Cn=0,Tf=null,za=0,lm=0,Gx=0,nf=null,Ci=null,Wx=0,gc=1/0,Gs=null,Fp=!1,vy=null,Go=null,ih=!1,Fo=null,Dp=0,rf=0,yy=null,tp=-1,np=0;function gi(){return(wt&6)!==0?hn():tp!==-1?tp:tp=hn()}function Wo(n){return(n.mode&1)===0?1:(wt&2)!==0&&Xn!==0?Xn&-Xn:Gk.transition!==null?(np===0&&(np=OE()),np):(n=Nt,n!==0||(n=window.event,n=n===void 0?16:WE(n.type)),n)}function Vr(n,e,t,i){if(50<rf)throw rf=0,yy=null,Error(_e(185));Hf(n,t,i),((wt&2)===0||n!==On)&&(n===On&&((wt&2)===0&&(lm|=t),Cn===4&&Lo(n,Xn)),Fi(n,i),t===1&&wt===0&&(e.mode&1)===0&&(gc=hn()+500,rm&&Zo()))}function Fi(n,e){var t=n.callbackNode;GO(n,e);var i=vp(n,n===On?Xn:0);if(i===0)t!==null&&RS(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&RS(t),e===1)n.tag===0?Hk(wM.bind(null,n)):lA(wM.bind(null,n)),kk(function(){(wt&6)===0&&Zo()}),t=null;else{switch(kE(i)){case 1:t=mx;break;case 4:t=DE;break;case 16:t=gp;break;case 536870912:t=NE;break;default:t=gp}t=o2(t,JA.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function JA(n,e){if(tp=-1,np=0,(wt&6)!==0)throw Error(_e(327));var t=n.callbackNode;if(rc()&&n.callbackNode!==t)return null;var i=vp(n,n===On?Xn:0);if(i===0)return null;if((i&30)!==0||(i&n.expiredLanes)!==0||e)e=Np(n,i);else{e=i;var r=wt;wt|=2;var s=t2();(On!==n||Xn!==e)&&(Gs=null,gc=hn()+500,La(n,e));do try{lB();break}catch(a){e2(n,a)}while(1);Cx(),Ip.current=s,wt=r,yn!==null?e=0:(On=null,Xn=0,e=Cn)}if(e!==0){if(e===2&&(r=$v(n),r!==0&&(i=r,e=xy(n,r))),e===1)throw t=Tf,La(n,0),Lo(n,i),Fi(n,hn()),t;if(e===6)Lo(n,i);else{if(r=n.current.alternate,(i&30)===0&&!oB(r)&&(e=Np(n,i),e===2&&(s=$v(n),s!==0&&(i=s,e=xy(n,s))),e===1))throw t=Tf,La(n,0),Lo(n,i),Fi(n,hn()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(_e(345));case 2:ya(n,Ci,Gs);break;case 3:if(Lo(n,i),(i&130023424)===i&&(e=Wx+500-hn(),10<e)){if(vp(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){gi(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=Jv(ya.bind(null,n,Ci,Gs),e);break}ya(n,Ci,Gs);break;case 4:if(Lo(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var o=31-Wr(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=hn()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*sB(i/1960))-i,10<i){n.timeoutHandle=Jv(ya.bind(null,n,Ci,Gs),i);break}ya(n,Ci,Gs);break;case 5:ya(n,Ci,Gs);break;default:throw Error(_e(329))}}}return Fi(n,hn()),n.callbackNode===t?JA.bind(null,n):null}function xy(n,e){var t=nf;return n.current.memoizedState.isDehydrated&&(La(n,e).flags|=256),n=Np(n,e),n!==2&&(e=Ci,Ci=t,e!==null&&_y(e)),n}function _y(n){Ci===null?Ci=n:Ci.push.apply(Ci,n)}function oB(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],s=r.getSnapshot;r=r.value;try{if(!Yr(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Lo(n,e){for(e&=~Gx,e&=~lm,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Wr(e),i=1<<t;n[t]=-1,e&=~i}}function wM(n){if((wt&6)!==0)throw Error(_e(327));rc();var e=vp(n,0);if((e&1)===0)return Fi(n,hn()),null;var t=Np(n,e);if(n.tag!==0&&t===2){var i=$v(n);i!==0&&(e=i,t=xy(n,i))}if(t===1)throw t=Tf,La(n,0),Lo(n,e),Fi(n,hn()),t;if(t===6)throw Error(_e(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,ya(n,Ci,Gs),Fi(n,hn()),null}function Vx(n,e){var t=wt;wt|=1;try{return n(e)}finally{wt=t,wt===0&&(gc=hn()+500,rm&&Zo())}}function Ua(n){Fo!==null&&Fo.tag===0&&(wt&6)===0&&rc();var e=wt;wt|=1;var t=Sr.transition,i=Nt;try{if(Sr.transition=null,Nt=1,n)return n()}finally{Nt=i,Sr.transition=t,wt=e,(wt&6)===0&&Zo()}}function $x(){$i=Yl.current,Vt(Yl)}function La(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Ok(t)),yn!==null)for(t=yn.return;t!==null;){var i=t;switch(Tx(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Sp();break;case 3:pc(),Vt(Li),Vt(oi),Dx();break;case 5:Fx(i);break;case 4:pc();break;case 13:Vt(en);break;case 19:Vt(en);break;case 10:Rx(i.type._context);break;case 22:case 23:$x()}t=t.return}if(On=n,yn=n=Vo(n.current,null),Xn=$i=e,Cn=0,Tf=null,Gx=lm=za=0,Ci=nf=null,Ea!==null){for(e=0;e<Ea.length;e++)if(t=Ea[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,s=t.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}t.pending=i}Ea=null}return n}function e2(n,e){do{var t=yn;try{if(Cx(),Qh.current=Lp,Pp){for(var i=tn.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Pp=!1}if(Ba=0,Dn=Tn=tn=null,ef=!1,Sf=0,Hx.current=null,t===null||t.return===null){Cn=1,Tf=e,yn=null;break}e:{var s=n,o=t.return,a=t,c=e;if(e=Xn,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var f=c,h=a,d=h.tag;if((h.mode&1)===0&&(d===0||d===11||d===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=lM(o);if(g!==null){g.flags&=-257,cM(g,o,a,s,e),g.mode&1&&aM(s,f,e),e=g,c=f;var _=e.updateQueue;if(_===null){var y=new Set;y.add(c),e.updateQueue=y}else _.add(c);break e}else{if((e&1)===0){aM(s,f,e),jx();break e}c=Error(_e(426))}}else if(Zt&&a.mode&1){var x=lM(o);if(x!==null){(x.flags&65536)===0&&(x.flags|=256),cM(x,o,a,s,e),Ex(mc(c,a));break e}}s=c=mc(c,a),Cn!==4&&(Cn=2),nf===null?nf=[s]:nf.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=kA(s,c,e);tM(s,v);break e;case 1:a=c;var w=s.type,S=s.stateNode;if((s.flags&128)===0&&(typeof w.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Go===null||!Go.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var E=BA(s,a,e);tM(s,E);break e}}s=s.return}while(s!==null)}i2(t)}catch(b){e=b,yn===t&&t!==null&&(yn=t=t.return);continue}break}while(1)}function t2(){var n=Ip.current;return Ip.current=Lp,n===null?Lp:n}function jx(){(Cn===0||Cn===3||Cn===2)&&(Cn=4),On===null||(za&268435455)===0&&(lm&268435455)===0||Lo(On,Xn)}function Np(n,e){var t=wt;wt|=2;var i=t2();(On!==n||Xn!==e)&&(Gs=null,La(n,e));do try{aB();break}catch(r){e2(n,r)}while(1);if(Cx(),wt=t,Ip.current=i,yn!==null)throw Error(_e(261));return On=null,Xn=0,Cn}function aB(){for(;yn!==null;)n2(yn)}function lB(){for(;yn!==null&&!FO();)n2(yn)}function n2(n){var e=s2(n.alternate,n,$i);n.memoizedProps=n.pendingProps,e===null?i2(n):yn=e,Hx.current=null}function i2(n){var e=n;do{var t=e.alternate;if(n=e.return,(e.flags&32768)===0){if(t=eB(t,e,$i),t!==null){yn=t;return}}else{if(t=tB(t,e),t!==null){t.flags&=32767,yn=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Cn=6,yn=null;return}}if(e=e.sibling,e!==null){yn=e;return}yn=e=n}while(e!==null);Cn===0&&(Cn=5)}function ya(n,e,t){var i=Nt,r=Sr.transition;try{Sr.transition=null,Nt=1,cB(n,e,t,i)}finally{Sr.transition=r,Nt=i}return null}function cB(n,e,t,i){do rc();while(Fo!==null);if((wt&6)!==0)throw Error(_e(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(_e(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(WO(n,s),n===On&&(yn=On=null,Xn=0),(t.subtreeFlags&2064)===0&&(t.flags&2064)===0||ih||(ih=!0,o2(gp,function(){return rc(),null})),s=(t.flags&15990)!==0,(t.subtreeFlags&15990)!==0||s){s=Sr.transition,Sr.transition=null;var o=Nt;Nt=1;var a=wt;wt|=4,Hx.current=null,iB(n,t),ZA(t,n),Rk(Zv),yp=!!Kv,Zv=Kv=null,n.current=t,rB(t),DO(),wt=a,Nt=o,Sr.transition=s}else n.current=t;if(ih&&(ih=!1,Fo=n,Dp=r),s=n.pendingLanes,s===0&&(Go=null),kO(t.stateNode),Fi(n,hn()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(Fp)throw Fp=!1,n=vy,vy=null,n;return(Dp&1)!==0&&n.tag!==0&&rc(),s=n.pendingLanes,(s&1)!==0?n===yy?rf++:(rf=0,yy=n):rf=0,Zo(),null}function rc(){if(Fo!==null){var n=kE(Dp),e=Sr.transition,t=Nt;try{if(Sr.transition=null,Nt=16>n?16:n,Fo===null)var i=!1;else{if(n=Fo,Fo=null,Dp=0,(wt&6)!==0)throw Error(_e(331));var r=wt;for(wt|=4,ke=n.current;ke!==null;){var s=ke,o=s.child;if((ke.flags&16)!==0){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var f=a[c];for(ke=f;ke!==null;){var h=ke;switch(h.tag){case 0:case 11:case 15:tf(8,h,s)}var d=h.child;if(d!==null)d.return=h,ke=d;else for(;ke!==null;){h=ke;var p=h.sibling,g=h.return;if(qA(h),h===f){ke=null;break}if(p!==null){p.return=g,ke=p;break}ke=g}}}var _=s.alternate;if(_!==null){var y=_.child;if(y!==null){_.child=null;do{var x=y.sibling;y.sibling=null,y=x}while(y!==null)}}ke=s}}if((s.subtreeFlags&2064)!==0&&o!==null)o.return=s,ke=o;else e:for(;ke!==null;){if(s=ke,(s.flags&2048)!==0)switch(s.tag){case 0:case 11:case 15:tf(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,ke=v;break e}ke=s.return}}var w=n.current;for(ke=w;ke!==null;){o=ke;var S=o.child;if((o.subtreeFlags&2064)!==0&&S!==null)S.return=o,ke=S;else e:for(o=w;ke!==null;){if(a=ke,(a.flags&2048)!==0)try{switch(a.tag){case 0:case 11:case 15:am(9,a)}}catch(b){ln(a,a.return,b)}if(a===o){ke=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,ke=E;break e}ke=a.return}}if(wt=r,Zo(),ms&&typeof ms.onPostCommitFiberRoot=="function")try{ms.onPostCommitFiberRoot(Jp,n)}catch{}i=!0}return i}finally{Nt=t,Sr.transition=e}}return!1}function SM(n,e,t){e=mc(t,e),e=kA(n,e,1),n=Ho(n,e,1),e=gi(),n!==null&&(Hf(n,1,e),Fi(n,e))}function ln(n,e,t){if(n.tag===3)SM(n,n,t);else for(;e!==null;){if(e.tag===3){SM(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Go===null||!Go.has(i))){n=mc(t,n),n=BA(e,n,1),e=Ho(e,n,1),n=gi(),e!==null&&(Hf(e,1,n),Fi(e,n));break}}e=e.return}}function uB(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=gi(),n.pingedLanes|=n.suspendedLanes&t,On===n&&(Xn&t)===t&&(Cn===4||Cn===3&&(Xn&130023424)===Xn&&500>hn()-Wx?La(n,0):Gx|=t),Fi(n,e)}function r2(n,e){e===0&&((n.mode&1)===0?e=1:(e=Xd,Xd<<=1,(Xd&130023424)===0&&(Xd=4194304)));var t=gi();n=Qs(n,e),n!==null&&(Hf(n,e,t),Fi(n,t))}function fB(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),r2(n,t)}function dB(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(_e(314))}i!==null&&i.delete(e),r2(n,t)}var s2;s2=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Li.current)Pi=!0;else{if((n.lanes&t)===0&&(e.flags&128)===0)return Pi=!1,Jk(n,e,t);Pi=(n.flags&131072)!==0}else Pi=!1,Zt&&(e.flags&1048576)!==0&&cA(e,Tp,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;ep(n,e),n=e.pendingProps;var r=fc(e,oi.current);ic(e,t),r=Ox(null,e,i,n,r,t);var s=kx();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ii(i)?(s=!0,Mp(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Lx(e),r.updater=om,e.stateNode=r,r._reactInternals=e,oy(e,i,n,t),e=cy(null,e,i,!0,s,t)):(e.tag=0,Zt&&s&&bx(e),fi(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(ep(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=pB(i),n=Br(i,n),r){case 0:e=ly(null,e,i,n,t);break e;case 1:e=dM(null,e,i,n,t);break e;case 11:e=uM(null,e,i,n,t);break e;case 14:e=fM(null,e,i,Br(i.type,n),t);break e}throw Error(_e(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Br(i,r),ly(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Br(i,r),dM(n,e,i,r,t);case 3:e:{if(GA(e),n===null)throw Error(_e(387));i=e.pendingProps,s=e.memoizedState,r=s.element,mA(n,e),Cp(e,i,null,t);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=mc(Error(_e(423)),e),e=hM(n,e,i,t,r);break e}else if(i!==r){r=mc(Error(_e(424)),e),e=hM(n,e,i,t,r);break e}else for(ji=Uo(e.stateNode.containerInfo.firstChild),qi=e,Zt=!0,Ur=null,t=hA(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(dc(),i===r){e=Js(n,e,t);break e}fi(n,e,i,t)}e=e.child}return e;case 5:return gA(e),n===null&&iy(e),i=e.type,r=e.pendingProps,s=n!==null?n.memoizedProps:null,o=r.children,Qv(i,r)?o=null:s!==null&&Qv(i,s)&&(e.flags|=32),HA(n,e),fi(n,e,o,t),e.child;case 6:return n===null&&iy(e),null;case 13:return WA(n,e,t);case 4:return Ix(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=hc(e,null,i,t):fi(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Br(i,r),uM(n,e,i,r,t);case 7:return fi(n,e,e.pendingProps,t),e.child;case 8:return fi(n,e,e.pendingProps.children,t),e.child;case 12:return fi(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,Ht(Ep,i._currentValue),i._currentValue=o,s!==null)if(Yr(s.value,o)){if(s.children===r.children&&!Li.current){e=Js(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===i){if(s.tag===1){c=Xs(-1,t&-t),c.tag=2;var f=s.updateQueue;if(f!==null){f=f.shared;var h=f.pending;h===null?c.next=c:(c.next=h.next,h.next=c),f.pending=c}}s.lanes|=t,c=s.alternate,c!==null&&(c.lanes|=t),ry(s.return,t,e),a.lanes|=t;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(_e(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),ry(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}fi(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,ic(e,t),r=Mr(r),i=i(r),e.flags|=1,fi(n,e,i,t),e.child;case 14:return i=e.type,r=Br(i,e.pendingProps),r=Br(i.type,r),fM(n,e,i,r,t);case 15:return zA(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Br(i,r),ep(n,e),e.tag=1,Ii(i)?(n=!0,Mp(e)):n=!1,ic(e,t),OA(e,i,r),oy(e,i,r,t),cy(null,e,i,!0,n,t);case 19:return VA(n,e,t);case 22:return UA(n,e,t)}throw Error(_e(156,e.tag))};function o2(n,e){return FE(n,e)}function hB(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xr(n,e,t,i){return new hB(n,e,t,i)}function Xx(n){return n=n.prototype,!(!n||!n.isReactComponent)}function pB(n){if(typeof n=="function")return Xx(n)?1:0;if(n!=null){if(n=n.$$typeof,n===dx)return 11;if(n===hx)return 14}return 2}function Vo(n,e){var t=n.alternate;return t===null?(t=xr(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function ip(n,e,t,i,r,s){var o=2;if(i=n,typeof n=="function")Xx(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case zl:return Ia(t.children,r,s,e);case fx:o=8,r|=8;break;case Pv:return n=xr(12,t,e,r|2),n.elementType=Pv,n.lanes=s,n;case Lv:return n=xr(13,t,e,r),n.elementType=Lv,n.lanes=s,n;case Iv:return n=xr(19,t,e,r),n.elementType=Iv,n.lanes=s,n;case gE:return cm(t,r,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case pE:o=10;break e;case mE:o=9;break e;case dx:o=11;break e;case hx:o=14;break e;case Ao:o=16,i=null;break e}throw Error(_e(130,n==null?n:typeof n,""))}return e=xr(o,t,e,r),e.elementType=n,e.type=i,e.lanes=s,e}function Ia(n,e,t,i){return n=xr(7,n,i,e),n.lanes=t,n}function cm(n,e,t,i){return n=xr(22,n,i,e),n.elementType=gE,n.lanes=t,n.stateNode={isHidden:!1},n}function F0(n,e,t){return n=xr(6,n,null,e),n.lanes=t,n}function D0(n,e,t){return e=xr(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function mB(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=p0(0),this.expirationTimes=p0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=p0(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function qx(n,e,t,i,r,s,o,a,c){return n=new mB(n,e,t,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=xr(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lx(s),n}function gB(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bl,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function a2(n){if(!n)return jo;n=n._reactInternals;e:{if(Xa(n)!==n||n.tag!==1)throw Error(_e(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ii(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(_e(171))}if(n.tag===1){var t=n.type;if(Ii(t))return aA(n,t,e)}return e}function l2(n,e,t,i,r,s,o,a,c){return n=qx(t,i,!0,n,r,s,o,a,c),n.context=a2(null),t=n.current,i=gi(),r=Wo(t),s=Xs(i,r),s.callback=e!=null?e:null,Ho(t,s,r),n.current.lanes=r,Hf(n,r,i),Fi(n,i),n}function um(n,e,t,i){var r=e.current,s=gi(),o=Wo(r);return t=a2(t),e.context===null?e.context=t:e.pendingContext=t,e=Xs(s,o),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=Ho(r,e,o),n!==null&&(Vr(n,r,o,s),Zh(n,r,o)),o}function Op(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function MM(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Yx(n,e){MM(n,e),(n=n.alternate)&&MM(n,e)}function vB(){return null}var c2=typeof reportError=="function"?reportError:function(n){console.error(n)};function Kx(n){this._internalRoot=n}fm.prototype.render=Kx.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(_e(409));um(n,e,null,null)};fm.prototype.unmount=Kx.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Ua(function(){um(null,n,null,null)}),e[Zs]=null}};function fm(n){this._internalRoot=n}fm.prototype.unstable_scheduleHydration=function(n){if(n){var e=UE();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Po.length&&e!==0&&e<Po[t].priority;t++);Po.splice(t,0,n),t===0&&GE(n)}};function Zx(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function dm(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function bM(){}function yB(n,e,t,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var f=Op(o);s.call(f)}}var o=l2(e,i,n,0,null,!1,!1,"",bM);return n._reactRootContainer=o,n[Zs]=o.current,vf(n.nodeType===8?n.parentNode:n),Ua(),o}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var f=Op(c);a.call(f)}}var c=qx(n,0,!1,null,null,!1,!1,"",bM);return n._reactRootContainer=c,n[Zs]=c.current,vf(n.nodeType===8?n.parentNode:n),Ua(function(){um(e,c,t,i)}),c}function hm(n,e,t,i,r){var s=t._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var c=Op(o);a.call(c)}}um(e,o,n,r)}else o=yB(t,e,n,r,i);return Op(o)}BE=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Wu(e.pendingLanes);t!==0&&(gx(e,t|1),Fi(e,hn()),(wt&6)===0&&(gc=hn()+500,Zo()))}break;case 13:Ua(function(){var i=Qs(n,1);if(i!==null){var r=gi();Vr(i,n,1,r)}}),Yx(n,1)}};vx=function(n){if(n.tag===13){var e=Qs(n,134217728);if(e!==null){var t=gi();Vr(e,n,134217728,t)}Yx(n,134217728)}};zE=function(n){if(n.tag===13){var e=Wo(n),t=Qs(n,e);if(t!==null){var i=gi();Vr(t,n,e,i)}Yx(n,e)}};UE=function(){return Nt};HE=function(n,e){var t=Nt;try{return Nt=n,e()}finally{Nt=t}};Gv=function(n,e,t){switch(e){case"input":if(Nv(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=im(i);if(!r)throw Error(_e(90));yE(i),Nv(i,r)}}}break;case"textarea":_E(n,t);break;case"select":e=t.value,e!=null&&Jl(n,!!t.multiple,e,!1)}};AE=Vx;CE=Ua;var xB={usingClientEntryPoint:!1,Events:[Wf,Wl,im,TE,EE,Vx]},wu={findFiberByHostInstance:Ta,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_B={bundleType:wu.bundleType,version:wu.version,rendererPackageName:wu.rendererPackageName,rendererConfig:wu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:to.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=LE(n),n===null?null:n.stateNode},findFiberByHostInstance:wu.findFiberByHostInstance||vB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"){var rh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rh.isDisabled&&rh.supportsFiber)try{Jp=rh.inject(_B),ms=rh}catch{}}Zi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xB;Zi.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zx(e))throw Error(_e(200));return gB(n,e,null,t)};Zi.createRoot=function(n,e){if(!Zx(n))throw Error(_e(299));var t=!1,i="",r=c2;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=qx(n,1,!1,null,null,t,!1,i,r),n[Zs]=e.current,vf(n.nodeType===8?n.parentNode:n),new Kx(e)};Zi.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(_e(188)):(n=Object.keys(n).join(","),Error(_e(268,n)));return n=LE(e),n=n===null?null:n.stateNode,n};Zi.flushSync=function(n){return Ua(n)};Zi.hydrate=function(n,e,t){if(!dm(e))throw Error(_e(200));return hm(null,n,e,!0,t)};Zi.hydrateRoot=function(n,e,t){if(!Zx(n))throw Error(_e(405));var i=t!=null&&t.hydratedSources||null,r=!1,s="",o=c2;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=l2(e,null,n,1,t!=null?t:null,r,!1,s,o),n[Zs]=e.current,vf(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new fm(e)};Zi.render=function(n,e,t){if(!dm(e))throw Error(_e(200));return hm(null,n,e,!1,t)};Zi.unmountComponentAtNode=function(n){if(!dm(n))throw Error(_e(40));return n._reactRootContainer?(Ua(function(){hm(null,null,n,!1,function(){n._reactRootContainer=null,n[Zs]=null})}),!0):!1};Zi.unstable_batchedUpdates=Vx;Zi.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!dm(t))throw Error(_e(200));if(n==null||n._reactInternals===void 0)throw Error(_e(38));return hm(n,e,t,!1,i)};Zi.version="18.3.1-next-f1338f8080-20240426";function u2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(u2)}catch(n){console.error(n)}}u2(),nE.exports=Zi;var TM=nE.exports;Cv.createRoot=TM.createRoot,Cv.hydrateRoot=TM.hydrateRoot;var sh,wB=new Uint8Array(16);function SB(){if(!sh&&(sh=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!sh))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return sh(wB)}var MB=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function bB(n){return typeof n=="string"&&MB.test(n)}var Wn=[];for(var N0=0;N0<256;++N0)Wn.push((N0+256).toString(16).substr(1));function TB(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(Wn[n[e+0]]+Wn[n[e+1]]+Wn[n[e+2]]+Wn[n[e+3]]+"-"+Wn[n[e+4]]+Wn[n[e+5]]+"-"+Wn[n[e+6]]+Wn[n[e+7]]+"-"+Wn[n[e+8]]+Wn[n[e+9]]+"-"+Wn[n[e+10]]+Wn[n[e+11]]+Wn[n[e+12]]+Wn[n[e+13]]+Wn[n[e+14]]+Wn[n[e+15]]).toLowerCase();if(!bB(t))throw TypeError("Stringified UUID is invalid");return t}function Qx(n,e,t){n=n||{};var i=n.random||(n.rng||SB)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){t=t||0;for(var r=0;r<16;++r)e[t+r]=i[r];return e}return TB(i)}const EB=n=>n[Math.floor(Math.random()*n.length)],AB=(n,e)=>{const t=n%e,i=Math.floor(n/e);return[t,i]},CB=(n,e)=>{const t=n.indexOf(e);t!==-1&&n.splice(t,1)},EM=n=>n===void 0?[]:Array.isArray(n)?n:[n];/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Jx="141",Ro={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},pl={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},RB=0,AM=1,PB=2,f2=1,d2=2,$u=3,vc=0,$r=1,xs=2,LB=1,jr=0,sc=1,kp=2,CM=3,RM=4,IB=5,kl=100,FB=101,DB=102,PM=103,LM=104,NB=200,OB=201,kB=202,BB=203,h2=204,p2=205,zB=206,UB=207,HB=208,GB=209,WB=210,VB=0,$B=1,jB=2,wy=3,XB=4,qB=5,YB=6,e_=7,pm=0,KB=1,ZB=2,vs=0,QB=1,m2=2,JB=3,e4=4,t4=5,g2=300,yc=301,xc=302,Bp=303,Sy=304,mm=306,hs=1e3,yr=1001,zp=1002,En=1003,My=1004,by=1005,Ri=1006,v2=1007,Dc=1008,Ha=1009,n4=1010,i4=1011,y2=1012,r4=1013,Ca=1014,Do=1015,Ef=1016,s4=1017,o4=1018,oc=1020,a4=1021,l4=1022,_r=1023,c4=1024,u4=1025,Fa=1026,_c=1027,f4=1028,d4=1029,h4=1030,p4=1031,m4=1033,O0=33776,k0=33777,B0=33778,z0=33779,IM=35840,FM=35841,DM=35842,NM=35843,g4=36196,OM=37492,kM=37496,BM=37808,zM=37809,UM=37810,HM=37811,GM=37812,WM=37813,VM=37814,$M=37815,jM=37816,XM=37817,qM=37818,YM=37819,KM=37820,ZM=37821,QM=36492,v4=2200,y4=2201,x4=2202,Af=2300,wc=2301,U0=2302,Kl=2400,Zl=2401,Up=2402,t_=2500,x2=2501,_4=1,_2=2,Ga=3e3,Lt=3001,w4=3200,n_=3201,qa=0,S4=1,Ws="srgb",Ra="srgb-linear",H0=7680,M4=519,Ty=35044,JM=35048,eb="300 es",Ey=1035;class Qo{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Vn=[];for(let n=0;n<256;n++)Vn[n]=(n<16?"0":"")+n.toString(16);let tb=1234567;const ac=Math.PI/180,Cf=180/Math.PI;function Xr(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Vn[n&255]+Vn[n>>8&255]+Vn[n>>16&255]+Vn[n>>24&255]+"-"+Vn[e&255]+Vn[e>>8&255]+"-"+Vn[e>>16&15|64]+Vn[e>>24&255]+"-"+Vn[t&63|128]+Vn[t>>8&255]+"-"+Vn[t>>16&255]+Vn[t>>24&255]+Vn[i&255]+Vn[i>>8&255]+Vn[i>>16&255]+Vn[i>>24&255]).toLowerCase()}function si(n,e,t){return Math.max(e,Math.min(t,n))}function i_(n,e){return(n%e+e)%e}function b4(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function T4(n,e,t){return n!==e?(t-n)/(e-n):0}function sf(n,e,t){return(1-t)*n+t*e}function E4(n,e,t,i){return sf(n,e,1-Math.exp(-t*i))}function A4(n,e=1){return e-Math.abs(i_(n,e*2)-e)}function C4(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function R4(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function P4(n,e){return n+Math.floor(Math.random()*(e-n+1))}function L4(n,e){return n+Math.random()*(e-n)}function I4(n){return n*(.5-Math.random())}function F4(n){n!==void 0&&(tb=n);let e=tb+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function D4(n){return n*ac}function N4(n){return n*Cf}function Ay(n){return(n&n-1)===0&&n!==0}function w2(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Hp(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function O4(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),c=o(t/2),f=s((e+i)/2),h=o((e+i)/2),d=s((e-i)/2),p=o((e-i)/2),g=s((i-e)/2),_=o((i-e)/2);switch(r){case"XYX":n.set(a*h,c*d,c*p,a*f);break;case"YZY":n.set(c*p,a*h,c*d,a*f);break;case"ZXZ":n.set(c*d,c*p,a*h,a*f);break;case"XZX":n.set(a*h,c*_,c*g,a*f);break;case"YXY":n.set(c*g,a*h,c*_,a*f);break;case"ZYZ":n.set(c*_,c*g,a*h,a*f);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function k4(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function B4(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}var z4=Object.freeze({__proto__:null,DEG2RAD:ac,RAD2DEG:Cf,generateUUID:Xr,clamp:si,euclideanModulo:i_,mapLinear:b4,inverseLerp:T4,lerp:sf,damp:E4,pingpong:A4,smoothstep:C4,smootherstep:R4,randInt:P4,randFloat:L4,randFloatSpread:I4,seededRandom:F4,degToRad:D4,radToDeg:N4,isPowerOfTwo:Ay,ceilPowerOfTwo:w2,floorPowerOfTwo:Hp,setQuaternionFromProperEuler:O4,normalize:B4,denormalize:k4});class Ce{constructor(e=0,t=0){this.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,i){return i!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ps{constructor(){this.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,s,o,a,c,f){const h=this.elements;return h[0]=e,h[1]=r,h[2]=a,h[3]=t,h[4]=s,h[5]=c,h[6]=i,h[7]=o,h[8]=f,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],c=i[6],f=i[1],h=i[4],d=i[7],p=i[2],g=i[5],_=i[8],y=r[0],x=r[3],v=r[6],w=r[1],S=r[4],E=r[7],b=r[2],T=r[5],C=r[8];return s[0]=o*y+a*w+c*b,s[3]=o*x+a*S+c*T,s[6]=o*v+a*E+c*C,s[1]=f*y+h*w+d*b,s[4]=f*x+h*S+d*T,s[7]=f*v+h*E+d*C,s[2]=p*y+g*w+_*b,s[5]=p*x+g*S+_*T,s[8]=p*v+g*E+_*C,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],f=e[7],h=e[8];return t*o*h-t*a*f-i*s*h+i*a*c+r*s*f-r*o*c}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],f=e[7],h=e[8],d=h*o-a*f,p=a*c-h*s,g=f*s-o*c,_=t*d+i*p+r*g;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/_;return e[0]=d*y,e[1]=(r*f-h*i)*y,e[2]=(a*i-r*o)*y,e[3]=p*y,e[4]=(h*t-r*c)*y,e[5]=(r*s-a*t)*y,e[6]=g*y,e[7]=(i*c-f*t)*y,e[8]=(o*t-i*s)*y,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const c=Math.cos(s),f=Math.sin(s);return this.set(i*c,i*f,-i*(c*o+f*a)+o+e,-r*f,r*c,-r*(-f*o+c*a)+a+t,0,0,1),this}scale(e,t){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.elements,s=r[0],o=r[3],a=r[6],c=r[1],f=r[4],h=r[7];return r[0]=t*s+i*c,r[3]=t*o+i*f,r[6]=t*a+i*h,r[1]=-i*s+t*c,r[4]=-i*o+t*f,r[7]=-i*a+t*h,this}translate(e,t){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}function S2(n){for(let e=n.length-1;e>=0;--e)if(n[e]>65535)return!0;return!1}function Rf(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Da(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function rp(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}const G0={[Ws]:{[Ra]:Da},[Ra]:{[Ws]:rp}},Fr={legacyMode:!0,get workingColorSpace(){return Ra},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.legacyMode||e===t||!e||!t)return n;if(G0[e]&&G0[e][t]!==void 0){const i=G0[e][t];return n.r=i(n.r),n.g=i(n.g),n.b=i(n.b),n}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}},M2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},bn={r:0,g:0,b:0},Dr={h:0,s:0,l:0},oh={h:0,s:0,l:0};function W0(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}function ah(n,e){return e.r=n.r,e.g=n.g,e.b=n.b,e}class Fe{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&i===void 0?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ws){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Fr.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Ra){return this.r=e,this.g=t,this.b=i,Fr.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Ra){if(e=i_(e,1),t=si(t,0,1),i=si(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=W0(o,s,e+1/3),this.g=W0(o,s,e),this.b=W0(o,s,e-1/3)}return Fr.toWorkingColorSpace(this,r),this}setStyle(e,t=Ws){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Fr.toWorkingColorSpace(this,t),i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Fr.toWorkingColorSpace(this,t),i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const c=parseFloat(s[1])/360,f=parseInt(s[2],10)/100,h=parseInt(s[3],10)/100;return i(s[4]),this.setHSL(c,f,h,t)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Fr.toWorkingColorSpace(this,t),this;if(o===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Fr.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=Ws){const i=M2[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Da(e.r),this.g=Da(e.g),this.b=Da(e.b),this}copyLinearToSRGB(e){return this.r=rp(e.r),this.g=rp(e.g),this.b=rp(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ws){return Fr.fromWorkingColorSpace(ah(this,bn),e),si(bn.r*255,0,255)<<16^si(bn.g*255,0,255)<<8^si(bn.b*255,0,255)<<0}getHexString(e=Ws){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ra){Fr.fromWorkingColorSpace(ah(this,bn),t);const i=bn.r,r=bn.g,s=bn.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let c,f;const h=(a+o)/2;if(a===o)c=0,f=0;else{const d=o-a;switch(f=h<=.5?d/(o+a):d/(2-o-a),o){case i:c=(r-s)/d+(r<s?6:0);break;case r:c=(s-i)/d+2;break;case s:c=(i-r)/d+4;break}c/=6}return e.h=c,e.s=f,e.l=h,e}getRGB(e,t=Ra){return Fr.fromWorkingColorSpace(ah(this,bn),t),e.r=bn.r,e.g=bn.g,e.b=bn.b,e}getStyle(e=Ws){return Fr.fromWorkingColorSpace(ah(this,bn),e),e!==Ws?`color(${e} ${bn.r} ${bn.g} ${bn.b})`:`rgb(${bn.r*255|0},${bn.g*255|0},${bn.b*255|0})`}offsetHSL(e,t,i){return this.getHSL(Dr),Dr.h+=e,Dr.s+=t,Dr.l+=i,this.setHSL(Dr.h,Dr.s,Dr.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Dr),e.getHSL(oh);const i=sf(Dr.h,oh.h,t),r=sf(Dr.s,oh.s,t),s=sf(Dr.l,oh.l,t);return this.setHSL(i,r,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}Fe.NAMES=M2;let ml;class b2{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement=="undefined")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{ml===void 0&&(ml=Rf("canvas")),ml.width=e.width,ml.height=e.height;const i=ml.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=ml}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement!="undefined"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&e instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap){const t=Rf("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Da(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Da(t[i]/255)*255):t[i]=Da(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class T2{constructor(e=null){this.isSource=!0,this.uuid=Xr(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(V0(r[o].image)):s.push(V0(r[o]))}else s=V0(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function V0(n){return typeof HTMLImageElement!="undefined"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&n instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&n instanceof ImageBitmap?b2.getDataURL(n):n.data?{data:Array.prototype.slice.call(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let U4=0;class yi extends Qo{constructor(e=yi.DEFAULT_IMAGE,t=yi.DEFAULT_MAPPING,i=yr,r=yr,s=Ri,o=Dc,a=_r,c=Ha,f=1,h=Ga){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:U4++}),this.uuid=Xr(),this.name="",this.source=new T2(e),this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=f,this.format=a,this.internalFormat=null,this.type=c,this.offset=new Ce(0,0),this.repeat=new Ce(1,1),this.center=new Ce(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ps,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==g2)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case hs:e.x=e.x-Math.floor(e.x);break;case yr:e.x=e.x<0?0:1;break;case zp:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case hs:e.y=e.y-Math.floor(e.y);break;case yr:e.y=e.y<0?0:1;break;case zp:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}yi.DEFAULT_IMAGE=null;yi.DEFAULT_MAPPING=g2;class Ut{constructor(e=0,t=0,i=0,r=1){this.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const c=e.elements,f=c[0],h=c[4],d=c[8],p=c[1],g=c[5],_=c[9],y=c[2],x=c[6],v=c[10];if(Math.abs(h-p)<.01&&Math.abs(d-y)<.01&&Math.abs(_-x)<.01){if(Math.abs(h+p)<.1&&Math.abs(d+y)<.1&&Math.abs(_+x)<.1&&Math.abs(f+g+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const S=(f+1)/2,E=(g+1)/2,b=(v+1)/2,T=(h+p)/4,C=(d+y)/4,A=(_+x)/4;return S>E&&S>b?S<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(S),r=T/i,s=C/i):E>b?E<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(E),i=T/r,s=A/r):b<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(b),i=C/s,r=A/s),this.set(i,r,s,t),this}let w=Math.sqrt((x-_)*(x-_)+(d-y)*(d-y)+(p-h)*(p-h));return Math.abs(w)<.001&&(w=1),this.x=(x-_)/w,this.y=(d-y)/w,this.z=(p-h)/w,this.w=Math.acos((f+g+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,i){return i!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class gn extends Qo{constructor(e,t,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ut(0,0,e,t),this.scissorTest=!1,this.viewport=new Ut(0,0,e,t);const r={width:e,height:t,depth:1};this.texture=new yi(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Ri,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new T2(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class E2 extends yi{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=En,this.minFilter=En,this.wrapR=yr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class H4 extends yi{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=En,this.minFilter=En,this.wrapR=yr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class qn{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerp(e,t,i,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),i.slerpQuaternions(e,t,r)}static slerpFlat(e,t,i,r,s,o,a){let c=i[r+0],f=i[r+1],h=i[r+2],d=i[r+3];const p=s[o+0],g=s[o+1],_=s[o+2],y=s[o+3];if(a===0){e[t+0]=c,e[t+1]=f,e[t+2]=h,e[t+3]=d;return}if(a===1){e[t+0]=p,e[t+1]=g,e[t+2]=_,e[t+3]=y;return}if(d!==y||c!==p||f!==g||h!==_){let x=1-a;const v=c*p+f*g+h*_+d*y,w=v>=0?1:-1,S=1-v*v;if(S>Number.EPSILON){const b=Math.sqrt(S),T=Math.atan2(b,v*w);x=Math.sin(x*T)/b,a=Math.sin(a*T)/b}const E=a*w;if(c=c*x+p*E,f=f*x+g*E,h=h*x+_*E,d=d*x+y*E,x===1-a){const b=1/Math.sqrt(c*c+f*f+h*h+d*d);c*=b,f*=b,h*=b,d*=b}}e[t]=c,e[t+1]=f,e[t+2]=h,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],c=i[r+1],f=i[r+2],h=i[r+3],d=s[o],p=s[o+1],g=s[o+2],_=s[o+3];return e[t]=a*_+h*d+c*g-f*p,e[t+1]=c*_+h*p+f*d-a*g,e[t+2]=f*_+h*g+a*p-c*d,e[t+3]=h*_-a*d-c*p-f*g,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,f=a(i/2),h=a(r/2),d=a(s/2),p=c(i/2),g=c(r/2),_=c(s/2);switch(o){case"XYZ":this._x=p*h*d+f*g*_,this._y=f*g*d-p*h*_,this._z=f*h*_+p*g*d,this._w=f*h*d-p*g*_;break;case"YXZ":this._x=p*h*d+f*g*_,this._y=f*g*d-p*h*_,this._z=f*h*_-p*g*d,this._w=f*h*d+p*g*_;break;case"ZXY":this._x=p*h*d-f*g*_,this._y=f*g*d+p*h*_,this._z=f*h*_+p*g*d,this._w=f*h*d-p*g*_;break;case"ZYX":this._x=p*h*d-f*g*_,this._y=f*g*d+p*h*_,this._z=f*h*_-p*g*d,this._w=f*h*d+p*g*_;break;case"YZX":this._x=p*h*d+f*g*_,this._y=f*g*d+p*h*_,this._z=f*h*_-p*g*d,this._w=f*h*d-p*g*_;break;case"XZY":this._x=p*h*d-f*g*_,this._y=f*g*d-p*h*_,this._z=f*h*_+p*g*d,this._w=f*h*d+p*g*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],c=t[9],f=t[2],h=t[6],d=t[10],p=i+a+d;if(p>0){const g=.5/Math.sqrt(p+1);this._w=.25/g,this._x=(h-c)*g,this._y=(s-f)*g,this._z=(o-r)*g}else if(i>a&&i>d){const g=2*Math.sqrt(1+i-a-d);this._w=(h-c)/g,this._x=.25*g,this._y=(r+o)/g,this._z=(s+f)/g}else if(a>d){const g=2*Math.sqrt(1+a-i-d);this._w=(s-f)/g,this._x=(r+o)/g,this._y=.25*g,this._z=(c+h)/g}else{const g=2*Math.sqrt(1+d-i-a);this._w=(o-r)/g,this._x=(s+f)/g,this._y=(c+h)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(si(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,c=t._y,f=t._z,h=t._w;return this._x=i*h+o*a+r*f-s*c,this._y=r*h+o*c+s*a-i*f,this._z=s*h+o*f+i*c-r*a,this._w=o*h-i*a-r*c-s*f,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const c=1-a*a;if(c<=Number.EPSILON){const g=1-t;return this._w=g*o+t*this._w,this._x=g*i+t*this._x,this._y=g*r+t*this._y,this._z=g*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const f=Math.sqrt(c),h=Math.atan2(f,a),d=Math.sin((1-t)*h)/f,p=Math.sin(t*h)/f;return this._w=o*d+this._w*p,this._x=i*d+this._x*p,this._y=r*d+this._y*p,this._z=s*d+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class z{constructor(e=0,t=0,i=0){this.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(nb.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(nb.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,c=e.w,f=c*t+o*r-a*i,h=c*i+a*t-s*r,d=c*r+s*i-o*t,p=-s*t-o*i-a*r;return this.x=f*c+p*-s+h*-a-d*-o,this.y=h*c+p*-o+d*-s-f*-a,this.z=d*c+p*-a+f*-o-h*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=r*c-s*a,this.y=s*o-i*c,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return $0.copy(this).projectOnVector(e),this.sub($0)}reflect(e){return this.sub($0.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(si(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,i){return i!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const $0=new z,nb=new qn;class Nc{constructor(e=new z(1/0,1/0,1/0),t=new z(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let c=0,f=e.length;c<f;c+=3){const h=e[c],d=e[c+1],p=e[c+2];h<t&&(t=h),d<i&&(i=d),p<r&&(r=p),h>s&&(s=h),d>o&&(o=d),p>a&&(a=p)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let c=0,f=e.count;c<f;c++){const h=e.getX(c),d=e.getY(c),p=e.getZ(c);h<t&&(t=h),d<i&&(i=d),p<r&&(r=p),h>s&&(s=h),d>o&&(o=d),p>a&&(a=p)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=da.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0)if(t&&i.attributes!=null&&i.attributes.position!==void 0){const s=i.attributes.position;for(let o=0,a=s.count;o<a;o++)da.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(da)}else i.boundingBox===null&&i.computeBoundingBox(),j0.copy(i.boundingBox),j0.applyMatrix4(e.matrixWorld),this.union(j0);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,da),da.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Su),lh.subVectors(this.max,Su),gl.subVectors(e.a,Su),vl.subVectors(e.b,Su),yl.subVectors(e.c,Su),vo.subVectors(vl,gl),yo.subVectors(yl,vl),ha.subVectors(gl,yl);let t=[0,-vo.z,vo.y,0,-yo.z,yo.y,0,-ha.z,ha.y,vo.z,0,-vo.x,yo.z,0,-yo.x,ha.z,0,-ha.x,-vo.y,vo.x,0,-yo.y,yo.x,0,-ha.y,ha.x,0];return!X0(t,gl,vl,yl,lh)||(t=[1,0,0,0,1,0,0,0,1],!X0(t,gl,vl,yl,lh))?!1:(ch.crossVectors(vo,yo),t=[ch.x,ch.y,ch.z],X0(t,gl,vl,yl,lh))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return da.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(da).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Ls[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ls[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ls[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ls[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ls[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ls[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ls[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ls[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ls),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ls=[new z,new z,new z,new z,new z,new z,new z,new z],da=new z,j0=new Nc,gl=new z,vl=new z,yl=new z,vo=new z,yo=new z,ha=new z,Su=new z,lh=new z,ch=new z,pa=new z;function X0(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){pa.fromArray(n,s);const a=r.x*Math.abs(pa.x)+r.y*Math.abs(pa.y)+r.z*Math.abs(pa.z),c=e.dot(pa),f=t.dot(pa),h=i.dot(pa);if(Math.max(-Math.max(c,f,h),Math.min(c,f,h))>a)return!1}return!0}const G4=new Nc,ib=new z,uh=new z,q0=new z;class Oc{constructor(e=new z,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):G4.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){q0.subVectors(e,this.center);const t=q0.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.add(q0.multiplyScalar(r/i)),this.radius+=r}return this}union(e){return this.center.equals(e.center)===!0?uh.set(0,0,1).multiplyScalar(e.radius):uh.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(ib.copy(e.center).add(uh)),this.expandByPoint(ib.copy(e.center).sub(uh)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Is=new z,Y0=new z,fh=new z,xo=new z,K0=new z,dh=new z,Z0=new z;class gm{constructor(e=new z,t=new z(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Is)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Is.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Is.copy(this.direction).multiplyScalar(t).add(this.origin),Is.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){Y0.copy(e).add(t).multiplyScalar(.5),fh.copy(t).sub(e).normalize(),xo.copy(this.origin).sub(Y0);const s=e.distanceTo(t)*.5,o=-this.direction.dot(fh),a=xo.dot(this.direction),c=-xo.dot(fh),f=xo.lengthSq(),h=Math.abs(1-o*o);let d,p,g,_;if(h>0)if(d=o*c-a,p=o*a-c,_=s*h,d>=0)if(p>=-_)if(p<=_){const y=1/h;d*=y,p*=y,g=d*(d+o*p+2*a)+p*(o*d+p+2*c)+f}else p=s,d=Math.max(0,-(o*p+a)),g=-d*d+p*(p+2*c)+f;else p=-s,d=Math.max(0,-(o*p+a)),g=-d*d+p*(p+2*c)+f;else p<=-_?(d=Math.max(0,-(-o*s+a)),p=d>0?-s:Math.min(Math.max(-s,-c),s),g=-d*d+p*(p+2*c)+f):p<=_?(d=0,p=Math.min(Math.max(-s,-c),s),g=p*(p+2*c)+f):(d=Math.max(0,-(o*s+a)),p=d>0?s:Math.min(Math.max(-s,-c),s),g=-d*d+p*(p+2*c)+f);else p=o>0?-s:s,d=Math.max(0,-(o*p+a)),g=-d*d+p*(p+2*c)+f;return i&&i.copy(this.direction).multiplyScalar(d).add(this.origin),r&&r.copy(fh).multiplyScalar(p).add(Y0),g}intersectSphere(e,t){Is.subVectors(e.center,this.origin);const i=Is.dot(this.direction),r=Is.dot(Is)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,c=i+o;return a<0&&c<0?null:a<0?this.at(c,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,c;const f=1/this.direction.x,h=1/this.direction.y,d=1/this.direction.z,p=this.origin;return f>=0?(i=(e.min.x-p.x)*f,r=(e.max.x-p.x)*f):(i=(e.max.x-p.x)*f,r=(e.min.x-p.x)*f),h>=0?(s=(e.min.y-p.y)*h,o=(e.max.y-p.y)*h):(s=(e.max.y-p.y)*h,o=(e.min.y-p.y)*h),i>o||s>r||((s>i||i!==i)&&(i=s),(o<r||r!==r)&&(r=o),d>=0?(a=(e.min.z-p.z)*d,c=(e.max.z-p.z)*d):(a=(e.max.z-p.z)*d,c=(e.min.z-p.z)*d),i>c||a>r)||((a>i||i!==i)&&(i=a),(c<r||r!==r)&&(r=c),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,Is)!==null}intersectTriangle(e,t,i,r,s){K0.subVectors(t,e),dh.subVectors(i,e),Z0.crossVectors(K0,dh);let o=this.direction.dot(Z0),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;xo.subVectors(this.origin,e);const c=a*this.direction.dot(dh.crossVectors(xo,dh));if(c<0)return null;const f=a*this.direction.dot(K0.cross(xo));if(f<0||c+f>o)return null;const h=-a*xo.dot(Z0);return h<0?null:this.at(h/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class pt{constructor(){this.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,s,o,a,c,f,h,d,p,g,_,y,x){const v=this.elements;return v[0]=e,v[4]=t,v[8]=i,v[12]=r,v[1]=s,v[5]=o,v[9]=a,v[13]=c,v[2]=f,v[6]=h,v[10]=d,v[14]=p,v[3]=g,v[7]=_,v[11]=y,v[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new pt().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/xl.setFromMatrixColumn(e,0).length(),s=1/xl.setFromMatrixColumn(e,1).length(),o=1/xl.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),c=Math.cos(r),f=Math.sin(r),h=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){const p=o*h,g=o*d,_=a*h,y=a*d;t[0]=c*h,t[4]=-c*d,t[8]=f,t[1]=g+_*f,t[5]=p-y*f,t[9]=-a*c,t[2]=y-p*f,t[6]=_+g*f,t[10]=o*c}else if(e.order==="YXZ"){const p=c*h,g=c*d,_=f*h,y=f*d;t[0]=p+y*a,t[4]=_*a-g,t[8]=o*f,t[1]=o*d,t[5]=o*h,t[9]=-a,t[2]=g*a-_,t[6]=y+p*a,t[10]=o*c}else if(e.order==="ZXY"){const p=c*h,g=c*d,_=f*h,y=f*d;t[0]=p-y*a,t[4]=-o*d,t[8]=_+g*a,t[1]=g+_*a,t[5]=o*h,t[9]=y-p*a,t[2]=-o*f,t[6]=a,t[10]=o*c}else if(e.order==="ZYX"){const p=o*h,g=o*d,_=a*h,y=a*d;t[0]=c*h,t[4]=_*f-g,t[8]=p*f+y,t[1]=c*d,t[5]=y*f+p,t[9]=g*f-_,t[2]=-f,t[6]=a*c,t[10]=o*c}else if(e.order==="YZX"){const p=o*c,g=o*f,_=a*c,y=a*f;t[0]=c*h,t[4]=y-p*d,t[8]=_*d+g,t[1]=d,t[5]=o*h,t[9]=-a*h,t[2]=-f*h,t[6]=g*d+_,t[10]=p-y*d}else if(e.order==="XZY"){const p=o*c,g=o*f,_=a*c,y=a*f;t[0]=c*h,t[4]=-d,t[8]=f*h,t[1]=p*d+y,t[5]=o*h,t[9]=g*d-_,t[2]=_*d-g,t[6]=a*h,t[10]=y*d+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(W4,e,V4)}lookAt(e,t,i){const r=this.elements;return Wi.subVectors(e,t),Wi.lengthSq()===0&&(Wi.z=1),Wi.normalize(),_o.crossVectors(i,Wi),_o.lengthSq()===0&&(Math.abs(i.z)===1?Wi.x+=1e-4:Wi.z+=1e-4,Wi.normalize(),_o.crossVectors(i,Wi)),_o.normalize(),hh.crossVectors(Wi,_o),r[0]=_o.x,r[4]=hh.x,r[8]=Wi.x,r[1]=_o.y,r[5]=hh.y,r[9]=Wi.y,r[2]=_o.z,r[6]=hh.z,r[10]=Wi.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],c=i[8],f=i[12],h=i[1],d=i[5],p=i[9],g=i[13],_=i[2],y=i[6],x=i[10],v=i[14],w=i[3],S=i[7],E=i[11],b=i[15],T=r[0],C=r[4],A=r[8],F=r[12],U=r[1],W=r[5],ne=r[9],re=r[13],V=r[2],ie=r[6],K=r[10],ae=r[14],$=r[3],Y=r[7],Z=r[11],he=r[15];return s[0]=o*T+a*U+c*V+f*$,s[4]=o*C+a*W+c*ie+f*Y,s[8]=o*A+a*ne+c*K+f*Z,s[12]=o*F+a*re+c*ae+f*he,s[1]=h*T+d*U+p*V+g*$,s[5]=h*C+d*W+p*ie+g*Y,s[9]=h*A+d*ne+p*K+g*Z,s[13]=h*F+d*re+p*ae+g*he,s[2]=_*T+y*U+x*V+v*$,s[6]=_*C+y*W+x*ie+v*Y,s[10]=_*A+y*ne+x*K+v*Z,s[14]=_*F+y*re+x*ae+v*he,s[3]=w*T+S*U+E*V+b*$,s[7]=w*C+S*W+E*ie+b*Y,s[11]=w*A+S*ne+E*K+b*Z,s[15]=w*F+S*re+E*ae+b*he,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],c=e[9],f=e[13],h=e[2],d=e[6],p=e[10],g=e[14],_=e[3],y=e[7],x=e[11],v=e[15];return _*(+s*c*d-r*f*d-s*a*p+i*f*p+r*a*g-i*c*g)+y*(+t*c*g-t*f*p+s*o*p-r*o*g+r*f*h-s*c*h)+x*(+t*f*d-t*a*g-s*o*d+i*o*g+s*a*h-i*f*h)+v*(-r*a*h-t*c*d+t*a*p+r*o*d-i*o*p+i*c*h)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],f=e[7],h=e[8],d=e[9],p=e[10],g=e[11],_=e[12],y=e[13],x=e[14],v=e[15],w=d*x*f-y*p*f+y*c*g-a*x*g-d*c*v+a*p*v,S=_*p*f-h*x*f-_*c*g+o*x*g+h*c*v-o*p*v,E=h*y*f-_*d*f+_*a*g-o*y*g-h*a*v+o*d*v,b=_*d*c-h*y*c-_*a*p+o*y*p+h*a*x-o*d*x,T=t*w+i*S+r*E+s*b;if(T===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/T;return e[0]=w*C,e[1]=(y*p*s-d*x*s-y*r*g+i*x*g+d*r*v-i*p*v)*C,e[2]=(a*x*s-y*c*s+y*r*f-i*x*f-a*r*v+i*c*v)*C,e[3]=(d*c*s-a*p*s-d*r*f+i*p*f+a*r*g-i*c*g)*C,e[4]=S*C,e[5]=(h*x*s-_*p*s+_*r*g-t*x*g-h*r*v+t*p*v)*C,e[6]=(_*c*s-o*x*s-_*r*f+t*x*f+o*r*v-t*c*v)*C,e[7]=(o*p*s-h*c*s+h*r*f-t*p*f-o*r*g+t*c*g)*C,e[8]=E*C,e[9]=(_*d*s-h*y*s-_*i*g+t*y*g+h*i*v-t*d*v)*C,e[10]=(o*y*s-_*a*s+_*i*f-t*y*f-o*i*v+t*a*v)*C,e[11]=(h*a*s-o*d*s-h*i*f+t*d*f+o*i*g-t*a*g)*C,e[12]=b*C,e[13]=(h*y*r-_*d*r+_*i*p-t*y*p-h*i*x+t*d*x)*C,e[14]=(_*a*r-o*y*r-_*i*c+t*y*c+o*i*x-t*a*x)*C,e[15]=(o*d*r-h*a*r+h*i*c-t*d*c-o*i*p+t*a*p)*C,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,c=e.z,f=s*o,h=s*a;return this.set(f*o+i,f*a-r*c,f*c+r*a,0,f*a+r*c,h*a+i,h*c-r*o,0,f*c-r*a,h*c+r*o,s*c*c+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,f=s+s,h=o+o,d=a+a,p=s*f,g=s*h,_=s*d,y=o*h,x=o*d,v=a*d,w=c*f,S=c*h,E=c*d,b=i.x,T=i.y,C=i.z;return r[0]=(1-(y+v))*b,r[1]=(g+E)*b,r[2]=(_-S)*b,r[3]=0,r[4]=(g-E)*T,r[5]=(1-(p+v))*T,r[6]=(x+w)*T,r[7]=0,r[8]=(_+S)*C,r[9]=(x-w)*C,r[10]=(1-(p+y))*C,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=xl.set(r[0],r[1],r[2]).length();const o=xl.set(r[4],r[5],r[6]).length(),a=xl.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Nr.copy(this);const f=1/s,h=1/o,d=1/a;return Nr.elements[0]*=f,Nr.elements[1]*=f,Nr.elements[2]*=f,Nr.elements[4]*=h,Nr.elements[5]*=h,Nr.elements[6]*=h,Nr.elements[8]*=d,Nr.elements[9]*=d,Nr.elements[10]*=d,t.setFromRotationMatrix(Nr),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o){o===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,c=2*s/(t-e),f=2*s/(i-r),h=(t+e)/(t-e),d=(i+r)/(i-r),p=-(o+s)/(o-s),g=-2*o*s/(o-s);return a[0]=c,a[4]=0,a[8]=h,a[12]=0,a[1]=0,a[5]=f,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=p,a[14]=g,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,s,o){const a=this.elements,c=1/(t-e),f=1/(i-r),h=1/(o-s),d=(t+e)*c,p=(i+r)*f,g=(o+s)*h;return a[0]=2*c,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2*f,a[9]=0,a[13]=-p,a[2]=0,a[6]=0,a[10]=-2*h,a[14]=-g,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const xl=new z,Nr=new pt,W4=new z(0,0,0),V4=new z(1,1,1),_o=new z,hh=new z,Wi=new z,rb=new pt,sb=new qn;class $f{constructor(e=0,t=0,i=0,r=$f.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],c=r[1],f=r[5],h=r[9],d=r[2],p=r[6],g=r[10];switch(t){case"XYZ":this._y=Math.asin(si(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,g),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(p,f),this._z=0);break;case"YXZ":this._x=Math.asin(-si(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,g),this._z=Math.atan2(c,f)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(si(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-d,g),this._z=Math.atan2(-o,f)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-si(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(p,g),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-o,f));break;case"YZX":this._z=Math.asin(si(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,f),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,g));break;case"XZY":this._z=Math.asin(-si(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(p,f),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-h,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return rb.makeRotationFromQuaternion(e),this.setFromRotationMatrix(rb,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return sb.setFromEuler(this),this.setFromQuaternion(sb,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}$f.DefaultOrder="XYZ";$f.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class r_{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let $4=0;const ob=new z,_l=new qn,Fs=new pt,ph=new z,Mu=new z,j4=new z,X4=new qn,ab=new z(1,0,0),lb=new z(0,1,0),cb=new z(0,0,1),q4={type:"added"},ub={type:"removed"};class $t extends Qo{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:$4++}),this.uuid=Xr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=$t.DefaultUp.clone();const e=new z,t=new $f,i=new qn,r=new z(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new pt},normalMatrix:{value:new ps}}),this.matrix=new pt,this.matrixWorld=new pt,this.matrixAutoUpdate=$t.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new r_,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return _l.setFromAxisAngle(e,t),this.quaternion.multiply(_l),this}rotateOnWorldAxis(e,t){return _l.setFromAxisAngle(e,t),this.quaternion.premultiply(_l),this}rotateX(e){return this.rotateOnAxis(ab,e)}rotateY(e){return this.rotateOnAxis(lb,e)}rotateZ(e){return this.rotateOnAxis(cb,e)}translateOnAxis(e,t){return ob.copy(e).applyQuaternion(this.quaternion),this.position.add(ob.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(ab,e)}translateY(e){return this.translateOnAxis(lb,e)}translateZ(e){return this.translateOnAxis(cb,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Fs.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?ph.copy(e):ph.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Mu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Fs.lookAt(Mu,ph,this.up):Fs.lookAt(ph,Mu,this.up),this.quaternion.setFromRotationMatrix(Fs),r&&(Fs.extractRotation(r.matrixWorld),_l.setFromRotationMatrix(Fs),this.quaternion.premultiply(_l.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(q4)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(ub)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(ub)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Fs.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Fs.multiply(e.parent.matrixWorld)),e.applyMatrix4(Fs),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Mu,e,j4),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Mu,X4,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,c){return a[c.uuid]===void 0&&(a[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const c=a.shapes;if(Array.isArray(c))for(let f=0,h=c.length;f<h;f++){const d=c[f];s(e.shapes,d)}else s(e.shapes,c)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let c=0,f=this.material.length;c<f;c++)a.push(s(e.materials,this.material[c]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const c=this.animations[a];r.animations.push(s(e.animations,c))}}if(t){const a=o(e.geometries),c=o(e.materials),f=o(e.textures),h=o(e.images),d=o(e.shapes),p=o(e.skeletons),g=o(e.animations),_=o(e.nodes);a.length>0&&(i.geometries=a),c.length>0&&(i.materials=c),f.length>0&&(i.textures=f),h.length>0&&(i.images=h),d.length>0&&(i.shapes=d),p.length>0&&(i.skeletons=p),g.length>0&&(i.animations=g),_.length>0&&(i.nodes=_)}return i.object=r,i;function o(a){const c=[];for(const f in a){const h=a[f];delete h.metadata,c.push(h)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}$t.DefaultUp=new z(0,1,0);$t.DefaultMatrixAutoUpdate=!0;const Or=new z,Ds=new z,Q0=new z,Ns=new z,wl=new z,Sl=new z,fb=new z,J0=new z,ev=new z,tv=new z;class Hr{constructor(e=new z,t=new z,i=new z){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Or.subVectors(e,t),r.cross(Or);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Or.subVectors(r,t),Ds.subVectors(i,t),Q0.subVectors(e,t);const o=Or.dot(Or),a=Or.dot(Ds),c=Or.dot(Q0),f=Ds.dot(Ds),h=Ds.dot(Q0),d=o*f-a*a;if(d===0)return s.set(-2,-1,-1);const p=1/d,g=(f*c-a*h)*p,_=(o*h-a*c)*p;return s.set(1-g-_,_,g)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Ns),Ns.x>=0&&Ns.y>=0&&Ns.x+Ns.y<=1}static getUV(e,t,i,r,s,o,a,c){return this.getBarycoord(e,t,i,r,Ns),c.set(0,0),c.addScaledVector(s,Ns.x),c.addScaledVector(o,Ns.y),c.addScaledVector(a,Ns.z),c}static isFrontFacing(e,t,i,r){return Or.subVectors(i,t),Ds.subVectors(e,t),Or.cross(Ds).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Or.subVectors(this.c,this.b),Ds.subVectors(this.a,this.b),Or.cross(Ds).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Hr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Hr.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return Hr.getUV(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Hr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Hr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;wl.subVectors(r,i),Sl.subVectors(s,i),J0.subVectors(e,i);const c=wl.dot(J0),f=Sl.dot(J0);if(c<=0&&f<=0)return t.copy(i);ev.subVectors(e,r);const h=wl.dot(ev),d=Sl.dot(ev);if(h>=0&&d<=h)return t.copy(r);const p=c*d-h*f;if(p<=0&&c>=0&&h<=0)return o=c/(c-h),t.copy(i).addScaledVector(wl,o);tv.subVectors(e,s);const g=wl.dot(tv),_=Sl.dot(tv);if(_>=0&&g<=_)return t.copy(s);const y=g*f-c*_;if(y<=0&&f>=0&&_<=0)return a=f/(f-_),t.copy(i).addScaledVector(Sl,a);const x=h*_-g*d;if(x<=0&&d-h>=0&&g-_>=0)return fb.subVectors(s,r),a=(d-h)/(d-h+(g-_)),t.copy(r).addScaledVector(fb,a);const v=1/(x+y+p);return o=y*v,a=p*v,t.copy(i).addScaledVector(wl,o).addScaledVector(Sl,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Y4=0;class xn extends Qo{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Y4++}),this.uuid=Xr(),this.name="",this.type="Material",this.blending=sc,this.side=vc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=h2,this.blendDst=p2,this.blendEquation=kl,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=wy,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=M4,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=H0,this.stencilZFail=H0,this.stencilZPass=H0,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===LB;continue}const r=this[t];if(r===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==sc&&(i.blending=this.blending),this.side!==vc&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const c=s[a];delete c.metadata,o.push(c)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}get vertexTangents(){return console.warn("THREE."+this.type+": .vertexTangents has been removed."),!1}set vertexTangents(e){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}xn.fromType=function(){return null};class wr extends xn{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Fe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const mn=new z,mh=new Ce;class vi{constructor(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i===!0,this.usage=Ty,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];o===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new Fe),t[i++]=o.r,t[i++]=o.g,t[i++]=o.b}return this}copyVector2sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new Ce),t[i++]=o.x,t[i++]=o.y}return this}copyVector3sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new z),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z}return this}copyVector4sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new Ut),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z,t[i++]=o.w}return this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)mh.fromBufferAttribute(this,t),mh.applyMatrix3(e),this.setXY(t,mh.x,mh.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)mn.fromBufferAttribute(this,t),mn.applyMatrix3(e),this.setXYZ(t,mn.x,mn.y,mn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)mn.fromBufferAttribute(this,t),mn.applyMatrix4(e),this.setXYZ(t,mn.x,mn.y,mn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)mn.fromBufferAttribute(this,t),mn.applyNormalMatrix(e),this.setXYZ(t,mn.x,mn.y,mn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)mn.fromBufferAttribute(this,t),mn.transformDirection(e),this.setXYZ(t,mn.x,mn.y,mn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Ty&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}class A2 extends vi{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class C2 extends vi{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class kt extends vi{constructor(e,t,i){super(new Float32Array(e),t,i)}}let K4=0;const pr=new pt,nv=new $t,Ml=new z,Vi=new Nc,bu=new Nc,In=new z;class Rn extends Qo{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:K4++}),this.uuid=Xr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(S2(e)?C2:A2)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new ps().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return pr.makeRotationFromQuaternion(e),this.applyMatrix4(pr),this}rotateX(e){return pr.makeRotationX(e),this.applyMatrix4(pr),this}rotateY(e){return pr.makeRotationY(e),this.applyMatrix4(pr),this}rotateZ(e){return pr.makeRotationZ(e),this.applyMatrix4(pr),this}translate(e,t,i){return pr.makeTranslation(e,t,i),this.applyMatrix4(pr),this}scale(e,t,i){return pr.makeScale(e,t,i),this.applyMatrix4(pr),this}lookAt(e){return nv.lookAt(e),nv.updateMatrix(),this.applyMatrix4(nv.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ml).negate(),this.translate(Ml.x,Ml.y,Ml.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new kt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Nc);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new z(-1/0,-1/0,-1/0),new z(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];Vi.setFromBufferAttribute(s),this.morphTargetsRelative?(In.addVectors(this.boundingBox.min,Vi.min),this.boundingBox.expandByPoint(In),In.addVectors(this.boundingBox.max,Vi.max),this.boundingBox.expandByPoint(In)):(this.boundingBox.expandByPoint(Vi.min),this.boundingBox.expandByPoint(Vi.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Oc);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new z,1/0);return}if(e){const i=this.boundingSphere.center;if(Vi.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];bu.setFromBufferAttribute(a),this.morphTargetsRelative?(In.addVectors(Vi.min,bu.min),Vi.expandByPoint(In),In.addVectors(Vi.max,bu.max),Vi.expandByPoint(In)):(Vi.expandByPoint(bu.min),Vi.expandByPoint(bu.max))}Vi.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)In.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(In));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],c=this.morphTargetsRelative;for(let f=0,h=a.count;f<h;f++)In.fromBufferAttribute(a,f),c&&(Ml.fromBufferAttribute(e,f),In.add(Ml)),r=Math.max(r,i.distanceToSquared(In))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new vi(new Float32Array(4*a),4));const c=this.getAttribute("tangent").array,f=[],h=[];for(let U=0;U<a;U++)f[U]=new z,h[U]=new z;const d=new z,p=new z,g=new z,_=new Ce,y=new Ce,x=new Ce,v=new z,w=new z;function S(U,W,ne){d.fromArray(r,U*3),p.fromArray(r,W*3),g.fromArray(r,ne*3),_.fromArray(o,U*2),y.fromArray(o,W*2),x.fromArray(o,ne*2),p.sub(d),g.sub(d),y.sub(_),x.sub(_);const re=1/(y.x*x.y-x.x*y.y);!isFinite(re)||(v.copy(p).multiplyScalar(x.y).addScaledVector(g,-y.y).multiplyScalar(re),w.copy(g).multiplyScalar(y.x).addScaledVector(p,-x.x).multiplyScalar(re),f[U].add(v),f[W].add(v),f[ne].add(v),h[U].add(w),h[W].add(w),h[ne].add(w))}let E=this.groups;E.length===0&&(E=[{start:0,count:i.length}]);for(let U=0,W=E.length;U<W;++U){const ne=E[U],re=ne.start,V=ne.count;for(let ie=re,K=re+V;ie<K;ie+=3)S(i[ie+0],i[ie+1],i[ie+2])}const b=new z,T=new z,C=new z,A=new z;function F(U){C.fromArray(s,U*3),A.copy(C);const W=f[U];b.copy(W),b.sub(C.multiplyScalar(C.dot(W))).normalize(),T.crossVectors(A,W);const re=T.dot(h[U])<0?-1:1;c[U*4]=b.x,c[U*4+1]=b.y,c[U*4+2]=b.z,c[U*4+3]=re}for(let U=0,W=E.length;U<W;++U){const ne=E[U],re=ne.start,V=ne.count;for(let ie=re,K=re+V;ie<K;ie+=3)F(i[ie+0]),F(i[ie+1]),F(i[ie+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new vi(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let p=0,g=i.count;p<g;p++)i.setXYZ(p,0,0,0);const r=new z,s=new z,o=new z,a=new z,c=new z,f=new z,h=new z,d=new z;if(e)for(let p=0,g=e.count;p<g;p+=3){const _=e.getX(p+0),y=e.getX(p+1),x=e.getX(p+2);r.fromBufferAttribute(t,_),s.fromBufferAttribute(t,y),o.fromBufferAttribute(t,x),h.subVectors(o,s),d.subVectors(r,s),h.cross(d),a.fromBufferAttribute(i,_),c.fromBufferAttribute(i,y),f.fromBufferAttribute(i,x),a.add(h),c.add(h),f.add(h),i.setXYZ(_,a.x,a.y,a.z),i.setXYZ(y,c.x,c.y,c.z),i.setXYZ(x,f.x,f.y,f.z)}else for(let p=0,g=t.count;p<g;p+=3)r.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),o.fromBufferAttribute(t,p+2),h.subVectors(o,s),d.subVectors(r,s),h.cross(d),i.setXYZ(p+0,h.x,h.y,h.z),i.setXYZ(p+1,h.x,h.y,h.z),i.setXYZ(p+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const i=this.attributes;for(const r in i){if(e.attributes[r]===void 0)continue;const o=i[r].array,a=e.attributes[r],c=a.array,f=a.itemSize*t,h=Math.min(c.length,o.length-f);for(let d=0,p=f;d<h;d++,p++)o[p]=c[d]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)In.fromBufferAttribute(e,t),In.normalize(),e.setXYZ(t,In.x,In.y,In.z)}toNonIndexed(){function e(a,c){const f=a.array,h=a.itemSize,d=a.normalized,p=new f.constructor(c.length*h);let g=0,_=0;for(let y=0,x=c.length;y<x;y++){a.isInterleavedBufferAttribute?g=c[y]*a.data.stride+a.offset:g=c[y]*h;for(let v=0;v<h;v++)p[_++]=f[g++]}return new vi(p,h,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Rn,i=this.index.array,r=this.attributes;for(const a in r){const c=r[a],f=e(c,i);t.setAttribute(a,f)}const s=this.morphAttributes;for(const a in s){const c=[],f=s[a];for(let h=0,d=f.length;h<d;h++){const p=f[h],g=e(p,i);c.push(g)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const f=o[a];t.addGroup(f.start,f.count,f.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const f in c)c[f]!==void 0&&(e[f]=c[f]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const c in i){const f=i[c];e.data.attributes[c]=f.toJSON(e.data)}const r={};let s=!1;for(const c in this.morphAttributes){const f=this.morphAttributes[c],h=[];for(let d=0,p=f.length;d<p;d++){const g=f[d];h.push(g.toJSON(e.data))}h.length>0&&(r[c]=h,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const f in r){const h=r[f];this.setAttribute(f,h.clone(t))}const s=e.morphAttributes;for(const f in s){const h=[],d=s[f];for(let p=0,g=d.length;p<g;p++)h.push(d[p].clone(t));this.morphAttributes[f]=h}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let f=0,h=o.length;f<h;f++){const d=o[f];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const db=new pt,bl=new gm,iv=new Oc,wo=new z,So=new z,Mo=new z,rv=new z,sv=new z,ov=new z,gh=new z,vh=new z,yh=new z,xh=new Ce,_h=new Ce,wh=new Ce,av=new z,Sh=new z;class cn extends $t{constructor(e=new Rn,t=new wr){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;if(r===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),iv.copy(i.boundingSphere),iv.applyMatrix4(s),e.ray.intersectsSphere(iv)===!1)||(db.copy(s).invert(),bl.copy(e.ray).applyMatrix4(db),i.boundingBox!==null&&bl.intersectsBox(i.boundingBox)===!1))return;let o;const a=i.index,c=i.attributes.position,f=i.morphAttributes.position,h=i.morphTargetsRelative,d=i.attributes.uv,p=i.attributes.uv2,g=i.groups,_=i.drawRange;if(a!==null)if(Array.isArray(r))for(let y=0,x=g.length;y<x;y++){const v=g[y],w=r[v.materialIndex],S=Math.max(v.start,_.start),E=Math.min(a.count,Math.min(v.start+v.count,_.start+_.count));for(let b=S,T=E;b<T;b+=3){const C=a.getX(b),A=a.getX(b+1),F=a.getX(b+2);o=Mh(this,w,e,bl,c,f,h,d,p,C,A,F),o&&(o.faceIndex=Math.floor(b/3),o.face.materialIndex=v.materialIndex,t.push(o))}}else{const y=Math.max(0,_.start),x=Math.min(a.count,_.start+_.count);for(let v=y,w=x;v<w;v+=3){const S=a.getX(v),E=a.getX(v+1),b=a.getX(v+2);o=Mh(this,r,e,bl,c,f,h,d,p,S,E,b),o&&(o.faceIndex=Math.floor(v/3),t.push(o))}}else if(c!==void 0)if(Array.isArray(r))for(let y=0,x=g.length;y<x;y++){const v=g[y],w=r[v.materialIndex],S=Math.max(v.start,_.start),E=Math.min(c.count,Math.min(v.start+v.count,_.start+_.count));for(let b=S,T=E;b<T;b+=3){const C=b,A=b+1,F=b+2;o=Mh(this,w,e,bl,c,f,h,d,p,C,A,F),o&&(o.faceIndex=Math.floor(b/3),o.face.materialIndex=v.materialIndex,t.push(o))}}else{const y=Math.max(0,_.start),x=Math.min(c.count,_.start+_.count);for(let v=y,w=x;v<w;v+=3){const S=v,E=v+1,b=v+2;o=Mh(this,r,e,bl,c,f,h,d,p,S,E,b),o&&(o.faceIndex=Math.floor(v/3),t.push(o))}}}}function Z4(n,e,t,i,r,s,o,a){let c;if(e.side===$r?c=i.intersectTriangle(o,s,r,!0,a):c=i.intersectTriangle(r,s,o,e.side!==xs,a),c===null)return null;Sh.copy(a),Sh.applyMatrix4(n.matrixWorld);const f=t.ray.origin.distanceTo(Sh);return f<t.near||f>t.far?null:{distance:f,point:Sh.clone(),object:n}}function Mh(n,e,t,i,r,s,o,a,c,f,h,d){wo.fromBufferAttribute(r,f),So.fromBufferAttribute(r,h),Mo.fromBufferAttribute(r,d);const p=n.morphTargetInfluences;if(s&&p){gh.set(0,0,0),vh.set(0,0,0),yh.set(0,0,0);for(let _=0,y=s.length;_<y;_++){const x=p[_],v=s[_];x!==0&&(rv.fromBufferAttribute(v,f),sv.fromBufferAttribute(v,h),ov.fromBufferAttribute(v,d),o?(gh.addScaledVector(rv,x),vh.addScaledVector(sv,x),yh.addScaledVector(ov,x)):(gh.addScaledVector(rv.sub(wo),x),vh.addScaledVector(sv.sub(So),x),yh.addScaledVector(ov.sub(Mo),x)))}wo.add(gh),So.add(vh),Mo.add(yh)}n.isSkinnedMesh&&(n.boneTransform(f,wo),n.boneTransform(h,So),n.boneTransform(d,Mo));const g=Z4(n,e,t,i,wo,So,Mo,av);if(g){a&&(xh.fromBufferAttribute(a,f),_h.fromBufferAttribute(a,h),wh.fromBufferAttribute(a,d),g.uv=Hr.getUV(av,wo,So,Mo,xh,_h,wh,new Ce)),c&&(xh.fromBufferAttribute(c,f),_h.fromBufferAttribute(c,h),wh.fromBufferAttribute(c,d),g.uv2=Hr.getUV(av,wo,So,Mo,xh,_h,wh,new Ce));const _={a:f,b:h,c:d,normal:new z,materialIndex:0};Hr.getNormal(wo,So,Mo,_.normal),g.face=_}return g}class kc extends Rn{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const c=[],f=[],h=[],d=[];let p=0,g=0;_("z","y","x",-1,-1,i,t,e,o,s,0),_("z","y","x",1,-1,i,t,-e,o,s,1),_("x","z","y",1,1,e,i,t,r,o,2),_("x","z","y",1,-1,e,i,-t,r,o,3),_("x","y","z",1,-1,e,t,i,r,s,4),_("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new kt(f,3)),this.setAttribute("normal",new kt(h,3)),this.setAttribute("uv",new kt(d,2));function _(y,x,v,w,S,E,b,T,C,A,F){const U=E/C,W=b/A,ne=E/2,re=b/2,V=T/2,ie=C+1,K=A+1;let ae=0,$=0;const Y=new z;for(let Z=0;Z<K;Z++){const he=Z*W-re;for(let me=0;me<ie;me++){const we=me*U-ne;Y[y]=we*w,Y[x]=he*S,Y[v]=V,f.push(Y.x,Y.y,Y.z),Y[y]=0,Y[x]=0,Y[v]=T>0?1:-1,h.push(Y.x,Y.y,Y.z),d.push(me/C),d.push(1-Z/A),ae+=1}}for(let Z=0;Z<A;Z++)for(let he=0;he<C;he++){const me=p+he+ie*Z,we=p+he+ie*(Z+1),De=p+(he+1)+ie*(Z+1),Be=p+(he+1)+ie*Z;c.push(me,we,Be),c.push(we,De,Be),$+=6}a.addGroup(g,$,F),g+=$,p+=ae}}static fromJSON(e){return new kc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Sc(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function ii(n){const e={};for(let t=0;t<n.length;t++){const i=Sc(n[t]);for(const r in i)e[r]=i[r]}return e}const Mc={clone:Sc,merge:ii};var Q4=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,J4=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class pn extends xn{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=Q4,this.fragmentShader=J4,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Sc(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class R2 extends $t{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new pt,this.projectionMatrix=new pt,this.projectionMatrixInverse=new pt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class di extends R2{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Cf*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(ac*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Cf*2*Math.atan(Math.tan(ac*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(ac*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const c=o.fullWidth,f=o.fullHeight;s+=o.offsetX*r/c,t-=o.offsetY*i/f,r*=o.width/c,i*=o.height/f}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Tl=90,El=1;class ez extends $t{constructor(e,t,i){if(super(),this.type="CubeCamera",i.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=i;const r=new di(Tl,El,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new z(1,0,0)),this.add(r);const s=new di(Tl,El,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new z(-1,0,0)),this.add(s);const o=new di(Tl,El,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new z(0,1,0)),this.add(o);const a=new di(Tl,El,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new z(0,-1,0)),this.add(a);const c=new di(Tl,El,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new z(0,0,1)),this.add(c);const f=new di(Tl,El,e,t);f.layers=this.layers,f.up.set(0,-1,0),f.lookAt(new z(0,0,-1)),this.add(f)}update(e,t){this.parent===null&&this.updateMatrixWorld();const i=this.renderTarget,[r,s,o,a,c,f]=this.children,h=e.getRenderTarget(),d=e.toneMapping,p=e.xr.enabled;e.toneMapping=vs,e.xr.enabled=!1;const g=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,c),i.texture.generateMipmaps=g,e.setRenderTarget(i,5),e.render(t,f),e.setRenderTarget(h),e.toneMapping=d,e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class P2 extends yi{constructor(e,t,i,r,s,o,a,c,f,h){e=e!==void 0?e:[],t=t!==void 0?t:yc,super(e,t,i,r,s,o,a,c,f,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class tz extends gn{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new P2(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Ri}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new kc(5,5,5),s=new pn({name:"CubemapFromEquirect",uniforms:Sc(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:$r,blending:jr});s.uniforms.tEquirect.value=t;const o=new cn(r,s),a=t.minFilter;return t.minFilter===Dc&&(t.minFilter=Ri),new ez(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const lv=new z,nz=new z,iz=new ps;class xa{constructor(e=new z(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=lv.subVectors(i,t).cross(nz.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const i=e.delta(lv),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(i).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||iz.getNormalMatrix(e),r=this.coplanarPoint(lv).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Al=new Oc,bh=new z;class vm{constructor(e=new xa,t=new xa,i=new xa,r=new xa,s=new xa,o=new xa){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],c=i[4],f=i[5],h=i[6],d=i[7],p=i[8],g=i[9],_=i[10],y=i[11],x=i[12],v=i[13],w=i[14],S=i[15];return t[0].setComponents(a-r,d-c,y-p,S-x).normalize(),t[1].setComponents(a+r,d+c,y+p,S+x).normalize(),t[2].setComponents(a+s,d+f,y+g,S+v).normalize(),t[3].setComponents(a-s,d-f,y-g,S-v).normalize(),t[4].setComponents(a-o,d-h,y-_,S-w).normalize(),t[5].setComponents(a+o,d+h,y+_,S+w).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Al.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Al)}intersectsSprite(e){return Al.center.set(0,0,0),Al.radius=.7071067811865476,Al.applyMatrix4(e.matrixWorld),this.intersectsSphere(Al)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(bh.x=r.normal.x>0?e.max.x:e.min.x,bh.y=r.normal.y>0?e.max.y:e.min.y,bh.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(bh)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function L2(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function rz(n,e){const t=e.isWebGL2,i=new WeakMap;function r(f,h){const d=f.array,p=f.usage,g=n.createBuffer();n.bindBuffer(h,g),n.bufferData(h,d,p),f.onUploadCallback();let _;if(d instanceof Float32Array)_=5126;else if(d instanceof Uint16Array)if(f.isFloat16BufferAttribute)if(t)_=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else _=5123;else if(d instanceof Int16Array)_=5122;else if(d instanceof Uint32Array)_=5125;else if(d instanceof Int32Array)_=5124;else if(d instanceof Int8Array)_=5120;else if(d instanceof Uint8Array)_=5121;else if(d instanceof Uint8ClampedArray)_=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:g,type:_,bytesPerElement:d.BYTES_PER_ELEMENT,version:f.version}}function s(f,h,d){const p=h.array,g=h.updateRange;n.bindBuffer(d,f),g.count===-1?n.bufferSubData(d,0,p):(t?n.bufferSubData(d,g.offset*p.BYTES_PER_ELEMENT,p,g.offset,g.count):n.bufferSubData(d,g.offset*p.BYTES_PER_ELEMENT,p.subarray(g.offset,g.offset+g.count)),g.count=-1)}function o(f){return f.isInterleavedBufferAttribute&&(f=f.data),i.get(f)}function a(f){f.isInterleavedBufferAttribute&&(f=f.data);const h=i.get(f);h&&(n.deleteBuffer(h.buffer),i.delete(f))}function c(f,h){if(f.isGLBufferAttribute){const p=i.get(f);(!p||p.version<f.version)&&i.set(f,{buffer:f.buffer,type:f.type,bytesPerElement:f.elementSize,version:f.version});return}f.isInterleavedBufferAttribute&&(f=f.data);const d=i.get(f);d===void 0?i.set(f,r(f,h)):d.version<f.version&&(s(d.buffer,f,h),d.version=f.version)}return{get:o,remove:a,update:c}}class s_ extends Rn{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),c=Math.floor(r),f=a+1,h=c+1,d=e/a,p=t/c,g=[],_=[],y=[],x=[];for(let v=0;v<h;v++){const w=v*p-o;for(let S=0;S<f;S++){const E=S*d-s;_.push(E,-w,0),y.push(0,0,1),x.push(S/a),x.push(1-v/c)}}for(let v=0;v<c;v++)for(let w=0;w<a;w++){const S=w+f*v,E=w+f*(v+1),b=w+1+f*(v+1),T=w+1+f*v;g.push(S,E,T),g.push(E,b,T)}this.setIndex(g),this.setAttribute("position",new kt(_,3)),this.setAttribute("normal",new kt(y,3)),this.setAttribute("uv",new kt(x,2))}static fromJSON(e){return new s_(e.width,e.height,e.widthSegments,e.heightSegments)}}var sz=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,oz=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,az=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,lz=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,cz=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,uz=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,fz="vec3 transformed = vec3( position );",dz=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,hz=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = mix(F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence);
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,pz=`#ifdef USE_IRIDESCENCE
const mat3 XYZ_TO_REC709 = mat3(
    3.2404542, -0.9692660,  0.0556434,
   -1.5371385,  1.8760108, -0.2040259,
   -0.4985314,  0.0415560,  1.0572252
);
vec3 Fresnel0ToIor( vec3 fresnel0 ) {
   vec3 sqrtF0 = sqrt( fresnel0 );
   return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
}
vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
   return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
}
float IorToFresnel0( float transmittedIor, float incidentIor ) {
   return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
}
vec3 evalSensitivity( float OPD, vec3 shift ) {
   float phase = 2.0 * PI * OPD * 1.0e-9;
   vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
   vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
   vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
   vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( -pow2( phase ) * var );
   xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[0] ) * exp( -4.5282e+09 * pow2( phase ) );
   xyz /= 1.0685e-7;
   vec3 srgb = XYZ_TO_REC709 * xyz;
   return srgb;
}
vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
   vec3 I;
   float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
   float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
   float cosTheta2Sq = 1.0 - sinTheta2Sq;
   if ( cosTheta2Sq < 0.0 ) {
       return vec3( 1.0 );
   }
   float cosTheta2 = sqrt( cosTheta2Sq );
   float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
   float R12 = F_Schlick( R0, 1.0, cosTheta1 );
   float R21 = R12;
   float T121 = 1.0 - R12;
   float phi12 = 0.0;
   if ( iridescenceIOR < outsideIOR ) phi12 = PI;
   float phi21 = PI - phi12;
   vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );   vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
   vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
   vec3 phi23 = vec3( 0.0 );
   if ( baseIOR[0] < iridescenceIOR ) phi23[0] = PI;
   if ( baseIOR[1] < iridescenceIOR ) phi23[1] = PI;
   if ( baseIOR[2] < iridescenceIOR ) phi23[2] = PI;
   float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
   vec3 phi = vec3( phi21 ) + phi23;
   vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
   vec3 r123 = sqrt( R123 );
   vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
   vec3 C0 = R12 + Rs;
   I = C0;
   vec3 Cm = Rs - T121;
   for ( int m = 1; m <= 2; ++m ) {
       Cm *= r123;
       vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
       I += Cm * Sm;
   }
   return max( I, vec3( 0.0 ) );
}
#endif`,mz=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,gz=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,vz=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,yz=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,xz=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,_z=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,wz=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Sz=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Mz=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,bz=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Tz=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Ez=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Az=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Cz=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Rz=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Pz=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Lz="gl_FragColor = linearToOutputTexel( gl_FragColor );",Iz=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Fz=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Dz=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Nz=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Oz=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,kz=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Bz=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,zz=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Uz=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Hz=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Gz=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,Wz=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Vz=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,$z=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,jz=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Xz=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,qz=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Yz=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,Kz=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Zz=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,Qz=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,Jz=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,eU=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
float dotNVi = saturate( dot( normal, geometry.viewDir ) );
if ( material.iridescenceThickness == 0.0 ) {
	material.iridescence = 0.0;
} else {
	material.iridescence = saturate( material.iridescence );
}
if ( material.iridescence > 0.0 ) {
	material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
	material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,tU=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,nU=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,iU=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,rU=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,sU=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,oU=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,aU=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,lU=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,cU=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,uU=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,fU=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,dU=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,hU=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,pU=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,mU=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,gU=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,vU=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,yU=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,xU=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,_U=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,wU=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,SU=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,MU=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,bU=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,TU=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,EU=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,AU=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,CU=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,RU=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,PU=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,LU=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,IU=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,FU=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,DU=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,NU=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,OU=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,kU=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,BU=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,zU=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,UU=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,HU=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,GU=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,WU=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,VU=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,$U=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,jU=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,XU=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,qU=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,YU=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,KU=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,ZU=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,QU=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,JU=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,e5=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,t5=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const n5=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,i5=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		gl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );
	#endif
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,r5=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,s5=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,o5=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,a5=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,l5=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,c5=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,u5=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,f5=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,d5=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,h5=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,p5=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,m5=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,g5=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,v5=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,y5=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,x5=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_5=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,w5=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,S5=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,M5=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,b5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,T5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,E5=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,A5=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,C5=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,R5=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,P5=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,L5=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,I5=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,F5=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,ct={alphamap_fragment:sz,alphamap_pars_fragment:oz,alphatest_fragment:az,alphatest_pars_fragment:lz,aomap_fragment:cz,aomap_pars_fragment:uz,begin_vertex:fz,beginnormal_vertex:dz,bsdfs:hz,iridescence_fragment:pz,bumpmap_pars_fragment:mz,clipping_planes_fragment:gz,clipping_planes_pars_fragment:vz,clipping_planes_pars_vertex:yz,clipping_planes_vertex:xz,color_fragment:_z,color_pars_fragment:wz,color_pars_vertex:Sz,color_vertex:Mz,common:bz,cube_uv_reflection_fragment:Tz,defaultnormal_vertex:Ez,displacementmap_pars_vertex:Az,displacementmap_vertex:Cz,emissivemap_fragment:Rz,emissivemap_pars_fragment:Pz,encodings_fragment:Lz,encodings_pars_fragment:Iz,envmap_fragment:Fz,envmap_common_pars_fragment:Dz,envmap_pars_fragment:Nz,envmap_pars_vertex:Oz,envmap_physical_pars_fragment:Xz,envmap_vertex:kz,fog_vertex:Bz,fog_pars_vertex:zz,fog_fragment:Uz,fog_pars_fragment:Hz,gradientmap_pars_fragment:Gz,lightmap_fragment:Wz,lightmap_pars_fragment:Vz,lights_lambert_vertex:$z,lights_pars_begin:jz,lights_toon_fragment:qz,lights_toon_pars_fragment:Yz,lights_phong_fragment:Kz,lights_phong_pars_fragment:Zz,lights_physical_fragment:Qz,lights_physical_pars_fragment:Jz,lights_fragment_begin:eU,lights_fragment_maps:tU,lights_fragment_end:nU,logdepthbuf_fragment:iU,logdepthbuf_pars_fragment:rU,logdepthbuf_pars_vertex:sU,logdepthbuf_vertex:oU,map_fragment:aU,map_pars_fragment:lU,map_particle_fragment:cU,map_particle_pars_fragment:uU,metalnessmap_fragment:fU,metalnessmap_pars_fragment:dU,morphcolor_vertex:hU,morphnormal_vertex:pU,morphtarget_pars_vertex:mU,morphtarget_vertex:gU,normal_fragment_begin:vU,normal_fragment_maps:yU,normal_pars_fragment:xU,normal_pars_vertex:_U,normal_vertex:wU,normalmap_pars_fragment:SU,clearcoat_normal_fragment_begin:MU,clearcoat_normal_fragment_maps:bU,clearcoat_pars_fragment:TU,iridescence_pars_fragment:EU,output_fragment:AU,packing:CU,premultiplied_alpha_fragment:RU,project_vertex:PU,dithering_fragment:LU,dithering_pars_fragment:IU,roughnessmap_fragment:FU,roughnessmap_pars_fragment:DU,shadowmap_pars_fragment:NU,shadowmap_pars_vertex:OU,shadowmap_vertex:kU,shadowmask_pars_fragment:BU,skinbase_vertex:zU,skinning_pars_vertex:UU,skinning_vertex:HU,skinnormal_vertex:GU,specularmap_fragment:WU,specularmap_pars_fragment:VU,tonemapping_fragment:$U,tonemapping_pars_fragment:jU,transmission_fragment:XU,transmission_pars_fragment:qU,uv_pars_fragment:YU,uv_pars_vertex:KU,uv_vertex:ZU,uv2_pars_fragment:QU,uv2_pars_vertex:JU,uv2_vertex:e5,worldpos_vertex:t5,background_vert:n5,background_frag:i5,cube_vert:r5,cube_frag:s5,depth_vert:o5,depth_frag:a5,distanceRGBA_vert:l5,distanceRGBA_frag:c5,equirect_vert:u5,equirect_frag:f5,linedashed_vert:d5,linedashed_frag:h5,meshbasic_vert:p5,meshbasic_frag:m5,meshlambert_vert:g5,meshlambert_frag:v5,meshmatcap_vert:y5,meshmatcap_frag:x5,meshnormal_vert:_5,meshnormal_frag:w5,meshphong_vert:S5,meshphong_frag:M5,meshphysical_vert:b5,meshphysical_frag:T5,meshtoon_vert:E5,meshtoon_frag:A5,points_vert:C5,points_frag:R5,shadow_vert:P5,shadow_frag:L5,sprite_vert:I5,sprite_frag:F5},Ie={common:{diffuse:{value:new Fe(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ps},uv2Transform:{value:new ps},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ce(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Fe(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Fe(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ps}},sprite:{diffuse:{value:new Fe(16777215)},opacity:{value:1},center:{value:new Ce(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ps}}},ls={basic:{uniforms:ii([Ie.common,Ie.specularmap,Ie.envmap,Ie.aomap,Ie.lightmap,Ie.fog]),vertexShader:ct.meshbasic_vert,fragmentShader:ct.meshbasic_frag},lambert:{uniforms:ii([Ie.common,Ie.specularmap,Ie.envmap,Ie.aomap,Ie.lightmap,Ie.emissivemap,Ie.fog,Ie.lights,{emissive:{value:new Fe(0)}}]),vertexShader:ct.meshlambert_vert,fragmentShader:ct.meshlambert_frag},phong:{uniforms:ii([Ie.common,Ie.specularmap,Ie.envmap,Ie.aomap,Ie.lightmap,Ie.emissivemap,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,Ie.fog,Ie.lights,{emissive:{value:new Fe(0)},specular:{value:new Fe(1118481)},shininess:{value:30}}]),vertexShader:ct.meshphong_vert,fragmentShader:ct.meshphong_frag},standard:{uniforms:ii([Ie.common,Ie.envmap,Ie.aomap,Ie.lightmap,Ie.emissivemap,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,Ie.roughnessmap,Ie.metalnessmap,Ie.fog,Ie.lights,{emissive:{value:new Fe(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ct.meshphysical_vert,fragmentShader:ct.meshphysical_frag},toon:{uniforms:ii([Ie.common,Ie.aomap,Ie.lightmap,Ie.emissivemap,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,Ie.gradientmap,Ie.fog,Ie.lights,{emissive:{value:new Fe(0)}}]),vertexShader:ct.meshtoon_vert,fragmentShader:ct.meshtoon_frag},matcap:{uniforms:ii([Ie.common,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,Ie.fog,{matcap:{value:null}}]),vertexShader:ct.meshmatcap_vert,fragmentShader:ct.meshmatcap_frag},points:{uniforms:ii([Ie.points,Ie.fog]),vertexShader:ct.points_vert,fragmentShader:ct.points_frag},dashed:{uniforms:ii([Ie.common,Ie.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ct.linedashed_vert,fragmentShader:ct.linedashed_frag},depth:{uniforms:ii([Ie.common,Ie.displacementmap]),vertexShader:ct.depth_vert,fragmentShader:ct.depth_frag},normal:{uniforms:ii([Ie.common,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,{opacity:{value:1}}]),vertexShader:ct.meshnormal_vert,fragmentShader:ct.meshnormal_frag},sprite:{uniforms:ii([Ie.sprite,Ie.fog]),vertexShader:ct.sprite_vert,fragmentShader:ct.sprite_frag},background:{uniforms:{uvTransform:{value:new ps},t2D:{value:null}},vertexShader:ct.background_vert,fragmentShader:ct.background_frag},cube:{uniforms:ii([Ie.envmap,{opacity:{value:1}}]),vertexShader:ct.cube_vert,fragmentShader:ct.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ct.equirect_vert,fragmentShader:ct.equirect_frag},distanceRGBA:{uniforms:ii([Ie.common,Ie.displacementmap,{referencePosition:{value:new z},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ct.distanceRGBA_vert,fragmentShader:ct.distanceRGBA_frag},shadow:{uniforms:ii([Ie.lights,Ie.fog,{color:{value:new Fe(0)},opacity:{value:1}}]),vertexShader:ct.shadow_vert,fragmentShader:ct.shadow_frag}};ls.physical={uniforms:ii([ls.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Ce(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Fe(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Ce},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Fe(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Fe(1,1,1)},specularColorMap:{value:null}}]),vertexShader:ct.meshphysical_vert,fragmentShader:ct.meshphysical_frag};function D5(n,e,t,i,r,s){const o=new Fe(0);let a=r===!0?0:1,c,f,h=null,d=0,p=null;function g(y,x){let v=!1,w=x.isScene===!0?x.background:null;w&&w.isTexture&&(w=e.get(w));const S=n.xr,E=S.getSession&&S.getSession();E&&E.environmentBlendMode==="additive"&&(w=null),w===null?_(o,a):w&&w.isColor&&(_(w,1),v=!0),(n.autoClear||v)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),w&&(w.isCubeTexture||w.mapping===mm)?(f===void 0&&(f=new cn(new kc(1,1,1),new pn({name:"BackgroundCubeMaterial",uniforms:Sc(ls.cube.uniforms),vertexShader:ls.cube.vertexShader,fragmentShader:ls.cube.fragmentShader,side:$r,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(b,T,C){this.matrixWorld.copyPosition(C.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(f)),f.material.uniforms.envMap.value=w,f.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,(h!==w||d!==w.version||p!==n.toneMapping)&&(f.material.needsUpdate=!0,h=w,d=w.version,p=n.toneMapping),f.layers.enableAll(),y.unshift(f,f.geometry,f.material,0,0,null)):w&&w.isTexture&&(c===void 0&&(c=new cn(new s_(2,2),new pn({name:"BackgroundMaterial",uniforms:Sc(ls.background.uniforms),vertexShader:ls.background.vertexShader,fragmentShader:ls.background.fragmentShader,side:vc,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(c)),c.material.uniforms.t2D.value=w,w.matrixAutoUpdate===!0&&w.updateMatrix(),c.material.uniforms.uvTransform.value.copy(w.matrix),(h!==w||d!==w.version||p!==n.toneMapping)&&(c.material.needsUpdate=!0,h=w,d=w.version,p=n.toneMapping),c.layers.enableAll(),y.unshift(c,c.geometry,c.material,0,0,null))}function _(y,x){t.buffers.color.setClear(y.r,y.g,y.b,x,s)}return{getClearColor:function(){return o},setClearColor:function(y,x=1){o.set(y),a=x,_(o,a)},getClearAlpha:function(){return a},setClearAlpha:function(y){a=y,_(o,a)},render:g}}function N5(n,e,t,i){const r=n.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},c=x(null);let f=c,h=!1;function d(V,ie,K,ae,$){let Y=!1;if(o){const Z=y(ae,K,ie);f!==Z&&(f=Z,g(f.object)),Y=v(V,ae,K,$),Y&&w(V,ae,K,$)}else{const Z=ie.wireframe===!0;(f.geometry!==ae.id||f.program!==K.id||f.wireframe!==Z)&&(f.geometry=ae.id,f.program=K.id,f.wireframe=Z,Y=!0)}$!==null&&t.update($,34963),(Y||h)&&(h=!1,A(V,ie,K,ae),$!==null&&n.bindBuffer(34963,t.get($).buffer))}function p(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function g(V){return i.isWebGL2?n.bindVertexArray(V):s.bindVertexArrayOES(V)}function _(V){return i.isWebGL2?n.deleteVertexArray(V):s.deleteVertexArrayOES(V)}function y(V,ie,K){const ae=K.wireframe===!0;let $=a[V.id];$===void 0&&($={},a[V.id]=$);let Y=$[ie.id];Y===void 0&&(Y={},$[ie.id]=Y);let Z=Y[ae];return Z===void 0&&(Z=x(p()),Y[ae]=Z),Z}function x(V){const ie=[],K=[],ae=[];for(let $=0;$<r;$++)ie[$]=0,K[$]=0,ae[$]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ie,enabledAttributes:K,attributeDivisors:ae,object:V,attributes:{},index:null}}function v(V,ie,K,ae){const $=f.attributes,Y=ie.attributes;let Z=0;const he=K.getAttributes();for(const me in he)if(he[me].location>=0){const De=$[me];let Be=Y[me];if(Be===void 0&&(me==="instanceMatrix"&&V.instanceMatrix&&(Be=V.instanceMatrix),me==="instanceColor"&&V.instanceColor&&(Be=V.instanceColor)),De===void 0||De.attribute!==Be||Be&&De.data!==Be.data)return!0;Z++}return f.attributesNum!==Z||f.index!==ae}function w(V,ie,K,ae){const $={},Y=ie.attributes;let Z=0;const he=K.getAttributes();for(const me in he)if(he[me].location>=0){let De=Y[me];De===void 0&&(me==="instanceMatrix"&&V.instanceMatrix&&(De=V.instanceMatrix),me==="instanceColor"&&V.instanceColor&&(De=V.instanceColor));const Be={};Be.attribute=De,De&&De.data&&(Be.data=De.data),$[me]=Be,Z++}f.attributes=$,f.attributesNum=Z,f.index=ae}function S(){const V=f.newAttributes;for(let ie=0,K=V.length;ie<K;ie++)V[ie]=0}function E(V){b(V,0)}function b(V,ie){const K=f.newAttributes,ae=f.enabledAttributes,$=f.attributeDivisors;K[V]=1,ae[V]===0&&(n.enableVertexAttribArray(V),ae[V]=1),$[V]!==ie&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](V,ie),$[V]=ie)}function T(){const V=f.newAttributes,ie=f.enabledAttributes;for(let K=0,ae=ie.length;K<ae;K++)ie[K]!==V[K]&&(n.disableVertexAttribArray(K),ie[K]=0)}function C(V,ie,K,ae,$,Y){i.isWebGL2===!0&&(K===5124||K===5125)?n.vertexAttribIPointer(V,ie,K,$,Y):n.vertexAttribPointer(V,ie,K,ae,$,Y)}function A(V,ie,K,ae){if(i.isWebGL2===!1&&(V.isInstancedMesh||ae.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;S();const $=ae.attributes,Y=K.getAttributes(),Z=ie.defaultAttributeValues;for(const he in Y){const me=Y[he];if(me.location>=0){let we=$[he];if(we===void 0&&(he==="instanceMatrix"&&V.instanceMatrix&&(we=V.instanceMatrix),he==="instanceColor"&&V.instanceColor&&(we=V.instanceColor)),we!==void 0){const De=we.normalized,Be=we.itemSize,ce=t.get(we);if(ce===void 0)continue;const yt=ce.buffer,qe=ce.type,Xe=ce.bytesPerElement;if(we.isInterleavedBufferAttribute){const Ne=we.data,dt=Ne.stride,nt=we.offset;if(Ne.isInstancedInterleavedBuffer){for(let Ye=0;Ye<me.locationSize;Ye++)b(me.location+Ye,Ne.meshPerAttribute);V.isInstancedMesh!==!0&&ae._maxInstanceCount===void 0&&(ae._maxInstanceCount=Ne.meshPerAttribute*Ne.count)}else for(let Ye=0;Ye<me.locationSize;Ye++)E(me.location+Ye);n.bindBuffer(34962,yt);for(let Ye=0;Ye<me.locationSize;Ye++)C(me.location+Ye,Be/me.locationSize,qe,De,dt*Xe,(nt+Be/me.locationSize*Ye)*Xe)}else{if(we.isInstancedBufferAttribute){for(let Ne=0;Ne<me.locationSize;Ne++)b(me.location+Ne,we.meshPerAttribute);V.isInstancedMesh!==!0&&ae._maxInstanceCount===void 0&&(ae._maxInstanceCount=we.meshPerAttribute*we.count)}else for(let Ne=0;Ne<me.locationSize;Ne++)E(me.location+Ne);n.bindBuffer(34962,yt);for(let Ne=0;Ne<me.locationSize;Ne++)C(me.location+Ne,Be/me.locationSize,qe,De,Be*Xe,Be/me.locationSize*Ne*Xe)}}else if(Z!==void 0){const De=Z[he];if(De!==void 0)switch(De.length){case 2:n.vertexAttrib2fv(me.location,De);break;case 3:n.vertexAttrib3fv(me.location,De);break;case 4:n.vertexAttrib4fv(me.location,De);break;default:n.vertexAttrib1fv(me.location,De)}}}}T()}function F(){ne();for(const V in a){const ie=a[V];for(const K in ie){const ae=ie[K];for(const $ in ae)_(ae[$].object),delete ae[$];delete ie[K]}delete a[V]}}function U(V){if(a[V.id]===void 0)return;const ie=a[V.id];for(const K in ie){const ae=ie[K];for(const $ in ae)_(ae[$].object),delete ae[$];delete ie[K]}delete a[V.id]}function W(V){for(const ie in a){const K=a[ie];if(K[V.id]===void 0)continue;const ae=K[V.id];for(const $ in ae)_(ae[$].object),delete ae[$];delete K[V.id]}}function ne(){re(),h=!0,f!==c&&(f=c,g(f.object))}function re(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:d,reset:ne,resetDefaultState:re,dispose:F,releaseStatesOfGeometry:U,releaseStatesOfProgram:W,initAttributes:S,enableAttribute:E,disableUnusedAttributes:T}}function O5(n,e,t,i){const r=i.isWebGL2;let s;function o(f){s=f}function a(f,h){n.drawArrays(s,f,h),t.update(h,s,1)}function c(f,h,d){if(d===0)return;let p,g;if(r)p=n,g="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),g="drawArraysInstancedANGLE",p===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[g](s,f,h,d),t.update(h,s,d)}this.setMode=o,this.render=a,this.renderInstances=c}function k5(n,e,t){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const C=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(C){if(C==="highp"){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";C="mediump"}return C==="mediump"&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext!="undefined"&&n instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&n instanceof WebGL2ComputeRenderingContext;let a=t.precision!==void 0?t.precision:"highp";const c=s(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);const f=o||e.has("WEBGL_draw_buffers"),h=t.logarithmicDepthBuffer===!0,d=n.getParameter(34930),p=n.getParameter(35660),g=n.getParameter(3379),_=n.getParameter(34076),y=n.getParameter(34921),x=n.getParameter(36347),v=n.getParameter(36348),w=n.getParameter(36349),S=p>0,E=o||e.has("OES_texture_float"),b=S&&E,T=o?n.getParameter(36183):0;return{isWebGL2:o,drawBuffers:f,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:h,maxTextures:d,maxVertexTextures:p,maxTextureSize:g,maxCubemapSize:_,maxAttributes:y,maxVertexUniforms:x,maxVaryings:v,maxFragmentUniforms:w,vertexTextures:S,floatFragmentTextures:E,floatVertexTextures:b,maxSamples:T}}function B5(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new xa,a=new ps,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(d,p,g){const _=d.length!==0||p||i!==0||r;return r=p,t=h(d,g,0),i=d.length,_},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1,f()},this.setState=function(d,p,g){const _=d.clippingPlanes,y=d.clipIntersection,x=d.clipShadows,v=n.get(d);if(!r||_===null||_.length===0||s&&!x)s?h(null):f();else{const w=s?0:i,S=w*4;let E=v.clippingState||null;c.value=E,E=h(_,p,S,g);for(let b=0;b!==S;++b)E[b]=t[b];v.clippingState=E,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=w}};function f(){c.value!==t&&(c.value=t,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function h(d,p,g,_){const y=d!==null?d.length:0;let x=null;if(y!==0){if(x=c.value,_!==!0||x===null){const v=g+y*4,w=p.matrixWorldInverse;a.getNormalMatrix(w),(x===null||x.length<v)&&(x=new Float32Array(v));for(let S=0,E=g;S!==y;++S,E+=4)o.copy(d[S]).applyMatrix4(w,a),o.normal.toArray(x,E),x[E+3]=o.constant}c.value=x,c.needsUpdate=!0}return e.numPlanes=y,e.numIntersection=0,x}}function z5(n){let e=new WeakMap;function t(o,a){return a===Bp?o.mapping=yc:a===Sy&&(o.mapping=xc),o}function i(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===Bp||a===Sy)if(e.has(o)){const c=e.get(o).texture;return t(c,o.mapping)}else{const c=o.image;if(c&&c.height>0){const f=new tz(c.height/2);return f.fromEquirectangularTexture(n,o),e.set(o,f),o.addEventListener("dispose",r),t(f.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}class jf extends R2{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,c=r-t;if(this.view!==null&&this.view.enabled){const f=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=f*this.view.offsetX,o=s+f*this.view.width,a-=h*this.view.offsetY,c=a-h*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Ql=4,hb=[.125,.215,.35,.446,.526,.582],ba=20,cv=new jf,pb=new Fe;let uv=null;const _a=(1+Math.sqrt(5))/2,Cl=1/_a,mb=[new z(1,1,1),new z(-1,1,1),new z(1,1,-1),new z(-1,1,-1),new z(0,_a,Cl),new z(0,_a,-Cl),new z(Cl,0,_a),new z(-Cl,0,_a),new z(_a,Cl,0),new z(-_a,Cl,0)];class gb{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){uv=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=xb(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=yb(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(uv),e.scissorTest=!1,Th(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===yc||e.mapping===xc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),uv=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Ri,minFilter:Ri,generateMipmaps:!1,type:Ef,format:_r,encoding:Ga,depthBuffer:!1},r=vb(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=vb(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=U5(s)),this._blurMaterial=H5(s,e,t)}return r}_compileMaterial(e){const t=new cn(this._lodPlanes[0],e);this._renderer.compile(t,cv)}_sceneToCubeUV(e,t,i,r){const a=new di(90,1,t,i),c=[1,-1,1,1,1,1],f=[1,1,1,-1,-1,-1],h=this._renderer,d=h.autoClear,p=h.toneMapping;h.getClearColor(pb),h.toneMapping=vs,h.autoClear=!1;const g=new wr({name:"PMREM.Background",side:$r,depthWrite:!1,depthTest:!1}),_=new cn(new kc,g);let y=!1;const x=e.background;x?x.isColor&&(g.color.copy(x),e.background=null,y=!0):(g.color.copy(pb),y=!0);for(let v=0;v<6;v++){const w=v%3;w===0?(a.up.set(0,c[v],0),a.lookAt(f[v],0,0)):w===1?(a.up.set(0,0,c[v]),a.lookAt(0,f[v],0)):(a.up.set(0,c[v],0),a.lookAt(0,0,f[v]));const S=this._cubeSize;Th(r,w*S,v>2?S:0,S,S),h.setRenderTarget(r),y&&h.render(_,a),h.render(e,a)}_.geometry.dispose(),_.material.dispose(),h.toneMapping=p,h.autoClear=d,e.background=x}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===yc||e.mapping===xc;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=xb()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=yb());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new cn(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const c=this._cubeSize;Th(t,0,0,3*c,2*c),i.setRenderTarget(t),i.render(o,cv)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=mb[(r-1)%mb.length];this._blur(e,r-1,r,s,o)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const c=this._renderer,f=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,d=new cn(this._lodPlanes[r],f),p=f.uniforms,g=this._sizeLods[i]-1,_=isFinite(s)?Math.PI/(2*g):2*Math.PI/(2*ba-1),y=s/_,x=isFinite(s)?1+Math.floor(h*y):ba;x>ba&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${ba}`);const v=[];let w=0;for(let C=0;C<ba;++C){const A=C/y,F=Math.exp(-A*A/2);v.push(F),C===0?w+=F:C<x&&(w+=2*F)}for(let C=0;C<v.length;C++)v[C]=v[C]/w;p.envMap.value=e.texture,p.samples.value=x,p.weights.value=v,p.latitudinal.value=o==="latitudinal",a&&(p.poleAxis.value=a);const{_lodMax:S}=this;p.dTheta.value=_,p.mipInt.value=S-i;const E=this._sizeLods[r],b=3*E*(r>S-Ql?r-S+Ql:0),T=4*(this._cubeSize-E);Th(t,b,T,3*E,2*E),c.setRenderTarget(t),c.render(d,cv)}}function U5(n){const e=[],t=[],i=[];let r=n;const s=n-Ql+1+hb.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let c=1/a;o>n-Ql?c=hb[o-n+Ql-1]:o===0&&(c=0),i.push(c);const f=1/(a-2),h=-f,d=1+f,p=[h,h,d,h,d,d,h,h,d,d,h,d],g=6,_=6,y=3,x=2,v=1,w=new Float32Array(y*_*g),S=new Float32Array(x*_*g),E=new Float32Array(v*_*g);for(let T=0;T<g;T++){const C=T%3*2/3-1,A=T>2?0:-1,F=[C,A,0,C+2/3,A,0,C+2/3,A+1,0,C,A,0,C+2/3,A+1,0,C,A+1,0];w.set(F,y*_*T),S.set(p,x*_*T);const U=[T,T,T,T,T,T];E.set(U,v*_*T)}const b=new Rn;b.setAttribute("position",new vi(w,y)),b.setAttribute("uv",new vi(S,x)),b.setAttribute("faceIndex",new vi(E,v)),e.push(b),r>Ql&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function vb(n,e,t){const i=new gn(n,e,t);return i.texture.mapping=mm,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Th(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function H5(n,e,t){const i=new Float32Array(ba),r=new z(0,1,0);return new pn({name:"SphericalGaussianBlur",defines:{n:ba,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:o_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:jr,depthTest:!1,depthWrite:!1})}function yb(){return new pn({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:o_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:jr,depthTest:!1,depthWrite:!1})}function xb(){return new pn({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:o_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:jr,depthTest:!1,depthWrite:!1})}function o_(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function G5(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const c=a.mapping,f=c===Bp||c===Sy,h=c===yc||c===xc;if(f||h)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let d=e.get(a);return t===null&&(t=new gb(n)),d=f?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}else{if(e.has(a))return e.get(a).texture;{const d=a.image;if(f&&d&&d.height>0||h&&d&&r(d)){t===null&&(t=new gb(n));const p=f?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,p),a.addEventListener("dispose",s),p.texture}else return null}}}return a}function r(a){let c=0;const f=6;for(let h=0;h<f;h++)a[h]!==void 0&&c++;return c===f}function s(a){const c=a.target;c.removeEventListener("dispose",s);const f=e.get(c);f!==void 0&&(e.delete(c),f.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function W5(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function V5(n,e,t,i){const r={},s=new WeakMap;function o(d){const p=d.target;p.index!==null&&e.remove(p.index);for(const _ in p.attributes)e.remove(p.attributes[_]);p.removeEventListener("dispose",o),delete r[p.id];const g=s.get(p);g&&(e.remove(g),s.delete(p)),i.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function a(d,p){return r[p.id]===!0||(p.addEventListener("dispose",o),r[p.id]=!0,t.memory.geometries++),p}function c(d){const p=d.attributes;for(const _ in p)e.update(p[_],34962);const g=d.morphAttributes;for(const _ in g){const y=g[_];for(let x=0,v=y.length;x<v;x++)e.update(y[x],34962)}}function f(d){const p=[],g=d.index,_=d.attributes.position;let y=0;if(g!==null){const w=g.array;y=g.version;for(let S=0,E=w.length;S<E;S+=3){const b=w[S+0],T=w[S+1],C=w[S+2];p.push(b,T,T,C,C,b)}}else{const w=_.array;y=_.version;for(let S=0,E=w.length/3-1;S<E;S+=3){const b=S+0,T=S+1,C=S+2;p.push(b,T,T,C,C,b)}}const x=new(S2(p)?C2:A2)(p,1);x.version=y;const v=s.get(d);v&&e.remove(v),s.set(d,x)}function h(d){const p=s.get(d);if(p){const g=d.index;g!==null&&p.version<g.version&&f(d)}else f(d);return s.get(d)}return{get:a,update:c,getWireframeAttribute:h}}function $5(n,e,t,i){const r=i.isWebGL2;let s;function o(p){s=p}let a,c;function f(p){a=p.type,c=p.bytesPerElement}function h(p,g){n.drawElements(s,g,a,p*c),t.update(g,s,1)}function d(p,g,_){if(_===0)return;let y,x;if(r)y=n,x="drawElementsInstanced";else if(y=e.get("ANGLE_instanced_arrays"),x="drawElementsInstancedANGLE",y===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}y[x](s,g,a,p*c,_),t.update(g,s,_)}this.setMode=o,this.setIndex=f,this.render=h,this.renderInstances=d}function j5(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function X5(n,e){return n[0]-e[0]}function q5(n,e){return Math.abs(e[1])-Math.abs(n[1])}function fv(n,e){let t=1;const i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?t=127:i instanceof Int16Array?t=32767:i instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),n.divideScalar(t)}function Y5(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Ut,a=[];for(let f=0;f<8;f++)a[f]=[f,0];function c(f,h,d,p){const g=f.morphTargetInfluences;if(e.isWebGL2===!0){const y=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,x=y!==void 0?y.length:0;let v=s.get(h);if(v===void 0||v.count!==x){let K=function(){V.dispose(),s.delete(h),h.removeEventListener("dispose",K)};var _=K;v!==void 0&&v.texture.dispose();const E=h.morphAttributes.position!==void 0,b=h.morphAttributes.normal!==void 0,T=h.morphAttributes.color!==void 0,C=h.morphAttributes.position||[],A=h.morphAttributes.normal||[],F=h.morphAttributes.color||[];let U=0;E===!0&&(U=1),b===!0&&(U=2),T===!0&&(U=3);let W=h.attributes.position.count*U,ne=1;W>e.maxTextureSize&&(ne=Math.ceil(W/e.maxTextureSize),W=e.maxTextureSize);const re=new Float32Array(W*ne*4*x),V=new E2(re,W,ne,x);V.type=Do,V.needsUpdate=!0;const ie=U*4;for(let ae=0;ae<x;ae++){const $=C[ae],Y=A[ae],Z=F[ae],he=W*ne*4*ae;for(let me=0;me<$.count;me++){const we=me*ie;E===!0&&(o.fromBufferAttribute($,me),$.normalized===!0&&fv(o,$),re[he+we+0]=o.x,re[he+we+1]=o.y,re[he+we+2]=o.z,re[he+we+3]=0),b===!0&&(o.fromBufferAttribute(Y,me),Y.normalized===!0&&fv(o,Y),re[he+we+4]=o.x,re[he+we+5]=o.y,re[he+we+6]=o.z,re[he+we+7]=0),T===!0&&(o.fromBufferAttribute(Z,me),Z.normalized===!0&&fv(o,Z),re[he+we+8]=o.x,re[he+we+9]=o.y,re[he+we+10]=o.z,re[he+we+11]=Z.itemSize===4?o.w:1)}}v={count:x,texture:V,size:new Ce(W,ne)},s.set(h,v),h.addEventListener("dispose",K)}let w=0;for(let E=0;E<g.length;E++)w+=g[E];const S=h.morphTargetsRelative?1:1-w;p.getUniforms().setValue(n,"morphTargetBaseInfluence",S),p.getUniforms().setValue(n,"morphTargetInfluences",g),p.getUniforms().setValue(n,"morphTargetsTexture",v.texture,t),p.getUniforms().setValue(n,"morphTargetsTextureSize",v.size)}else{const y=g===void 0?0:g.length;let x=i[h.id];if(x===void 0||x.length!==y){x=[];for(let b=0;b<y;b++)x[b]=[b,0];i[h.id]=x}for(let b=0;b<y;b++){const T=x[b];T[0]=b,T[1]=g[b]}x.sort(q5);for(let b=0;b<8;b++)b<y&&x[b][1]?(a[b][0]=x[b][0],a[b][1]=x[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(X5);const v=h.morphAttributes.position,w=h.morphAttributes.normal;let S=0;for(let b=0;b<8;b++){const T=a[b],C=T[0],A=T[1];C!==Number.MAX_SAFE_INTEGER&&A?(v&&h.getAttribute("morphTarget"+b)!==v[C]&&h.setAttribute("morphTarget"+b,v[C]),w&&h.getAttribute("morphNormal"+b)!==w[C]&&h.setAttribute("morphNormal"+b,w[C]),r[b]=A,S+=A):(v&&h.hasAttribute("morphTarget"+b)===!0&&h.deleteAttribute("morphTarget"+b),w&&h.hasAttribute("morphNormal"+b)===!0&&h.deleteAttribute("morphNormal"+b),r[b]=0)}const E=h.morphTargetsRelative?1:1-S;p.getUniforms().setValue(n,"morphTargetBaseInfluence",E),p.getUniforms().setValue(n,"morphTargetInfluences",r)}}return{update:c}}function K5(n,e,t,i){let r=new WeakMap;function s(c){const f=i.render.frame,h=c.geometry,d=e.get(c,h);return r.get(d)!==f&&(e.update(d),r.set(d,f)),c.isInstancedMesh&&(c.hasEventListener("dispose",a)===!1&&c.addEventListener("dispose",a),t.update(c.instanceMatrix,34962),c.instanceColor!==null&&t.update(c.instanceColor,34962)),d}function o(){r=new WeakMap}function a(c){const f=c.target;f.removeEventListener("dispose",a),t.remove(f.instanceMatrix),f.instanceColor!==null&&t.remove(f.instanceColor)}return{update:s,dispose:o}}const I2=new yi,F2=new E2,D2=new H4,N2=new P2,_b=[],wb=[],Sb=new Float32Array(16),Mb=new Float32Array(9),bb=new Float32Array(4);function Bc(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=_b[r];if(s===void 0&&(s=new Float32Array(r),_b[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function xi(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function _i(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function ym(n,e){let t=wb[e];t===void 0&&(t=new Int32Array(e),wb[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Z5(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Q5(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(xi(t,e))return;n.uniform2fv(this.addr,e),_i(t,e)}}function J5(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(xi(t,e))return;n.uniform3fv(this.addr,e),_i(t,e)}}function e6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(xi(t,e))return;n.uniform4fv(this.addr,e),_i(t,e)}}function t6(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(xi(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),_i(t,e)}else{if(xi(t,i))return;bb.set(i),n.uniformMatrix2fv(this.addr,!1,bb),_i(t,i)}}function n6(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(xi(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),_i(t,e)}else{if(xi(t,i))return;Mb.set(i),n.uniformMatrix3fv(this.addr,!1,Mb),_i(t,i)}}function i6(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(xi(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),_i(t,e)}else{if(xi(t,i))return;Sb.set(i),n.uniformMatrix4fv(this.addr,!1,Sb),_i(t,i)}}function r6(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function s6(n,e){const t=this.cache;xi(t,e)||(n.uniform2iv(this.addr,e),_i(t,e))}function o6(n,e){const t=this.cache;xi(t,e)||(n.uniform3iv(this.addr,e),_i(t,e))}function a6(n,e){const t=this.cache;xi(t,e)||(n.uniform4iv(this.addr,e),_i(t,e))}function l6(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function c6(n,e){const t=this.cache;xi(t,e)||(n.uniform2uiv(this.addr,e),_i(t,e))}function u6(n,e){const t=this.cache;xi(t,e)||(n.uniform3uiv(this.addr,e),_i(t,e))}function f6(n,e){const t=this.cache;xi(t,e)||(n.uniform4uiv(this.addr,e),_i(t,e))}function d6(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||I2,r)}function h6(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||D2,r)}function p6(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||N2,r)}function m6(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||F2,r)}function g6(n){switch(n){case 5126:return Z5;case 35664:return Q5;case 35665:return J5;case 35666:return e6;case 35674:return t6;case 35675:return n6;case 35676:return i6;case 5124:case 35670:return r6;case 35667:case 35671:return s6;case 35668:case 35672:return o6;case 35669:case 35673:return a6;case 5125:return l6;case 36294:return c6;case 36295:return u6;case 36296:return f6;case 35678:case 36198:case 36298:case 36306:case 35682:return d6;case 35679:case 36299:case 36307:return h6;case 35680:case 36300:case 36308:case 36293:return p6;case 36289:case 36303:case 36311:case 36292:return m6}}function v6(n,e){n.uniform1fv(this.addr,e)}function y6(n,e){const t=Bc(e,this.size,2);n.uniform2fv(this.addr,t)}function x6(n,e){const t=Bc(e,this.size,3);n.uniform3fv(this.addr,t)}function _6(n,e){const t=Bc(e,this.size,4);n.uniform4fv(this.addr,t)}function w6(n,e){const t=Bc(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function S6(n,e){const t=Bc(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function M6(n,e){const t=Bc(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function b6(n,e){n.uniform1iv(this.addr,e)}function T6(n,e){n.uniform2iv(this.addr,e)}function E6(n,e){n.uniform3iv(this.addr,e)}function A6(n,e){n.uniform4iv(this.addr,e)}function C6(n,e){n.uniform1uiv(this.addr,e)}function R6(n,e){n.uniform2uiv(this.addr,e)}function P6(n,e){n.uniform3uiv(this.addr,e)}function L6(n,e){n.uniform4uiv(this.addr,e)}function I6(n,e,t){const i=e.length,r=ym(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture2D(e[s]||I2,r[s])}function F6(n,e,t){const i=e.length,r=ym(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture3D(e[s]||D2,r[s])}function D6(n,e,t){const i=e.length,r=ym(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTextureCube(e[s]||N2,r[s])}function N6(n,e,t){const i=e.length,r=ym(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture2DArray(e[s]||F2,r[s])}function O6(n){switch(n){case 5126:return v6;case 35664:return y6;case 35665:return x6;case 35666:return _6;case 35674:return w6;case 35675:return S6;case 35676:return M6;case 5124:case 35670:return b6;case 35667:case 35671:return T6;case 35668:case 35672:return E6;case 35669:case 35673:return A6;case 5125:return C6;case 36294:return R6;case 36295:return P6;case 36296:return L6;case 35678:case 36198:case 36298:case 36306:case 35682:return I6;case 35679:case 36299:case 36307:return F6;case 35680:case 36300:case 36308:case 36293:return D6;case 36289:case 36303:case 36311:case 36292:return N6}}class k6{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=g6(t.type)}}class B6{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=O6(t.type)}}class z6{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const dv=/(\w+)(\])?(\[|\.)?/g;function Tb(n,e){n.seq.push(e),n.map[e.id]=e}function U6(n,e,t){const i=n.name,r=i.length;for(dv.lastIndex=0;;){const s=dv.exec(i),o=dv.lastIndex;let a=s[1];const c=s[2]==="]",f=s[3];if(c&&(a=a|0),f===void 0||f==="["&&o+2===r){Tb(t,f===void 0?new k6(a,n,e):new B6(a,n,e));break}else{let d=t.map[a];d===void 0&&(d=new z6(a),Tb(t,d)),t=d}}}class sp{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,35718);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);U6(s,o,this)}}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],c=i[a.id];c.needsUpdate!==!1&&a.setValue(e,c.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function Eb(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let H6=0;function G6(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}function W6(n){switch(n){case Ga:return["Linear","( value )"];case Lt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}function Ab(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+G6(n.getShaderSource(e),o)}else return r}function V6(n,e){const t=W6(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function $6(n,e){let t;switch(e){case QB:t="Linear";break;case m2:t="Reinhard";break;case JB:t="OptimizedCineon";break;case e4:t="ACESFilmic";break;case t4:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function j6(n){return[n.extensionDerivatives||!!n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ju).join(`
`)}function X6(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function q6(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function ju(n){return n!==""}function Cb(n,e){return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Rb(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Y6=/^[ \t]*#include +<([\w\d./]+)>/gm;function Cy(n){return n.replace(Y6,K6)}function K6(n,e){const t=ct[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return Cy(t)}const Z6=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Q6=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Pb(n){return n.replace(Q6,O2).replace(Z6,J6)}function J6(n,e,t,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),O2(n,e,t,i)}function O2(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Lb(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function eH(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===f2?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===d2?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===$u&&(e="SHADOWMAP_TYPE_VSM"),e}function tH(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case yc:case xc:e="ENVMAP_TYPE_CUBE";break;case mm:e="ENVMAP_TYPE_CUBE_UV";break}return e}function nH(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case xc:e="ENVMAP_MODE_REFRACTION";break}return e}function iH(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case pm:e="ENVMAP_BLENDING_MULTIPLY";break;case KB:e="ENVMAP_BLENDING_MIX";break;case ZB:e="ENVMAP_BLENDING_ADD";break}return e}function rH(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function sH(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const c=eH(t),f=tH(t),h=nH(t),d=iH(t),p=rH(t),g=t.isWebGL2?"":j6(t),_=X6(s),y=r.createProgram();let x,v,w=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(x=[_].filter(ju).join(`
`),x.length>0&&(x+=`
`),v=[g,_].filter(ju).join(`
`),v.length>0&&(v+=`
`)):(x=[Lb(t),"#define SHADER_NAME "+t.shaderName,_,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(ju).join(`
`),v=[g,Lb(t),"#define SHADER_NAME "+t.shaderName,_,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.envMap?"#define "+h:"",t.envMap?"#define "+d:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==vs?"#define TONE_MAPPING":"",t.toneMapping!==vs?ct.tonemapping_pars_fragment:"",t.toneMapping!==vs?$6("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",ct.encodings_pars_fragment,V6("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(ju).join(`
`)),o=Cy(o),o=Cb(o,t),o=Rb(o,t),a=Cy(a),a=Cb(a,t),a=Rb(a,t),o=Pb(o),a=Pb(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,x=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+x,v=["#define varying in",t.glslVersion===eb?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===eb?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);const S=w+x+o,E=w+v+a,b=Eb(r,35633,S),T=Eb(r,35632,E);if(r.attachShader(y,b),r.attachShader(y,T),t.index0AttributeName!==void 0?r.bindAttribLocation(y,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(y,0,"position"),r.linkProgram(y),n.debug.checkShaderErrors){const F=r.getProgramInfoLog(y).trim(),U=r.getShaderInfoLog(b).trim(),W=r.getShaderInfoLog(T).trim();let ne=!0,re=!0;if(r.getProgramParameter(y,35714)===!1){ne=!1;const V=Ab(r,b,"vertex"),ie=Ab(r,T,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(y,35715)+`

Program Info Log: `+F+`
`+V+`
`+ie)}else F!==""?console.warn("THREE.WebGLProgram: Program Info Log:",F):(U===""||W==="")&&(re=!1);re&&(this.diagnostics={runnable:ne,programLog:F,vertexShader:{log:U,prefix:x},fragmentShader:{log:W,prefix:v}})}r.deleteShader(b),r.deleteShader(T);let C;this.getUniforms=function(){return C===void 0&&(C=new sp(r,y)),C};let A;return this.getAttributes=function(){return A===void 0&&(A=q6(r,y)),A},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(y),this.program=void 0},this.name=t.shaderName,this.id=H6++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=b,this.fragmentShader=T,this}let oH=0;class aH{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return t.has(e)===!1&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(t.has(e)===!1){const i=new lH(e);t.set(e,i)}return t.get(e)}}class lH{constructor(e){this.id=oH++,this.code=e,this.usedTimes=0}}function cH(n,e,t,i,r,s,o){const a=new r_,c=new aH,f=[],h=r.isWebGL2,d=r.logarithmicDepthBuffer,p=r.vertexTextures;let g=r.precision;const _={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function y(A,F,U,W,ne){const re=W.fog,V=ne.geometry,ie=A.isMeshStandardMaterial?W.environment:null,K=(A.isMeshStandardMaterial?t:e).get(A.envMap||ie),ae=!!K&&K.mapping===mm?K.image.height:null,$=_[A.type];A.precision!==null&&(g=r.getMaxPrecision(A.precision),g!==A.precision&&console.warn("THREE.WebGLProgram.getParameters:",A.precision,"not supported, using",g,"instead."));const Y=V.morphAttributes.position||V.morphAttributes.normal||V.morphAttributes.color,Z=Y!==void 0?Y.length:0;let he=0;V.morphAttributes.position!==void 0&&(he=1),V.morphAttributes.normal!==void 0&&(he=2),V.morphAttributes.color!==void 0&&(he=3);let me,we,De,Be;if($){const dt=ls[$];me=dt.vertexShader,we=dt.fragmentShader}else me=A.vertexShader,we=A.fragmentShader,c.update(A),De=c.getVertexShaderID(A),Be=c.getFragmentShaderID(A);const ce=n.getRenderTarget(),yt=A.alphaTest>0,qe=A.clearcoat>0,Xe=A.iridescence>0;return{isWebGL2:h,shaderID:$,shaderName:A.type,vertexShader:me,fragmentShader:we,defines:A.defines,customVertexShaderID:De,customFragmentShaderID:Be,isRawShaderMaterial:A.isRawShaderMaterial===!0,glslVersion:A.glslVersion,precision:g,instancing:ne.isInstancedMesh===!0,instancingColor:ne.isInstancedMesh===!0&&ne.instanceColor!==null,supportsVertexTextures:p,outputEncoding:ce===null?n.outputEncoding:ce.isXRRenderTarget===!0?ce.texture.encoding:Ga,map:!!A.map,matcap:!!A.matcap,envMap:!!K,envMapMode:K&&K.mapping,envMapCubeUVHeight:ae,lightMap:!!A.lightMap,aoMap:!!A.aoMap,emissiveMap:!!A.emissiveMap,bumpMap:!!A.bumpMap,normalMap:!!A.normalMap,objectSpaceNormalMap:A.normalMapType===S4,tangentSpaceNormalMap:A.normalMapType===qa,decodeVideoTexture:!!A.map&&A.map.isVideoTexture===!0&&A.map.encoding===Lt,clearcoat:qe,clearcoatMap:qe&&!!A.clearcoatMap,clearcoatRoughnessMap:qe&&!!A.clearcoatRoughnessMap,clearcoatNormalMap:qe&&!!A.clearcoatNormalMap,iridescence:Xe,iridescenceMap:Xe&&!!A.iridescenceMap,iridescenceThicknessMap:Xe&&!!A.iridescenceThicknessMap,displacementMap:!!A.displacementMap,roughnessMap:!!A.roughnessMap,metalnessMap:!!A.metalnessMap,specularMap:!!A.specularMap,specularIntensityMap:!!A.specularIntensityMap,specularColorMap:!!A.specularColorMap,opaque:A.transparent===!1&&A.blending===sc,alphaMap:!!A.alphaMap,alphaTest:yt,gradientMap:!!A.gradientMap,sheen:A.sheen>0,sheenColorMap:!!A.sheenColorMap,sheenRoughnessMap:!!A.sheenRoughnessMap,transmission:A.transmission>0,transmissionMap:!!A.transmissionMap,thicknessMap:!!A.thicknessMap,combine:A.combine,vertexTangents:!!A.normalMap&&!!V.attributes.tangent,vertexColors:A.vertexColors,vertexAlphas:A.vertexColors===!0&&!!V.attributes.color&&V.attributes.color.itemSize===4,vertexUvs:!!A.map||!!A.bumpMap||!!A.normalMap||!!A.specularMap||!!A.alphaMap||!!A.emissiveMap||!!A.roughnessMap||!!A.metalnessMap||!!A.clearcoatMap||!!A.clearcoatRoughnessMap||!!A.clearcoatNormalMap||!!A.iridescenceMap||!!A.iridescenceThicknessMap||!!A.displacementMap||!!A.transmissionMap||!!A.thicknessMap||!!A.specularIntensityMap||!!A.specularColorMap||!!A.sheenColorMap||!!A.sheenRoughnessMap,uvsVertexOnly:!(!!A.map||!!A.bumpMap||!!A.normalMap||!!A.specularMap||!!A.alphaMap||!!A.emissiveMap||!!A.roughnessMap||!!A.metalnessMap||!!A.clearcoatNormalMap||!!A.iridescenceMap||!!A.iridescenceThicknessMap||A.transmission>0||!!A.transmissionMap||!!A.thicknessMap||!!A.specularIntensityMap||!!A.specularColorMap||A.sheen>0||!!A.sheenColorMap||!!A.sheenRoughnessMap)&&!!A.displacementMap,fog:!!re,useFog:A.fog===!0,fogExp2:re&&re.isFogExp2,flatShading:!!A.flatShading,sizeAttenuation:A.sizeAttenuation,logarithmicDepthBuffer:d,skinning:ne.isSkinnedMesh===!0,morphTargets:V.morphAttributes.position!==void 0,morphNormals:V.morphAttributes.normal!==void 0,morphColors:V.morphAttributes.color!==void 0,morphTargetsCount:Z,morphTextureStride:he,numDirLights:F.directional.length,numPointLights:F.point.length,numSpotLights:F.spot.length,numRectAreaLights:F.rectArea.length,numHemiLights:F.hemi.length,numDirLightShadows:F.directionalShadowMap.length,numPointLightShadows:F.pointShadowMap.length,numSpotLightShadows:F.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:A.dithering,shadowMapEnabled:n.shadowMap.enabled&&U.length>0,shadowMapType:n.shadowMap.type,toneMapping:A.toneMapped?n.toneMapping:vs,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:A.premultipliedAlpha,doubleSided:A.side===xs,flipSided:A.side===$r,useDepthPacking:!!A.depthPacking,depthPacking:A.depthPacking||0,index0AttributeName:A.index0AttributeName,extensionDerivatives:A.extensions&&A.extensions.derivatives,extensionFragDepth:A.extensions&&A.extensions.fragDepth,extensionDrawBuffers:A.extensions&&A.extensions.drawBuffers,extensionShaderTextureLOD:A.extensions&&A.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||i.has("EXT_shader_texture_lod"),customProgramCacheKey:A.customProgramCacheKey()}}function x(A){const F=[];if(A.shaderID?F.push(A.shaderID):(F.push(A.customVertexShaderID),F.push(A.customFragmentShaderID)),A.defines!==void 0)for(const U in A.defines)F.push(U),F.push(A.defines[U]);return A.isRawShaderMaterial===!1&&(v(F,A),w(F,A),F.push(n.outputEncoding)),F.push(A.customProgramCacheKey),F.join()}function v(A,F){A.push(F.precision),A.push(F.outputEncoding),A.push(F.envMapMode),A.push(F.envMapCubeUVHeight),A.push(F.combine),A.push(F.vertexUvs),A.push(F.fogExp2),A.push(F.sizeAttenuation),A.push(F.morphTargetsCount),A.push(F.morphAttributeCount),A.push(F.numDirLights),A.push(F.numPointLights),A.push(F.numSpotLights),A.push(F.numHemiLights),A.push(F.numRectAreaLights),A.push(F.numDirLightShadows),A.push(F.numPointLightShadows),A.push(F.numSpotLightShadows),A.push(F.shadowMapType),A.push(F.toneMapping),A.push(F.numClippingPlanes),A.push(F.numClipIntersection),A.push(F.depthPacking)}function w(A,F){a.disableAll(),F.isWebGL2&&a.enable(0),F.supportsVertexTextures&&a.enable(1),F.instancing&&a.enable(2),F.instancingColor&&a.enable(3),F.map&&a.enable(4),F.matcap&&a.enable(5),F.envMap&&a.enable(6),F.lightMap&&a.enable(7),F.aoMap&&a.enable(8),F.emissiveMap&&a.enable(9),F.bumpMap&&a.enable(10),F.normalMap&&a.enable(11),F.objectSpaceNormalMap&&a.enable(12),F.tangentSpaceNormalMap&&a.enable(13),F.clearcoat&&a.enable(14),F.clearcoatMap&&a.enable(15),F.clearcoatRoughnessMap&&a.enable(16),F.clearcoatNormalMap&&a.enable(17),F.iridescence&&a.enable(18),F.iridescenceMap&&a.enable(19),F.iridescenceThicknessMap&&a.enable(20),F.displacementMap&&a.enable(21),F.specularMap&&a.enable(22),F.roughnessMap&&a.enable(23),F.metalnessMap&&a.enable(24),F.gradientMap&&a.enable(25),F.alphaMap&&a.enable(26),F.alphaTest&&a.enable(27),F.vertexColors&&a.enable(28),F.vertexAlphas&&a.enable(29),F.vertexUvs&&a.enable(30),F.vertexTangents&&a.enable(31),F.uvsVertexOnly&&a.enable(32),F.fog&&a.enable(33),A.push(a.mask),a.disableAll(),F.useFog&&a.enable(0),F.flatShading&&a.enable(1),F.logarithmicDepthBuffer&&a.enable(2),F.skinning&&a.enable(3),F.morphTargets&&a.enable(4),F.morphNormals&&a.enable(5),F.morphColors&&a.enable(6),F.premultipliedAlpha&&a.enable(7),F.shadowMapEnabled&&a.enable(8),F.physicallyCorrectLights&&a.enable(9),F.doubleSided&&a.enable(10),F.flipSided&&a.enable(11),F.useDepthPacking&&a.enable(12),F.dithering&&a.enable(13),F.specularIntensityMap&&a.enable(14),F.specularColorMap&&a.enable(15),F.transmission&&a.enable(16),F.transmissionMap&&a.enable(17),F.thicknessMap&&a.enable(18),F.sheen&&a.enable(19),F.sheenColorMap&&a.enable(20),F.sheenRoughnessMap&&a.enable(21),F.decodeVideoTexture&&a.enable(22),F.opaque&&a.enable(23),A.push(a.mask)}function S(A){const F=_[A.type];let U;if(F){const W=ls[F];U=Mc.clone(W.uniforms)}else U=A.uniforms;return U}function E(A,F){let U;for(let W=0,ne=f.length;W<ne;W++){const re=f[W];if(re.cacheKey===F){U=re,++U.usedTimes;break}}return U===void 0&&(U=new sH(n,F,A,s),f.push(U)),U}function b(A){if(--A.usedTimes===0){const F=f.indexOf(A);f[F]=f[f.length-1],f.pop(),A.destroy()}}function T(A){c.remove(A)}function C(){c.dispose()}return{getParameters:y,getProgramCacheKey:x,getUniforms:S,acquireProgram:E,releaseProgram:b,releaseShaderCache:T,programs:f,dispose:C}}function uH(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function i(s,o,a){n.get(s)[o]=a}function r(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:r}}function fH(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function Ib(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function Fb(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(d,p,g,_,y,x){let v=n[e];return v===void 0?(v={id:d.id,object:d,geometry:p,material:g,groupOrder:_,renderOrder:d.renderOrder,z:y,group:x},n[e]=v):(v.id=d.id,v.object=d,v.geometry=p,v.material=g,v.groupOrder=_,v.renderOrder=d.renderOrder,v.z=y,v.group=x),e++,v}function a(d,p,g,_,y,x){const v=o(d,p,g,_,y,x);g.transmission>0?i.push(v):g.transparent===!0?r.push(v):t.push(v)}function c(d,p,g,_,y,x){const v=o(d,p,g,_,y,x);g.transmission>0?i.unshift(v):g.transparent===!0?r.unshift(v):t.unshift(v)}function f(d,p){t.length>1&&t.sort(d||fH),i.length>1&&i.sort(p||Ib),r.length>1&&r.sort(p||Ib)}function h(){for(let d=e,p=n.length;d<p;d++){const g=n[d];if(g.id===null)break;g.id=null,g.object=null,g.geometry=null,g.material=null,g.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:c,finish:h,sort:f}}function dH(){let n=new WeakMap;function e(i,r){let s;return n.has(i)===!1?(s=new Fb,n.set(i,[s])):r>=n.get(i).length?(s=new Fb,n.get(i).push(s)):s=n.get(i)[r],s}function t(){n=new WeakMap}return{get:e,dispose:t}}function hH(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new z,color:new Fe};break;case"SpotLight":t={position:new z,direction:new z,color:new Fe,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new z,color:new Fe,distance:0,decay:0};break;case"HemisphereLight":t={direction:new z,skyColor:new Fe,groundColor:new Fe};break;case"RectAreaLight":t={color:new Fe,position:new z,halfWidth:new z,halfHeight:new z};break}return n[e.id]=t,t}}}function pH(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ce};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ce};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ce,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let mH=0;function gH(n,e){return(e.castShadow?1:0)-(n.castShadow?1:0)}function vH(n,e){const t=new hH,i=pH(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let h=0;h<9;h++)r.probe.push(new z);const s=new z,o=new pt,a=new pt;function c(h,d){let p=0,g=0,_=0;for(let F=0;F<9;F++)r.probe[F].set(0,0,0);let y=0,x=0,v=0,w=0,S=0,E=0,b=0,T=0;h.sort(gH);const C=d!==!0?Math.PI:1;for(let F=0,U=h.length;F<U;F++){const W=h[F],ne=W.color,re=W.intensity,V=W.distance,ie=W.shadow&&W.shadow.map?W.shadow.map.texture:null;if(W.isAmbientLight)p+=ne.r*re*C,g+=ne.g*re*C,_+=ne.b*re*C;else if(W.isLightProbe)for(let K=0;K<9;K++)r.probe[K].addScaledVector(W.sh.coefficients[K],re);else if(W.isDirectionalLight){const K=t.get(W);if(K.color.copy(W.color).multiplyScalar(W.intensity*C),W.castShadow){const ae=W.shadow,$=i.get(W);$.shadowBias=ae.bias,$.shadowNormalBias=ae.normalBias,$.shadowRadius=ae.radius,$.shadowMapSize=ae.mapSize,r.directionalShadow[y]=$,r.directionalShadowMap[y]=ie,r.directionalShadowMatrix[y]=W.shadow.matrix,E++}r.directional[y]=K,y++}else if(W.isSpotLight){const K=t.get(W);if(K.position.setFromMatrixPosition(W.matrixWorld),K.color.copy(ne).multiplyScalar(re*C),K.distance=V,K.coneCos=Math.cos(W.angle),K.penumbraCos=Math.cos(W.angle*(1-W.penumbra)),K.decay=W.decay,W.castShadow){const ae=W.shadow,$=i.get(W);$.shadowBias=ae.bias,$.shadowNormalBias=ae.normalBias,$.shadowRadius=ae.radius,$.shadowMapSize=ae.mapSize,r.spotShadow[v]=$,r.spotShadowMap[v]=ie,r.spotShadowMatrix[v]=W.shadow.matrix,T++}r.spot[v]=K,v++}else if(W.isRectAreaLight){const K=t.get(W);K.color.copy(ne).multiplyScalar(re),K.halfWidth.set(W.width*.5,0,0),K.halfHeight.set(0,W.height*.5,0),r.rectArea[w]=K,w++}else if(W.isPointLight){const K=t.get(W);if(K.color.copy(W.color).multiplyScalar(W.intensity*C),K.distance=W.distance,K.decay=W.decay,W.castShadow){const ae=W.shadow,$=i.get(W);$.shadowBias=ae.bias,$.shadowNormalBias=ae.normalBias,$.shadowRadius=ae.radius,$.shadowMapSize=ae.mapSize,$.shadowCameraNear=ae.camera.near,$.shadowCameraFar=ae.camera.far,r.pointShadow[x]=$,r.pointShadowMap[x]=ie,r.pointShadowMatrix[x]=W.shadow.matrix,b++}r.point[x]=K,x++}else if(W.isHemisphereLight){const K=t.get(W);K.skyColor.copy(W.color).multiplyScalar(re*C),K.groundColor.copy(W.groundColor).multiplyScalar(re*C),r.hemi[S]=K,S++}}w>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Ie.LTC_FLOAT_1,r.rectAreaLTC2=Ie.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=Ie.LTC_HALF_1,r.rectAreaLTC2=Ie.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=g,r.ambient[2]=_;const A=r.hash;(A.directionalLength!==y||A.pointLength!==x||A.spotLength!==v||A.rectAreaLength!==w||A.hemiLength!==S||A.numDirectionalShadows!==E||A.numPointShadows!==b||A.numSpotShadows!==T)&&(r.directional.length=y,r.spot.length=v,r.rectArea.length=w,r.point.length=x,r.hemi.length=S,r.directionalShadow.length=E,r.directionalShadowMap.length=E,r.pointShadow.length=b,r.pointShadowMap.length=b,r.spotShadow.length=T,r.spotShadowMap.length=T,r.directionalShadowMatrix.length=E,r.pointShadowMatrix.length=b,r.spotShadowMatrix.length=T,A.directionalLength=y,A.pointLength=x,A.spotLength=v,A.rectAreaLength=w,A.hemiLength=S,A.numDirectionalShadows=E,A.numPointShadows=b,A.numSpotShadows=T,r.version=mH++)}function f(h,d){let p=0,g=0,_=0,y=0,x=0;const v=d.matrixWorldInverse;for(let w=0,S=h.length;w<S;w++){const E=h[w];if(E.isDirectionalLight){const b=r.directional[p];b.direction.setFromMatrixPosition(E.matrixWorld),s.setFromMatrixPosition(E.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(v),p++}else if(E.isSpotLight){const b=r.spot[_];b.position.setFromMatrixPosition(E.matrixWorld),b.position.applyMatrix4(v),b.direction.setFromMatrixPosition(E.matrixWorld),s.setFromMatrixPosition(E.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(v),_++}else if(E.isRectAreaLight){const b=r.rectArea[y];b.position.setFromMatrixPosition(E.matrixWorld),b.position.applyMatrix4(v),a.identity(),o.copy(E.matrixWorld),o.premultiply(v),a.extractRotation(o),b.halfWidth.set(E.width*.5,0,0),b.halfHeight.set(0,E.height*.5,0),b.halfWidth.applyMatrix4(a),b.halfHeight.applyMatrix4(a),y++}else if(E.isPointLight){const b=r.point[g];b.position.setFromMatrixPosition(E.matrixWorld),b.position.applyMatrix4(v),g++}else if(E.isHemisphereLight){const b=r.hemi[x];b.direction.setFromMatrixPosition(E.matrixWorld),b.direction.transformDirection(v),x++}}}return{setup:c,setupView:f,state:r}}function Db(n,e){const t=new vH(n,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(d){i.push(d)}function a(d){r.push(d)}function c(d){t.setup(i,d)}function f(d){t.setupView(i,d)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:c,setupLightsView:f,pushLight:o,pushShadow:a}}function yH(n,e){let t=new WeakMap;function i(s,o=0){let a;return t.has(s)===!1?(a=new Db(n,e),t.set(s,[a])):o>=t.get(s).length?(a=new Db(n,e),t.get(s).push(a)):a=t.get(s)[o],a}function r(){t=new WeakMap}return{get:i,dispose:r}}class xm extends xn{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=w4,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class k2 extends xn{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new z,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const xH=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,_H=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function wH(n,e,t){let i=new vm;const r=new Ce,s=new Ce,o=new Ut,a=new xm({depthPacking:n_}),c=new k2,f={},h=t.maxTextureSize,d={0:$r,1:vc,2:xs},p=new pn({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ce},radius:{value:4}},vertexShader:xH,fragmentShader:_H}),g=p.clone();g.defines.HORIZONTAL_PASS=1;const _=new Rn;_.setAttribute("position",new vi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const y=new cn(_,p),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=f2,this.render=function(E,b,T){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||E.length===0)return;const C=n.getRenderTarget(),A=n.getActiveCubeFace(),F=n.getActiveMipmapLevel(),U=n.state;U.setBlending(jr),U.buffers.color.setClear(1,1,1,1),U.buffers.depth.setTest(!0),U.setScissorTest(!1);for(let W=0,ne=E.length;W<ne;W++){const re=E[W],V=re.shadow;if(V===void 0){console.warn("THREE.WebGLShadowMap:",re,"has no shadow.");continue}if(V.autoUpdate===!1&&V.needsUpdate===!1)continue;r.copy(V.mapSize);const ie=V.getFrameExtents();if(r.multiply(ie),s.copy(V.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/ie.x),r.x=s.x*ie.x,V.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/ie.y),r.y=s.y*ie.y,V.mapSize.y=s.y)),V.map===null&&!V.isPointLightShadow&&this.type===$u&&(V.map=new gn(r.x,r.y),V.map.texture.name=re.name+".shadowMap",V.mapPass=new gn(r.x,r.y),V.camera.updateProjectionMatrix()),V.map===null){const ae={minFilter:En,magFilter:En,format:_r};V.map=new gn(r.x,r.y,ae),V.map.texture.name=re.name+".shadowMap",V.camera.updateProjectionMatrix()}n.setRenderTarget(V.map),n.clear();const K=V.getViewportCount();for(let ae=0;ae<K;ae++){const $=V.getViewport(ae);o.set(s.x*$.x,s.y*$.y,s.x*$.z,s.y*$.w),U.viewport(o),V.updateMatrices(re,ae),i=V.getFrustum(),S(b,T,V.camera,re,this.type)}!V.isPointLightShadow&&this.type===$u&&v(V,T),V.needsUpdate=!1}x.needsUpdate=!1,n.setRenderTarget(C,A,F)};function v(E,b){const T=e.update(y);p.defines.VSM_SAMPLES!==E.blurSamples&&(p.defines.VSM_SAMPLES=E.blurSamples,g.defines.VSM_SAMPLES=E.blurSamples,p.needsUpdate=!0,g.needsUpdate=!0),p.uniforms.shadow_pass.value=E.map.texture,p.uniforms.resolution.value=E.mapSize,p.uniforms.radius.value=E.radius,n.setRenderTarget(E.mapPass),n.clear(),n.renderBufferDirect(b,null,T,p,y,null),g.uniforms.shadow_pass.value=E.mapPass.texture,g.uniforms.resolution.value=E.mapSize,g.uniforms.radius.value=E.radius,n.setRenderTarget(E.map),n.clear(),n.renderBufferDirect(b,null,T,g,y,null)}function w(E,b,T,C,A,F){let U=null;const W=T.isPointLight===!0?E.customDistanceMaterial:E.customDepthMaterial;if(W!==void 0?U=W:U=T.isPointLight===!0?c:a,n.localClippingEnabled&&b.clipShadows===!0&&b.clippingPlanes.length!==0||b.displacementMap&&b.displacementScale!==0||b.alphaMap&&b.alphaTest>0){const ne=U.uuid,re=b.uuid;let V=f[ne];V===void 0&&(V={},f[ne]=V);let ie=V[re];ie===void 0&&(ie=U.clone(),V[re]=ie),U=ie}return U.visible=b.visible,U.wireframe=b.wireframe,F===$u?U.side=b.shadowSide!==null?b.shadowSide:b.side:U.side=b.shadowSide!==null?b.shadowSide:d[b.side],U.alphaMap=b.alphaMap,U.alphaTest=b.alphaTest,U.clipShadows=b.clipShadows,U.clippingPlanes=b.clippingPlanes,U.clipIntersection=b.clipIntersection,U.displacementMap=b.displacementMap,U.displacementScale=b.displacementScale,U.displacementBias=b.displacementBias,U.wireframeLinewidth=b.wireframeLinewidth,U.linewidth=b.linewidth,T.isPointLight===!0&&U.isMeshDistanceMaterial===!0&&(U.referencePosition.setFromMatrixPosition(T.matrixWorld),U.nearDistance=C,U.farDistance=A),U}function S(E,b,T,C,A){if(E.visible===!1)return;if(E.layers.test(b.layers)&&(E.isMesh||E.isLine||E.isPoints)&&(E.castShadow||E.receiveShadow&&A===$u)&&(!E.frustumCulled||i.intersectsObject(E))){E.modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,E.matrixWorld);const W=e.update(E),ne=E.material;if(Array.isArray(ne)){const re=W.groups;for(let V=0,ie=re.length;V<ie;V++){const K=re[V],ae=ne[K.materialIndex];if(ae&&ae.visible){const $=w(E,ae,C,T.near,T.far,A);n.renderBufferDirect(T,null,W,$,E,K)}}}else if(ne.visible){const re=w(E,ne,C,T.near,T.far,A);n.renderBufferDirect(T,null,W,re,E,null)}}const U=E.children;for(let W=0,ne=U.length;W<ne;W++)S(U[W],b,T,C,A)}}function SH(n,e,t){const i=t.isWebGL2;function r(){let H=!1;const be=new Ut;let Se=null;const We=new Ut(0,0,0,0);return{setMask:function(Pe){Se!==Pe&&!H&&(n.colorMask(Pe,Pe,Pe,Pe),Se=Pe)},setLocked:function(Pe){H=Pe},setClear:function(Pe,He,Te,Qe,St){St===!0&&(Pe*=Qe,He*=Qe,Te*=Qe),be.set(Pe,He,Te,Qe),We.equals(be)===!1&&(n.clearColor(Pe,He,Te,Qe),We.copy(be))},reset:function(){H=!1,Se=null,We.set(-1,0,0,0)}}}function s(){let H=!1,be=null,Se=null,We=null;return{setTest:function(Pe){Pe?Be(2929):ce(2929)},setMask:function(Pe){be!==Pe&&!H&&(n.depthMask(Pe),be=Pe)},setFunc:function(Pe){if(Se!==Pe){if(Pe)switch(Pe){case VB:n.depthFunc(512);break;case $B:n.depthFunc(519);break;case jB:n.depthFunc(513);break;case wy:n.depthFunc(515);break;case XB:n.depthFunc(514);break;case qB:n.depthFunc(518);break;case YB:n.depthFunc(516);break;case e_:n.depthFunc(517);break;default:n.depthFunc(515)}else n.depthFunc(515);Se=Pe}},setLocked:function(Pe){H=Pe},setClear:function(Pe){We!==Pe&&(n.clearDepth(Pe),We=Pe)},reset:function(){H=!1,be=null,Se=null,We=null}}}function o(){let H=!1,be=null,Se=null,We=null,Pe=null,He=null,Te=null,Qe=null,St=null;return{setTest:function(Mt){H||(Mt?Be(2960):ce(2960))},setMask:function(Mt){be!==Mt&&!H&&(n.stencilMask(Mt),be=Mt)},setFunc:function(Mt,zn,nr){(Se!==Mt||We!==zn||Pe!==nr)&&(n.stencilFunc(Mt,zn,nr),Se=Mt,We=zn,Pe=nr)},setOp:function(Mt,zn,nr){(He!==Mt||Te!==zn||Qe!==nr)&&(n.stencilOp(Mt,zn,nr),He=Mt,Te=zn,Qe=nr)},setLocked:function(Mt){H=Mt},setClear:function(Mt){St!==Mt&&(n.clearStencil(Mt),St=Mt)},reset:function(){H=!1,be=null,Se=null,We=null,Pe=null,He=null,Te=null,Qe=null,St=null}}}const a=new r,c=new s,f=new o;let h={},d={},p=new WeakMap,g=[],_=null,y=!1,x=null,v=null,w=null,S=null,E=null,b=null,T=null,C=!1,A=null,F=null,U=null,W=null,ne=null;const re=n.getParameter(35661);let V=!1,ie=0;const K=n.getParameter(7938);K.indexOf("WebGL")!==-1?(ie=parseFloat(/^WebGL (\d)/.exec(K)[1]),V=ie>=1):K.indexOf("OpenGL ES")!==-1&&(ie=parseFloat(/^OpenGL ES (\d)/.exec(K)[1]),V=ie>=2);let ae=null,$={};const Y=n.getParameter(3088),Z=n.getParameter(2978),he=new Ut().fromArray(Y),me=new Ut().fromArray(Z);function we(H,be,Se){const We=new Uint8Array(4),Pe=n.createTexture();n.bindTexture(H,Pe),n.texParameteri(H,10241,9728),n.texParameteri(H,10240,9728);for(let He=0;He<Se;He++)n.texImage2D(be+He,0,6408,1,1,0,6408,5121,We);return Pe}const De={};De[3553]=we(3553,3553,1),De[34067]=we(34067,34069,6),a.setClear(0,0,0,1),c.setClear(1),f.setClear(0),Be(2929),c.setFunc(wy),Tt(!1),jt(AM),Be(2884),nt(jr);function Be(H){h[H]!==!0&&(n.enable(H),h[H]=!0)}function ce(H){h[H]!==!1&&(n.disable(H),h[H]=!1)}function yt(H,be){return d[H]!==be?(n.bindFramebuffer(H,be),d[H]=be,i&&(H===36009&&(d[36160]=be),H===36160&&(d[36009]=be)),!0):!1}function qe(H,be){let Se=g,We=!1;if(H)if(Se=p.get(be),Se===void 0&&(Se=[],p.set(be,Se)),H.isWebGLMultipleRenderTargets){const Pe=H.texture;if(Se.length!==Pe.length||Se[0]!==36064){for(let He=0,Te=Pe.length;He<Te;He++)Se[He]=36064+He;Se.length=Pe.length,We=!0}}else Se[0]!==36064&&(Se[0]=36064,We=!0);else Se[0]!==1029&&(Se[0]=1029,We=!0);We&&(t.isWebGL2?n.drawBuffers(Se):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Se))}function Xe(H){return _!==H?(n.useProgram(H),_=H,!0):!1}const Ne={[kl]:32774,[FB]:32778,[DB]:32779};if(i)Ne[PM]=32775,Ne[LM]=32776;else{const H=e.get("EXT_blend_minmax");H!==null&&(Ne[PM]=H.MIN_EXT,Ne[LM]=H.MAX_EXT)}const dt={[NB]:0,[OB]:1,[kB]:768,[h2]:770,[WB]:776,[HB]:774,[zB]:772,[BB]:769,[p2]:771,[GB]:775,[UB]:773};function nt(H,be,Se,We,Pe,He,Te,Qe){if(H===jr){y===!0&&(ce(3042),y=!1);return}if(y===!1&&(Be(3042),y=!0),H!==IB){if(H!==x||Qe!==C){if((v!==kl||E!==kl)&&(n.blendEquation(32774),v=kl,E=kl),Qe)switch(H){case sc:n.blendFuncSeparate(1,771,1,771);break;case kp:n.blendFunc(1,1);break;case CM:n.blendFuncSeparate(0,769,0,1);break;case RM:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",H);break}else switch(H){case sc:n.blendFuncSeparate(770,771,1,771);break;case kp:n.blendFunc(770,1);break;case CM:n.blendFuncSeparate(0,769,0,1);break;case RM:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",H);break}w=null,S=null,b=null,T=null,x=H,C=Qe}return}Pe=Pe||be,He=He||Se,Te=Te||We,(be!==v||Pe!==E)&&(n.blendEquationSeparate(Ne[be],Ne[Pe]),v=be,E=Pe),(Se!==w||We!==S||He!==b||Te!==T)&&(n.blendFuncSeparate(dt[Se],dt[We],dt[He],dt[Te]),w=Se,S=We,b=He,T=Te),x=H,C=null}function Ye(H,be){H.side===xs?ce(2884):Be(2884);let Se=H.side===$r;be&&(Se=!Se),Tt(Se),H.blending===sc&&H.transparent===!1?nt(jr):nt(H.blending,H.blendEquation,H.blendSrc,H.blendDst,H.blendEquationAlpha,H.blendSrcAlpha,H.blendDstAlpha,H.premultipliedAlpha),c.setFunc(H.depthFunc),c.setTest(H.depthTest),c.setMask(H.depthWrite),a.setMask(H.colorWrite);const We=H.stencilWrite;f.setTest(We),We&&(f.setMask(H.stencilWriteMask),f.setFunc(H.stencilFunc,H.stencilRef,H.stencilFuncMask),f.setOp(H.stencilFail,H.stencilZFail,H.stencilZPass)),Qt(H.polygonOffset,H.polygonOffsetFactor,H.polygonOffsetUnits),H.alphaToCoverage===!0?Be(32926):ce(32926)}function Tt(H){A!==H&&(H?n.frontFace(2304):n.frontFace(2305),A=H)}function jt(H){H!==RB?(Be(2884),H!==F&&(H===AM?n.cullFace(1029):H===PB?n.cullFace(1028):n.cullFace(1032))):ce(2884),F=H}function wn(H){H!==U&&(V&&n.lineWidth(H),U=H)}function Qt(H,be,Se){H?(Be(32823),(W!==be||ne!==Se)&&(n.polygonOffset(be,Se),W=be,ne=Se)):ce(32823)}function rn(H){H?Be(3089):ce(3089)}function Et(H){H===void 0&&(H=33984+re-1),ae!==H&&(n.activeTexture(H),ae=H)}function Pn(H,be){ae===null&&Et();let Se=$[ae];Se===void 0&&(Se={type:void 0,texture:void 0},$[ae]=Se),(Se.type!==H||Se.texture!==be)&&(n.bindTexture(H,be||De[H]),Se.type=H,Se.texture=be)}function Xt(){const H=$[ae];H!==void 0&&H.type!==void 0&&(n.bindTexture(H.type,null),H.type=void 0,H.texture=void 0)}function k(){try{n.compressedTexImage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function I(){try{n.texSubImage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function fe(){try{n.texSubImage3D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function xe(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function Ee(){try{n.texStorage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function Re(){try{n.texStorage3D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function Ge(){try{n.texImage2D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function D(){try{n.texImage3D.apply(n,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function ve(H){he.equals(H)===!1&&(n.scissor(H.x,H.y,H.z,H.w),he.copy(H))}function Ae(H){me.equals(H)===!1&&(n.viewport(H.x,H.y,H.z,H.w),me.copy(H))}function Me(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),i===!0&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},ae=null,$={},d={},p=new WeakMap,g=[],_=null,y=!1,x=null,v=null,w=null,S=null,E=null,b=null,T=null,C=!1,A=null,F=null,U=null,W=null,ne=null,he.set(0,0,n.canvas.width,n.canvas.height),me.set(0,0,n.canvas.width,n.canvas.height),a.reset(),c.reset(),f.reset()}return{buffers:{color:a,depth:c,stencil:f},enable:Be,disable:ce,bindFramebuffer:yt,drawBuffers:qe,useProgram:Xe,setBlending:nt,setMaterial:Ye,setFlipSided:Tt,setCullFace:jt,setLineWidth:wn,setPolygonOffset:Qt,setScissorTest:rn,activeTexture:Et,bindTexture:Pn,unbindTexture:Xt,compressedTexImage2D:k,texImage2D:Ge,texImage3D:D,texStorage2D:Ee,texStorage3D:Re,texSubImage2D:I,texSubImage3D:fe,compressedTexSubImage2D:xe,scissor:ve,viewport:Ae,reset:Me}}function MH(n,e,t,i,r,s,o){const a=r.isWebGL2,c=r.maxTextures,f=r.maxCubemapSize,h=r.maxTextureSize,d=r.maxSamples,p=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,g=/OculusBrowser/g.test(navigator.userAgent),_=new WeakMap;let y;const x=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function w(k,I){return v?new OffscreenCanvas(k,I):Rf("canvas")}function S(k,I,fe,xe){let Ee=1;if((k.width>xe||k.height>xe)&&(Ee=xe/Math.max(k.width,k.height)),Ee<1||I===!0)if(typeof HTMLImageElement!="undefined"&&k instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&k instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&k instanceof ImageBitmap){const Re=I?Hp:Math.floor,Ge=Re(Ee*k.width),D=Re(Ee*k.height);y===void 0&&(y=w(Ge,D));const ve=fe?w(Ge,D):y;return ve.width=Ge,ve.height=D,ve.getContext("2d").drawImage(k,0,0,Ge,D),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+k.width+"x"+k.height+") to ("+Ge+"x"+D+")."),ve}else return"data"in k&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+k.width+"x"+k.height+")."),k;return k}function E(k){return Ay(k.width)&&Ay(k.height)}function b(k){return a?!1:k.wrapS!==yr||k.wrapT!==yr||k.minFilter!==En&&k.minFilter!==Ri}function T(k,I){return k.generateMipmaps&&I&&k.minFilter!==En&&k.minFilter!==Ri}function C(k){n.generateMipmap(k)}function A(k,I,fe,xe,Ee=!1){if(a===!1)return I;if(k!==null){if(n[k]!==void 0)return n[k];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+k+"'")}let Re=I;return I===6403&&(fe===5126&&(Re=33326),fe===5131&&(Re=33325),fe===5121&&(Re=33321)),I===33319&&(fe===5126&&(Re=33328),fe===5131&&(Re=33327),fe===5121&&(Re=33323)),I===6408&&(fe===5126&&(Re=34836),fe===5131&&(Re=34842),fe===5121&&(Re=xe===Lt&&Ee===!1?35907:32856),fe===32819&&(Re=32854),fe===32820&&(Re=32855)),(Re===33325||Re===33326||Re===33327||Re===33328||Re===34842||Re===34836)&&e.get("EXT_color_buffer_float"),Re}function F(k,I,fe){return T(k,fe)===!0||k.isFramebufferTexture&&k.minFilter!==En&&k.minFilter!==Ri?Math.log2(Math.max(I.width,I.height))+1:k.mipmaps!==void 0&&k.mipmaps.length>0?k.mipmaps.length:k.isCompressedTexture&&Array.isArray(k.image)?I.mipmaps.length:1}function U(k){return k===En||k===My||k===by?9728:9729}function W(k){const I=k.target;I.removeEventListener("dispose",W),re(I),I.isVideoTexture&&_.delete(I)}function ne(k){const I=k.target;I.removeEventListener("dispose",ne),ie(I)}function re(k){const I=i.get(k);if(I.__webglInit===void 0)return;const fe=k.source,xe=x.get(fe);if(xe){const Ee=xe[I.__cacheKey];Ee.usedTimes--,Ee.usedTimes===0&&V(k),Object.keys(xe).length===0&&x.delete(fe)}i.remove(k)}function V(k){const I=i.get(k);n.deleteTexture(I.__webglTexture);const fe=k.source,xe=x.get(fe);delete xe[I.__cacheKey],o.memory.textures--}function ie(k){const I=k.texture,fe=i.get(k),xe=i.get(I);if(xe.__webglTexture!==void 0&&(n.deleteTexture(xe.__webglTexture),o.memory.textures--),k.depthTexture&&k.depthTexture.dispose(),k.isWebGLCubeRenderTarget)for(let Ee=0;Ee<6;Ee++)n.deleteFramebuffer(fe.__webglFramebuffer[Ee]),fe.__webglDepthbuffer&&n.deleteRenderbuffer(fe.__webglDepthbuffer[Ee]);else{if(n.deleteFramebuffer(fe.__webglFramebuffer),fe.__webglDepthbuffer&&n.deleteRenderbuffer(fe.__webglDepthbuffer),fe.__webglMultisampledFramebuffer&&n.deleteFramebuffer(fe.__webglMultisampledFramebuffer),fe.__webglColorRenderbuffer)for(let Ee=0;Ee<fe.__webglColorRenderbuffer.length;Ee++)fe.__webglColorRenderbuffer[Ee]&&n.deleteRenderbuffer(fe.__webglColorRenderbuffer[Ee]);fe.__webglDepthRenderbuffer&&n.deleteRenderbuffer(fe.__webglDepthRenderbuffer)}if(k.isWebGLMultipleRenderTargets)for(let Ee=0,Re=I.length;Ee<Re;Ee++){const Ge=i.get(I[Ee]);Ge.__webglTexture&&(n.deleteTexture(Ge.__webglTexture),o.memory.textures--),i.remove(I[Ee])}i.remove(I),i.remove(k)}let K=0;function ae(){K=0}function $(){const k=K;return k>=c&&console.warn("THREE.WebGLTextures: Trying to use "+k+" texture units while this GPU supports only "+c),K+=1,k}function Y(k){const I=[];return I.push(k.wrapS),I.push(k.wrapT),I.push(k.magFilter),I.push(k.minFilter),I.push(k.anisotropy),I.push(k.internalFormat),I.push(k.format),I.push(k.type),I.push(k.generateMipmaps),I.push(k.premultiplyAlpha),I.push(k.flipY),I.push(k.unpackAlignment),I.push(k.encoding),I.join()}function Z(k,I){const fe=i.get(k);if(k.isVideoTexture&&Pn(k),k.isRenderTargetTexture===!1&&k.version>0&&fe.__version!==k.version){const xe=k.image;if(xe===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(xe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{qe(fe,k,I);return}}t.activeTexture(33984+I),t.bindTexture(3553,fe.__webglTexture)}function he(k,I){const fe=i.get(k);if(k.version>0&&fe.__version!==k.version){qe(fe,k,I);return}t.activeTexture(33984+I),t.bindTexture(35866,fe.__webglTexture)}function me(k,I){const fe=i.get(k);if(k.version>0&&fe.__version!==k.version){qe(fe,k,I);return}t.activeTexture(33984+I),t.bindTexture(32879,fe.__webglTexture)}function we(k,I){const fe=i.get(k);if(k.version>0&&fe.__version!==k.version){Xe(fe,k,I);return}t.activeTexture(33984+I),t.bindTexture(34067,fe.__webglTexture)}const De={[hs]:10497,[yr]:33071,[zp]:33648},Be={[En]:9728,[My]:9984,[by]:9986,[Ri]:9729,[v2]:9985,[Dc]:9987};function ce(k,I,fe){if(fe?(n.texParameteri(k,10242,De[I.wrapS]),n.texParameteri(k,10243,De[I.wrapT]),(k===32879||k===35866)&&n.texParameteri(k,32882,De[I.wrapR]),n.texParameteri(k,10240,Be[I.magFilter]),n.texParameteri(k,10241,Be[I.minFilter])):(n.texParameteri(k,10242,33071),n.texParameteri(k,10243,33071),(k===32879||k===35866)&&n.texParameteri(k,32882,33071),(I.wrapS!==yr||I.wrapT!==yr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(k,10240,U(I.magFilter)),n.texParameteri(k,10241,U(I.minFilter)),I.minFilter!==En&&I.minFilter!==Ri&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const xe=e.get("EXT_texture_filter_anisotropic");if(I.type===Do&&e.has("OES_texture_float_linear")===!1||a===!1&&I.type===Ef&&e.has("OES_texture_half_float_linear")===!1)return;(I.anisotropy>1||i.get(I).__currentAnisotropy)&&(n.texParameterf(k,xe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(I.anisotropy,r.getMaxAnisotropy())),i.get(I).__currentAnisotropy=I.anisotropy)}}function yt(k,I){let fe=!1;k.__webglInit===void 0&&(k.__webglInit=!0,I.addEventListener("dispose",W));const xe=I.source;let Ee=x.get(xe);Ee===void 0&&(Ee={},x.set(xe,Ee));const Re=Y(I);if(Re!==k.__cacheKey){Ee[Re]===void 0&&(Ee[Re]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,fe=!0),Ee[Re].usedTimes++;const Ge=Ee[k.__cacheKey];Ge!==void 0&&(Ee[k.__cacheKey].usedTimes--,Ge.usedTimes===0&&V(I)),k.__cacheKey=Re,k.__webglTexture=Ee[Re].texture}return fe}function qe(k,I,fe){let xe=3553;I.isDataArrayTexture&&(xe=35866),I.isData3DTexture&&(xe=32879);const Ee=yt(k,I),Re=I.source;if(t.activeTexture(33984+fe),t.bindTexture(xe,k.__webglTexture),Re.version!==Re.__currentVersion||Ee===!0){n.pixelStorei(37440,I.flipY),n.pixelStorei(37441,I.premultiplyAlpha),n.pixelStorei(3317,I.unpackAlignment),n.pixelStorei(37443,0);const Ge=b(I)&&E(I.image)===!1;let D=S(I.image,Ge,!1,h);D=Xt(I,D);const ve=E(D)||a,Ae=s.convert(I.format,I.encoding);let Me=s.convert(I.type),H=A(I.internalFormat,Ae,Me,I.encoding,I.isVideoTexture);ce(xe,I,ve);let be;const Se=I.mipmaps,We=a&&I.isVideoTexture!==!0,Pe=Re.__currentVersion===void 0||Ee===!0,He=F(I,D,ve);if(I.isDepthTexture)H=6402,a?I.type===Do?H=36012:I.type===Ca?H=33190:I.type===oc?H=35056:H=33189:I.type===Do&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),I.format===Fa&&H===6402&&I.type!==y2&&I.type!==Ca&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),I.type=Ca,Me=s.convert(I.type)),I.format===_c&&H===6402&&(H=34041,I.type!==oc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),I.type=oc,Me=s.convert(I.type))),Pe&&(We?t.texStorage2D(3553,1,H,D.width,D.height):t.texImage2D(3553,0,H,D.width,D.height,0,Ae,Me,null));else if(I.isDataTexture)if(Se.length>0&&ve){We&&Pe&&t.texStorage2D(3553,He,H,Se[0].width,Se[0].height);for(let Te=0,Qe=Se.length;Te<Qe;Te++)be=Se[Te],We?t.texSubImage2D(3553,Te,0,0,be.width,be.height,Ae,Me,be.data):t.texImage2D(3553,Te,H,be.width,be.height,0,Ae,Me,be.data);I.generateMipmaps=!1}else We?(Pe&&t.texStorage2D(3553,He,H,D.width,D.height),t.texSubImage2D(3553,0,0,0,D.width,D.height,Ae,Me,D.data)):t.texImage2D(3553,0,H,D.width,D.height,0,Ae,Me,D.data);else if(I.isCompressedTexture){We&&Pe&&t.texStorage2D(3553,He,H,Se[0].width,Se[0].height);for(let Te=0,Qe=Se.length;Te<Qe;Te++)be=Se[Te],I.format!==_r?Ae!==null?We?t.compressedTexSubImage2D(3553,Te,0,0,be.width,be.height,Ae,be.data):t.compressedTexImage2D(3553,Te,H,be.width,be.height,0,be.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):We?t.texSubImage2D(3553,Te,0,0,be.width,be.height,Ae,Me,be.data):t.texImage2D(3553,Te,H,be.width,be.height,0,Ae,Me,be.data)}else if(I.isDataArrayTexture)We?(Pe&&t.texStorage3D(35866,He,H,D.width,D.height,D.depth),t.texSubImage3D(35866,0,0,0,0,D.width,D.height,D.depth,Ae,Me,D.data)):t.texImage3D(35866,0,H,D.width,D.height,D.depth,0,Ae,Me,D.data);else if(I.isData3DTexture)We?(Pe&&t.texStorage3D(32879,He,H,D.width,D.height,D.depth),t.texSubImage3D(32879,0,0,0,0,D.width,D.height,D.depth,Ae,Me,D.data)):t.texImage3D(32879,0,H,D.width,D.height,D.depth,0,Ae,Me,D.data);else if(I.isFramebufferTexture){if(Pe)if(We)t.texStorage2D(3553,He,H,D.width,D.height);else{let Te=D.width,Qe=D.height;for(let St=0;St<He;St++)t.texImage2D(3553,St,H,Te,Qe,0,Ae,Me,null),Te>>=1,Qe>>=1}}else if(Se.length>0&&ve){We&&Pe&&t.texStorage2D(3553,He,H,Se[0].width,Se[0].height);for(let Te=0,Qe=Se.length;Te<Qe;Te++)be=Se[Te],We?t.texSubImage2D(3553,Te,0,0,Ae,Me,be):t.texImage2D(3553,Te,H,Ae,Me,be);I.generateMipmaps=!1}else We?(Pe&&t.texStorage2D(3553,He,H,D.width,D.height),t.texSubImage2D(3553,0,0,0,Ae,Me,D)):t.texImage2D(3553,0,H,Ae,Me,D);T(I,ve)&&C(xe),Re.__currentVersion=Re.version,I.onUpdate&&I.onUpdate(I)}k.__version=I.version}function Xe(k,I,fe){if(I.image.length!==6)return;const xe=yt(k,I),Ee=I.source;if(t.activeTexture(33984+fe),t.bindTexture(34067,k.__webglTexture),Ee.version!==Ee.__currentVersion||xe===!0){n.pixelStorei(37440,I.flipY),n.pixelStorei(37441,I.premultiplyAlpha),n.pixelStorei(3317,I.unpackAlignment),n.pixelStorei(37443,0);const Re=I.isCompressedTexture||I.image[0].isCompressedTexture,Ge=I.image[0]&&I.image[0].isDataTexture,D=[];for(let Te=0;Te<6;Te++)!Re&&!Ge?D[Te]=S(I.image[Te],!1,!0,f):D[Te]=Ge?I.image[Te].image:I.image[Te],D[Te]=Xt(I,D[Te]);const ve=D[0],Ae=E(ve)||a,Me=s.convert(I.format,I.encoding),H=s.convert(I.type),be=A(I.internalFormat,Me,H,I.encoding),Se=a&&I.isVideoTexture!==!0,We=Ee.__currentVersion===void 0||xe===!0;let Pe=F(I,ve,Ae);ce(34067,I,Ae);let He;if(Re){Se&&We&&t.texStorage2D(34067,Pe,be,ve.width,ve.height);for(let Te=0;Te<6;Te++){He=D[Te].mipmaps;for(let Qe=0;Qe<He.length;Qe++){const St=He[Qe];I.format!==_r?Me!==null?Se?t.compressedTexSubImage2D(34069+Te,Qe,0,0,St.width,St.height,Me,St.data):t.compressedTexImage2D(34069+Te,Qe,be,St.width,St.height,0,St.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Se?t.texSubImage2D(34069+Te,Qe,0,0,St.width,St.height,Me,H,St.data):t.texImage2D(34069+Te,Qe,be,St.width,St.height,0,Me,H,St.data)}}}else{He=I.mipmaps,Se&&We&&(He.length>0&&Pe++,t.texStorage2D(34067,Pe,be,D[0].width,D[0].height));for(let Te=0;Te<6;Te++)if(Ge){Se?t.texSubImage2D(34069+Te,0,0,0,D[Te].width,D[Te].height,Me,H,D[Te].data):t.texImage2D(34069+Te,0,be,D[Te].width,D[Te].height,0,Me,H,D[Te].data);for(let Qe=0;Qe<He.length;Qe++){const Mt=He[Qe].image[Te].image;Se?t.texSubImage2D(34069+Te,Qe+1,0,0,Mt.width,Mt.height,Me,H,Mt.data):t.texImage2D(34069+Te,Qe+1,be,Mt.width,Mt.height,0,Me,H,Mt.data)}}else{Se?t.texSubImage2D(34069+Te,0,0,0,Me,H,D[Te]):t.texImage2D(34069+Te,0,be,Me,H,D[Te]);for(let Qe=0;Qe<He.length;Qe++){const St=He[Qe];Se?t.texSubImage2D(34069+Te,Qe+1,0,0,Me,H,St.image[Te]):t.texImage2D(34069+Te,Qe+1,be,Me,H,St.image[Te])}}}T(I,Ae)&&C(34067),Ee.__currentVersion=Ee.version,I.onUpdate&&I.onUpdate(I)}k.__version=I.version}function Ne(k,I,fe,xe,Ee){const Re=s.convert(fe.format,fe.encoding),Ge=s.convert(fe.type),D=A(fe.internalFormat,Re,Ge,fe.encoding);i.get(I).__hasExternalTextures||(Ee===32879||Ee===35866?t.texImage3D(Ee,0,D,I.width,I.height,I.depth,0,Re,Ge,null):t.texImage2D(Ee,0,D,I.width,I.height,0,Re,Ge,null)),t.bindFramebuffer(36160,k),Et(I)?p.framebufferTexture2DMultisampleEXT(36160,xe,Ee,i.get(fe).__webglTexture,0,rn(I)):n.framebufferTexture2D(36160,xe,Ee,i.get(fe).__webglTexture,0),t.bindFramebuffer(36160,null)}function dt(k,I,fe){if(n.bindRenderbuffer(36161,k),I.depthBuffer&&!I.stencilBuffer){let xe=33189;if(fe||Et(I)){const Ee=I.depthTexture;Ee&&Ee.isDepthTexture&&(Ee.type===Do?xe=36012:Ee.type===Ca&&(xe=33190));const Re=rn(I);Et(I)?p.renderbufferStorageMultisampleEXT(36161,Re,xe,I.width,I.height):n.renderbufferStorageMultisample(36161,Re,xe,I.width,I.height)}else n.renderbufferStorage(36161,xe,I.width,I.height);n.framebufferRenderbuffer(36160,36096,36161,k)}else if(I.depthBuffer&&I.stencilBuffer){const xe=rn(I);fe&&Et(I)===!1?n.renderbufferStorageMultisample(36161,xe,35056,I.width,I.height):Et(I)?p.renderbufferStorageMultisampleEXT(36161,xe,35056,I.width,I.height):n.renderbufferStorage(36161,34041,I.width,I.height),n.framebufferRenderbuffer(36160,33306,36161,k)}else{const xe=I.isWebGLMultipleRenderTargets===!0?I.texture:[I.texture];for(let Ee=0;Ee<xe.length;Ee++){const Re=xe[Ee],Ge=s.convert(Re.format,Re.encoding),D=s.convert(Re.type),ve=A(Re.internalFormat,Ge,D,Re.encoding),Ae=rn(I);fe&&Et(I)===!1?n.renderbufferStorageMultisample(36161,Ae,ve,I.width,I.height):Et(I)?p.renderbufferStorageMultisampleEXT(36161,Ae,ve,I.width,I.height):n.renderbufferStorage(36161,ve,I.width,I.height)}}n.bindRenderbuffer(36161,null)}function nt(k,I){if(I&&I.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,k),!(I.depthTexture&&I.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(I.depthTexture).__webglTexture||I.depthTexture.image.width!==I.width||I.depthTexture.image.height!==I.height)&&(I.depthTexture.image.width=I.width,I.depthTexture.image.height=I.height,I.depthTexture.needsUpdate=!0),Z(I.depthTexture,0);const xe=i.get(I.depthTexture).__webglTexture,Ee=rn(I);if(I.depthTexture.format===Fa)Et(I)?p.framebufferTexture2DMultisampleEXT(36160,36096,3553,xe,0,Ee):n.framebufferTexture2D(36160,36096,3553,xe,0);else if(I.depthTexture.format===_c)Et(I)?p.framebufferTexture2DMultisampleEXT(36160,33306,3553,xe,0,Ee):n.framebufferTexture2D(36160,33306,3553,xe,0);else throw new Error("Unknown depthTexture format")}function Ye(k){const I=i.get(k),fe=k.isWebGLCubeRenderTarget===!0;if(k.depthTexture&&!I.__autoAllocateDepthBuffer){if(fe)throw new Error("target.depthTexture not supported in Cube render targets");nt(I.__webglFramebuffer,k)}else if(fe){I.__webglDepthbuffer=[];for(let xe=0;xe<6;xe++)t.bindFramebuffer(36160,I.__webglFramebuffer[xe]),I.__webglDepthbuffer[xe]=n.createRenderbuffer(),dt(I.__webglDepthbuffer[xe],k,!1)}else t.bindFramebuffer(36160,I.__webglFramebuffer),I.__webglDepthbuffer=n.createRenderbuffer(),dt(I.__webglDepthbuffer,k,!1);t.bindFramebuffer(36160,null)}function Tt(k,I,fe){const xe=i.get(k);I!==void 0&&Ne(xe.__webglFramebuffer,k,k.texture,36064,3553),fe!==void 0&&Ye(k)}function jt(k){const I=k.texture,fe=i.get(k),xe=i.get(I);k.addEventListener("dispose",ne),k.isWebGLMultipleRenderTargets!==!0&&(xe.__webglTexture===void 0&&(xe.__webglTexture=n.createTexture()),xe.__version=I.version,o.memory.textures++);const Ee=k.isWebGLCubeRenderTarget===!0,Re=k.isWebGLMultipleRenderTargets===!0,Ge=E(k)||a;if(Ee){fe.__webglFramebuffer=[];for(let D=0;D<6;D++)fe.__webglFramebuffer[D]=n.createFramebuffer()}else{if(fe.__webglFramebuffer=n.createFramebuffer(),Re)if(r.drawBuffers){const D=k.texture;for(let ve=0,Ae=D.length;ve<Ae;ve++){const Me=i.get(D[ve]);Me.__webglTexture===void 0&&(Me.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&k.samples>0&&Et(k)===!1){const D=Re?I:[I];fe.__webglMultisampledFramebuffer=n.createFramebuffer(),fe.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,fe.__webglMultisampledFramebuffer);for(let ve=0;ve<D.length;ve++){const Ae=D[ve];fe.__webglColorRenderbuffer[ve]=n.createRenderbuffer(),n.bindRenderbuffer(36161,fe.__webglColorRenderbuffer[ve]);const Me=s.convert(Ae.format,Ae.encoding),H=s.convert(Ae.type),be=A(Ae.internalFormat,Me,H,Ae.encoding),Se=rn(k);n.renderbufferStorageMultisample(36161,Se,be,k.width,k.height),n.framebufferRenderbuffer(36160,36064+ve,36161,fe.__webglColorRenderbuffer[ve])}n.bindRenderbuffer(36161,null),k.depthBuffer&&(fe.__webglDepthRenderbuffer=n.createRenderbuffer(),dt(fe.__webglDepthRenderbuffer,k,!0)),t.bindFramebuffer(36160,null)}}if(Ee){t.bindTexture(34067,xe.__webglTexture),ce(34067,I,Ge);for(let D=0;D<6;D++)Ne(fe.__webglFramebuffer[D],k,I,36064,34069+D);T(I,Ge)&&C(34067),t.unbindTexture()}else if(Re){const D=k.texture;for(let ve=0,Ae=D.length;ve<Ae;ve++){const Me=D[ve],H=i.get(Me);t.bindTexture(3553,H.__webglTexture),ce(3553,Me,Ge),Ne(fe.__webglFramebuffer,k,Me,36064+ve,3553),T(Me,Ge)&&C(3553)}t.unbindTexture()}else{let D=3553;(k.isWebGL3DRenderTarget||k.isWebGLArrayRenderTarget)&&(a?D=k.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(D,xe.__webglTexture),ce(D,I,Ge),Ne(fe.__webglFramebuffer,k,I,36064,D),T(I,Ge)&&C(D),t.unbindTexture()}k.depthBuffer&&Ye(k)}function wn(k){const I=E(k)||a,fe=k.isWebGLMultipleRenderTargets===!0?k.texture:[k.texture];for(let xe=0,Ee=fe.length;xe<Ee;xe++){const Re=fe[xe];if(T(Re,I)){const Ge=k.isWebGLCubeRenderTarget?34067:3553,D=i.get(Re).__webglTexture;t.bindTexture(Ge,D),C(Ge),t.unbindTexture()}}}function Qt(k){if(a&&k.samples>0&&Et(k)===!1){const I=k.isWebGLMultipleRenderTargets?k.texture:[k.texture],fe=k.width,xe=k.height;let Ee=16384;const Re=[],Ge=k.stencilBuffer?33306:36096,D=i.get(k),ve=k.isWebGLMultipleRenderTargets===!0;if(ve)for(let Ae=0;Ae<I.length;Ae++)t.bindFramebuffer(36160,D.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Ae,36161,null),t.bindFramebuffer(36160,D.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Ae,3553,null,0);t.bindFramebuffer(36008,D.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,D.__webglFramebuffer);for(let Ae=0;Ae<I.length;Ae++){Re.push(36064+Ae),k.depthBuffer&&Re.push(Ge);const Me=D.__ignoreDepthValues!==void 0?D.__ignoreDepthValues:!1;if(Me===!1&&(k.depthBuffer&&(Ee|=256),k.stencilBuffer&&(Ee|=1024)),ve&&n.framebufferRenderbuffer(36008,36064,36161,D.__webglColorRenderbuffer[Ae]),Me===!0&&(n.invalidateFramebuffer(36008,[Ge]),n.invalidateFramebuffer(36009,[Ge])),ve){const H=i.get(I[Ae]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,H,0)}n.blitFramebuffer(0,0,fe,xe,0,0,fe,xe,Ee,9728),g&&n.invalidateFramebuffer(36008,Re)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),ve)for(let Ae=0;Ae<I.length;Ae++){t.bindFramebuffer(36160,D.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Ae,36161,D.__webglColorRenderbuffer[Ae]);const Me=i.get(I[Ae]).__webglTexture;t.bindFramebuffer(36160,D.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Ae,3553,Me,0)}t.bindFramebuffer(36009,D.__webglMultisampledFramebuffer)}}function rn(k){return Math.min(d,k.samples)}function Et(k){const I=i.get(k);return a&&k.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&I.__useRenderToTexture!==!1}function Pn(k){const I=o.render.frame;_.get(k)!==I&&(_.set(k,I),k.update())}function Xt(k,I){const fe=k.encoding,xe=k.format,Ee=k.type;return k.isCompressedTexture===!0||k.isVideoTexture===!0||k.format===Ey||fe!==Ga&&(fe===Lt?a===!1?e.has("EXT_sRGB")===!0&&xe===_r?(k.format=Ey,k.minFilter=Ri,k.generateMipmaps=!1):I=b2.sRGBToLinear(I):(xe!==_r||Ee!==Ha)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",fe)),I}this.allocateTextureUnit=$,this.resetTextureUnits=ae,this.setTexture2D=Z,this.setTexture2DArray=he,this.setTexture3D=me,this.setTextureCube=we,this.rebindTextures=Tt,this.setupRenderTarget=jt,this.updateRenderTargetMipmap=wn,this.updateMultisampleRenderTarget=Qt,this.setupDepthRenderbuffer=Ye,this.setupFrameBufferTexture=Ne,this.useMultisampledRTT=Et}function bH(n,e,t){const i=t.isWebGL2;function r(s,o=null){let a;if(s===Ha)return 5121;if(s===s4)return 32819;if(s===o4)return 32820;if(s===n4)return 5120;if(s===i4)return 5122;if(s===y2)return 5123;if(s===r4)return 5124;if(s===Ca)return 5125;if(s===Do)return 5126;if(s===Ef)return i?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===a4)return 6406;if(s===_r)return 6408;if(s===c4)return 6409;if(s===u4)return 6410;if(s===Fa)return 6402;if(s===_c)return 34041;if(s===f4)return 6403;if(s===l4)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(s===Ey)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===d4)return 36244;if(s===h4)return 33319;if(s===p4)return 33320;if(s===m4)return 36249;if(s===O0||s===k0||s===B0||s===z0)if(o===Lt)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===O0)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===k0)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===B0)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===z0)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===O0)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===k0)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===B0)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===z0)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===IM||s===FM||s===DM||s===NM)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===IM)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===FM)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===DM)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===NM)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===g4)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===OM||s===kM)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===OM)return o===Lt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===kM)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===BM||s===zM||s===UM||s===HM||s===GM||s===WM||s===VM||s===$M||s===jM||s===XM||s===qM||s===YM||s===KM||s===ZM)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===BM)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===zM)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===UM)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===HM)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===GM)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===WM)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===VM)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===$M)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===jM)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===XM)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===qM)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===YM)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===KM)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===ZM)return o===Lt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===QM)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===QM)return o===Lt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;return s===oc?i?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:r}}class TH extends di{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Xi extends $t{constructor(){super(),this.isGroup=!0,this.type="Group"}}const EH={type:"move"};class hv{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Xi,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Xi,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new z,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new z),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Xi,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new z,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new z),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,c=this._grip,f=this._hand;if(e&&t.session.visibilityState!=="visible-blurred")if(a!==null&&(r=t.getPose(e.targetRaySpace,i),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(EH))),f&&e.hand){o=!0;for(const y of e.hand.values()){const x=t.getJointPose(y,i);if(f.joints[y.jointName]===void 0){const w=new Xi;w.matrixAutoUpdate=!1,w.visible=!1,f.joints[y.jointName]=w,f.add(w)}const v=f.joints[y.jointName];x!==null&&(v.matrix.fromArray(x.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.jointRadius=x.radius),v.visible=x!==null}const h=f.joints["index-finger-tip"],d=f.joints["thumb-tip"],p=h.position.distanceTo(d.position),g=.02,_=.005;f.inputState.pinching&&p>g+_?(f.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!f.inputState.pinching&&p<=g-_&&(f.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));return a!==null&&(a.visible=r!==null),c!==null&&(c.visible=s!==null),f!==null&&(f.visible=o!==null),this}}class AH extends yi{constructor(e,t,i,r,s,o,a,c,f,h){if(h=h!==void 0?h:Fa,h!==Fa&&h!==_c)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&h===Fa&&(i=Ca),i===void 0&&h===_c&&(i=oc),super(null,r,s,o,a,c,h,i,f),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:En,this.minFilter=c!==void 0?c:En,this.flipY=!1,this.generateMipmaps=!1}}class CH extends Qo{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",c=null,f=null,h=null,d=null,p=null,g=null;const _=t.getContextAttributes();let y=null,x=null;const v=[],w=new Map,S=new di;S.layers.enable(1),S.viewport=new Ut;const E=new di;E.layers.enable(2),E.viewport=new Ut;const b=[S,E],T=new TH;T.layers.enable(1),T.layers.enable(2);let C=null,A=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Y){let Z=v[Y];return Z===void 0&&(Z=new hv,v[Y]=Z),Z.getTargetRaySpace()},this.getControllerGrip=function(Y){let Z=v[Y];return Z===void 0&&(Z=new hv,v[Y]=Z),Z.getGripSpace()},this.getHand=function(Y){let Z=v[Y];return Z===void 0&&(Z=new hv,v[Y]=Z),Z.getHandSpace()};function F(Y){const Z=w.get(Y.inputSource);Z!==void 0&&Z.dispatchEvent({type:Y.type,data:Y.inputSource})}function U(){r.removeEventListener("select",F),r.removeEventListener("selectstart",F),r.removeEventListener("selectend",F),r.removeEventListener("squeeze",F),r.removeEventListener("squeezestart",F),r.removeEventListener("squeezeend",F),r.removeEventListener("end",U),r.removeEventListener("inputsourceschange",W),w.forEach(function(Y,Z){Y!==void 0&&Y.disconnect(Z)}),w.clear(),C=null,A=null,e.setRenderTarget(y),p=null,d=null,h=null,r=null,x=null,$.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Y){s=Y,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Y){a=Y,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(Y){c=Y},this.getBaseLayer=function(){return d!==null?d:p},this.getBinding=function(){return h},this.getFrame=function(){return g},this.getSession=function(){return r},this.setSession=async function(Y){if(r=Y,r!==null){if(y=e.getRenderTarget(),r.addEventListener("select",F),r.addEventListener("selectstart",F),r.addEventListener("selectend",F),r.addEventListener("squeeze",F),r.addEventListener("squeezestart",F),r.addEventListener("squeezeend",F),r.addEventListener("end",U),r.addEventListener("inputsourceschange",W),_.xrCompatible!==!0&&await t.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const Z={antialias:r.renderState.layers===void 0?_.antialias:!0,alpha:_.alpha,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:s};p=new XRWebGLLayer(r,t,Z),r.updateRenderState({baseLayer:p}),x=new gn(p.framebufferWidth,p.framebufferHeight,{format:_r,type:Ha,encoding:e.outputEncoding})}else{let Z=null,he=null,me=null;_.depth&&(me=_.stencil?35056:33190,Z=_.stencil?_c:Fa,he=_.stencil?oc:Ca);const we={colorFormat:e.outputEncoding===Lt?35907:32856,depthFormat:me,scaleFactor:s};h=new XRWebGLBinding(r,t),d=h.createProjectionLayer(we),r.updateRenderState({layers:[d]}),x=new gn(d.textureWidth,d.textureHeight,{format:_r,type:Ha,depthTexture:new AH(d.textureWidth,d.textureHeight,he,void 0,void 0,void 0,void 0,void 0,void 0,Z),stencilBuffer:_.stencil,encoding:e.outputEncoding,samples:_.antialias?4:0});const De=e.properties.get(x);De.__ignoreDepthValues=d.ignoreDepthValues}x.isXRRenderTarget=!0,this.setFoveation(1),c=null,o=await r.requestReferenceSpace(a),$.setContext(r),$.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function W(Y){const Z=r.inputSources;for(let he=0;he<Z.length;he++){const me=Z[he].handedness==="right"?1:0;w.set(Z[he],v[me])}for(let he=0;he<Y.removed.length;he++){const me=Y.removed[he],we=w.get(me);we&&(we.dispatchEvent({type:"disconnected",data:me}),w.delete(me))}for(let he=0;he<Y.added.length;he++){const me=Y.added[he],we=w.get(me);we&&we.dispatchEvent({type:"connected",data:me})}}const ne=new z,re=new z;function V(Y,Z,he){ne.setFromMatrixPosition(Z.matrixWorld),re.setFromMatrixPosition(he.matrixWorld);const me=ne.distanceTo(re),we=Z.projectionMatrix.elements,De=he.projectionMatrix.elements,Be=we[14]/(we[10]-1),ce=we[14]/(we[10]+1),yt=(we[9]+1)/we[5],qe=(we[9]-1)/we[5],Xe=(we[8]-1)/we[0],Ne=(De[8]+1)/De[0],dt=Be*Xe,nt=Be*Ne,Ye=me/(-Xe+Ne),Tt=Ye*-Xe;Z.matrixWorld.decompose(Y.position,Y.quaternion,Y.scale),Y.translateX(Tt),Y.translateZ(Ye),Y.matrixWorld.compose(Y.position,Y.quaternion,Y.scale),Y.matrixWorldInverse.copy(Y.matrixWorld).invert();const jt=Be+Ye,wn=ce+Ye,Qt=dt-Tt,rn=nt+(me-Tt),Et=yt*ce/wn*jt,Pn=qe*ce/wn*jt;Y.projectionMatrix.makePerspective(Qt,rn,Et,Pn,jt,wn)}function ie(Y,Z){Z===null?Y.matrixWorld.copy(Y.matrix):Y.matrixWorld.multiplyMatrices(Z.matrixWorld,Y.matrix),Y.matrixWorldInverse.copy(Y.matrixWorld).invert()}this.updateCamera=function(Y){if(r===null)return;T.near=E.near=S.near=Y.near,T.far=E.far=S.far=Y.far,(C!==T.near||A!==T.far)&&(r.updateRenderState({depthNear:T.near,depthFar:T.far}),C=T.near,A=T.far);const Z=Y.parent,he=T.cameras;ie(T,Z);for(let we=0;we<he.length;we++)ie(he[we],Z);T.matrixWorld.decompose(T.position,T.quaternion,T.scale),Y.position.copy(T.position),Y.quaternion.copy(T.quaternion),Y.scale.copy(T.scale),Y.matrix.copy(T.matrix),Y.matrixWorld.copy(T.matrixWorld);const me=Y.children;for(let we=0,De=me.length;we<De;we++)me[we].updateMatrixWorld(!0);he.length===2?V(T,S,E):T.projectionMatrix.copy(S.projectionMatrix)},this.getCamera=function(){return T},this.getFoveation=function(){if(d!==null)return d.fixedFoveation;if(p!==null)return p.fixedFoveation},this.setFoveation=function(Y){d!==null&&(d.fixedFoveation=Y),p!==null&&p.fixedFoveation!==void 0&&(p.fixedFoveation=Y)};let K=null;function ae(Y,Z){if(f=Z.getViewerPose(c||o),g=Z,f!==null){const me=f.views;p!==null&&(e.setRenderTargetFramebuffer(x,p.framebuffer),e.setRenderTarget(x));let we=!1;me.length!==T.cameras.length&&(T.cameras.length=0,we=!0);for(let De=0;De<me.length;De++){const Be=me[De];let ce=null;if(p!==null)ce=p.getViewport(Be);else{const qe=h.getViewSubImage(d,Be);ce=qe.viewport,De===0&&(e.setRenderTargetTextures(x,qe.colorTexture,d.ignoreDepthValues?void 0:qe.depthStencilTexture),e.setRenderTarget(x))}let yt=b[De];yt===void 0&&(yt=new di,yt.layers.enable(De),yt.viewport=new Ut,b[De]=yt),yt.matrix.fromArray(Be.transform.matrix),yt.projectionMatrix.fromArray(Be.projectionMatrix),yt.viewport.set(ce.x,ce.y,ce.width,ce.height),De===0&&T.matrix.copy(yt.matrix),we===!0&&T.cameras.push(yt)}}const he=r.inputSources;for(let me=0;me<v.length;me++){const we=he[me],De=w.get(we);De!==void 0&&De.update(we,Z,c||o)}K&&K(Y,Z),g=null}const $=new L2;$.setAnimationLoop(ae),this.setAnimationLoop=function(Y){K=Y},this.dispose=function(){}}}function RH(n,e){function t(y,x){y.fogColor.value.copy(x.color),x.isFog?(y.fogNear.value=x.near,y.fogFar.value=x.far):x.isFogExp2&&(y.fogDensity.value=x.density)}function i(y,x,v,w,S){x.isMeshBasicMaterial||x.isMeshLambertMaterial?r(y,x):x.isMeshToonMaterial?(r(y,x),h(y,x)):x.isMeshPhongMaterial?(r(y,x),f(y,x)):x.isMeshStandardMaterial?(r(y,x),d(y,x),x.isMeshPhysicalMaterial&&p(y,x,S)):x.isMeshMatcapMaterial?(r(y,x),g(y,x)):x.isMeshDepthMaterial?r(y,x):x.isMeshDistanceMaterial?(r(y,x),_(y,x)):x.isMeshNormalMaterial?r(y,x):x.isLineBasicMaterial?(s(y,x),x.isLineDashedMaterial&&o(y,x)):x.isPointsMaterial?a(y,x,v,w):x.isSpriteMaterial?c(y,x):x.isShadowMaterial?(y.color.value.copy(x.color),y.opacity.value=x.opacity):x.isShaderMaterial&&(x.uniformsNeedUpdate=!1)}function r(y,x){y.opacity.value=x.opacity,x.color&&y.diffuse.value.copy(x.color),x.emissive&&y.emissive.value.copy(x.emissive).multiplyScalar(x.emissiveIntensity),x.map&&(y.map.value=x.map),x.alphaMap&&(y.alphaMap.value=x.alphaMap),x.bumpMap&&(y.bumpMap.value=x.bumpMap,y.bumpScale.value=x.bumpScale,x.side===$r&&(y.bumpScale.value*=-1)),x.displacementMap&&(y.displacementMap.value=x.displacementMap,y.displacementScale.value=x.displacementScale,y.displacementBias.value=x.displacementBias),x.emissiveMap&&(y.emissiveMap.value=x.emissiveMap),x.normalMap&&(y.normalMap.value=x.normalMap,y.normalScale.value.copy(x.normalScale),x.side===$r&&y.normalScale.value.negate()),x.specularMap&&(y.specularMap.value=x.specularMap),x.alphaTest>0&&(y.alphaTest.value=x.alphaTest);const v=e.get(x).envMap;if(v&&(y.envMap.value=v,y.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=x.reflectivity,y.ior.value=x.ior,y.refractionRatio.value=x.refractionRatio),x.lightMap){y.lightMap.value=x.lightMap;const E=n.physicallyCorrectLights!==!0?Math.PI:1;y.lightMapIntensity.value=x.lightMapIntensity*E}x.aoMap&&(y.aoMap.value=x.aoMap,y.aoMapIntensity.value=x.aoMapIntensity);let w;x.map?w=x.map:x.specularMap?w=x.specularMap:x.displacementMap?w=x.displacementMap:x.normalMap?w=x.normalMap:x.bumpMap?w=x.bumpMap:x.roughnessMap?w=x.roughnessMap:x.metalnessMap?w=x.metalnessMap:x.alphaMap?w=x.alphaMap:x.emissiveMap?w=x.emissiveMap:x.clearcoatMap?w=x.clearcoatMap:x.clearcoatNormalMap?w=x.clearcoatNormalMap:x.clearcoatRoughnessMap?w=x.clearcoatRoughnessMap:x.iridescenceMap?w=x.iridescenceMap:x.iridescenceThicknessMap?w=x.iridescenceThicknessMap:x.specularIntensityMap?w=x.specularIntensityMap:x.specularColorMap?w=x.specularColorMap:x.transmissionMap?w=x.transmissionMap:x.thicknessMap?w=x.thicknessMap:x.sheenColorMap?w=x.sheenColorMap:x.sheenRoughnessMap&&(w=x.sheenRoughnessMap),w!==void 0&&(w.isWebGLRenderTarget&&(w=w.texture),w.matrixAutoUpdate===!0&&w.updateMatrix(),y.uvTransform.value.copy(w.matrix));let S;x.aoMap?S=x.aoMap:x.lightMap&&(S=x.lightMap),S!==void 0&&(S.isWebGLRenderTarget&&(S=S.texture),S.matrixAutoUpdate===!0&&S.updateMatrix(),y.uv2Transform.value.copy(S.matrix))}function s(y,x){y.diffuse.value.copy(x.color),y.opacity.value=x.opacity}function o(y,x){y.dashSize.value=x.dashSize,y.totalSize.value=x.dashSize+x.gapSize,y.scale.value=x.scale}function a(y,x,v,w){y.diffuse.value.copy(x.color),y.opacity.value=x.opacity,y.size.value=x.size*v,y.scale.value=w*.5,x.map&&(y.map.value=x.map),x.alphaMap&&(y.alphaMap.value=x.alphaMap),x.alphaTest>0&&(y.alphaTest.value=x.alphaTest);let S;x.map?S=x.map:x.alphaMap&&(S=x.alphaMap),S!==void 0&&(S.matrixAutoUpdate===!0&&S.updateMatrix(),y.uvTransform.value.copy(S.matrix))}function c(y,x){y.diffuse.value.copy(x.color),y.opacity.value=x.opacity,y.rotation.value=x.rotation,x.map&&(y.map.value=x.map),x.alphaMap&&(y.alphaMap.value=x.alphaMap),x.alphaTest>0&&(y.alphaTest.value=x.alphaTest);let v;x.map?v=x.map:x.alphaMap&&(v=x.alphaMap),v!==void 0&&(v.matrixAutoUpdate===!0&&v.updateMatrix(),y.uvTransform.value.copy(v.matrix))}function f(y,x){y.specular.value.copy(x.specular),y.shininess.value=Math.max(x.shininess,1e-4)}function h(y,x){x.gradientMap&&(y.gradientMap.value=x.gradientMap)}function d(y,x){y.roughness.value=x.roughness,y.metalness.value=x.metalness,x.roughnessMap&&(y.roughnessMap.value=x.roughnessMap),x.metalnessMap&&(y.metalnessMap.value=x.metalnessMap),e.get(x).envMap&&(y.envMapIntensity.value=x.envMapIntensity)}function p(y,x,v){y.ior.value=x.ior,x.sheen>0&&(y.sheenColor.value.copy(x.sheenColor).multiplyScalar(x.sheen),y.sheenRoughness.value=x.sheenRoughness,x.sheenColorMap&&(y.sheenColorMap.value=x.sheenColorMap),x.sheenRoughnessMap&&(y.sheenRoughnessMap.value=x.sheenRoughnessMap)),x.clearcoat>0&&(y.clearcoat.value=x.clearcoat,y.clearcoatRoughness.value=x.clearcoatRoughness,x.clearcoatMap&&(y.clearcoatMap.value=x.clearcoatMap),x.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=x.clearcoatRoughnessMap),x.clearcoatNormalMap&&(y.clearcoatNormalScale.value.copy(x.clearcoatNormalScale),y.clearcoatNormalMap.value=x.clearcoatNormalMap,x.side===$r&&y.clearcoatNormalScale.value.negate())),x.iridescence>0&&(y.iridescence.value=x.iridescence,y.iridescenceIOR.value=x.iridescenceIOR,y.iridescenceThicknessMinimum.value=x.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=x.iridescenceThicknessRange[1],x.iridescenceMap&&(y.iridescenceMap.value=x.iridescenceMap),x.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=x.iridescenceThicknessMap)),x.transmission>0&&(y.transmission.value=x.transmission,y.transmissionSamplerMap.value=v.texture,y.transmissionSamplerSize.value.set(v.width,v.height),x.transmissionMap&&(y.transmissionMap.value=x.transmissionMap),y.thickness.value=x.thickness,x.thicknessMap&&(y.thicknessMap.value=x.thicknessMap),y.attenuationDistance.value=x.attenuationDistance,y.attenuationColor.value.copy(x.attenuationColor)),y.specularIntensity.value=x.specularIntensity,y.specularColor.value.copy(x.specularColor),x.specularIntensityMap&&(y.specularIntensityMap.value=x.specularIntensityMap),x.specularColorMap&&(y.specularColorMap.value=x.specularColorMap)}function g(y,x){x.matcap&&(y.matcap.value=x.matcap)}function _(y,x){y.referencePosition.value.copy(x.referencePosition),y.nearDistance.value=x.nearDistance,y.farDistance.value=x.farDistance}return{refreshFogUniforms:t,refreshMaterialUniforms:i}}function PH(){const n=Rf("canvas");return n.style.display="block",n}function B2(n={}){this.isWebGLRenderer=!0;const e=n.canvas!==void 0?n.canvas:PH(),t=n.context!==void 0?n.context:null,i=n.depth!==void 0?n.depth:!0,r=n.stencil!==void 0?n.stencil:!0,s=n.antialias!==void 0?n.antialias:!1,o=n.premultipliedAlpha!==void 0?n.premultipliedAlpha:!0,a=n.preserveDrawingBuffer!==void 0?n.preserveDrawingBuffer:!1,c=n.powerPreference!==void 0?n.powerPreference:"default",f=n.failIfMajorPerformanceCaveat!==void 0?n.failIfMajorPerformanceCaveat:!1;let h;t!==null?h=t.getContextAttributes().alpha:h=n.alpha!==void 0?n.alpha:!1;let d=null,p=null;const g=[],_=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Ga,this.physicallyCorrectLights=!1,this.toneMapping=vs,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const y=this;let x=!1,v=0,w=0,S=null,E=-1,b=null;const T=new Ut,C=new Ut;let A=null,F=e.width,U=e.height,W=1,ne=null,re=null;const V=new Ut(0,0,F,U),ie=new Ut(0,0,F,U);let K=!1;const ae=new vm;let $=!1,Y=!1,Z=null;const he=new pt,me=new Ce,we=new z,De={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Be(){return S===null?W:1}let ce=t;function yt(N,Q){for(let oe=0;oe<N.length;oe++){const te=N[oe],ge=e.getContext(te,Q);if(ge!==null)return ge}return null}try{const N={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:c,failIfMajorPerformanceCaveat:f};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Jx}`),e.addEventListener("webglcontextlost",H,!1),e.addEventListener("webglcontextrestored",be,!1),e.addEventListener("webglcontextcreationerror",Se,!1),ce===null){const Q=["webgl2","webgl","experimental-webgl"];if(y.isWebGL1Renderer===!0&&Q.shift(),ce=yt(Q,N),ce===null)throw yt(Q)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ce.getShaderPrecisionFormat===void 0&&(ce.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(N){throw console.error("THREE.WebGLRenderer: "+N.message),N}let qe,Xe,Ne,dt,nt,Ye,Tt,jt,wn,Qt,rn,Et,Pn,Xt,k,I,fe,xe,Ee,Re,Ge,D,ve;function Ae(){qe=new W5(ce),Xe=new k5(ce,qe,n),qe.init(Xe),D=new bH(ce,qe,Xe),Ne=new SH(ce,qe,Xe),dt=new j5,nt=new uH,Ye=new MH(ce,qe,Ne,nt,Xe,D,dt),Tt=new z5(y),jt=new G5(y),wn=new rz(ce,Xe),ve=new N5(ce,qe,wn,Xe),Qt=new V5(ce,wn,dt,ve),rn=new K5(ce,Qt,wn,dt),Ee=new Y5(ce,Xe,Ye),I=new B5(nt),Et=new cH(y,Tt,jt,qe,Xe,ve,I),Pn=new RH(y,nt),Xt=new dH,k=new yH(qe,Xe),xe=new D5(y,Tt,Ne,rn,h,o),fe=new wH(y,rn,Xe),Re=new O5(ce,qe,dt,Xe),Ge=new $5(ce,qe,dt,Xe),dt.programs=Et.programs,y.capabilities=Xe,y.extensions=qe,y.properties=nt,y.renderLists=Xt,y.shadowMap=fe,y.state=Ne,y.info=dt}Ae();const Me=new CH(y,ce);this.xr=Me,this.getContext=function(){return ce},this.getContextAttributes=function(){return ce.getContextAttributes()},this.forceContextLoss=function(){const N=qe.get("WEBGL_lose_context");N&&N.loseContext()},this.forceContextRestore=function(){const N=qe.get("WEBGL_lose_context");N&&N.restoreContext()},this.getPixelRatio=function(){return W},this.setPixelRatio=function(N){N!==void 0&&(W=N,this.setSize(F,U,!1))},this.getSize=function(N){return N.set(F,U)},this.setSize=function(N,Q,oe){if(Me.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}F=N,U=Q,e.width=Math.floor(N*W),e.height=Math.floor(Q*W),oe!==!1&&(e.style.width=N+"px",e.style.height=Q+"px"),this.setViewport(0,0,N,Q)},this.getDrawingBufferSize=function(N){return N.set(F*W,U*W).floor()},this.setDrawingBufferSize=function(N,Q,oe){F=N,U=Q,W=oe,e.width=Math.floor(N*oe),e.height=Math.floor(Q*oe),this.setViewport(0,0,N,Q)},this.getCurrentViewport=function(N){return N.copy(T)},this.getViewport=function(N){return N.copy(V)},this.setViewport=function(N,Q,oe,te){N.isVector4?V.set(N.x,N.y,N.z,N.w):V.set(N,Q,oe,te),Ne.viewport(T.copy(V).multiplyScalar(W).floor())},this.getScissor=function(N){return N.copy(ie)},this.setScissor=function(N,Q,oe,te){N.isVector4?ie.set(N.x,N.y,N.z,N.w):ie.set(N,Q,oe,te),Ne.scissor(C.copy(ie).multiplyScalar(W).floor())},this.getScissorTest=function(){return K},this.setScissorTest=function(N){Ne.setScissorTest(K=N)},this.setOpaqueSort=function(N){ne=N},this.setTransparentSort=function(N){re=N},this.getClearColor=function(N){return N.copy(xe.getClearColor())},this.setClearColor=function(){xe.setClearColor.apply(xe,arguments)},this.getClearAlpha=function(){return xe.getClearAlpha()},this.setClearAlpha=function(){xe.setClearAlpha.apply(xe,arguments)},this.clear=function(N=!0,Q=!0,oe=!0){let te=0;N&&(te|=16384),Q&&(te|=256),oe&&(te|=1024),ce.clear(te)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",H,!1),e.removeEventListener("webglcontextrestored",be,!1),e.removeEventListener("webglcontextcreationerror",Se,!1),Xt.dispose(),k.dispose(),nt.dispose(),Tt.dispose(),jt.dispose(),rn.dispose(),ve.dispose(),Et.dispose(),Me.dispose(),Me.removeEventListener("sessionstart",St),Me.removeEventListener("sessionend",Mt),Z&&(Z.dispose(),Z=null),zn.stop()};function H(N){N.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),x=!0}function be(){console.log("THREE.WebGLRenderer: Context Restored."),x=!1;const N=dt.autoReset,Q=fe.enabled,oe=fe.autoUpdate,te=fe.needsUpdate,ge=fe.type;Ae(),dt.autoReset=N,fe.enabled=Q,fe.autoUpdate=oe,fe.needsUpdate=te,fe.type=ge}function Se(N){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",N.statusMessage)}function We(N){const Q=N.target;Q.removeEventListener("dispose",We),Pe(Q)}function Pe(N){He(N),nt.remove(N)}function He(N){const Q=nt.get(N).programs;Q!==void 0&&(Q.forEach(function(oe){Et.releaseProgram(oe)}),N.isShaderMaterial&&Et.releaseShaderCache(N))}this.renderBufferDirect=function(N,Q,oe,te,ge,Ke){Q===null&&(Q=De);const et=ge.isMesh&&ge.matrixWorld.determinant()<0,st=Kc(N,Q,oe,te,ge);Ne.setMaterial(te,et);let it=oe.index;const At=oe.attributes.position;if(it===null){if(At===void 0||At.count===0)return}else if(it.count===0)return;let mt=1;te.wireframe===!0&&(it=Qt.getWireframeAttribute(oe),mt=2),ve.setup(ge,te,st,oe,it);let xt,qt=Re;it!==null&&(xt=wn.get(it),qt=Ge,qt.setIndex(xt));const ws=it!==null?it.count:At.count,io=oe.drawRange.start*mt,Er=oe.drawRange.count*mt,ir=Ke!==null?Ke.start*mt:0,gt=Ke!==null?Ke.count*mt:1/0,ro=Math.max(io,ir),sn=Math.min(ws,io+Er,ir+gt)-1,rr=Math.max(0,sn-ro+1);if(rr!==0){if(ge.isMesh)te.wireframe===!0?(Ne.setLineWidth(te.wireframeLinewidth*Be()),qt.setMode(1)):qt.setMode(4);else if(ge.isLine){let Ar=te.linewidth;Ar===void 0&&(Ar=1),Ne.setLineWidth(Ar*Be()),ge.isLineSegments?qt.setMode(1):ge.isLineLoop?qt.setMode(2):qt.setMode(3)}else ge.isPoints?qt.setMode(0):ge.isSprite&&qt.setMode(4);if(ge.isInstancedMesh)qt.renderInstances(ro,rr,ge.count);else if(oe.isInstancedBufferGeometry){const Ar=Math.min(oe.instanceCount,oe._maxInstanceCount);qt.renderInstances(ro,rr,Ar)}else qt.render(ro,rr)}},this.compile=function(N,Q){p=k.get(N),p.init(),_.push(p),N.traverseVisible(function(oe){oe.isLight&&oe.layers.test(Q.layers)&&(p.pushLight(oe),oe.castShadow&&p.pushShadow(oe))}),p.setupLights(y.physicallyCorrectLights),N.traverse(function(oe){const te=oe.material;if(te)if(Array.isArray(te))for(let ge=0;ge<te.length;ge++){const Ke=te[ge];Yc(Ke,N,oe)}else Yc(te,N,oe)}),_.pop(),p=null};let Te=null;function Qe(N){Te&&Te(N)}function St(){zn.stop()}function Mt(){zn.start()}const zn=new L2;zn.setAnimationLoop(Qe),typeof self!="undefined"&&zn.setContext(self),this.setAnimationLoop=function(N){Te=N,Me.setAnimationLoop(N),N===null?zn.stop():zn.start()},Me.addEventListener("sessionstart",St),Me.addEventListener("sessionend",Mt),this.render=function(N,Q){if(Q!==void 0&&Q.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(x===!0)return;N.autoUpdate===!0&&N.updateMatrixWorld(),Q.parent===null&&Q.updateMatrixWorld(),Me.enabled===!0&&Me.isPresenting===!0&&(Me.cameraAutoUpdate===!0&&Me.updateCamera(Q),Q=Me.getCamera()),N.isScene===!0&&N.onBeforeRender(y,N,Q,S),p=k.get(N,_.length),p.init(),_.push(p),he.multiplyMatrices(Q.projectionMatrix,Q.matrixWorldInverse),ae.setFromProjectionMatrix(he),Y=this.localClippingEnabled,$=I.init(this.clippingPlanes,Y,Q),d=Xt.get(N,g.length),d.init(),g.push(d),nr(N,Q,0,y.sortObjects),d.finish(),y.sortObjects===!0&&d.sort(ne,re),$===!0&&I.beginShadows();const oe=p.state.shadowsArray;if(fe.render(oe,N,Q),$===!0&&I.endShadows(),this.info.autoReset===!0&&this.info.reset(),xe.render(d,N),p.setupLights(y.physicallyCorrectLights),Q.isArrayCamera){const te=Q.cameras;for(let ge=0,Ke=te.length;ge<Ke;ge++){const et=te[ge];ed(d,N,et,et.viewport)}}else ed(d,N,Q);S!==null&&(Ye.updateMultisampleRenderTarget(S),Ye.updateRenderTargetMipmap(S)),N.isScene===!0&&N.onAfterRender(y,N,Q),ve.resetDefaultState(),E=-1,b=null,_.pop(),_.length>0?p=_[_.length-1]:p=null,g.pop(),g.length>0?d=g[g.length-1]:d=null};function nr(N,Q,oe,te){if(N.visible===!1)return;if(N.layers.test(Q.layers)){if(N.isGroup)oe=N.renderOrder;else if(N.isLOD)N.autoUpdate===!0&&N.update(Q);else if(N.isLight)p.pushLight(N),N.castShadow&&p.pushShadow(N);else if(N.isSprite){if(!N.frustumCulled||ae.intersectsSprite(N)){te&&we.setFromMatrixPosition(N.matrixWorld).applyMatrix4(he);const et=rn.update(N),st=N.material;st.visible&&d.push(N,et,st,oe,we.z,null)}}else if((N.isMesh||N.isLine||N.isPoints)&&(N.isSkinnedMesh&&N.skeleton.frame!==dt.render.frame&&(N.skeleton.update(),N.skeleton.frame=dt.render.frame),!N.frustumCulled||ae.intersectsObject(N))){te&&we.setFromMatrixPosition(N.matrixWorld).applyMatrix4(he);const et=rn.update(N),st=N.material;if(Array.isArray(st)){const it=et.groups;for(let At=0,mt=it.length;At<mt;At++){const xt=it[At],qt=st[xt.materialIndex];qt&&qt.visible&&d.push(N,et,qt,oe,we.z,xt)}}else st.visible&&d.push(N,et,st,oe,we.z,null)}}const Ke=N.children;for(let et=0,st=Ke.length;et<st;et++)nr(Ke[et],Q,oe,te)}function ed(N,Q,oe,te){const ge=N.opaque,Ke=N.transmissive,et=N.transparent;p.setupLightsView(oe),Ke.length>0&&Km(ge,Q,oe),te&&Ne.viewport(T.copy(te)),ge.length>0&&ta(ge,Q,oe),Ke.length>0&&ta(Ke,Q,oe),et.length>0&&ta(et,Q,oe),Ne.buffers.depth.setTest(!0),Ne.buffers.depth.setMask(!0),Ne.buffers.color.setMask(!0),Ne.setPolygonOffset(!1)}function Km(N,Q,oe){const te=Xe.isWebGL2;Z===null&&(Z=new gn(1,1,{generateMipmaps:!0,type:qe.has("EXT_color_buffer_half_float")?Ef:Ha,minFilter:Dc,samples:te&&s===!0?4:0})),y.getDrawingBufferSize(me),te?Z.setSize(me.x,me.y):Z.setSize(Hp(me.x),Hp(me.y));const ge=y.getRenderTarget();y.setRenderTarget(Z),y.clear();const Ke=y.toneMapping;y.toneMapping=vs,ta(N,Q,oe),y.toneMapping=Ke,Ye.updateMultisampleRenderTarget(Z),Ye.updateRenderTargetMipmap(Z),y.setRenderTarget(ge)}function ta(N,Q,oe){const te=Q.isScene===!0?Q.overrideMaterial:null;for(let ge=0,Ke=N.length;ge<Ke;ge++){const et=N[ge],st=et.object,it=et.geometry,At=te===null?et.material:te,mt=et.group;st.layers.test(oe.layers)&&Zm(st,Q,oe,it,At,mt)}}function Zm(N,Q,oe,te,ge,Ke){N.onBeforeRender(y,Q,oe,te,ge,Ke),N.modelViewMatrix.multiplyMatrices(oe.matrixWorldInverse,N.matrixWorld),N.normalMatrix.getNormalMatrix(N.modelViewMatrix),ge.onBeforeRender(y,Q,oe,te,N,Ke),ge.transparent===!0&&ge.side===xs?(ge.side=$r,ge.needsUpdate=!0,y.renderBufferDirect(oe,Q,te,ge,N,Ke),ge.side=vc,ge.needsUpdate=!0,y.renderBufferDirect(oe,Q,te,ge,N,Ke),ge.side=xs):y.renderBufferDirect(oe,Q,te,ge,N,Ke),N.onAfterRender(y,Q,oe,te,ge,Ke)}function Yc(N,Q,oe){Q.isScene!==!0&&(Q=De);const te=nt.get(N),ge=p.state.lights,Ke=p.state.shadowsArray,et=ge.state.version,st=Et.getParameters(N,ge.state,Ke,Q,oe),it=Et.getProgramCacheKey(st);let At=te.programs;te.environment=N.isMeshStandardMaterial?Q.environment:null,te.fog=Q.fog,te.envMap=(N.isMeshStandardMaterial?jt:Tt).get(N.envMap||te.environment),At===void 0&&(N.addEventListener("dispose",We),At=new Map,te.programs=At);let mt=At.get(it);if(mt!==void 0){if(te.currentProgram===mt&&te.lightsStateVersion===et)return td(N,st),mt}else st.uniforms=Et.getUniforms(N),N.onBuild(oe,st,y),N.onBeforeCompile(st,y),mt=Et.acquireProgram(st,it),At.set(it,mt),te.uniforms=st.uniforms;const xt=te.uniforms;(!N.isShaderMaterial&&!N.isRawShaderMaterial||N.clipping===!0)&&(xt.clippingPlanes=I.uniform),td(N,st),te.needsLights=Zc(N),te.lightsStateVersion=et,te.needsLights&&(xt.ambientLightColor.value=ge.state.ambient,xt.lightProbe.value=ge.state.probe,xt.directionalLights.value=ge.state.directional,xt.directionalLightShadows.value=ge.state.directionalShadow,xt.spotLights.value=ge.state.spot,xt.spotLightShadows.value=ge.state.spotShadow,xt.rectAreaLights.value=ge.state.rectArea,xt.ltc_1.value=ge.state.rectAreaLTC1,xt.ltc_2.value=ge.state.rectAreaLTC2,xt.pointLights.value=ge.state.point,xt.pointLightShadows.value=ge.state.pointShadow,xt.hemisphereLights.value=ge.state.hemi,xt.directionalShadowMap.value=ge.state.directionalShadowMap,xt.directionalShadowMatrix.value=ge.state.directionalShadowMatrix,xt.spotShadowMap.value=ge.state.spotShadowMap,xt.spotShadowMatrix.value=ge.state.spotShadowMatrix,xt.pointShadowMap.value=ge.state.pointShadowMap,xt.pointShadowMatrix.value=ge.state.pointShadowMatrix);const qt=mt.getUniforms(),ws=sp.seqWithValue(qt.seq,xt);return te.currentProgram=mt,te.uniformsList=ws,mt}function td(N,Q){const oe=nt.get(N);oe.outputEncoding=Q.outputEncoding,oe.instancing=Q.instancing,oe.skinning=Q.skinning,oe.morphTargets=Q.morphTargets,oe.morphNormals=Q.morphNormals,oe.morphColors=Q.morphColors,oe.morphTargetsCount=Q.morphTargetsCount,oe.numClippingPlanes=Q.numClippingPlanes,oe.numIntersection=Q.numClipIntersection,oe.vertexAlphas=Q.vertexAlphas,oe.vertexTangents=Q.vertexTangents,oe.toneMapping=Q.toneMapping}function Kc(N,Q,oe,te,ge){Q.isScene!==!0&&(Q=De),Ye.resetTextureUnits();const Ke=Q.fog,et=te.isMeshStandardMaterial?Q.environment:null,st=S===null?y.outputEncoding:S.isXRRenderTarget===!0?S.texture.encoding:Ga,it=(te.isMeshStandardMaterial?jt:Tt).get(te.envMap||et),At=te.vertexColors===!0&&!!oe.attributes.color&&oe.attributes.color.itemSize===4,mt=!!te.normalMap&&!!oe.attributes.tangent,xt=!!oe.morphAttributes.position,qt=!!oe.morphAttributes.normal,ws=!!oe.morphAttributes.color,io=te.toneMapped?y.toneMapping:vs,Er=oe.morphAttributes.position||oe.morphAttributes.normal||oe.morphAttributes.color,ir=Er!==void 0?Er.length:0,gt=nt.get(te),ro=p.state.lights;if($===!0&&(Y===!0||N!==b)){const sr=N===b&&te.id===E;I.setState(te,N,sr)}let sn=!1;te.version===gt.__version?(gt.needsLights&&gt.lightsStateVersion!==ro.state.version||gt.outputEncoding!==st||ge.isInstancedMesh&&gt.instancing===!1||!ge.isInstancedMesh&&gt.instancing===!0||ge.isSkinnedMesh&&gt.skinning===!1||!ge.isSkinnedMesh&&gt.skinning===!0||gt.envMap!==it||te.fog===!0&&gt.fog!==Ke||gt.numClippingPlanes!==void 0&&(gt.numClippingPlanes!==I.numPlanes||gt.numIntersection!==I.numIntersection)||gt.vertexAlphas!==At||gt.vertexTangents!==mt||gt.morphTargets!==xt||gt.morphNormals!==qt||gt.morphColors!==ws||gt.toneMapping!==io||Xe.isWebGL2===!0&&gt.morphTargetsCount!==ir)&&(sn=!0):(sn=!0,gt.__version=te.version);let rr=gt.currentProgram;sn===!0&&(rr=Yc(te,Q,ge));let Ar=!1,so=!1,Qa=!1;const Un=rr.getUniforms(),na=gt.uniforms;if(Ne.useProgram(rr.program)&&(Ar=!0,so=!0,Qa=!0),te.id!==E&&(E=te.id,so=!0),Ar||b!==N){if(Un.setValue(ce,"projectionMatrix",N.projectionMatrix),Xe.logarithmicDepthBuffer&&Un.setValue(ce,"logDepthBufFC",2/(Math.log(N.far+1)/Math.LN2)),b!==N&&(b=N,so=!0,Qa=!0),te.isShaderMaterial||te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshStandardMaterial||te.envMap){const sr=Un.map.cameraPosition;sr!==void 0&&sr.setValue(ce,we.setFromMatrixPosition(N.matrixWorld))}(te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshLambertMaterial||te.isMeshBasicMaterial||te.isMeshStandardMaterial||te.isShaderMaterial)&&Un.setValue(ce,"isOrthographic",N.isOrthographicCamera===!0),(te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshLambertMaterial||te.isMeshBasicMaterial||te.isMeshStandardMaterial||te.isShaderMaterial||te.isShadowMaterial||ge.isSkinnedMesh)&&Un.setValue(ce,"viewMatrix",N.matrixWorldInverse)}if(ge.isSkinnedMesh){Un.setOptional(ce,ge,"bindMatrix"),Un.setOptional(ce,ge,"bindMatrixInverse");const sr=ge.skeleton;sr&&(Xe.floatVertexTextures?(sr.boneTexture===null&&sr.computeBoneTexture(),Un.setValue(ce,"boneTexture",sr.boneTexture,Ye),Un.setValue(ce,"boneTextureSize",sr.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Qc=oe.morphAttributes;return(Qc.position!==void 0||Qc.normal!==void 0||Qc.color!==void 0&&Xe.isWebGL2===!0)&&Ee.update(ge,oe,te,rr),(so||gt.receiveShadow!==ge.receiveShadow)&&(gt.receiveShadow=ge.receiveShadow,Un.setValue(ce,"receiveShadow",ge.receiveShadow)),so&&(Un.setValue(ce,"toneMappingExposure",y.toneMappingExposure),gt.needsLights&&Qm(na,Qa),Ke&&te.fog===!0&&Pn.refreshFogUniforms(na,Ke),Pn.refreshMaterialUniforms(na,te,W,U,Z),sp.upload(ce,gt.uniformsList,na,Ye)),te.isShaderMaterial&&te.uniformsNeedUpdate===!0&&(sp.upload(ce,gt.uniformsList,na,Ye),te.uniformsNeedUpdate=!1),te.isSpriteMaterial&&Un.setValue(ce,"center",ge.center),Un.setValue(ce,"modelViewMatrix",ge.modelViewMatrix),Un.setValue(ce,"normalMatrix",ge.normalMatrix),Un.setValue(ce,"modelMatrix",ge.matrixWorld),rr}function Qm(N,Q){N.ambientLightColor.needsUpdate=Q,N.lightProbe.needsUpdate=Q,N.directionalLights.needsUpdate=Q,N.directionalLightShadows.needsUpdate=Q,N.pointLights.needsUpdate=Q,N.pointLightShadows.needsUpdate=Q,N.spotLights.needsUpdate=Q,N.spotLightShadows.needsUpdate=Q,N.rectAreaLights.needsUpdate=Q,N.hemisphereLights.needsUpdate=Q}function Zc(N){return N.isMeshLambertMaterial||N.isMeshToonMaterial||N.isMeshPhongMaterial||N.isMeshStandardMaterial||N.isShadowMaterial||N.isShaderMaterial&&N.lights===!0}this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return S},this.setRenderTargetTextures=function(N,Q,oe){nt.get(N.texture).__webglTexture=Q,nt.get(N.depthTexture).__webglTexture=oe;const te=nt.get(N);te.__hasExternalTextures=!0,te.__hasExternalTextures&&(te.__autoAllocateDepthBuffer=oe===void 0,te.__autoAllocateDepthBuffer||qe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),te.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(N,Q){const oe=nt.get(N);oe.__webglFramebuffer=Q,oe.__useDefaultFramebuffer=Q===void 0},this.setRenderTarget=function(N,Q=0,oe=0){S=N,v=Q,w=oe;let te=!0;if(N){const it=nt.get(N);it.__useDefaultFramebuffer!==void 0?(Ne.bindFramebuffer(36160,null),te=!1):it.__webglFramebuffer===void 0?Ye.setupRenderTarget(N):it.__hasExternalTextures&&Ye.rebindTextures(N,nt.get(N.texture).__webglTexture,nt.get(N.depthTexture).__webglTexture)}let ge=null,Ke=!1,et=!1;if(N){const it=N.texture;(it.isData3DTexture||it.isDataArrayTexture)&&(et=!0);const At=nt.get(N).__webglFramebuffer;N.isWebGLCubeRenderTarget?(ge=At[Q],Ke=!0):Xe.isWebGL2&&N.samples>0&&Ye.useMultisampledRTT(N)===!1?ge=nt.get(N).__webglMultisampledFramebuffer:ge=At,T.copy(N.viewport),C.copy(N.scissor),A=N.scissorTest}else T.copy(V).multiplyScalar(W).floor(),C.copy(ie).multiplyScalar(W).floor(),A=K;if(Ne.bindFramebuffer(36160,ge)&&Xe.drawBuffers&&te&&Ne.drawBuffers(N,ge),Ne.viewport(T),Ne.scissor(C),Ne.setScissorTest(A),Ke){const it=nt.get(N.texture);ce.framebufferTexture2D(36160,36064,34069+Q,it.__webglTexture,oe)}else if(et){const it=nt.get(N.texture),At=Q||0;ce.framebufferTextureLayer(36160,36064,it.__webglTexture,oe||0,At)}E=-1},this.readRenderTargetPixels=function(N,Q,oe,te,ge,Ke,et){if(!(N&&N.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let st=nt.get(N).__webglFramebuffer;if(N.isWebGLCubeRenderTarget&&et!==void 0&&(st=st[et]),st){Ne.bindFramebuffer(36160,st);try{const it=N.texture,At=it.format,mt=it.type;if(At!==_r&&D.convert(At)!==ce.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const xt=mt===Ef&&(qe.has("EXT_color_buffer_half_float")||Xe.isWebGL2&&qe.has("EXT_color_buffer_float"));if(mt!==Ha&&D.convert(mt)!==ce.getParameter(35738)&&!(mt===Do&&(Xe.isWebGL2||qe.has("OES_texture_float")||qe.has("WEBGL_color_buffer_float")))&&!xt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Q>=0&&Q<=N.width-te&&oe>=0&&oe<=N.height-ge&&ce.readPixels(Q,oe,te,ge,D.convert(At),D.convert(mt),Ke)}finally{const it=S!==null?nt.get(S).__webglFramebuffer:null;Ne.bindFramebuffer(36160,it)}}},this.copyFramebufferToTexture=function(N,Q,oe=0){const te=Math.pow(2,-oe),ge=Math.floor(Q.image.width*te),Ke=Math.floor(Q.image.height*te);Ye.setTexture2D(Q,0),ce.copyTexSubImage2D(3553,oe,0,0,N.x,N.y,ge,Ke),Ne.unbindTexture()},this.copyTextureToTexture=function(N,Q,oe,te=0){const ge=Q.image.width,Ke=Q.image.height,et=D.convert(oe.format),st=D.convert(oe.type);Ye.setTexture2D(oe,0),ce.pixelStorei(37440,oe.flipY),ce.pixelStorei(37441,oe.premultiplyAlpha),ce.pixelStorei(3317,oe.unpackAlignment),Q.isDataTexture?ce.texSubImage2D(3553,te,N.x,N.y,ge,Ke,et,st,Q.image.data):Q.isCompressedTexture?ce.compressedTexSubImage2D(3553,te,N.x,N.y,Q.mipmaps[0].width,Q.mipmaps[0].height,et,Q.mipmaps[0].data):ce.texSubImage2D(3553,te,N.x,N.y,et,st,Q.image),te===0&&oe.generateMipmaps&&ce.generateMipmap(3553),Ne.unbindTexture()},this.copyTextureToTexture3D=function(N,Q,oe,te,ge=0){if(y.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ke=N.max.x-N.min.x+1,et=N.max.y-N.min.y+1,st=N.max.z-N.min.z+1,it=D.convert(te.format),At=D.convert(te.type);let mt;if(te.isData3DTexture)Ye.setTexture3D(te,0),mt=32879;else if(te.isDataArrayTexture)Ye.setTexture2DArray(te,0),mt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ce.pixelStorei(37440,te.flipY),ce.pixelStorei(37441,te.premultiplyAlpha),ce.pixelStorei(3317,te.unpackAlignment);const xt=ce.getParameter(3314),qt=ce.getParameter(32878),ws=ce.getParameter(3316),io=ce.getParameter(3315),Er=ce.getParameter(32877),ir=oe.isCompressedTexture?oe.mipmaps[0]:oe.image;ce.pixelStorei(3314,ir.width),ce.pixelStorei(32878,ir.height),ce.pixelStorei(3316,N.min.x),ce.pixelStorei(3315,N.min.y),ce.pixelStorei(32877,N.min.z),oe.isDataTexture||oe.isData3DTexture?ce.texSubImage3D(mt,ge,Q.x,Q.y,Q.z,Ke,et,st,it,At,ir.data):oe.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ce.compressedTexSubImage3D(mt,ge,Q.x,Q.y,Q.z,Ke,et,st,it,ir.data)):ce.texSubImage3D(mt,ge,Q.x,Q.y,Q.z,Ke,et,st,it,At,ir),ce.pixelStorei(3314,xt),ce.pixelStorei(32878,qt),ce.pixelStorei(3316,ws),ce.pixelStorei(3315,io),ce.pixelStorei(32877,Er),ge===0&&te.generateMipmaps&&ce.generateMipmap(mt),Ne.unbindTexture()},this.initTexture=function(N){Ye.setTexture2D(N,0),Ne.unbindTexture()},this.resetState=function(){v=0,w=0,S=null,Ne.reset(),ve.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class LH extends B2{}LH.prototype.isWebGL1Renderer=!0;class Gp{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new Fe(e),this.near=t,this.far=i}clone(){return new Gp(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class IH extends $t{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}}class z2{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Ty,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Xr()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Xr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Xr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ui=new z;class Pf{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)ui.fromBufferAttribute(this,t),ui.applyMatrix4(e),this.setXYZ(t,ui.x,ui.y,ui.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ui.fromBufferAttribute(this,t),ui.applyNormalMatrix(e),this.setXYZ(t,ui.x,ui.y,ui.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ui.fromBufferAttribute(this,t),ui.transformDirection(e),this.setXYZ(t,ui.x,ui.y,ui.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new vi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Pf(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class of extends xn{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Fe(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Rl;const Tu=new z,Pl=new z,Ll=new z,Il=new Ce,Eu=new Ce,U2=new pt,Eh=new z,Au=new z,Ah=new z,Nb=new Ce,pv=new Ce,Ob=new Ce;class kb extends $t{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",Rl===void 0){Rl=new Rn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new z2(t,5);Rl.setIndex([0,1,2,0,2,3]),Rl.setAttribute("position",new Pf(i,3,0,!1)),Rl.setAttribute("uv",new Pf(i,2,3,!1))}this.geometry=Rl,this.material=e!==void 0?e:new of,this.center=new Ce(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Pl.setFromMatrixScale(this.matrixWorld),U2.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ll.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Pl.multiplyScalar(-Ll.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;Ch(Eh.set(-.5,-.5,0),Ll,o,Pl,r,s),Ch(Au.set(.5,-.5,0),Ll,o,Pl,r,s),Ch(Ah.set(.5,.5,0),Ll,o,Pl,r,s),Nb.set(0,0),pv.set(1,0),Ob.set(1,1);let a=e.ray.intersectTriangle(Eh,Au,Ah,!1,Tu);if(a===null&&(Ch(Au.set(-.5,.5,0),Ll,o,Pl,r,s),pv.set(0,1),a=e.ray.intersectTriangle(Eh,Ah,Au,!1,Tu),a===null))return;const c=e.ray.origin.distanceTo(Tu);c<e.near||c>e.far||t.push({distance:c,point:Tu.clone(),uv:Hr.getUV(Tu,Eh,Au,Ah,Nb,pv,Ob,new Ce),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Ch(n,e,t,i,r,s){Il.subVectors(n,t).addScalar(.5).multiply(i),r!==void 0?(Eu.x=s*Il.x-r*Il.y,Eu.y=r*Il.x+s*Il.y):Eu.copy(Il),n.copy(e),n.x+=Eu.x,n.y+=Eu.y,n.applyMatrix4(U2)}const Rh=new z,Bb=new z;class a_ extends $t{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,r=t.length;i<r;i++){const s=t[i];this.addLevel(s.object.clone(),s.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);const i=this.levels;let r;for(r=0;r<i.length&&!(t<i[r].distance);r++);return i.splice(r,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r&&!(e<t[i].distance);i++);return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){Rh.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(Rh);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Rh.setFromMatrixPosition(e.matrixWorld),Bb.setFromMatrixPosition(this.matrixWorld);const i=Rh.distanceTo(Bb)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s&&i>=t[r].distance;r++)t[r-1].object.visible=!1,t[r].object.visible=!0;for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}const zb=new z,Ub=new Ut,Hb=new Ut,FH=new z,Gb=new pt;class DH extends cn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new pt,this.bindMatrixInverse=new pt}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ut,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,r=this.geometry;Ub.fromBufferAttribute(r.attributes.skinIndex,e),Hb.fromBufferAttribute(r.attributes.skinWeight,e),zb.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=Hb.getComponent(s);if(o!==0){const a=Ub.getComponent(s);Gb.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(FH.copy(zb).applyMatrix4(Gb),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class H2 extends $t{constructor(){super(),this.isBone=!0,this.type="Bone"}}class NH extends yi{constructor(e=null,t=1,i=1,r,s,o,a,c,f=En,h=En,d,p){super(null,o,a,c,f,h,r,s,d,p),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Wb=new pt,OH=new pt;class l_{constructor(e=[],t=[]){this.uuid=Xr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new pt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new pt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:OH;Wb.multiplyMatrices(a,t[s]),Wb.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new l_(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=w2(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new NH(t,e,e,_r,Do);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new H2),this.bones.push(o),this.boneInverses.push(new pt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const o=t[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class Vb extends vi{constructor(e,t,i,r=1){typeof i=="number"&&(r=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const $b=new pt,jb=new pt,Ph=[],Cu=new cn;class Xb extends cn{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Vb(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Cu.geometry=this.geometry,Cu.material=this.material,Cu.material!==void 0)for(let s=0;s<r;s++){this.getMatrixAt(s,$b),jb.multiplyMatrices(i,$b),Cu.matrixWorld=jb,Cu.raycast(e,Ph);for(let o=0,a=Ph.length;o<a;o++){const c=Ph[o];c.instanceId=s,c.object=this,t.push(c)}Ph.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Vb(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class zc extends xn{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Fe(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const qb=new z,Yb=new z,Kb=new pt,mv=new gm,Lh=new Oc;class c_ extends $t{constructor(e=new Rn,t=new zc){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)qb.fromBufferAttribute(t,r-1),Yb.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=qb.distanceTo(Yb);e.setAttribute("lineDistance",new kt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Lh.copy(i.boundingSphere),Lh.applyMatrix4(r),Lh.radius+=s,e.ray.intersectsSphere(Lh)===!1)return;Kb.copy(r).invert(),mv.copy(e.ray).applyMatrix4(Kb);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,f=new z,h=new z,d=new z,p=new z,g=this.isLineSegments?2:1,_=i.index,x=i.attributes.position;if(_!==null){const v=Math.max(0,o.start),w=Math.min(_.count,o.start+o.count);for(let S=v,E=w-1;S<E;S+=g){const b=_.getX(S),T=_.getX(S+1);if(f.fromBufferAttribute(x,b),h.fromBufferAttribute(x,T),mv.distanceSqToSegment(f,h,p,d)>c)continue;p.applyMatrix4(this.matrixWorld);const A=e.ray.origin.distanceTo(p);A<e.near||A>e.far||t.push({distance:A,point:d.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}else{const v=Math.max(0,o.start),w=Math.min(x.count,o.start+o.count);for(let S=v,E=w-1;S<E;S+=g){if(f.fromBufferAttribute(x,S),h.fromBufferAttribute(x,S+1),mv.distanceSqToSegment(f,h,p,d)>c)continue;p.applyMatrix4(this.matrixWorld);const T=e.ray.origin.distanceTo(p);T<e.near||T>e.far||t.push({distance:T,point:d.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const Zb=new z,Qb=new z;class u_ extends c_{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)Zb.fromBufferAttribute(t,r),Qb.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+Zb.distanceTo(Qb);e.setAttribute("lineDistance",new kt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class kH extends c_{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class f_ extends xn{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Fe(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Jb=new pt,Ry=new gm,Ih=new Oc,Fh=new z;class BH extends $t{constructor(e=new Rn,t=new f_){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Ih.copy(i.boundingSphere),Ih.applyMatrix4(r),Ih.radius+=s,e.ray.intersectsSphere(Ih)===!1)return;Jb.copy(r).invert(),Ry.copy(e.ray).applyMatrix4(Jb);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,f=i.index,d=i.attributes.position;if(f!==null){const p=Math.max(0,o.start),g=Math.min(f.count,o.start+o.count);for(let _=p,y=g;_<y;_++){const x=f.getX(_);Fh.fromBufferAttribute(d,x),eT(Fh,x,c,r,e,t,this)}}else{const p=Math.max(0,o.start),g=Math.min(d.count,o.start+o.count);for(let _=p,y=g;_<y;_++)Fh.fromBufferAttribute(d,_),eT(Fh,_,c,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function eT(n,e,t,i,r,s,o){const a=Ry.distanceSqToPoint(n);if(a<t){const c=new z;Ry.closestPointToPoint(n,c),c.applyMatrix4(i);const f=r.ray.origin.distanceTo(c);if(f<r.near||f>r.far)return;s.push({distance:f,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,object:o})}}new z;class d_ extends Rn{constructor(e=1,t=8,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],c=[],f=new z,h=new Ce;o.push(0,0,0),a.push(0,0,1),c.push(.5,.5);for(let d=0,p=3;d<=t;d++,p+=3){const g=i+d/t*r;f.x=e*Math.cos(g),f.y=e*Math.sin(g),o.push(f.x,f.y,f.z),a.push(0,0,1),h.x=(o[p]/e+1)/2,h.y=(o[p+1]/e+1)/2,c.push(h.x,h.y)}for(let d=1;d<=t;d++)s.push(d,d+1,0);this.setIndex(s),this.setAttribute("position",new kt(o,3)),this.setAttribute("normal",new kt(a,3)),this.setAttribute("uv",new kt(c,2))}static fromJSON(e){return new d_(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class h_ extends Rn{constructor(e=1,t=1,i=1,r=8,s=1,o=!1,a=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:c};const f=this;r=Math.floor(r),s=Math.floor(s);const h=[],d=[],p=[],g=[];let _=0;const y=[],x=i/2;let v=0;w(),o===!1&&(e>0&&S(!0),t>0&&S(!1)),this.setIndex(h),this.setAttribute("position",new kt(d,3)),this.setAttribute("normal",new kt(p,3)),this.setAttribute("uv",new kt(g,2));function w(){const E=new z,b=new z;let T=0;const C=(t-e)/i;for(let A=0;A<=s;A++){const F=[],U=A/s,W=U*(t-e)+e;for(let ne=0;ne<=r;ne++){const re=ne/r,V=re*c+a,ie=Math.sin(V),K=Math.cos(V);b.x=W*ie,b.y=-U*i+x,b.z=W*K,d.push(b.x,b.y,b.z),E.set(ie,C,K).normalize(),p.push(E.x,E.y,E.z),g.push(re,1-U),F.push(_++)}y.push(F)}for(let A=0;A<r;A++)for(let F=0;F<s;F++){const U=y[F][A],W=y[F+1][A],ne=y[F+1][A+1],re=y[F][A+1];h.push(U,W,re),h.push(W,ne,re),T+=6}f.addGroup(v,T,0),v+=T}function S(E){const b=_,T=new Ce,C=new z;let A=0;const F=E===!0?e:t,U=E===!0?1:-1;for(let ne=1;ne<=r;ne++)d.push(0,x*U,0),p.push(0,U,0),g.push(.5,.5),_++;const W=_;for(let ne=0;ne<=r;ne++){const V=ne/r*c+a,ie=Math.cos(V),K=Math.sin(V);C.x=F*K,C.y=x*U,C.z=F*ie,d.push(C.x,C.y,C.z),p.push(0,U,0),T.x=ie*.5+.5,T.y=K*.5*U+.5,g.push(T.x,T.y),_++}for(let ne=0;ne<r;ne++){const re=b+ne,V=W+ne;E===!0?h.push(V,V+1,re):h.push(V+1,V,re),A+=3}f.addGroup(v,A,E===!0?1:2),v+=A}}static fromJSON(e){return new h_(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}const Dh=new z,Nh=new z,gv=new z,Oh=new Hr;class zH extends Rn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),s=Math.cos(ac*t),o=e.getIndex(),a=e.getAttribute("position"),c=o?o.count:a.count,f=[0,0,0],h=["a","b","c"],d=new Array(3),p={},g=[];for(let _=0;_<c;_+=3){o?(f[0]=o.getX(_),f[1]=o.getX(_+1),f[2]=o.getX(_+2)):(f[0]=_,f[1]=_+1,f[2]=_+2);const{a:y,b:x,c:v}=Oh;if(y.fromBufferAttribute(a,f[0]),x.fromBufferAttribute(a,f[1]),v.fromBufferAttribute(a,f[2]),Oh.getNormal(gv),d[0]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,d[1]=`${Math.round(x.x*r)},${Math.round(x.y*r)},${Math.round(x.z*r)}`,d[2]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(let w=0;w<3;w++){const S=(w+1)%3,E=d[w],b=d[S],T=Oh[h[w]],C=Oh[h[S]],A=`${E}_${b}`,F=`${b}_${E}`;F in p&&p[F]?(gv.dot(p[F].normal)<=s&&(g.push(T.x,T.y,T.z),g.push(C.x,C.y,C.z)),p[F]=null):A in p||(p[A]={index0:f[w],index1:f[S],normal:gv.clone()})}}for(const _ in p)if(p[_]){const{index0:y,index1:x}=p[_];Dh.fromBufferAttribute(a,y),Nh.fromBufferAttribute(a,x),g.push(Dh.x,Dh.y,Dh.z),g.push(Nh.x,Nh.y,Nh.z)}this.setAttribute("position",new kt(g,3))}}}class Uc extends Rn{constructor(e=1,t=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const c=Math.min(o+a,Math.PI);let f=0;const h=[],d=new z,p=new z,g=[],_=[],y=[],x=[];for(let v=0;v<=i;v++){const w=[],S=v/i;let E=0;v==0&&o==0?E=.5/t:v==i&&c==Math.PI&&(E=-.5/t);for(let b=0;b<=t;b++){const T=b/t;d.x=-e*Math.cos(r+T*s)*Math.sin(o+S*a),d.y=e*Math.cos(o+S*a),d.z=e*Math.sin(r+T*s)*Math.sin(o+S*a),_.push(d.x,d.y,d.z),p.copy(d).normalize(),y.push(p.x,p.y,p.z),x.push(T+E,1-S),w.push(f++)}h.push(w)}for(let v=0;v<i;v++)for(let w=0;w<t;w++){const S=h[v][w+1],E=h[v][w],b=h[v+1][w],T=h[v+1][w+1];(v!==0||o>0)&&g.push(S,E,T),(v!==i-1||c<Math.PI)&&g.push(E,b,T)}this.setIndex(g),this.setAttribute("position",new kt(_,3)),this.setAttribute("normal",new kt(y,3)),this.setAttribute("uv",new kt(x,2))}static fromJSON(e){return new Uc(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class UH extends xn{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Fe(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class HH extends pn{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Yn extends xn{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Fe(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qa,this.normalScale=new Ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Jo extends Yn{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ce(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return si(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Fe(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Fe(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Fe(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class GH extends xn{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Fe(16777215),this.specular=new Fe(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qa,this.normalScale=new Ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class WH extends xn{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Fe(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qa,this.normalScale=new Ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class VH extends xn{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qa,this.normalScale=new Ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class $H extends xn{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Fe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class jH extends xn{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Fe(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qa,this.normalScale=new Ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class XH extends zc{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}const qH={ShadowMaterial:UH,SpriteMaterial:of,RawShaderMaterial:HH,ShaderMaterial:pn,PointsMaterial:f_,MeshPhysicalMaterial:Jo,MeshStandardMaterial:Yn,MeshPhongMaterial:GH,MeshToonMaterial:WH,MeshNormalMaterial:VH,MeshLambertMaterial:$H,MeshDepthMaterial:xm,MeshDistanceMaterial:k2,MeshBasicMaterial:wr,MeshMatcapMaterial:jH,LineDashedMaterial:XH,LineBasicMaterial:zc,Material:xn};xn.fromType=function(n){return new qH[n]};const Kt={arraySlice:function(n,e,t){return Kt.isTypedArray(n)?new n.constructor(n.subarray(e,t!==void 0?t:n.length)):n.slice(e,t)},convertArray:function(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)},isTypedArray:function(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)},getKeyframeOrder:function(n){function e(r,s){return n[r]-n[s]}const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(e),i},sortedArray:function(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let c=0;c!==e;++c)r[o++]=n[a+c]}return r},flattenJSON:function(n,e,t,i){let r=1,s=n[0];for(;s!==void 0&&s[i]===void 0;)s=n[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),t.push(o)),s=n[r++];while(s!==void 0)},subclip:function(n,e,t,i,r=30){const s=n.clone();s.name=e;const o=[];for(let c=0;c<s.tracks.length;++c){const f=s.tracks[c],h=f.getValueSize(),d=[],p=[];for(let g=0;g<f.times.length;++g){const _=f.times[g]*r;if(!(_<t||_>=i)){d.push(f.times[g]);for(let y=0;y<h;++y)p.push(f.values[g*h+y])}}d.length!==0&&(f.times=Kt.convertArray(d,f.times.constructor),f.values=Kt.convertArray(p,f.values.constructor),o.push(f))}s.tracks=o;let a=1/0;for(let c=0;c<s.tracks.length;++c)a>s.tracks[c].times[0]&&(a=s.tracks[c].times[0]);for(let c=0;c<s.tracks.length;++c)s.tracks[c].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=t.tracks[o],c=a.ValueTypeName;if(c==="bool"||c==="string")continue;const f=n.tracks.find(function(v){return v.name===a.name&&v.ValueTypeName===c});if(f===void 0)continue;let h=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=d/3);let p=0;const g=f.getValueSize();f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=g/3);const _=a.times.length-1;let y;if(s<=a.times[0]){const v=h,w=d-h;y=Kt.arraySlice(a.values,v,w)}else if(s>=a.times[_]){const v=_*d+h,w=v+d-h;y=Kt.arraySlice(a.values,v,w)}else{const v=a.createInterpolant(),w=h,S=d-h;v.evaluate(s),y=Kt.arraySlice(v.resultBuffer,w,S)}c==="quaternion"&&new qn().fromArray(y).normalize().conjugate().toArray(y);const x=f.times.length;for(let v=0;v<x;++v){const w=v*g+p;if(c==="quaternion")qn.multiplyQuaternionsFlat(f.values,w,y,0,f.values,w);else{const S=g-p*2;for(let E=0;E<S;++E)f.values[w+E]-=y[E]}}}return n.blendMode=x2,n}};class Xf{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(i=2,s=a);for(let c=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class YH extends Xf{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Kl,endingEnd:Kl}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],c=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case Zl:s=e,a=2*t-i;break;case Up:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(c===void 0)switch(this.getSettings_().endingEnd){case Zl:o=e,c=2*i-t;break;case Up:o=1,c=i+r[1]-r[0];break;default:o=e-1,c=t}const f=(i-t)*.5,h=this.valueSize;this._weightPrev=f/(t-a),this._weightNext=f/(c-i),this._offsetPrev=s*h,this._offsetNext=o*h}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,f=c-a,h=this._offsetPrev,d=this._offsetNext,p=this._weightPrev,g=this._weightNext,_=(i-t)/(r-t),y=_*_,x=y*_,v=-p*x+2*p*y-p*_,w=(1+p)*x+(-1.5-2*p)*y+(-.5+p)*_+1,S=(-1-g)*x+(1.5+g)*y+.5*_,E=g*x-g*y;for(let b=0;b!==a;++b)s[b]=v*o[h+b]+w*o[f+b]+S*o[c+b]+E*o[d+b];return s}}class G2 extends Xf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,f=c-a,h=(i-t)/(r-t),d=1-h;for(let p=0;p!==a;++p)s[p]=o[f+p]*d+o[c+p]*h;return s}}class KH extends Xf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class _s{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Kt.convertArray(t,this.TimeBufferType),this.values=Kt.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Kt.convertArray(e.times,Array),values:Kt.convertArray(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new KH(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new G2(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new YH(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Af:t=this.InterpolantFactoryMethodDiscrete;break;case wc:t=this.InterpolantFactoryMethodLinear;break;case U0:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Af;case this.InterpolantFactoryMethodLinear:return wc;case this.InterpolantFactoryMethodSmooth:return U0}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Kt.arraySlice(i,s,o),this.values=Kt.arraySlice(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const c=i[a];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(o!==null&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(r!==void 0&&Kt.isTypedArray(r))for(let a=0,c=r.length;a!==c;++a){const f=r[a];if(isNaN(f)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,f),e=!1;break}}return e}optimize(){const e=Kt.arraySlice(this.times),t=Kt.arraySlice(this.values),i=this.getValueSize(),r=this.getInterpolation()===U0,s=e.length-1;let o=1;for(let a=1;a<s;++a){let c=!1;const f=e[a],h=e[a+1];if(f!==h&&(a!==1||f!==e[0]))if(r)c=!0;else{const d=a*i,p=d-i,g=d+i;for(let _=0;_!==i;++_){const y=t[d+_];if(y!==t[p+_]||y!==t[g+_]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];const d=a*i,p=o*i;for(let g=0;g!==i;++g)t[p+g]=t[d+g]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,c=o*i,f=0;f!==i;++f)t[c+f]=t[a+f];++o}return o!==e.length?(this.times=Kt.arraySlice(e,0,o),this.values=Kt.arraySlice(t,0,o*i)):(this.times=e,this.values=t),this}clone(){const e=Kt.arraySlice(this.times,0),t=Kt.arraySlice(this.values,0),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}_s.prototype.TimeBufferType=Float32Array;_s.prototype.ValueBufferType=Float32Array;_s.prototype.DefaultInterpolation=wc;class Hc extends _s{}Hc.prototype.ValueTypeName="bool";Hc.prototype.ValueBufferType=Array;Hc.prototype.DefaultInterpolation=Af;Hc.prototype.InterpolantFactoryMethodLinear=void 0;Hc.prototype.InterpolantFactoryMethodSmooth=void 0;class W2 extends _s{}W2.prototype.ValueTypeName="color";class Lf extends _s{}Lf.prototype.ValueTypeName="number";class ZH extends Xf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(i-t)/(r-t);let f=e*a;for(let h=f+a;f!==h;f+=4)qn.slerpFlat(s,0,o,f-a,o,f,c);return s}}class Wa extends _s{InterpolantFactoryMethodLinear(e){return new ZH(this.times,this.values,this.getValueSize(),e)}}Wa.prototype.ValueTypeName="quaternion";Wa.prototype.DefaultInterpolation=wc;Wa.prototype.InterpolantFactoryMethodSmooth=void 0;class Gc extends _s{}Gc.prototype.ValueTypeName="string";Gc.prototype.ValueBufferType=Array;Gc.prototype.DefaultInterpolation=Af;Gc.prototype.InterpolantFactoryMethodLinear=void 0;Gc.prototype.InterpolantFactoryMethodSmooth=void 0;class If extends _s{}If.prototype.ValueTypeName="vector";class Py{constructor(e,t=-1,i,r=t_){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Xr(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(JH(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(_s.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let c=[],f=[];c.push((a+s-1)%s,a,(a+1)%s),f.push(0,1,0);const h=Kt.getKeyframeOrder(c);c=Kt.sortedArray(c,1,h),f=Kt.sortedArray(f,1,h),!r&&c[0]===0&&(c.push(s),f.push(f[0])),o.push(new Lf(".morphTargetInfluences["+t[a].name+"]",c,f).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){const f=e[a],h=f.name.match(s);if(h&&h.length>1){const d=h[1];let p=r[d];p||(r[d]=p=[]),p.push(f)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,p,g,_,y){if(g.length!==0){const x=[],v=[];Kt.flattenJSON(g,x,v,_),x.length!==0&&y.push(new d(p,x,v))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let c=e.length||-1;const f=e.hierarchy||[];for(let d=0;d<f.length;d++){const p=f[d].keys;if(!(!p||p.length===0))if(p[0].morphTargets){const g={};let _;for(_=0;_<p.length;_++)if(p[_].morphTargets)for(let y=0;y<p[_].morphTargets.length;y++)g[p[_].morphTargets[y]]=-1;for(const y in g){const x=[],v=[];for(let w=0;w!==p[_].morphTargets.length;++w){const S=p[_];x.push(S.time),v.push(S.morphTarget===y?1:0)}r.push(new Lf(".morphTargetInfluence["+y+"]",x,v))}c=g.length*o}else{const g=".bones["+t[d].name+"]";i(If,g+".position",p,"pos",r),i(Wa,g+".quaternion",p,"rot",r),i(If,g+".scale",p,"scl",r)}}return r.length===0?null:new this(s,c,r,a)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function QH(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Lf;case"vector":case"vector2":case"vector3":case"vector4":return If;case"color":return W2;case"quaternion":return Wa;case"bool":case"boolean":return Hc;case"string":return Gc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function JH(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=QH(n.type);if(n.times===void 0){const t=[],i=[];Kt.flattenJSON(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const bc={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class eG{constructor(e,t,i){const r=this;let s=!1,o=0,a=0,c;const f=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(h){a++,s===!1&&r.onStart!==void 0&&r.onStart(h,o,a),s=!0},this.itemEnd=function(h){o++,r.onProgress!==void 0&&r.onProgress(h,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(h){r.onError!==void 0&&r.onError(h)},this.resolveURL=function(h){return c?c(h):h},this.setURLModifier=function(h){return c=h,this},this.addHandler=function(h,d){return f.push(h,d),this},this.removeHandler=function(h){const d=f.indexOf(h);return d!==-1&&f.splice(d,2),this},this.getHandler=function(h){for(let d=0,p=f.length;d<p;d+=2){const g=f[d],_=f[d+1];if(g.global&&(g.lastIndex=0),g.test(h))return _}return null}}}const tG=new eG;class qf{constructor(e){this.manager=e!==void 0?e:tG,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Os={};class V2 extends qf{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=bc.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Os[e]!==void 0){Os[e].push({onLoad:t,onProgress:i,onError:r});return}Os[e]=[],Os[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(f=>{if(f.status===200||f.status===0){if(f.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream=="undefined"||f.body===void 0||f.body.getReader===void 0)return f;const h=Os[e],d=f.body.getReader(),p=f.headers.get("Content-Length"),g=p?parseInt(p):0,_=g!==0;let y=0;const x=new ReadableStream({start(v){w();function w(){d.read().then(({done:S,value:E})=>{if(S)v.close();else{y+=E.byteLength;const b=new ProgressEvent("progress",{lengthComputable:_,loaded:y,total:g});for(let T=0,C=h.length;T<C;T++){const A=h[T];A.onProgress&&A.onProgress(b)}v.enqueue(E),w()}})}}});return new Response(x)}else throw Error(`fetch for "${f.url}" responded with ${f.status}: ${f.statusText}`)}).then(f=>{switch(c){case"arraybuffer":return f.arrayBuffer();case"blob":return f.blob();case"document":return f.text().then(h=>new DOMParser().parseFromString(h,a));case"json":return f.json();default:if(a===void 0)return f.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),p=d&&d[1]?d[1].toLowerCase():void 0,g=new TextDecoder(p);return f.arrayBuffer().then(_=>g.decode(_))}}}).then(f=>{bc.add(e,f);const h=Os[e];delete Os[e];for(let d=0,p=h.length;d<p;d++){const g=h[d];g.onLoad&&g.onLoad(f)}}).catch(f=>{const h=Os[e];if(h===void 0)throw this.manager.itemError(e),f;delete Os[e];for(let d=0,p=h.length;d<p;d++){const g=h[d];g.onError&&g.onError(f)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class nG extends qf{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=bc.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Rf("img");function c(){h(),bc.add(e,this),t&&t(this),s.manager.itemEnd(e)}function f(d){h(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function h(){a.removeEventListener("load",c,!1),a.removeEventListener("error",f,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",f,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class p_ extends qf{constructor(e){super(e)}load(e,t,i,r){const s=new yi,o=new nG(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}}class _m extends $t{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Fe(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}const tT=new pt,nT=new z,iT=new z;class m_{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ce(512,512),this.map=null,this.mapPass=null,this.matrix=new pt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new vm,this._frameExtents=new Ce(1,1),this._viewportCount=1,this._viewports=[new Ut(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;nT.setFromMatrixPosition(e.matrixWorld),t.position.copy(nT),iT.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(iT),t.updateMatrixWorld(),tT.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(tT),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t.projectionMatrix),i.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class iG extends m_{constructor(){super(new di(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=Cf*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class rG extends _m{constructor(e,t,i=0,r=Math.PI/3,s=0,o=1){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy($t.DefaultUp),this.updateMatrix(),this.target=new $t,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.shadow=new iG}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const rT=new pt,Ru=new z,vv=new z;class sG extends m_{constructor(){super(new di(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ce(4,2),this._viewportCount=6,this._viewports=[new Ut(2,1,1,1),new Ut(0,1,1,1),new Ut(3,1,1,1),new Ut(1,1,1,1),new Ut(3,0,1,1),new Ut(1,0,1,1)],this._cubeDirections=[new z(1,0,0),new z(-1,0,0),new z(0,0,1),new z(0,0,-1),new z(0,1,0),new z(0,-1,0)],this._cubeUps=[new z(0,1,0),new z(0,1,0),new z(0,1,0),new z(0,1,0),new z(0,0,1),new z(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Ru.setFromMatrixPosition(e.matrixWorld),i.position.copy(Ru),vv.copy(i.position),vv.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(vv),i.updateMatrixWorld(),r.makeTranslation(-Ru.x,-Ru.y,-Ru.z),rT.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(rT)}}class Yf extends _m{constructor(e,t,i=0,r=1){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new sG}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class oG extends m_{constructor(){super(new jf(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class $2 extends _m{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy($t.DefaultUp),this.updateMatrix(),this.target=new $t,this.shadow=new oG}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class aG extends _m{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Na{static decodeText(e){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class lG extends qf{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=bc.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){bc.add(e,c),t&&t(c),s.manager.itemEnd(e)}).catch(function(c){r&&r(c),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}class j2{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=sT(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=sT();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function sT(){return(typeof performance=="undefined"?Date:performance).now()}class cG{constructor(e,t,i){this.binding=e,this.valueSize=i;let r,s,o;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)i[s+a]=i[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(i,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const c=t*this._origIndex;this._mixBufferRegion(i,r,c,1-s,t)}o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let c=t,f=t+t;c!==f;++c)if(i[c]!==i[c+t]){a.setValue(i,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let s=i,o=r;s!==o;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[i+o]}_slerp(e,t,i,r){qn.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const o=this._workIndex*s;qn.multiplyQuaternionsFlat(e,o,e,t,e,i),qn.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const c=t+a;e[c]=e[c]*o+e[i+a]*r}}_lerpAdditive(e,t,i,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[i+o]*r}}}const g_="\\[\\]\\.:\\/",uG=new RegExp("["+g_+"]","g"),v_="[^"+g_+"]",fG="[^"+g_.replace("\\.","")+"]",dG=/((?:WC+[\/:])*)/.source.replace("WC",v_),hG=/(WCOD+)?/.source.replace("WCOD",fG),pG=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",v_),mG=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",v_),gG=new RegExp("^"+dG+hG+pG+mG+"$"),vG=["material","materials","bones"];class yG{constructor(e,t,i){const r=i||Ft.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class Ft{constructor(e,t,i){this.path=t,this.parsedPath=i||Ft.parseTrackName(t),this.node=Ft.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new Ft.Composite(e,t,i):new Ft(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(uG,"")}static parseTrackName(e){const t=gG.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);vG.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const c=i(a.children);if(c)return c}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=Ft.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let f=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let h=0;h<e.length;h++)if(e[h].name===f){f=h;break}break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(f!==void 0){if(e[f]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[f]}}const o=e[r];if(o===void 0){const f=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+f+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}c=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(c=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ft.Composite=yG;Ft.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ft.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ft.prototype.GetterByBindingType=[Ft.prototype._getValue_direct,Ft.prototype._getValue_array,Ft.prototype._getValue_arrayElement,Ft.prototype._getValue_toArray];Ft.prototype.SetterByBindingTypeAndVersioning=[[Ft.prototype._setValue_direct,Ft.prototype._setValue_direct_setNeedsUpdate,Ft.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ft.prototype._setValue_array,Ft.prototype._setValue_array_setNeedsUpdate,Ft.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ft.prototype._setValue_arrayElement,Ft.prototype._setValue_arrayElement_setNeedsUpdate,Ft.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ft.prototype._setValue_fromArray,Ft.prototype._setValue_fromArray_setNeedsUpdate,Ft.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class xG{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),c={endingStart:Kl,endingEnd:Kl};for(let f=0;f!==o;++f){const h=s[f].createInterpolant(null);a[f]=h,h.settings=c}this._interpolantSettings=c,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=y4,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const c=a.parameterPositions,f=a.sampleValues;return c[0]=s,c[1]=s+i,f[0]=e/o,f[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const c=(e-s)*i;if(c<0||i===0)return;this._startTime=null,t=i*c}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const c=this._interpolants,f=this._propertyBindings;switch(this.blendMode){case x2:for(let h=0,d=c.length;h!==d;++h)c[h].evaluate(o),f[h].accumulateAdditive(a);break;case t_:default:for(let h=0,d=c.length;h!==d;++h)c[h].evaluate(o),f[h].accumulate(r,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;i!==null&&(t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===x4;if(e===0)return s===-1?r:o&&(s&1)===1?t-r:r;if(i===v4){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const c=this.repetitions-s;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){const f=e<0;this._setEndings(f,!f,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=Zl,r.endingEnd=Zl):(e?r.endingStart=this.zeroSlopeAtStart?Zl:Kl:r.endingStart=Up,t?r.endingEnd=this.zeroSlopeAtEnd?Zl:Kl:r.endingEnd=Up)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,c=o.sampleValues;return a[0]=s,c[0]=t,a[1]=s+e,c[1]=i,this}}const _G=new Float32Array(1);class wG extends Qo{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,c=i.uuid,f=this._bindingsByRootAndName;let h=f[c];h===void 0&&(h={},f[c]=h);for(let d=0;d!==s;++d){const p=r[d],g=p.name;let _=h[g];if(_!==void 0)++_.referenceCount,o[d]=_;else{if(_=o[d],_!==void 0){_._cacheIndex===null&&(++_.referenceCount,this._addInactiveBinding(_,c,g));continue}const y=t&&t._propertyBindings[d].binding.parsedPath;_=new cG(Ft.create(i,g,y),p.ValueTypeName,p.getValueSize()),++_.referenceCount,this._addInactiveBinding(_,c,g),o[d]=_}a[d].resultBuffer=_.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],c=a.knownActions,f=c[c.length-1],h=e._byClipCacheIndex;f._byClipCacheIndex=h,c[h]=f,c.pop(),e._byClipCacheIndex=null;const d=a.actionByRoot,p=(e._localRoot||this._root).uuid;delete d[p],c.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];o===void 0&&(o={},r[t]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],c=t[t.length-1],f=e._cacheIndex;c._cacheIndex=f,t[f]=c,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&(i=new G2(new Float32Array(2),new Float32Array(2),1,_G),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let o=typeof e=="string"?Py.findByName(r,e):e;const a=o!==null?o.uuid:e,c=this._actionsByClip[a];let f=null;if(i===void 0&&(o!==null?i=o.blendMode:i=t_),c!==void 0){const d=c.actionByRoot[s];if(d!==void 0&&d.blendMode===i)return d;f=c.knownActions[0],o===null&&(o=f._clip)}if(o===null)return null;const h=new xG(this,o,t,i);return this._bindAction(h,f),this._addInactiveAction(h,a,s),h}existingAction(e,t){const i=t||this._root,r=i.uuid,s=typeof e=="string"?Py.findByName(i,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let f=0;f!==i;++f)t[f]._update(r,e,s,o);const a=this._bindings,c=this._nActiveBindings;for(let f=0;f!==c;++f)a[f].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const o=s.knownActions;for(let a=0,c=o.length;a!==c;++a){const f=o[a];this._deactivateAction(f);const h=f._cacheIndex,d=t[t.length-1];f._cacheIndex=null,f._byClipCacheIndex=null,d._cacheIndex=h,t[h]=d,t.pop(),this._removeInactiveBindingsForAction(f)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const a=i[o].actionByRoot,c=a[t];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class oT{constructor(e,t,i=0,r=1/0){this.ray=new gm(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new r_,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return Ly(e,this,i,t),i.sort(aT),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)Ly(e[r],this,i,t);return i.sort(aT),i}}function aT(n,e){return n.distance-e.distance}function Ly(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),i===!0){const r=n.children;for(let s=0,o=r.length;s<o;s++)Ly(r[s],e,t,!0)}}class lT{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(si(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Tc extends u_{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Rn;r.setAttribute("position",new kt(t,3)),r.setAttribute("color",new kt(i,3));const s=new zc({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,i){const r=new Fe,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}const is=new Uint32Array(512),rs=new Uint32Array(512);for(let n=0;n<256;++n){const e=n-127;e<-27?(is[n]=0,is[n|256]=32768,rs[n]=24,rs[n|256]=24):e<-14?(is[n]=1024>>-e-14,is[n|256]=1024>>-e-14|32768,rs[n]=-e-1,rs[n|256]=-e-1):e<=15?(is[n]=e+15<<10,is[n|256]=e+15<<10|32768,rs[n]=13,rs[n|256]=13):e<128?(is[n]=31744,is[n|256]=64512,rs[n]=24,rs[n|256]=24):(is[n]=31744,is[n|256]=64512,rs[n]=13,rs[n|256]=13)}const X2=new Uint32Array(2048),Kf=new Uint32Array(64),SG=new Uint32Array(64);for(let n=1;n<1024;++n){let e=n<<13,t=0;for(;(e&8388608)===0;)e<<=1,t-=8388608;e&=-8388609,t+=947912704,X2[n]=e|t}for(let n=1024;n<2048;++n)X2[n]=939524096+(n-1024<<13);for(let n=1;n<31;++n)Kf[n]=n<<23;Kf[31]=1199570944;Kf[32]=2147483648;for(let n=33;n<63;++n)Kf[n]=2147483648+(n-32<<23);Kf[63]=3347054592;for(let n=1;n<64;++n)n!==32&&(SG[n]=1024);typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Jx}}));typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Jx);const MG=n=>`#${n.toString(16)}`,bG=n=>parseInt(n.replace("#",""),16),qs=(n,e,t)=>{const i=new Fe(n),r=i.r*255,s=i.g*255,o=i.b*255;let a=Math.round(r+(Math.random()-.5)*2*e),c=Math.round(s+(Math.random()-.5)*2*e),f=Math.round(o+(Math.random()-.5)*2*e);if(t){let h=Math.random();a=Math.round(r+(h-.5)*2*e),c=Math.round(s+(h-.5)*2*e),f=Math.round(o+(h-.5)*2*e)}return a=a>255?255:a,c=c>255?255:c,f=f>255?255:f,a=a<0?0:a,c=c<0?0:c,f=f<0?0:f,i.r=a/255,i.g=c/255,i.b=f/255,i.getHex()},Iy=(n,e,t)=>{const i=new Fe(n);i.r*255,i.g*255,i.b*255;let r={h:0,s:0,l:0};return i.getHSL(r),e&&(r.l=e),t&&(r.s=t),i.setHSL(r.h,r.s,r.l),i.getHex()},Pa=([n,e],[t,i])=>Math.sqrt(Math.pow(t-n,2)+Math.pow(i-e,2)),q2=(n,e)=>n<e?n:e,Ff=([n,e],t)=>typeof t=="number"?[n+t,e+t]:[n+t[0],e+t[1]],TG=([n,e],t)=>typeof t=="number"?[n*t,e*t]:[n*t[0],e*t[1]],cT=(n,e)=>n[0]===e[0]&&n[1]===e[1],Y2=n=>n*-(Math.PI/2),EG=(n,e,t)=>{const[i,r]=e,[s,o]=n;let a=n;return t===1&&(a=[r-o,s]),t===2&&(a=[i-s,r-o]),t===3&&(a=[o,i-s]),a},AG=(n,e,t,i)=>{const[r,s]=t;if(i===1)return[Math.ceil(n/2)-1,s];if(i===2){const o=Math.ceil(n/2)-1,a=Math.ceil(e/2)-1;return[o,a]}if(i===3){const o=Math.ceil(e/2)-1;return[r,o]}return[r,s]},Kr=(n,e,t=!1)=>{const i=Math.random()*(e-n)+n;return t?Math.round(i):i},CG=n=>()=>{let e=n+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296},y_=()=>Number.MAX_SAFE_INTEGER*Math.random(),K2=(n=y_())=>{const e=CG(n);return(t=0,i=1)=>e()*(i-t)+t};var Fy={exports:{}};(function(n){var e=function(){var t=String.fromCharCode,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function o(c,f){if(!s[c]){s[c]={};for(var h=0;h<c.length;h++)s[c][c.charAt(h)]=h}return s[c][f]}var a={compressToBase64:function(c){if(c==null)return"";var f=a._compress(c,6,function(h){return i.charAt(h)});switch(f.length%4){default:case 0:return f;case 1:return f+"===";case 2:return f+"==";case 3:return f+"="}},decompressFromBase64:function(c){return c==null?"":c==""?null:a._decompress(c.length,32,function(f){return o(i,c.charAt(f))})},compressToUTF16:function(c){return c==null?"":a._compress(c,15,function(f){return t(f+32)})+" "},decompressFromUTF16:function(c){return c==null?"":c==""?null:a._decompress(c.length,16384,function(f){return c.charCodeAt(f)-32})},compressToUint8Array:function(c){for(var f=a.compress(c),h=new Uint8Array(f.length*2),d=0,p=f.length;d<p;d++){var g=f.charCodeAt(d);h[d*2]=g>>>8,h[d*2+1]=g%256}return h},decompressFromUint8Array:function(c){if(c==null)return a.decompress(c);for(var f=new Array(c.length/2),h=0,d=f.length;h<d;h++)f[h]=c[h*2]*256+c[h*2+1];var p=[];return f.forEach(function(g){p.push(t(g))}),a.decompress(p.join(""))},compressToEncodedURIComponent:function(c){return c==null?"":a._compress(c,6,function(f){return r.charAt(f)})},decompressFromEncodedURIComponent:function(c){return c==null?"":c==""?null:(c=c.replace(/ /g,"+"),a._decompress(c.length,32,function(f){return o(r,c.charAt(f))}))},compress:function(c){return a._compress(c,16,function(f){return t(f)})},_compress:function(c,f,h){if(c==null)return"";var d,p,g={},_={},y="",x="",v="",w=2,S=3,E=2,b=[],T=0,C=0,A;for(A=0;A<c.length;A+=1)if(y=c.charAt(A),Object.prototype.hasOwnProperty.call(g,y)||(g[y]=S++,_[y]=!0),x=v+y,Object.prototype.hasOwnProperty.call(g,x))v=x;else{if(Object.prototype.hasOwnProperty.call(_,v)){if(v.charCodeAt(0)<256){for(d=0;d<E;d++)T=T<<1,C==f-1?(C=0,b.push(h(T)),T=0):C++;for(p=v.charCodeAt(0),d=0;d<8;d++)T=T<<1|p&1,C==f-1?(C=0,b.push(h(T)),T=0):C++,p=p>>1}else{for(p=1,d=0;d<E;d++)T=T<<1|p,C==f-1?(C=0,b.push(h(T)),T=0):C++,p=0;for(p=v.charCodeAt(0),d=0;d<16;d++)T=T<<1|p&1,C==f-1?(C=0,b.push(h(T)),T=0):C++,p=p>>1}w--,w==0&&(w=Math.pow(2,E),E++),delete _[v]}else for(p=g[v],d=0;d<E;d++)T=T<<1|p&1,C==f-1?(C=0,b.push(h(T)),T=0):C++,p=p>>1;w--,w==0&&(w=Math.pow(2,E),E++),g[x]=S++,v=String(y)}if(v!==""){if(Object.prototype.hasOwnProperty.call(_,v)){if(v.charCodeAt(0)<256){for(d=0;d<E;d++)T=T<<1,C==f-1?(C=0,b.push(h(T)),T=0):C++;for(p=v.charCodeAt(0),d=0;d<8;d++)T=T<<1|p&1,C==f-1?(C=0,b.push(h(T)),T=0):C++,p=p>>1}else{for(p=1,d=0;d<E;d++)T=T<<1|p,C==f-1?(C=0,b.push(h(T)),T=0):C++,p=0;for(p=v.charCodeAt(0),d=0;d<16;d++)T=T<<1|p&1,C==f-1?(C=0,b.push(h(T)),T=0):C++,p=p>>1}w--,w==0&&(w=Math.pow(2,E),E++),delete _[v]}else for(p=g[v],d=0;d<E;d++)T=T<<1|p&1,C==f-1?(C=0,b.push(h(T)),T=0):C++,p=p>>1;w--,w==0&&(w=Math.pow(2,E),E++)}for(p=2,d=0;d<E;d++)T=T<<1|p&1,C==f-1?(C=0,b.push(h(T)),T=0):C++,p=p>>1;for(;;)if(T=T<<1,C==f-1){b.push(h(T));break}else C++;return b.join("")},decompress:function(c){return c==null?"":c==""?null:a._decompress(c.length,32768,function(f){return c.charCodeAt(f)})},_decompress:function(c,f,h){var d=[],p=4,g=4,_=3,y="",x=[],v,w,S,E,b,T,C,A={val:h(0),position:f,index:1};for(v=0;v<3;v+=1)d[v]=v;for(S=0,b=Math.pow(2,2),T=1;T!=b;)E=A.val&A.position,A.position>>=1,A.position==0&&(A.position=f,A.val=h(A.index++)),S|=(E>0?1:0)*T,T<<=1;switch(S){case 0:for(S=0,b=Math.pow(2,8),T=1;T!=b;)E=A.val&A.position,A.position>>=1,A.position==0&&(A.position=f,A.val=h(A.index++)),S|=(E>0?1:0)*T,T<<=1;C=t(S);break;case 1:for(S=0,b=Math.pow(2,16),T=1;T!=b;)E=A.val&A.position,A.position>>=1,A.position==0&&(A.position=f,A.val=h(A.index++)),S|=(E>0?1:0)*T,T<<=1;C=t(S);break;case 2:return""}for(d[3]=C,w=C,x.push(C);;){if(A.index>c)return"";for(S=0,b=Math.pow(2,_),T=1;T!=b;)E=A.val&A.position,A.position>>=1,A.position==0&&(A.position=f,A.val=h(A.index++)),S|=(E>0?1:0)*T,T<<=1;switch(C=S){case 0:for(S=0,b=Math.pow(2,8),T=1;T!=b;)E=A.val&A.position,A.position>>=1,A.position==0&&(A.position=f,A.val=h(A.index++)),S|=(E>0?1:0)*T,T<<=1;d[g++]=t(S),C=g-1,p--;break;case 1:for(S=0,b=Math.pow(2,16),T=1;T!=b;)E=A.val&A.position,A.position>>=1,A.position==0&&(A.position=f,A.val=h(A.index++)),S|=(E>0?1:0)*T,T<<=1;d[g++]=t(S),C=g-1,p--;break;case 2:return x.join("")}if(p==0&&(p=Math.pow(2,_),_++),d[C])y=d[C];else if(C===g)y=w+w.charAt(0);else return null;x.push(y),d[g++]=w+y.charAt(0),p--,w=y,p==0&&(p=Math.pow(2,_),_++)}}};return a}();n!=null?n.exports=e:typeof angular!="undefined"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})})(Fy);const Z2=(n,e)=>({get:()=>{const t=localStorage.getItem(n);return t?JSON.parse(t):e},set:t=>{localStorage.setItem(n,JSON.stringify(t))},remove:()=>localStorage.removeItem(n)}),RG=(n,e)=>({get:()=>{const t=localStorage.getItem(n),i=typeof t=="string"?Fy.exports.decompress(t):void 0;return typeof i=="string"?JSON.parse(i):e},set:t=>{const i=Fy.exports.compress(JSON.stringify(t));localStorage.setItem(n,i)},remove:()=>localStorage.removeItem(n)}),PG=n=>n.length===1?n.toLowerCase():n;class x_ extends Rn{constructor(t=1,i=1,r=1,s=1,o="random"){super();O(this,"parameters");this.type="PlaneGeometry",this.parameters={width:t,height:i,widthSegments:r,heightSegments:s,diagonals:o};const a=t/2,c=i/2,f=Math.floor(r),h=Math.floor(s),d=f+1,p=h+1,g=t/f,_=i/h,y=[],x=[],v=[],w=[];for(let S=0;S<p;S++){const E=S*_-c;for(let b=0;b<d;b++){const T=b*g-a;x.push(T,-E,0),v.push(0,0,1),w.push(b/f),w.push(1-S/h)}}for(let S=0;S<h;S++)for(let E=0;E<f;E++){const b=E+d*S,T=E+d*(S+1),C=E+1+d*(S+1),A=E+1+d*S;this.parameters.diagonals==="left"?(y.push(b,C,A),y.push(T,C,b)):this.parameters.diagonals==="right"?(y.push(b,T,A),y.push(T,C,A)):this.parameters.diagonals==="both"?(y.push(b,T,C),y.push(b,T,A),y.push(b,C,A),y.push(T,C,A)):Math.random()>.5?(y.push(b,T,A),y.push(T,C,A)):(y.push(b,C,A),y.push(T,C,b))}this.setIndex(y),this.setAttribute("position",new kt(x,3)),this.setAttribute("normal",new kt(v,3)),this.setAttribute("uv",new kt(w,2))}static fromJSON(t){return new x_(t.width,t.height,t.widthSegments,t.heightSegments)}}class LG extends qf{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new OG(t)}),this.register(function(t){return new WG(t)}),this.register(function(t){return new VG(t)}),this.register(function(t){return new BG(t)}),this.register(function(t){return new zG(t)}),this.register(function(t){return new UG(t)}),this.register(function(t){return new HG(t)}),this.register(function(t){return new NG(t)}),this.register(function(t){return new GG(t)}),this.register(function(t){return new kG(t)}),this.register(function(t){return new FG(t)}),this.register(function(t){return new $G(t)})}load(e,t,i,r){const s=this;let o;this.resourcePath!==""?o=this.resourcePath:this.path!==""?o=this.path:o=Na.extractUrlBase(e),this.manager.itemStart(e);const a=function(f){r?r(f):console.error(f),s.manager.itemError(e),s.manager.itemEnd(e)},c=new V2(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(f){try{s.parse(f,o,function(h){t(h),s.manager.itemEnd(e)},a)}catch(h){a(h)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={};if(typeof e=="string")s=e;else if(Na.decodeText(new Uint8Array(e,0,4))===Q2){try{o[ut.KHR_BINARY_GLTF]=new jG(e)}catch(d){r&&r(d);return}s=o[ut.KHR_BINARY_GLTF].content}else s=Na.decodeText(new Uint8Array(e));const c=JSON.parse(s);if(c.asset===void 0||c.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const f=new sW(c,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});f.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const d=this.pluginCallbacks[h](f);a[d.name]=d,o[d.name]=!0}if(c.extensionsUsed)for(let h=0;h<c.extensionsUsed.length;++h){const d=c.extensionsUsed[h],p=c.extensionsRequired||[];switch(d){case ut.KHR_MATERIALS_UNLIT:o[d]=new DG;break;case ut.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[d]=new YG;break;case ut.KHR_DRACO_MESH_COMPRESSION:o[d]=new XG(c,this.dracoLoader);break;case ut.KHR_TEXTURE_TRANSFORM:o[d]=new qG;break;case ut.KHR_MESH_QUANTIZATION:o[d]=new KG;break;default:p.indexOf(d)>=0&&a[d]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}f.setExtensions(o),f.setPlugins(a),f.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function IG(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const ut={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class FG{constructor(e){this.parser=e,this.name=ut.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,c=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let f;const h=new Fe(16777215);c.color!==void 0&&h.fromArray(c.color);const d=c.range!==void 0?c.range:0;switch(c.type){case"directional":f=new $2(h),f.target.position.set(0,0,-1),f.add(f.target);break;case"point":f=new Yf(h),f.distance=d;break;case"spot":f=new rG(h),f.distance=d,c.spot=c.spot||{},c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0,c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4,f.angle=c.spot.outerConeAngle,f.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,f.target.position.set(0,0,-1),f.add(f.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return f.position.set(0,0,0),f.decay=2,c.intensity!==void 0&&(f.intensity=c.intensity),f.name=t.createUniqueName(c.name||"light_"+e),r=Promise.resolve(f),t.cache.add(i,r),r}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(c){return i._getNodeRef(t.cache,a,c)})}}class DG{constructor(){this.name=ut.KHR_MATERIALS_UNLIT}getMaterialType(){return wr}extendParams(e,t,i){const r=[];e.color=new Fe(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(i.assignTexture(e,"map",s.baseColorTexture,Lt))}return Promise.all(r)}}class NG{constructor(e){this.parser=e,this.name=ut.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class OG{constructor(e){this.parser=e,this.name=ut.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Ce(a,a)}return Promise.all(s)}}class kG{constructor(e){this.parser=e,this.name=ut.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class BG{constructor(e){this.parser=e,this.name=ut.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Fe(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return o.sheenColorFactor!==void 0&&t.sheenColor.fromArray(o.sheenColorFactor),o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Lt)),o.sheenRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class zG{constructor(e){this.parser=e,this.name=ut.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class UG{constructor(e){this.parser=e,this.name=ut.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new Fe(a[0],a[1],a[2]),Promise.all(s)}}class HG{constructor(e){this.parser=e,this.name=ut.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class GG{constructor(e){this.parser=e,this.name=ut.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Jo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new Fe(a[0],a[1],a[2]),o.specularColorTexture!==void 0&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,Lt)),Promise.all(s)}}class WG{constructor(e){this.parser=e,this.name=ut.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class VG{constructor(e){this.parser=e,this.name=ut.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let c=i.textureLoader;if(a.uri){const f=i.options.manager.getHandler(a.uri);f!==null&&(c=f)}return this.detectSupport().then(function(f){if(f)return i.loadTextureImage(e,o.source,c);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class $G{constructor(e){this.name=ut.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([s,o.ready]).then(function(a){const c=r.byteOffset||0,f=r.byteLength||0,h=r.count,d=r.byteStride,p=new ArrayBuffer(h*d),g=new Uint8Array(a[0],c,f);return o.decodeGltfBuffer(new Uint8Array(p),h,d,g,r.mode,r.filter),p})}else return null}}const Q2="glTF",Pu=12,uT={JSON:1313821514,BIN:5130562};class jG{constructor(e){this.name=ut.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Pu);if(this.header={magic:Na.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Q2)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-Pu,r=new DataView(e,Pu);let s=0;for(;s<i;){const o=r.getUint32(s,!0);s+=4;const a=r.getUint32(s,!0);if(s+=4,a===uT.JSON){const c=new Uint8Array(e,Pu+s,o);this.content=Na.decodeText(c)}else if(a===uT.BIN){const c=Pu+s;this.body=e.slice(c,c+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class XG{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=ut.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},c={},f={};for(const h in o){const d=Ny[h]||h.toLowerCase();a[d]=o[h]}for(const h in e.attributes){const d=Ny[h]||h.toLowerCase();if(o[h]!==void 0){const p=i.accessors[e.attributes[h]],g=Df[p.componentType];f[d]=g,c[d]=p.normalized===!0}}return t.getDependency("bufferView",s).then(function(h){return new Promise(function(d){r.decodeDracoFile(h,function(p){for(const g in p.attributes){const _=p.attributes[g],y=c[g];y!==void 0&&(_.normalized=y)}d(p)},a,f)})})}}class qG{constructor(){this.name=ut.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Dy extends Yn{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),i=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),a={specular:{value:new Fe().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(c){for(const f in a)c.uniforms[f]=a[f];c.fragmentShader=c.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",i).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(c){a.specular.value=c}},specularMap:{get:function(){return a.specularMap.value},set:function(c){a.specularMap.value=c,c?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(c){a.glossiness.value=c}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(c){a.glossinessMap.value=c,c?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class YG{constructor(){this.name=ut.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity"]}getMaterialType(){return Dy}extendParams(e,t,i){const r=t.extensions[this.name];e.color=new Fe(1,1,1),e.opacity=1;const s=[];if(Array.isArray(r.diffuseFactor)){const o=r.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(r.diffuseTexture!==void 0&&s.push(i.assignTexture(e,"map",r.diffuseTexture,Lt)),e.emissive=new Fe(0,0,0),e.glossiness=r.glossinessFactor!==void 0?r.glossinessFactor:1,e.specular=new Fe(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),r.specularGlossinessTexture!==void 0){const o=r.specularGlossinessTexture;s.push(i.assignTexture(e,"glossinessMap",o)),s.push(i.assignTexture(e,"specularMap",o,Lt))}return Promise.all(s)}createMaterial(e){const t=new Dy(e);return t.fog=!0,t.color=e.color,t.map=e.map===void 0?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=e.aoMap===void 0?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=e.emissiveIntensity===void 0?1:e.emissiveIntensity,t.emissiveMap=e.emissiveMap===void 0?null:e.emissiveMap,t.bumpMap=e.bumpMap===void 0?null:e.bumpMap,t.bumpScale=1,t.normalMap=e.normalMap===void 0?null:e.normalMap,t.normalMapType=qa,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=e.specularMap===void 0?null:e.specularMap,t.specular=e.specular,t.glossinessMap=e.glossinessMap===void 0?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=e.envMap===void 0?null:e.envMap,t.envMapIntensity=1,t}}class KG{constructor(){this.name=ut.KHR_MESH_QUANTIZATION}}class __ extends Xf{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}}__.prototype.interpolate_=function(n,e,t,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=o*2,c=o*3,f=i-e,h=(t-e)/f,d=h*h,p=d*h,g=n*c,_=g-c,y=-2*p+3*d,x=p-d,v=1-y,w=x-d+h;for(let S=0;S!==o;S++){const E=s[_+S+o],b=s[_+S+a]*f,T=s[g+S+o],C=s[g+S]*f;r[S]=v*E+w*b+y*T+x*C}return r};const ZG=new qn;class QG extends __{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return ZG.fromArray(s).normalize().toArray(s),s}}const ks={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Df={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},fT={9728:En,9729:Ri,9984:My,9985:v2,9986:by,9987:Dc},dT={33071:yr,33648:zp,10497:hs},hT={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ny={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},bo={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},JG={CUBICSPLINE:void 0,LINEAR:wc,STEP:Af},yv={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function eW(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new Yn({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:vc})),n.DefaultMaterial}function Lu(n,e,t){for(const i in t.extensions)n[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function wa(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function tW(n,e,t){let i=!1,r=!1,s=!1;for(let f=0,h=e.length;f<h;f++){const d=e[f];if(d.POSITION!==void 0&&(i=!0),d.NORMAL!==void 0&&(r=!0),d.COLOR_0!==void 0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],c=[];for(let f=0,h=e.length;f<h;f++){const d=e[f];if(i){const p=d.POSITION!==void 0?t.getDependency("accessor",d.POSITION):n.attributes.position;o.push(p)}if(r){const p=d.NORMAL!==void 0?t.getDependency("accessor",d.NORMAL):n.attributes.normal;a.push(p)}if(s){const p=d.COLOR_0!==void 0?t.getDependency("accessor",d.COLOR_0):n.attributes.color;c.push(p)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(c)]).then(function(f){const h=f[0],d=f[1],p=f[2];return i&&(n.morphAttributes.position=h),r&&(n.morphAttributes.normal=d),s&&(n.morphAttributes.color=p),n.morphTargetsRelative=!0,n})}function nW(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function iW(n){const e=n.extensions&&n.extensions[ut.KHR_DRACO_MESH_COMPRESSION];let t;return e?t="draco:"+e.bufferView+":"+e.indices+":"+pT(e.attributes):t=n.indices+":"+pT(n.attributes)+":"+n.mode,t}function pT(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function Oy(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function rW(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}class sW{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new IG,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};const i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1;typeof createImageBitmap=="undefined"||i||r&&s<98?this.textureLoader=new p_(this.options.manager):this.textureLoader=new lG(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new V2(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};Lu(s,a,r),wa(a,r),Promise.all(i._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,c=o.length;a<c;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(i[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const c=this.associations.get(o);c!=null&&this.associations.set(a,c);for(const[f,h]of o.children.entries())s(h,a.children[f])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[ut.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(Na.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const r=t.byteLength||0,s=t.byteOffset||0;return i.slice(s,s+r)})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0)return Promise.resolve(null);const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],c=hT[r.type],f=Df[r.componentType],h=f.BYTES_PER_ELEMENT,d=h*c,p=r.byteOffset||0,g=r.bufferView!==void 0?i.bufferViews[r.bufferView].byteStride:void 0,_=r.normalized===!0;let y,x;if(g&&g!==d){const v=Math.floor(p/g),w="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+v+":"+r.count;let S=t.cache.get(w);S||(y=new f(a,v*g,r.count*g/h),S=new z2(y,g/h),t.cache.add(w,S)),x=new Pf(S,c,p%g/h,_)}else a===null?y=new f(r.count*c):y=new f(a,p,r.count*c),x=new vi(y,c,_);if(r.sparse!==void 0){const v=hT.SCALAR,w=Df[r.sparse.indices.componentType],S=r.sparse.indices.byteOffset||0,E=r.sparse.values.byteOffset||0,b=new w(o[1],S,r.sparse.count*v),T=new f(o[2],E,r.sparse.count*c);a!==null&&(x=new vi(x.array.slice(),x.itemSize,x.normalized));for(let C=0,A=b.length;C<A;C++){const F=b[C];if(x.setX(F,T[C*c]),c>=2&&x.setY(F,T[C*c+1]),c>=3&&x.setZ(F,T[C*c+2]),c>=4&&x.setW(F,T[C*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return x})}loadTexture(e){const t=this.json,i=this.options,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const c=i.manager.getHandler(o.uri);c!==null&&(a=c)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],c=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[c])return this.textureCache[c];const f=this.loadImageSource(t,i).then(function(h){h.flipY=!1,o.name&&(h.name=o.name);const p=(s.samplers||{})[o.sampler]||{};return h.magFilter=fT[p.magFilter]||Ri,h.minFilter=fT[p.minFilter]||Dc,h.wrapS=dT[p.wrapS]||hs,h.wrapT=dT[p.wrapT]||hs,r.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[c]=f,f}loadImageSource(e,t){const i=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(d=>d.clone());const o=r.images[e],a=self.URL||self.webkitURL;let c=o.uri||"",f=!1;if(o.bufferView!==void 0)c=i.getDependency("bufferView",o.bufferView).then(function(d){f=!0;const p=new Blob([d],{type:o.mimeType});return c=a.createObjectURL(p),c});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(c).then(function(d){return new Promise(function(p,g){let _=p;t.isImageBitmapLoader===!0&&(_=function(y){const x=new yi(y);x.needsUpdate=!0,p(x)}),t.load(Na.resolveURL(d,s.path),_,void 0,g)})}).then(function(d){return f===!0&&a.revokeObjectURL(c),d.userData.mimeType=o.mimeType||rW(o.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),d});return this.sourceCache[e]=h,h}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(i.texCoord!==void 0&&i.texCoord!=0&&!(t==="aoMap"&&i.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+i.texCoord+" for texture "+t+" not yet supported."),s.extensions[ut.KHR_TEXTURE_TRANSFORM]){const a=i.extensions!==void 0?i.extensions[ut.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const c=s.associations.get(o);o=s.extensions[ut.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,c)}}return r!==void 0&&(o.encoding=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let c=this.cache.get(a);c||(c=new f_,xn.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,c.sizeAttenuation=!1,this.cache.add(a,c)),i=c}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let c=this.cache.get(a);c||(c=new zc,xn.prototype.copy.call(c,i),c.color.copy(i.color),this.cache.add(a,c)),i=c}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";i.isGLTFSpecularGlossinessMaterial&&(a+="specular-glossiness:"),r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=i.clone(),s&&(c.vertexColors=!0),o&&(c.flatShading=!0),r&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(i))),i=c}i.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=i}getMaterialType(){return Yn}loadMaterial(e){const t=this,i=this.json,r=this.extensions,s=i.materials[e];let o;const a={},c=s.extensions||{},f=[];if(c[ut.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const d=r[ut.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=d.getMaterialType(),f.push(d.extendParams(a,s,t))}else if(c[ut.KHR_MATERIALS_UNLIT]){const d=r[ut.KHR_MATERIALS_UNLIT];o=d.getMaterialType(),f.push(d.extendParams(a,s,t))}else{const d=s.pbrMetallicRoughness||{};if(a.color=new Fe(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){const p=d.baseColorFactor;a.color.fromArray(p),a.opacity=p[3]}d.baseColorTexture!==void 0&&f.push(t.assignTexture(a,"map",d.baseColorTexture,Lt)),a.metalness=d.metallicFactor!==void 0?d.metallicFactor:1,a.roughness=d.roughnessFactor!==void 0?d.roughnessFactor:1,d.metallicRoughnessTexture!==void 0&&(f.push(t.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),f.push(t.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),o=this._invokeOne(function(p){return p.getMaterialType&&p.getMaterialType(e)}),f.push(Promise.all(this._invokeAll(function(p){return p.extendMaterialParams&&p.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=xs);const h=s.alphaMode||yv.OPAQUE;if(h===yv.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,h===yv.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==wr&&(f.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Ce(1,1),s.normalTexture.scale!==void 0)){const d=s.normalTexture.scale;a.normalScale.set(d,d)}return s.occlusionTexture!==void 0&&o!==wr&&(f.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==wr&&(a.emissive=new Fe().fromArray(s.emissiveFactor)),s.emissiveTexture!==void 0&&o!==wr&&f.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,Lt)),Promise.all(f).then(function(){let d;return o===Dy?d=r[ut.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):d=new o(a),s.name&&(d.name=s.name),wa(d,s),t.associations.set(d,{materials:e}),s.extensions&&Lu(r,d,s),d})}createUniqueName(e){const t=Ft.sanitizeNodeName(e||"");let i=t;for(let r=1;this.nodeNamesUsed[i];++r)i=t+"_"+r;return this.nodeNamesUsed[i]=!0,i}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[ut.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return mT(c,a,t)})}const o=[];for(let a=0,c=e.length;a<c;a++){const f=e[a],h=iW(f),d=r[h];if(d)o.push(d.promise);else{let p;f.extensions&&f.extensions[ut.KHR_DRACO_MESH_COMPRESSION]?p=s(f):p=mT(new Rn,f,t),r[h]={primitive:f,promise:p},o.push(p)}}return Promise.all(o)}loadMesh(e){const t=this,i=this.json,r=this.extensions,s=i.meshes[e],o=s.primitives,a=[];for(let c=0,f=o.length;c<f;c++){const h=o[c].material===void 0?eW(this.cache):this.getDependency("material",o[c].material);a.push(h)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(c){const f=c.slice(0,c.length-1),h=c[c.length-1],d=[];for(let g=0,_=h.length;g<_;g++){const y=h[g],x=o[g];let v;const w=f[g];if(x.mode===ks.TRIANGLES||x.mode===ks.TRIANGLE_STRIP||x.mode===ks.TRIANGLE_FAN||x.mode===void 0)v=s.isSkinnedMesh===!0?new DH(y,w):new cn(y,w),v.isSkinnedMesh===!0&&!v.geometry.attributes.skinWeight.normalized&&v.normalizeSkinWeights(),x.mode===ks.TRIANGLE_STRIP?v.geometry=gT(v.geometry,_4):x.mode===ks.TRIANGLE_FAN&&(v.geometry=gT(v.geometry,_2));else if(x.mode===ks.LINES)v=new u_(y,w);else if(x.mode===ks.LINE_STRIP)v=new c_(y,w);else if(x.mode===ks.LINE_LOOP)v=new kH(y,w);else if(x.mode===ks.POINTS)v=new BH(y,w);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+x.mode);Object.keys(v.geometry.morphAttributes).length>0&&nW(v,s),v.name=t.createUniqueName(s.name||"mesh_"+e),wa(v,s),x.extensions&&Lu(r,v,x),t.assignFinalMaterial(v),d.push(v)}for(let g=0,_=d.length;g<_;g++)t.associations.set(d[g],{meshes:e,primitives:g});if(d.length===1)return d[0];const p=new Xi;t.associations.set(p,{meshes:e});for(let g=0,_=d.length;g<_;g++)p.add(d[g]);return p})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new di(z4.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):i.type==="orthographic"&&(t=new jf(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),wa(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i={joints:t.joints};return t.inverseBindMatrices===void 0?Promise.resolve(i):this.getDependency("accessor",t.inverseBindMatrices).then(function(r){return i.inverseBindMatrices=r,i})}loadAnimation(e){const i=this.json.animations[e],r=[],s=[],o=[],a=[],c=[];for(let f=0,h=i.channels.length;f<h;f++){const d=i.channels[f],p=i.samplers[d.sampler],g=d.target,_=g.node!==void 0?g.node:g.id,y=i.parameters!==void 0?i.parameters[p.input]:p.input,x=i.parameters!==void 0?i.parameters[p.output]:p.output;r.push(this.getDependency("node",_)),s.push(this.getDependency("accessor",y)),o.push(this.getDependency("accessor",x)),a.push(p),c.push(g)}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(c)]).then(function(f){const h=f[0],d=f[1],p=f[2],g=f[3],_=f[4],y=[];for(let v=0,w=h.length;v<w;v++){const S=h[v],E=d[v],b=p[v],T=g[v],C=_[v];if(S===void 0)continue;S.updateMatrix(),S.matrixAutoUpdate=!0;let A;switch(bo[C.path]){case bo.weights:A=Lf;break;case bo.rotation:A=Wa;break;case bo.position:case bo.scale:default:A=If;break}const F=S.name?S.name:S.uuid,U=T.interpolation!==void 0?JG[T.interpolation]:wc,W=[];bo[C.path]===bo.weights?S.traverse(function(re){re.morphTargetInfluences&&W.push(re.name?re.name:re.uuid)}):W.push(F);let ne=b.array;if(b.normalized){const re=Oy(ne.constructor),V=new Float32Array(ne.length);for(let ie=0,K=ne.length;ie<K;ie++)V[ie]=ne[ie]*re;ne=V}for(let re=0,V=W.length;re<V;re++){const ie=new A(W[re]+"."+bo[C.path],E.array,ne,U);T.interpolation==="CUBICSPLINE"&&(ie.createInterpolant=function(ae){const $=this instanceof Wa?QG:__;return new $(this.times,this.values,this.getValueSize()/3,ae)},ie.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),y.push(ie)}}const x=i.name?i.name:"animation_"+e;return new Py(x,void 0,y)})}createNodeMesh(e){const t=this.json,i=this,r=t.nodes[e];return r.mesh===void 0?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(!!a.isMesh)for(let c=0,f=r.weights.length;c<f;c++)a.morphTargetInfluences[c]=r.weights[c]}),o})}loadNode(e){const t=this.json,i=this.extensions,r=this,s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"";return function(){const a=[],c=r._invokeOne(function(f){return f.createNodeMesh&&f.createNodeMesh(e)});return c&&a.push(c),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(f){return r._getNodeRef(r.cameraCache,s.camera,f)})),r._invokeAll(function(f){return f.createNodeAttachment&&f.createNodeAttachment(e)}).forEach(function(f){a.push(f)}),Promise.all(a)}().then(function(a){let c;if(s.isBone===!0?c=new H2:a.length>1?c=new Xi:a.length===1?c=a[0]:c=new $t,c!==a[0])for(let f=0,h=a.length;f<h;f++)c.add(a[f]);if(s.name&&(c.userData.name=s.name,c.name=o),wa(c,s),s.extensions&&Lu(i,c,s),s.matrix!==void 0){const f=new pt;f.fromArray(s.matrix),c.applyMatrix4(f)}else s.translation!==void 0&&c.position.fromArray(s.translation),s.rotation!==void 0&&c.quaternion.fromArray(s.rotation),s.scale!==void 0&&c.scale.fromArray(s.scale);return r.associations.has(c)||r.associations.set(c,{}),r.associations.get(c).nodes=e,c})}loadScene(e){const t=this.json,i=this.extensions,r=this.json.scenes[e],s=this,o=new Xi;r.name&&(o.name=s.createUniqueName(r.name)),wa(o,r),r.extensions&&Lu(i,o,r);const a=r.nodes||[],c=[];for(let f=0,h=a.length;f<h;f++)c.push(J2(a[f],o,t,s));return Promise.all(c).then(function(){const f=h=>{const d=new Map;for(const[p,g]of s.associations)(p instanceof xn||p instanceof yi)&&d.set(p,g);return h.traverse(p=>{const g=s.associations.get(p);g!=null&&d.set(p,g)}),d};return s.associations=f(o),o})}}function J2(n,e,t,i){const r=t.nodes[n];return i.getDependency("node",n).then(function(s){if(r.skin===void 0)return s;let o;return i.getDependency("skin",r.skin).then(function(a){o=a;const c=[];for(let f=0,h=o.joints.length;f<h;f++)c.push(i.getDependency("node",o.joints[f]));return Promise.all(c)}).then(function(a){return s.traverse(function(c){if(!c.isMesh)return;const f=[],h=[];for(let d=0,p=a.length;d<p;d++){const g=a[d];if(g){f.push(g);const _=new pt;o.inverseBindMatrices!==void 0&&_.fromArray(o.inverseBindMatrices.array,d*16),h.push(_)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',o.joints[d])}c.bind(new l_(f,h),c.matrixWorld)}),s})}).then(function(s){e.add(s);const o=[];if(r.children){const a=r.children;for(let c=0,f=a.length;c<f;c++){const h=a[c];o.push(J2(h,s,t,i))}}return Promise.all(o)})}function oW(n,e,t){const i=e.attributes,r=new Nc;if(i.POSITION!==void 0){const a=t.json.accessors[i.POSITION],c=a.min,f=a.max;if(c!==void 0&&f!==void 0){if(r.set(new z(c[0],c[1],c[2]),new z(f[0],f[1],f[2])),a.normalized){const h=Oy(Df[a.componentType]);r.min.multiplyScalar(h),r.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new z,c=new z;for(let f=0,h=s.length;f<h;f++){const d=s[f];if(d.POSITION!==void 0){const p=t.json.accessors[d.POSITION],g=p.min,_=p.max;if(g!==void 0&&_!==void 0){if(c.setX(Math.max(Math.abs(g[0]),Math.abs(_[0]))),c.setY(Math.max(Math.abs(g[1]),Math.abs(_[1]))),c.setZ(Math.max(Math.abs(g[2]),Math.abs(_[2]))),p.normalized){const y=Oy(Df[p.componentType]);c.multiplyScalar(y)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new Oc;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}function mT(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(c){n.setAttribute(a,c)})}for(const o in i){const a=Ny[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(e.indices!==void 0&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return wa(n,e),oW(n,e,t),Promise.all(r).then(function(){return e.targets!==void 0?tW(n,e.targets,t):n})}function gT(n,e){let t=n.getIndex();if(t===null){const o=[],a=n.getAttribute("position");if(a!==void 0){for(let c=0;c<a.count;c++)o.push(c);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,r=[];if(e===_2)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s}const eC=new LG,Zf=n=>new Promise((e,t)=>{eC.load(n,i=>{i.scene.traverse(r=>{if(se.debug.wireModel){const s=r;s.material=new wr({color:16764074,wireframe:!0,transparent:!0,opacity:.1})}else r.castShadow=!0,r.receiveShadow=!0}),e(i.scene)},()=>{},i=>{t(i)})}),aW=n=>new Promise((e,t)=>{eC.load(n,i=>{i.scene.traverse(r=>{r.castShadow=!0,r.receiveShadow=!0}),e(i)},()=>{},i=>{t(i)})}),Wp=(n,e,t)=>{const[i,r]=TG(e,se.renderer.tileSize);n.position.x=i,n.position.z=r,n.position.y=t*se.renderer.tileSize},Wc=(n,e=1)=>{n.scale.set(e*se.renderer.tileSize,e*se.renderer.tileSize,e*se.renderer.tileSize)};class lW extends x_{constructor(...e){super(...e),this.rotateX(-Math.PI/2)}}var Gr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(n,e){(function(){var t,i="4.17.21",r=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",a="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",f=500,h="__lodash_placeholder__",d=1,p=2,g=4,_=1,y=2,x=1,v=2,w=4,S=8,E=16,b=32,T=64,C=128,A=256,F=512,U=30,W="...",ne=800,re=16,V=1,ie=2,K=3,ae=1/0,$=9007199254740991,Y=17976931348623157e292,Z=0/0,he=4294967295,me=he-1,we=he>>>1,De=[["ary",C],["bind",x],["bindKey",v],["curry",S],["curryRight",E],["flip",F],["partial",b],["partialRight",T],["rearg",A]],Be="[object Arguments]",ce="[object Array]",yt="[object AsyncFunction]",qe="[object Boolean]",Xe="[object Date]",Ne="[object DOMException]",dt="[object Error]",nt="[object Function]",Ye="[object GeneratorFunction]",Tt="[object Map]",jt="[object Number]",wn="[object Null]",Qt="[object Object]",rn="[object Promise]",Et="[object Proxy]",Pn="[object RegExp]",Xt="[object Set]",k="[object String]",I="[object Symbol]",fe="[object Undefined]",xe="[object WeakMap]",Ee="[object WeakSet]",Re="[object ArrayBuffer]",Ge="[object DataView]",D="[object Float32Array]",ve="[object Float64Array]",Ae="[object Int8Array]",Me="[object Int16Array]",H="[object Int32Array]",be="[object Uint8Array]",Se="[object Uint8ClampedArray]",We="[object Uint16Array]",Pe="[object Uint32Array]",He=/\b__p \+= '';/g,Te=/\b(__p \+=) '' \+/g,Qe=/(__e\(.*?\)|\b__t\)) \+\n'';/g,St=/&(?:amp|lt|gt|quot|#39);/g,Mt=/[&<>"']/g,zn=RegExp(St.source),nr=RegExp(Mt.source),ed=/<%-([\s\S]+?)%>/g,Km=/<%([\s\S]+?)%>/g,ta=/<%=([\s\S]+?)%>/g,Zm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yc=/^\w*$/,td=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Kc=/[\\^$.*+?()[\]{}|]/g,Qm=RegExp(Kc.source),Zc=/^\s+/,N=/\s/,Q=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,oe=/\{\n\/\* \[wrapped with (.+)\] \*/,te=/,? & /,ge=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ke=/[()=,{}\[\]\/\s]/,et=/\\(\\)?/g,st=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,it=/\w*$/,At=/^[-+]0x[0-9a-f]+$/i,mt=/^0b[01]+$/i,xt=/^\[object .+?Constructor\]$/,qt=/^0o[0-7]+$/i,ws=/^(?:0|[1-9]\d*)$/,io=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Er=/($^)/,ir=/['\n\r\u2028\u2029\\]/g,gt="\\ud800-\\udfff",ro="\\u0300-\\u036f",sn="\\ufe20-\\ufe2f",rr="\\u20d0-\\u20ff",Ar=ro+sn+rr,so="\\u2700-\\u27bf",Qa="a-z\\xdf-\\xf6\\xf8-\\xff",Un="\\xac\\xb1\\xd7\\xf7",na="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Qc="\\u2000-\\u206f",sr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Y_="A-Z\\xc0-\\xd6\\xd8-\\xde",K_="\\ufe0e\\ufe0f",Z_=Un+na+Qc+sr,Jm="['\u2019]",JR="["+gt+"]",Q_="["+Z_+"]",nd="["+Ar+"]",J_="\\d+",e3="["+so+"]",e1="["+Qa+"]",t1="[^"+gt+Z_+J_+so+Qa+Y_+"]",eg="\\ud83c[\\udffb-\\udfff]",t3="(?:"+nd+"|"+eg+")",n1="[^"+gt+"]",tg="(?:\\ud83c[\\udde6-\\uddff]){2}",ng="[\\ud800-\\udbff][\\udc00-\\udfff]",Ja="["+Y_+"]",i1="\\u200d",r1="(?:"+e1+"|"+t1+")",n3="(?:"+Ja+"|"+t1+")",s1="(?:"+Jm+"(?:d|ll|m|re|s|t|ve))?",o1="(?:"+Jm+"(?:D|LL|M|RE|S|T|VE))?",a1=t3+"?",l1="["+K_+"]?",i3="(?:"+i1+"(?:"+[n1,tg,ng].join("|")+")"+l1+a1+")*",r3="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",s3="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",c1=l1+a1+i3,o3="(?:"+[e3,tg,ng].join("|")+")"+c1,a3="(?:"+[n1+nd+"?",nd,tg,ng,JR].join("|")+")",l3=RegExp(Jm,"g"),c3=RegExp(nd,"g"),ig=RegExp(eg+"(?="+eg+")|"+a3+c1,"g"),u3=RegExp([Ja+"?"+e1+"+"+s1+"(?="+[Q_,Ja,"$"].join("|")+")",n3+"+"+o1+"(?="+[Q_,Ja+r1,"$"].join("|")+")",Ja+"?"+r1+"+"+s1,Ja+"+"+o1,s3,r3,J_,o3].join("|"),"g"),f3=RegExp("["+i1+gt+Ar+K_+"]"),d3=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,h3=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],p3=-1,Gt={};Gt[D]=Gt[ve]=Gt[Ae]=Gt[Me]=Gt[H]=Gt[be]=Gt[Se]=Gt[We]=Gt[Pe]=!0,Gt[Be]=Gt[ce]=Gt[Re]=Gt[qe]=Gt[Ge]=Gt[Xe]=Gt[dt]=Gt[nt]=Gt[Tt]=Gt[jt]=Gt[Qt]=Gt[Pn]=Gt[Xt]=Gt[k]=Gt[xe]=!1;var zt={};zt[Be]=zt[ce]=zt[Re]=zt[Ge]=zt[qe]=zt[Xe]=zt[D]=zt[ve]=zt[Ae]=zt[Me]=zt[H]=zt[Tt]=zt[jt]=zt[Qt]=zt[Pn]=zt[Xt]=zt[k]=zt[I]=zt[be]=zt[Se]=zt[We]=zt[Pe]=!0,zt[dt]=zt[nt]=zt[xe]=!1;var m3={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},g3={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},v3={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},y3={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},x3=parseFloat,_3=parseInt,u1=typeof Ma=="object"&&Ma&&Ma.Object===Object&&Ma,w3=typeof self=="object"&&self&&self.Object===Object&&self,Hn=u1||w3||Function("return this")(),rg=e&&!e.nodeType&&e,ia=rg&&!0&&n&&!n.nodeType&&n,f1=ia&&ia.exports===rg,sg=f1&&u1.process,or=function(){try{var j=ia&&ia.require&&ia.require("util").types;return j||sg&&sg.binding&&sg.binding("util")}catch{}}(),d1=or&&or.isArrayBuffer,h1=or&&or.isDate,p1=or&&or.isMap,m1=or&&or.isRegExp,g1=or&&or.isSet,v1=or&&or.isTypedArray;function ki(j,ue,ee){switch(ee.length){case 0:return j.call(ue);case 1:return j.call(ue,ee[0]);case 2:return j.call(ue,ee[0],ee[1]);case 3:return j.call(ue,ee[0],ee[1],ee[2])}return j.apply(ue,ee)}function S3(j,ue,ee,Oe){for(var Je=-1,Ct=j==null?0:j.length;++Je<Ct;){var Sn=j[Je];ue(Oe,Sn,ee(Sn),j)}return Oe}function ar(j,ue){for(var ee=-1,Oe=j==null?0:j.length;++ee<Oe&&ue(j[ee],ee,j)!==!1;);return j}function M3(j,ue){for(var ee=j==null?0:j.length;ee--&&ue(j[ee],ee,j)!==!1;);return j}function y1(j,ue){for(var ee=-1,Oe=j==null?0:j.length;++ee<Oe;)if(!ue(j[ee],ee,j))return!1;return!0}function oo(j,ue){for(var ee=-1,Oe=j==null?0:j.length,Je=0,Ct=[];++ee<Oe;){var Sn=j[ee];ue(Sn,ee,j)&&(Ct[Je++]=Sn)}return Ct}function id(j,ue){var ee=j==null?0:j.length;return!!ee&&el(j,ue,0)>-1}function og(j,ue,ee){for(var Oe=-1,Je=j==null?0:j.length;++Oe<Je;)if(ee(ue,j[Oe]))return!0;return!1}function Yt(j,ue){for(var ee=-1,Oe=j==null?0:j.length,Je=Array(Oe);++ee<Oe;)Je[ee]=ue(j[ee],ee,j);return Je}function ao(j,ue){for(var ee=-1,Oe=ue.length,Je=j.length;++ee<Oe;)j[Je+ee]=ue[ee];return j}function ag(j,ue,ee,Oe){var Je=-1,Ct=j==null?0:j.length;for(Oe&&Ct&&(ee=j[++Je]);++Je<Ct;)ee=ue(ee,j[Je],Je,j);return ee}function b3(j,ue,ee,Oe){var Je=j==null?0:j.length;for(Oe&&Je&&(ee=j[--Je]);Je--;)ee=ue(ee,j[Je],Je,j);return ee}function lg(j,ue){for(var ee=-1,Oe=j==null?0:j.length;++ee<Oe;)if(ue(j[ee],ee,j))return!0;return!1}var T3=cg("length");function E3(j){return j.split("")}function A3(j){return j.match(ge)||[]}function x1(j,ue,ee){var Oe;return ee(j,function(Je,Ct,Sn){if(ue(Je,Ct,Sn))return Oe=Ct,!1}),Oe}function rd(j,ue,ee,Oe){for(var Je=j.length,Ct=ee+(Oe?1:-1);Oe?Ct--:++Ct<Je;)if(ue(j[Ct],Ct,j))return Ct;return-1}function el(j,ue,ee){return ue===ue?z3(j,ue,ee):rd(j,_1,ee)}function C3(j,ue,ee,Oe){for(var Je=ee-1,Ct=j.length;++Je<Ct;)if(Oe(j[Je],ue))return Je;return-1}function _1(j){return j!==j}function w1(j,ue){var ee=j==null?0:j.length;return ee?fg(j,ue)/ee:Z}function cg(j){return function(ue){return ue==null?t:ue[j]}}function ug(j){return function(ue){return j==null?t:j[ue]}}function S1(j,ue,ee,Oe,Je){return Je(j,function(Ct,Sn,Bt){ee=Oe?(Oe=!1,Ct):ue(ee,Ct,Sn,Bt)}),ee}function R3(j,ue){var ee=j.length;for(j.sort(ue);ee--;)j[ee]=j[ee].value;return j}function fg(j,ue){for(var ee,Oe=-1,Je=j.length;++Oe<Je;){var Ct=ue(j[Oe]);Ct!==t&&(ee=ee===t?Ct:ee+Ct)}return ee}function dg(j,ue){for(var ee=-1,Oe=Array(j);++ee<j;)Oe[ee]=ue(ee);return Oe}function P3(j,ue){return Yt(ue,function(ee){return[ee,j[ee]]})}function M1(j){return j&&j.slice(0,A1(j)+1).replace(Zc,"")}function Bi(j){return function(ue){return j(ue)}}function hg(j,ue){return Yt(ue,function(ee){return j[ee]})}function Jc(j,ue){return j.has(ue)}function b1(j,ue){for(var ee=-1,Oe=j.length;++ee<Oe&&el(ue,j[ee],0)>-1;);return ee}function T1(j,ue){for(var ee=j.length;ee--&&el(ue,j[ee],0)>-1;);return ee}function L3(j,ue){for(var ee=j.length,Oe=0;ee--;)j[ee]===ue&&++Oe;return Oe}var I3=ug(m3),F3=ug(g3);function D3(j){return"\\"+y3[j]}function N3(j,ue){return j==null?t:j[ue]}function tl(j){return f3.test(j)}function O3(j){return d3.test(j)}function k3(j){for(var ue,ee=[];!(ue=j.next()).done;)ee.push(ue.value);return ee}function pg(j){var ue=-1,ee=Array(j.size);return j.forEach(function(Oe,Je){ee[++ue]=[Je,Oe]}),ee}function E1(j,ue){return function(ee){return j(ue(ee))}}function lo(j,ue){for(var ee=-1,Oe=j.length,Je=0,Ct=[];++ee<Oe;){var Sn=j[ee];(Sn===ue||Sn===h)&&(j[ee]=h,Ct[Je++]=ee)}return Ct}function sd(j){var ue=-1,ee=Array(j.size);return j.forEach(function(Oe){ee[++ue]=Oe}),ee}function B3(j){var ue=-1,ee=Array(j.size);return j.forEach(function(Oe){ee[++ue]=[Oe,Oe]}),ee}function z3(j,ue,ee){for(var Oe=ee-1,Je=j.length;++Oe<Je;)if(j[Oe]===ue)return Oe;return-1}function U3(j,ue,ee){for(var Oe=ee+1;Oe--;)if(j[Oe]===ue)return Oe;return Oe}function nl(j){return tl(j)?G3(j):T3(j)}function Cr(j){return tl(j)?W3(j):E3(j)}function A1(j){for(var ue=j.length;ue--&&N.test(j.charAt(ue)););return ue}var H3=ug(v3);function G3(j){for(var ue=ig.lastIndex=0;ig.test(j);)++ue;return ue}function W3(j){return j.match(ig)||[]}function V3(j){return j.match(u3)||[]}var $3=function j(ue){ue=ue==null?Hn:il.defaults(Hn.Object(),ue,il.pick(Hn,h3));var ee=ue.Array,Oe=ue.Date,Je=ue.Error,Ct=ue.Function,Sn=ue.Math,Bt=ue.Object,mg=ue.RegExp,j3=ue.String,lr=ue.TypeError,od=ee.prototype,X3=Ct.prototype,rl=Bt.prototype,ad=ue["__core-js_shared__"],ld=X3.toString,Dt=rl.hasOwnProperty,q3=0,C1=function(){var l=/[^.]+$/.exec(ad&&ad.keys&&ad.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""}(),cd=rl.toString,Y3=ld.call(Bt),K3=Hn._,Z3=mg("^"+ld.call(Dt).replace(Kc,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ud=f1?ue.Buffer:t,co=ue.Symbol,fd=ue.Uint8Array,R1=ud?ud.allocUnsafe:t,dd=E1(Bt.getPrototypeOf,Bt),P1=Bt.create,L1=rl.propertyIsEnumerable,hd=od.splice,I1=co?co.isConcatSpreadable:t,eu=co?co.iterator:t,ra=co?co.toStringTag:t,pd=function(){try{var l=ca(Bt,"defineProperty");return l({},"",{}),l}catch{}}(),Q3=ue.clearTimeout!==Hn.clearTimeout&&ue.clearTimeout,J3=Oe&&Oe.now!==Hn.Date.now&&Oe.now,eP=ue.setTimeout!==Hn.setTimeout&&ue.setTimeout,md=Sn.ceil,gd=Sn.floor,gg=Bt.getOwnPropertySymbols,tP=ud?ud.isBuffer:t,F1=ue.isFinite,nP=od.join,iP=E1(Bt.keys,Bt),Mn=Sn.max,Qn=Sn.min,rP=Oe.now,sP=ue.parseInt,D1=Sn.random,oP=od.reverse,vg=ca(ue,"DataView"),tu=ca(ue,"Map"),yg=ca(ue,"Promise"),sl=ca(ue,"Set"),nu=ca(ue,"WeakMap"),iu=ca(Bt,"create"),vd=nu&&new nu,ol={},aP=ua(vg),lP=ua(tu),cP=ua(yg),uP=ua(sl),fP=ua(nu),yd=co?co.prototype:t,ru=yd?yd.valueOf:t,N1=yd?yd.toString:t;function P(l){if(on(l)&&!tt(l)&&!(l instanceof ht)){if(l instanceof cr)return l;if(Dt.call(l,"__wrapped__"))return Ow(l)}return new cr(l)}var al=function(){function l(){}return function(u){if(!Jt(u))return{};if(P1)return P1(u);l.prototype=u;var m=new l;return l.prototype=t,m}}();function xd(){}function cr(l,u){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!u,this.__index__=0,this.__values__=t}P.templateSettings={escape:ed,evaluate:Km,interpolate:ta,variable:"",imports:{_:P}},P.prototype=xd.prototype,P.prototype.constructor=P,cr.prototype=al(xd.prototype),cr.prototype.constructor=cr;function ht(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=he,this.__views__=[]}function dP(){var l=new ht(this.__wrapped__);return l.__actions__=Mi(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=Mi(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=Mi(this.__views__),l}function hP(){if(this.__filtered__){var l=new ht(this);l.__dir__=-1,l.__filtered__=!0}else l=this.clone(),l.__dir__*=-1;return l}function pP(){var l=this.__wrapped__.value(),u=this.__dir__,m=tt(l),M=u<0,R=m?l.length:0,L=EL(0,R,this.__views__),B=L.start,G=L.end,X=G-B,de=M?G:B-1,pe=this.__iteratees__,ye=pe.length,Le=0,ze=Qn(X,this.__takeCount__);if(!m||!M&&R==X&&ze==X)return sw(l,this.__actions__);var $e=[];e:for(;X--&&Le<ze;){de+=u;for(var ot=-1,je=l[de];++ot<ye;){var lt=pe[ot],vt=lt.iteratee,Hi=lt.type,ci=vt(je);if(Hi==ie)je=ci;else if(!ci){if(Hi==V)continue e;break e}}$e[Le++]=je}return $e}ht.prototype=al(xd.prototype),ht.prototype.constructor=ht;function sa(l){var u=-1,m=l==null?0:l.length;for(this.clear();++u<m;){var M=l[u];this.set(M[0],M[1])}}function mP(){this.__data__=iu?iu(null):{},this.size=0}function gP(l){var u=this.has(l)&&delete this.__data__[l];return this.size-=u?1:0,u}function vP(l){var u=this.__data__;if(iu){var m=u[l];return m===c?t:m}return Dt.call(u,l)?u[l]:t}function yP(l){var u=this.__data__;return iu?u[l]!==t:Dt.call(u,l)}function xP(l,u){var m=this.__data__;return this.size+=this.has(l)?0:1,m[l]=iu&&u===t?c:u,this}sa.prototype.clear=mP,sa.prototype.delete=gP,sa.prototype.get=vP,sa.prototype.has=yP,sa.prototype.set=xP;function Ss(l){var u=-1,m=l==null?0:l.length;for(this.clear();++u<m;){var M=l[u];this.set(M[0],M[1])}}function _P(){this.__data__=[],this.size=0}function wP(l){var u=this.__data__,m=_d(u,l);if(m<0)return!1;var M=u.length-1;return m==M?u.pop():hd.call(u,m,1),--this.size,!0}function SP(l){var u=this.__data__,m=_d(u,l);return m<0?t:u[m][1]}function MP(l){return _d(this.__data__,l)>-1}function bP(l,u){var m=this.__data__,M=_d(m,l);return M<0?(++this.size,m.push([l,u])):m[M][1]=u,this}Ss.prototype.clear=_P,Ss.prototype.delete=wP,Ss.prototype.get=SP,Ss.prototype.has=MP,Ss.prototype.set=bP;function Ms(l){var u=-1,m=l==null?0:l.length;for(this.clear();++u<m;){var M=l[u];this.set(M[0],M[1])}}function TP(){this.size=0,this.__data__={hash:new sa,map:new(tu||Ss),string:new sa}}function EP(l){var u=Id(this,l).delete(l);return this.size-=u?1:0,u}function AP(l){return Id(this,l).get(l)}function CP(l){return Id(this,l).has(l)}function RP(l,u){var m=Id(this,l),M=m.size;return m.set(l,u),this.size+=m.size==M?0:1,this}Ms.prototype.clear=TP,Ms.prototype.delete=EP,Ms.prototype.get=AP,Ms.prototype.has=CP,Ms.prototype.set=RP;function oa(l){var u=-1,m=l==null?0:l.length;for(this.__data__=new Ms;++u<m;)this.add(l[u])}function PP(l){return this.__data__.set(l,c),this}function LP(l){return this.__data__.has(l)}oa.prototype.add=oa.prototype.push=PP,oa.prototype.has=LP;function Rr(l){var u=this.__data__=new Ss(l);this.size=u.size}function IP(){this.__data__=new Ss,this.size=0}function FP(l){var u=this.__data__,m=u.delete(l);return this.size=u.size,m}function DP(l){return this.__data__.get(l)}function NP(l){return this.__data__.has(l)}function OP(l,u){var m=this.__data__;if(m instanceof Ss){var M=m.__data__;if(!tu||M.length<r-1)return M.push([l,u]),this.size=++m.size,this;m=this.__data__=new Ms(M)}return m.set(l,u),this.size=m.size,this}Rr.prototype.clear=IP,Rr.prototype.delete=FP,Rr.prototype.get=DP,Rr.prototype.has=NP,Rr.prototype.set=OP;function O1(l,u){var m=tt(l),M=!m&&fa(l),R=!m&&!M&&mo(l),L=!m&&!M&&!R&&fl(l),B=m||M||R||L,G=B?dg(l.length,j3):[],X=G.length;for(var de in l)(u||Dt.call(l,de))&&!(B&&(de=="length"||R&&(de=="offset"||de=="parent")||L&&(de=="buffer"||de=="byteLength"||de=="byteOffset")||As(de,X)))&&G.push(de);return G}function k1(l){var u=l.length;return u?l[Rg(0,u-1)]:t}function kP(l,u){return Fd(Mi(l),aa(u,0,l.length))}function BP(l){return Fd(Mi(l))}function xg(l,u,m){(m!==t&&!Pr(l[u],m)||m===t&&!(u in l))&&bs(l,u,m)}function su(l,u,m){var M=l[u];(!(Dt.call(l,u)&&Pr(M,m))||m===t&&!(u in l))&&bs(l,u,m)}function _d(l,u){for(var m=l.length;m--;)if(Pr(l[m][0],u))return m;return-1}function zP(l,u,m,M){return uo(l,function(R,L,B){u(M,R,m(R),B)}),M}function B1(l,u){return l&&es(u,Ln(u),l)}function UP(l,u){return l&&es(u,Ti(u),l)}function bs(l,u,m){u=="__proto__"&&pd?pd(l,u,{configurable:!0,enumerable:!0,value:m,writable:!0}):l[u]=m}function _g(l,u){for(var m=-1,M=u.length,R=ee(M),L=l==null;++m<M;)R[m]=L?t:e0(l,u[m]);return R}function aa(l,u,m){return l===l&&(m!==t&&(l=l<=m?l:m),u!==t&&(l=l>=u?l:u)),l}function ur(l,u,m,M,R,L){var B,G=u&d,X=u&p,de=u&g;if(m&&(B=R?m(l,M,R,L):m(l)),B!==t)return B;if(!Jt(l))return l;var pe=tt(l);if(pe){if(B=CL(l),!G)return Mi(l,B)}else{var ye=Jn(l),Le=ye==nt||ye==Ye;if(mo(l))return lw(l,G);if(ye==Qt||ye==Be||Le&&!R){if(B=X||Le?{}:Aw(l),!G)return X?vL(l,UP(B,l)):gL(l,B1(B,l))}else{if(!zt[ye])return R?l:{};B=RL(l,ye,G)}}L||(L=new Rr);var ze=L.get(l);if(ze)return ze;L.set(l,B),nS(l)?l.forEach(function(je){B.add(ur(je,u,m,je,l,L))}):eS(l)&&l.forEach(function(je,lt){B.set(lt,ur(je,u,m,lt,l,L))});var $e=de?X?Ug:zg:X?Ti:Ln,ot=pe?t:$e(l);return ar(ot||l,function(je,lt){ot&&(lt=je,je=l[lt]),su(B,lt,ur(je,u,m,lt,l,L))}),B}function HP(l){var u=Ln(l);return function(m){return z1(m,l,u)}}function z1(l,u,m){var M=m.length;if(l==null)return!M;for(l=Bt(l);M--;){var R=m[M],L=u[R],B=l[R];if(B===t&&!(R in l)||!L(B))return!1}return!0}function U1(l,u,m){if(typeof l!="function")throw new lr(o);return du(function(){l.apply(t,m)},u)}function ou(l,u,m,M){var R=-1,L=id,B=!0,G=l.length,X=[],de=u.length;if(!G)return X;m&&(u=Yt(u,Bi(m))),M?(L=og,B=!1):u.length>=r&&(L=Jc,B=!1,u=new oa(u));e:for(;++R<G;){var pe=l[R],ye=m==null?pe:m(pe);if(pe=M||pe!==0?pe:0,B&&ye===ye){for(var Le=de;Le--;)if(u[Le]===ye)continue e;X.push(pe)}else L(u,ye,M)||X.push(pe)}return X}var uo=hw(Jr),H1=hw(Sg,!0);function GP(l,u){var m=!0;return uo(l,function(M,R,L){return m=!!u(M,R,L),m}),m}function wd(l,u,m){for(var M=-1,R=l.length;++M<R;){var L=l[M],B=u(L);if(B!=null&&(G===t?B===B&&!Ui(B):m(B,G)))var G=B,X=L}return X}function WP(l,u,m,M){var R=l.length;for(m=rt(m),m<0&&(m=-m>R?0:R+m),M=M===t||M>R?R:rt(M),M<0&&(M+=R),M=m>M?0:rS(M);m<M;)l[m++]=u;return l}function G1(l,u){var m=[];return uo(l,function(M,R,L){u(M,R,L)&&m.push(M)}),m}function Gn(l,u,m,M,R){var L=-1,B=l.length;for(m||(m=LL),R||(R=[]);++L<B;){var G=l[L];u>0&&m(G)?u>1?Gn(G,u-1,m,M,R):ao(R,G):M||(R[R.length]=G)}return R}var wg=pw(),W1=pw(!0);function Jr(l,u){return l&&wg(l,u,Ln)}function Sg(l,u){return l&&W1(l,u,Ln)}function Sd(l,u){return oo(u,function(m){return Cs(l[m])})}function la(l,u){u=ho(u,l);for(var m=0,M=u.length;l!=null&&m<M;)l=l[ts(u[m++])];return m&&m==M?l:t}function V1(l,u,m){var M=u(l);return tt(l)?M:ao(M,m(l))}function ai(l){return l==null?l===t?fe:wn:ra&&ra in Bt(l)?TL(l):BL(l)}function Mg(l,u){return l>u}function VP(l,u){return l!=null&&Dt.call(l,u)}function $P(l,u){return l!=null&&u in Bt(l)}function jP(l,u,m){return l>=Qn(u,m)&&l<Mn(u,m)}function bg(l,u,m){for(var M=m?og:id,R=l[0].length,L=l.length,B=L,G=ee(L),X=1/0,de=[];B--;){var pe=l[B];B&&u&&(pe=Yt(pe,Bi(u))),X=Qn(pe.length,X),G[B]=!m&&(u||R>=120&&pe.length>=120)?new oa(B&&pe):t}pe=l[0];var ye=-1,Le=G[0];e:for(;++ye<R&&de.length<X;){var ze=pe[ye],$e=u?u(ze):ze;if(ze=m||ze!==0?ze:0,!(Le?Jc(Le,$e):M(de,$e,m))){for(B=L;--B;){var ot=G[B];if(!(ot?Jc(ot,$e):M(l[B],$e,m)))continue e}Le&&Le.push($e),de.push(ze)}}return de}function XP(l,u,m,M){return Jr(l,function(R,L,B){u(M,m(R),L,B)}),M}function au(l,u,m){u=ho(u,l),l=Lw(l,u);var M=l==null?l:l[ts(dr(u))];return M==null?t:ki(M,l,m)}function $1(l){return on(l)&&ai(l)==Be}function qP(l){return on(l)&&ai(l)==Re}function YP(l){return on(l)&&ai(l)==Xe}function lu(l,u,m,M,R){return l===u?!0:l==null||u==null||!on(l)&&!on(u)?l!==l&&u!==u:KP(l,u,m,M,lu,R)}function KP(l,u,m,M,R,L){var B=tt(l),G=tt(u),X=B?ce:Jn(l),de=G?ce:Jn(u);X=X==Be?Qt:X,de=de==Be?Qt:de;var pe=X==Qt,ye=de==Qt,Le=X==de;if(Le&&mo(l)){if(!mo(u))return!1;B=!0,pe=!1}if(Le&&!pe)return L||(L=new Rr),B||fl(l)?bw(l,u,m,M,R,L):ML(l,u,X,m,M,R,L);if(!(m&_)){var ze=pe&&Dt.call(l,"__wrapped__"),$e=ye&&Dt.call(u,"__wrapped__");if(ze||$e){var ot=ze?l.value():l,je=$e?u.value():u;return L||(L=new Rr),R(ot,je,m,M,L)}}return Le?(L||(L=new Rr),bL(l,u,m,M,R,L)):!1}function ZP(l){return on(l)&&Jn(l)==Tt}function Tg(l,u,m,M){var R=m.length,L=R,B=!M;if(l==null)return!L;for(l=Bt(l);R--;){var G=m[R];if(B&&G[2]?G[1]!==l[G[0]]:!(G[0]in l))return!1}for(;++R<L;){G=m[R];var X=G[0],de=l[X],pe=G[1];if(B&&G[2]){if(de===t&&!(X in l))return!1}else{var ye=new Rr;if(M)var Le=M(de,pe,X,l,u,ye);if(!(Le===t?lu(pe,de,_|y,M,ye):Le))return!1}}return!0}function j1(l){if(!Jt(l)||FL(l))return!1;var u=Cs(l)?Z3:xt;return u.test(ua(l))}function QP(l){return on(l)&&ai(l)==Pn}function JP(l){return on(l)&&Jn(l)==Xt}function eL(l){return on(l)&&zd(l.length)&&!!Gt[ai(l)]}function X1(l){return typeof l=="function"?l:l==null?Ei:typeof l=="object"?tt(l)?K1(l[0],l[1]):Y1(l):mS(l)}function Eg(l){if(!fu(l))return iP(l);var u=[];for(var m in Bt(l))Dt.call(l,m)&&m!="constructor"&&u.push(m);return u}function tL(l){if(!Jt(l))return kL(l);var u=fu(l),m=[];for(var M in l)M=="constructor"&&(u||!Dt.call(l,M))||m.push(M);return m}function Ag(l,u){return l<u}function q1(l,u){var m=-1,M=bi(l)?ee(l.length):[];return uo(l,function(R,L,B){M[++m]=u(R,L,B)}),M}function Y1(l){var u=Gg(l);return u.length==1&&u[0][2]?Rw(u[0][0],u[0][1]):function(m){return m===l||Tg(m,l,u)}}function K1(l,u){return Vg(l)&&Cw(u)?Rw(ts(l),u):function(m){var M=e0(m,l);return M===t&&M===u?t0(m,l):lu(u,M,_|y)}}function Md(l,u,m,M,R){l!==u&&wg(u,function(L,B){if(R||(R=new Rr),Jt(L))nL(l,u,B,m,Md,M,R);else{var G=M?M(jg(l,B),L,B+"",l,u,R):t;G===t&&(G=L),xg(l,B,G)}},Ti)}function nL(l,u,m,M,R,L,B){var G=jg(l,m),X=jg(u,m),de=B.get(X);if(de){xg(l,m,de);return}var pe=L?L(G,X,m+"",l,u,B):t,ye=pe===t;if(ye){var Le=tt(X),ze=!Le&&mo(X),$e=!Le&&!ze&&fl(X);pe=X,Le||ze||$e?tt(G)?pe=G:un(G)?pe=Mi(G):ze?(ye=!1,pe=lw(X,!0)):$e?(ye=!1,pe=cw(X,!0)):pe=[]:hu(X)||fa(X)?(pe=G,fa(G)?pe=sS(G):(!Jt(G)||Cs(G))&&(pe=Aw(X))):ye=!1}ye&&(B.set(X,pe),R(pe,X,M,L,B),B.delete(X)),xg(l,m,pe)}function Z1(l,u){var m=l.length;if(!!m)return u+=u<0?m:0,As(u,m)?l[u]:t}function Q1(l,u,m){u.length?u=Yt(u,function(L){return tt(L)?function(B){return la(B,L.length===1?L[0]:L)}:L}):u=[Ei];var M=-1;u=Yt(u,Bi(Ve()));var R=q1(l,function(L,B,G){var X=Yt(u,function(de){return de(L)});return{criteria:X,index:++M,value:L}});return R3(R,function(L,B){return mL(L,B,m)})}function iL(l,u){return J1(l,u,function(m,M){return t0(l,M)})}function J1(l,u,m){for(var M=-1,R=u.length,L={};++M<R;){var B=u[M],G=la(l,B);m(G,B)&&cu(L,ho(B,l),G)}return L}function rL(l){return function(u){return la(u,l)}}function Cg(l,u,m,M){var R=M?C3:el,L=-1,B=u.length,G=l;for(l===u&&(u=Mi(u)),m&&(G=Yt(l,Bi(m)));++L<B;)for(var X=0,de=u[L],pe=m?m(de):de;(X=R(G,pe,X,M))>-1;)G!==l&&hd.call(G,X,1),hd.call(l,X,1);return l}function ew(l,u){for(var m=l?u.length:0,M=m-1;m--;){var R=u[m];if(m==M||R!==L){var L=R;As(R)?hd.call(l,R,1):Ig(l,R)}}return l}function Rg(l,u){return l+gd(D1()*(u-l+1))}function sL(l,u,m,M){for(var R=-1,L=Mn(md((u-l)/(m||1)),0),B=ee(L);L--;)B[M?L:++R]=l,l+=m;return B}function Pg(l,u){var m="";if(!l||u<1||u>$)return m;do u%2&&(m+=l),u=gd(u/2),u&&(l+=l);while(u);return m}function at(l,u){return Xg(Pw(l,u,Ei),l+"")}function oL(l){return k1(dl(l))}function aL(l,u){var m=dl(l);return Fd(m,aa(u,0,m.length))}function cu(l,u,m,M){if(!Jt(l))return l;u=ho(u,l);for(var R=-1,L=u.length,B=L-1,G=l;G!=null&&++R<L;){var X=ts(u[R]),de=m;if(X==="__proto__"||X==="constructor"||X==="prototype")return l;if(R!=B){var pe=G[X];de=M?M(pe,X,G):t,de===t&&(de=Jt(pe)?pe:As(u[R+1])?[]:{})}su(G,X,de),G=G[X]}return l}var tw=vd?function(l,u){return vd.set(l,u),l}:Ei,lL=pd?function(l,u){return pd(l,"toString",{configurable:!0,enumerable:!1,value:i0(u),writable:!0})}:Ei;function cL(l){return Fd(dl(l))}function fr(l,u,m){var M=-1,R=l.length;u<0&&(u=-u>R?0:R+u),m=m>R?R:m,m<0&&(m+=R),R=u>m?0:m-u>>>0,u>>>=0;for(var L=ee(R);++M<R;)L[M]=l[M+u];return L}function uL(l,u){var m;return uo(l,function(M,R,L){return m=u(M,R,L),!m}),!!m}function bd(l,u,m){var M=0,R=l==null?M:l.length;if(typeof u=="number"&&u===u&&R<=we){for(;M<R;){var L=M+R>>>1,B=l[L];B!==null&&!Ui(B)&&(m?B<=u:B<u)?M=L+1:R=L}return R}return Lg(l,u,Ei,m)}function Lg(l,u,m,M){var R=0,L=l==null?0:l.length;if(L===0)return 0;u=m(u);for(var B=u!==u,G=u===null,X=Ui(u),de=u===t;R<L;){var pe=gd((R+L)/2),ye=m(l[pe]),Le=ye!==t,ze=ye===null,$e=ye===ye,ot=Ui(ye);if(B)var je=M||$e;else de?je=$e&&(M||Le):G?je=$e&&Le&&(M||!ze):X?je=$e&&Le&&!ze&&(M||!ot):ze||ot?je=!1:je=M?ye<=u:ye<u;je?R=pe+1:L=pe}return Qn(L,me)}function nw(l,u){for(var m=-1,M=l.length,R=0,L=[];++m<M;){var B=l[m],G=u?u(B):B;if(!m||!Pr(G,X)){var X=G;L[R++]=B===0?0:B}}return L}function iw(l){return typeof l=="number"?l:Ui(l)?Z:+l}function zi(l){if(typeof l=="string")return l;if(tt(l))return Yt(l,zi)+"";if(Ui(l))return N1?N1.call(l):"";var u=l+"";return u=="0"&&1/l==-ae?"-0":u}function fo(l,u,m){var M=-1,R=id,L=l.length,B=!0,G=[],X=G;if(m)B=!1,R=og;else if(L>=r){var de=u?null:wL(l);if(de)return sd(de);B=!1,R=Jc,X=new oa}else X=u?[]:G;e:for(;++M<L;){var pe=l[M],ye=u?u(pe):pe;if(pe=m||pe!==0?pe:0,B&&ye===ye){for(var Le=X.length;Le--;)if(X[Le]===ye)continue e;u&&X.push(ye),G.push(pe)}else R(X,ye,m)||(X!==G&&X.push(ye),G.push(pe))}return G}function Ig(l,u){return u=ho(u,l),l=Lw(l,u),l==null||delete l[ts(dr(u))]}function rw(l,u,m,M){return cu(l,u,m(la(l,u)),M)}function Td(l,u,m,M){for(var R=l.length,L=M?R:-1;(M?L--:++L<R)&&u(l[L],L,l););return m?fr(l,M?0:L,M?L+1:R):fr(l,M?L+1:0,M?R:L)}function sw(l,u){var m=l;return m instanceof ht&&(m=m.value()),ag(u,function(M,R){return R.func.apply(R.thisArg,ao([M],R.args))},m)}function Fg(l,u,m){var M=l.length;if(M<2)return M?fo(l[0]):[];for(var R=-1,L=ee(M);++R<M;)for(var B=l[R],G=-1;++G<M;)G!=R&&(L[R]=ou(L[R]||B,l[G],u,m));return fo(Gn(L,1),u,m)}function ow(l,u,m){for(var M=-1,R=l.length,L=u.length,B={};++M<R;){var G=M<L?u[M]:t;m(B,l[M],G)}return B}function Dg(l){return un(l)?l:[]}function Ng(l){return typeof l=="function"?l:Ei}function ho(l,u){return tt(l)?l:Vg(l,u)?[l]:Nw(It(l))}var fL=at;function po(l,u,m){var M=l.length;return m=m===t?M:m,!u&&m>=M?l:fr(l,u,m)}var aw=Q3||function(l){return Hn.clearTimeout(l)};function lw(l,u){if(u)return l.slice();var m=l.length,M=R1?R1(m):new l.constructor(m);return l.copy(M),M}function Og(l){var u=new l.constructor(l.byteLength);return new fd(u).set(new fd(l)),u}function dL(l,u){var m=u?Og(l.buffer):l.buffer;return new l.constructor(m,l.byteOffset,l.byteLength)}function hL(l){var u=new l.constructor(l.source,it.exec(l));return u.lastIndex=l.lastIndex,u}function pL(l){return ru?Bt(ru.call(l)):{}}function cw(l,u){var m=u?Og(l.buffer):l.buffer;return new l.constructor(m,l.byteOffset,l.length)}function uw(l,u){if(l!==u){var m=l!==t,M=l===null,R=l===l,L=Ui(l),B=u!==t,G=u===null,X=u===u,de=Ui(u);if(!G&&!de&&!L&&l>u||L&&B&&X&&!G&&!de||M&&B&&X||!m&&X||!R)return 1;if(!M&&!L&&!de&&l<u||de&&m&&R&&!M&&!L||G&&m&&R||!B&&R||!X)return-1}return 0}function mL(l,u,m){for(var M=-1,R=l.criteria,L=u.criteria,B=R.length,G=m.length;++M<B;){var X=uw(R[M],L[M]);if(X){if(M>=G)return X;var de=m[M];return X*(de=="desc"?-1:1)}}return l.index-u.index}function fw(l,u,m,M){for(var R=-1,L=l.length,B=m.length,G=-1,X=u.length,de=Mn(L-B,0),pe=ee(X+de),ye=!M;++G<X;)pe[G]=u[G];for(;++R<B;)(ye||R<L)&&(pe[m[R]]=l[R]);for(;de--;)pe[G++]=l[R++];return pe}function dw(l,u,m,M){for(var R=-1,L=l.length,B=-1,G=m.length,X=-1,de=u.length,pe=Mn(L-G,0),ye=ee(pe+de),Le=!M;++R<pe;)ye[R]=l[R];for(var ze=R;++X<de;)ye[ze+X]=u[X];for(;++B<G;)(Le||R<L)&&(ye[ze+m[B]]=l[R++]);return ye}function Mi(l,u){var m=-1,M=l.length;for(u||(u=ee(M));++m<M;)u[m]=l[m];return u}function es(l,u,m,M){var R=!m;m||(m={});for(var L=-1,B=u.length;++L<B;){var G=u[L],X=M?M(m[G],l[G],G,m,l):t;X===t&&(X=l[G]),R?bs(m,G,X):su(m,G,X)}return m}function gL(l,u){return es(l,Wg(l),u)}function vL(l,u){return es(l,Tw(l),u)}function Ed(l,u){return function(m,M){var R=tt(m)?S3:zP,L=u?u():{};return R(m,l,Ve(M,2),L)}}function ll(l){return at(function(u,m){var M=-1,R=m.length,L=R>1?m[R-1]:t,B=R>2?m[2]:t;for(L=l.length>3&&typeof L=="function"?(R--,L):t,B&&li(m[0],m[1],B)&&(L=R<3?t:L,R=1),u=Bt(u);++M<R;){var G=m[M];G&&l(u,G,M,L)}return u})}function hw(l,u){return function(m,M){if(m==null)return m;if(!bi(m))return l(m,M);for(var R=m.length,L=u?R:-1,B=Bt(m);(u?L--:++L<R)&&M(B[L],L,B)!==!1;);return m}}function pw(l){return function(u,m,M){for(var R=-1,L=Bt(u),B=M(u),G=B.length;G--;){var X=B[l?G:++R];if(m(L[X],X,L)===!1)break}return u}}function yL(l,u,m){var M=u&x,R=uu(l);function L(){var B=this&&this!==Hn&&this instanceof L?R:l;return B.apply(M?m:this,arguments)}return L}function mw(l){return function(u){u=It(u);var m=tl(u)?Cr(u):t,M=m?m[0]:u.charAt(0),R=m?po(m,1).join(""):u.slice(1);return M[l]()+R}}function cl(l){return function(u){return ag(hS(dS(u).replace(l3,"")),l,"")}}function uu(l){return function(){var u=arguments;switch(u.length){case 0:return new l;case 1:return new l(u[0]);case 2:return new l(u[0],u[1]);case 3:return new l(u[0],u[1],u[2]);case 4:return new l(u[0],u[1],u[2],u[3]);case 5:return new l(u[0],u[1],u[2],u[3],u[4]);case 6:return new l(u[0],u[1],u[2],u[3],u[4],u[5]);case 7:return new l(u[0],u[1],u[2],u[3],u[4],u[5],u[6])}var m=al(l.prototype),M=l.apply(m,u);return Jt(M)?M:m}}function xL(l,u,m){var M=uu(l);function R(){for(var L=arguments.length,B=ee(L),G=L,X=ul(R);G--;)B[G]=arguments[G];var de=L<3&&B[0]!==X&&B[L-1]!==X?[]:lo(B,X);if(L-=de.length,L<m)return _w(l,u,Ad,R.placeholder,t,B,de,t,t,m-L);var pe=this&&this!==Hn&&this instanceof R?M:l;return ki(pe,this,B)}return R}function gw(l){return function(u,m,M){var R=Bt(u);if(!bi(u)){var L=Ve(m,3);u=Ln(u),m=function(G){return L(R[G],G,R)}}var B=l(u,m,M);return B>-1?R[L?u[B]:B]:t}}function vw(l){return Es(function(u){var m=u.length,M=m,R=cr.prototype.thru;for(l&&u.reverse();M--;){var L=u[M];if(typeof L!="function")throw new lr(o);if(R&&!B&&Ld(L)=="wrapper")var B=new cr([],!0)}for(M=B?M:m;++M<m;){L=u[M];var G=Ld(L),X=G=="wrapper"?Hg(L):t;X&&$g(X[0])&&X[1]==(C|S|b|A)&&!X[4].length&&X[9]==1?B=B[Ld(X[0])].apply(B,X[3]):B=L.length==1&&$g(L)?B[G]():B.thru(L)}return function(){var de=arguments,pe=de[0];if(B&&de.length==1&&tt(pe))return B.plant(pe).value();for(var ye=0,Le=m?u[ye].apply(this,de):pe;++ye<m;)Le=u[ye].call(this,Le);return Le}})}function Ad(l,u,m,M,R,L,B,G,X,de){var pe=u&C,ye=u&x,Le=u&v,ze=u&(S|E),$e=u&F,ot=Le?t:uu(l);function je(){for(var lt=arguments.length,vt=ee(lt),Hi=lt;Hi--;)vt[Hi]=arguments[Hi];if(ze)var ci=ul(je),Gi=L3(vt,ci);if(M&&(vt=fw(vt,M,R,ze)),L&&(vt=dw(vt,L,B,ze)),lt-=Gi,ze&&lt<de){var fn=lo(vt,ci);return _w(l,u,Ad,je.placeholder,m,vt,fn,G,X,de-lt)}var Lr=ye?m:this,Ps=Le?Lr[l]:l;return lt=vt.length,G?vt=zL(vt,G):$e&&lt>1&&vt.reverse(),pe&&X<lt&&(vt.length=X),this&&this!==Hn&&this instanceof je&&(Ps=ot||uu(Ps)),Ps.apply(Lr,vt)}return je}function yw(l,u){return function(m,M){return XP(m,l,u(M),{})}}function Cd(l,u){return function(m,M){var R;if(m===t&&M===t)return u;if(m!==t&&(R=m),M!==t){if(R===t)return M;typeof m=="string"||typeof M=="string"?(m=zi(m),M=zi(M)):(m=iw(m),M=iw(M)),R=l(m,M)}return R}}function kg(l){return Es(function(u){return u=Yt(u,Bi(Ve())),at(function(m){var M=this;return l(u,function(R){return ki(R,M,m)})})})}function Rd(l,u){u=u===t?" ":zi(u);var m=u.length;if(m<2)return m?Pg(u,l):u;var M=Pg(u,md(l/nl(u)));return tl(u)?po(Cr(M),0,l).join(""):M.slice(0,l)}function _L(l,u,m,M){var R=u&x,L=uu(l);function B(){for(var G=-1,X=arguments.length,de=-1,pe=M.length,ye=ee(pe+X),Le=this&&this!==Hn&&this instanceof B?L:l;++de<pe;)ye[de]=M[de];for(;X--;)ye[de++]=arguments[++G];return ki(Le,R?m:this,ye)}return B}function xw(l){return function(u,m,M){return M&&typeof M!="number"&&li(u,m,M)&&(m=M=t),u=Rs(u),m===t?(m=u,u=0):m=Rs(m),M=M===t?u<m?1:-1:Rs(M),sL(u,m,M,l)}}function Pd(l){return function(u,m){return typeof u=="string"&&typeof m=="string"||(u=hr(u),m=hr(m)),l(u,m)}}function _w(l,u,m,M,R,L,B,G,X,de){var pe=u&S,ye=pe?B:t,Le=pe?t:B,ze=pe?L:t,$e=pe?t:L;u|=pe?b:T,u&=~(pe?T:b),u&w||(u&=~(x|v));var ot=[l,u,R,ze,ye,$e,Le,G,X,de],je=m.apply(t,ot);return $g(l)&&Iw(je,ot),je.placeholder=M,Fw(je,l,u)}function Bg(l){var u=Sn[l];return function(m,M){if(m=hr(m),M=M==null?0:Qn(rt(M),292),M&&F1(m)){var R=(It(m)+"e").split("e"),L=u(R[0]+"e"+(+R[1]+M));return R=(It(L)+"e").split("e"),+(R[0]+"e"+(+R[1]-M))}return u(m)}}var wL=sl&&1/sd(new sl([,-0]))[1]==ae?function(l){return new sl(l)}:o0;function ww(l){return function(u){var m=Jn(u);return m==Tt?pg(u):m==Xt?B3(u):P3(u,l(u))}}function Ts(l,u,m,M,R,L,B,G){var X=u&v;if(!X&&typeof l!="function")throw new lr(o);var de=M?M.length:0;if(de||(u&=~(b|T),M=R=t),B=B===t?B:Mn(rt(B),0),G=G===t?G:rt(G),de-=R?R.length:0,u&T){var pe=M,ye=R;M=R=t}var Le=X?t:Hg(l),ze=[l,u,m,M,R,pe,ye,L,B,G];if(Le&&OL(ze,Le),l=ze[0],u=ze[1],m=ze[2],M=ze[3],R=ze[4],G=ze[9]=ze[9]===t?X?0:l.length:Mn(ze[9]-de,0),!G&&u&(S|E)&&(u&=~(S|E)),!u||u==x)var $e=yL(l,u,m);else u==S||u==E?$e=xL(l,u,G):(u==b||u==(x|b))&&!R.length?$e=_L(l,u,m,M):$e=Ad.apply(t,ze);var ot=Le?tw:Iw;return Fw(ot($e,ze),l,u)}function Sw(l,u,m,M){return l===t||Pr(l,rl[m])&&!Dt.call(M,m)?u:l}function Mw(l,u,m,M,R,L){return Jt(l)&&Jt(u)&&(L.set(u,l),Md(l,u,t,Mw,L),L.delete(u)),l}function SL(l){return hu(l)?t:l}function bw(l,u,m,M,R,L){var B=m&_,G=l.length,X=u.length;if(G!=X&&!(B&&X>G))return!1;var de=L.get(l),pe=L.get(u);if(de&&pe)return de==u&&pe==l;var ye=-1,Le=!0,ze=m&y?new oa:t;for(L.set(l,u),L.set(u,l);++ye<G;){var $e=l[ye],ot=u[ye];if(M)var je=B?M(ot,$e,ye,u,l,L):M($e,ot,ye,l,u,L);if(je!==t){if(je)continue;Le=!1;break}if(ze){if(!lg(u,function(lt,vt){if(!Jc(ze,vt)&&($e===lt||R($e,lt,m,M,L)))return ze.push(vt)})){Le=!1;break}}else if(!($e===ot||R($e,ot,m,M,L))){Le=!1;break}}return L.delete(l),L.delete(u),Le}function ML(l,u,m,M,R,L,B){switch(m){case Ge:if(l.byteLength!=u.byteLength||l.byteOffset!=u.byteOffset)return!1;l=l.buffer,u=u.buffer;case Re:return!(l.byteLength!=u.byteLength||!L(new fd(l),new fd(u)));case qe:case Xe:case jt:return Pr(+l,+u);case dt:return l.name==u.name&&l.message==u.message;case Pn:case k:return l==u+"";case Tt:var G=pg;case Xt:var X=M&_;if(G||(G=sd),l.size!=u.size&&!X)return!1;var de=B.get(l);if(de)return de==u;M|=y,B.set(l,u);var pe=bw(G(l),G(u),M,R,L,B);return B.delete(l),pe;case I:if(ru)return ru.call(l)==ru.call(u)}return!1}function bL(l,u,m,M,R,L){var B=m&_,G=zg(l),X=G.length,de=zg(u),pe=de.length;if(X!=pe&&!B)return!1;for(var ye=X;ye--;){var Le=G[ye];if(!(B?Le in u:Dt.call(u,Le)))return!1}var ze=L.get(l),$e=L.get(u);if(ze&&$e)return ze==u&&$e==l;var ot=!0;L.set(l,u),L.set(u,l);for(var je=B;++ye<X;){Le=G[ye];var lt=l[Le],vt=u[Le];if(M)var Hi=B?M(vt,lt,Le,u,l,L):M(lt,vt,Le,l,u,L);if(!(Hi===t?lt===vt||R(lt,vt,m,M,L):Hi)){ot=!1;break}je||(je=Le=="constructor")}if(ot&&!je){var ci=l.constructor,Gi=u.constructor;ci!=Gi&&"constructor"in l&&"constructor"in u&&!(typeof ci=="function"&&ci instanceof ci&&typeof Gi=="function"&&Gi instanceof Gi)&&(ot=!1)}return L.delete(l),L.delete(u),ot}function Es(l){return Xg(Pw(l,t,zw),l+"")}function zg(l){return V1(l,Ln,Wg)}function Ug(l){return V1(l,Ti,Tw)}var Hg=vd?function(l){return vd.get(l)}:o0;function Ld(l){for(var u=l.name+"",m=ol[u],M=Dt.call(ol,u)?m.length:0;M--;){var R=m[M],L=R.func;if(L==null||L==l)return R.name}return u}function ul(l){var u=Dt.call(P,"placeholder")?P:l;return u.placeholder}function Ve(){var l=P.iteratee||r0;return l=l===r0?X1:l,arguments.length?l(arguments[0],arguments[1]):l}function Id(l,u){var m=l.__data__;return IL(u)?m[typeof u=="string"?"string":"hash"]:m.map}function Gg(l){for(var u=Ln(l),m=u.length;m--;){var M=u[m],R=l[M];u[m]=[M,R,Cw(R)]}return u}function ca(l,u){var m=N3(l,u);return j1(m)?m:t}function TL(l){var u=Dt.call(l,ra),m=l[ra];try{l[ra]=t;var M=!0}catch{}var R=cd.call(l);return M&&(u?l[ra]=m:delete l[ra]),R}var Wg=gg?function(l){return l==null?[]:(l=Bt(l),oo(gg(l),function(u){return L1.call(l,u)}))}:a0,Tw=gg?function(l){for(var u=[];l;)ao(u,Wg(l)),l=dd(l);return u}:a0,Jn=ai;(vg&&Jn(new vg(new ArrayBuffer(1)))!=Ge||tu&&Jn(new tu)!=Tt||yg&&Jn(yg.resolve())!=rn||sl&&Jn(new sl)!=Xt||nu&&Jn(new nu)!=xe)&&(Jn=function(l){var u=ai(l),m=u==Qt?l.constructor:t,M=m?ua(m):"";if(M)switch(M){case aP:return Ge;case lP:return Tt;case cP:return rn;case uP:return Xt;case fP:return xe}return u});function EL(l,u,m){for(var M=-1,R=m.length;++M<R;){var L=m[M],B=L.size;switch(L.type){case"drop":l+=B;break;case"dropRight":u-=B;break;case"take":u=Qn(u,l+B);break;case"takeRight":l=Mn(l,u-B);break}}return{start:l,end:u}}function AL(l){var u=l.match(oe);return u?u[1].split(te):[]}function Ew(l,u,m){u=ho(u,l);for(var M=-1,R=u.length,L=!1;++M<R;){var B=ts(u[M]);if(!(L=l!=null&&m(l,B)))break;l=l[B]}return L||++M!=R?L:(R=l==null?0:l.length,!!R&&zd(R)&&As(B,R)&&(tt(l)||fa(l)))}function CL(l){var u=l.length,m=new l.constructor(u);return u&&typeof l[0]=="string"&&Dt.call(l,"index")&&(m.index=l.index,m.input=l.input),m}function Aw(l){return typeof l.constructor=="function"&&!fu(l)?al(dd(l)):{}}function RL(l,u,m){var M=l.constructor;switch(u){case Re:return Og(l);case qe:case Xe:return new M(+l);case Ge:return dL(l,m);case D:case ve:case Ae:case Me:case H:case be:case Se:case We:case Pe:return cw(l,m);case Tt:return new M;case jt:case k:return new M(l);case Pn:return hL(l);case Xt:return new M;case I:return pL(l)}}function PL(l,u){var m=u.length;if(!m)return l;var M=m-1;return u[M]=(m>1?"& ":"")+u[M],u=u.join(m>2?", ":" "),l.replace(Q,`{
/* [wrapped with `+u+`] */
`)}function LL(l){return tt(l)||fa(l)||!!(I1&&l&&l[I1])}function As(l,u){var m=typeof l;return u=u==null?$:u,!!u&&(m=="number"||m!="symbol"&&ws.test(l))&&l>-1&&l%1==0&&l<u}function li(l,u,m){if(!Jt(m))return!1;var M=typeof u;return(M=="number"?bi(m)&&As(u,m.length):M=="string"&&u in m)?Pr(m[u],l):!1}function Vg(l,u){if(tt(l))return!1;var m=typeof l;return m=="number"||m=="symbol"||m=="boolean"||l==null||Ui(l)?!0:Yc.test(l)||!Zm.test(l)||u!=null&&l in Bt(u)}function IL(l){var u=typeof l;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?l!=="__proto__":l===null}function $g(l){var u=Ld(l),m=P[u];if(typeof m!="function"||!(u in ht.prototype))return!1;if(l===m)return!0;var M=Hg(m);return!!M&&l===M[0]}function FL(l){return!!C1&&C1 in l}var DL=ad?Cs:l0;function fu(l){var u=l&&l.constructor,m=typeof u=="function"&&u.prototype||rl;return l===m}function Cw(l){return l===l&&!Jt(l)}function Rw(l,u){return function(m){return m==null?!1:m[l]===u&&(u!==t||l in Bt(m))}}function NL(l){var u=kd(l,function(M){return m.size===f&&m.clear(),M}),m=u.cache;return u}function OL(l,u){var m=l[1],M=u[1],R=m|M,L=R<(x|v|C),B=M==C&&m==S||M==C&&m==A&&l[7].length<=u[8]||M==(C|A)&&u[7].length<=u[8]&&m==S;if(!(L||B))return l;M&x&&(l[2]=u[2],R|=m&x?0:w);var G=u[3];if(G){var X=l[3];l[3]=X?fw(X,G,u[4]):G,l[4]=X?lo(l[3],h):u[4]}return G=u[5],G&&(X=l[5],l[5]=X?dw(X,G,u[6]):G,l[6]=X?lo(l[5],h):u[6]),G=u[7],G&&(l[7]=G),M&C&&(l[8]=l[8]==null?u[8]:Qn(l[8],u[8])),l[9]==null&&(l[9]=u[9]),l[0]=u[0],l[1]=R,l}function kL(l){var u=[];if(l!=null)for(var m in Bt(l))u.push(m);return u}function BL(l){return cd.call(l)}function Pw(l,u,m){return u=Mn(u===t?l.length-1:u,0),function(){for(var M=arguments,R=-1,L=Mn(M.length-u,0),B=ee(L);++R<L;)B[R]=M[u+R];R=-1;for(var G=ee(u+1);++R<u;)G[R]=M[R];return G[u]=m(B),ki(l,this,G)}}function Lw(l,u){return u.length<2?l:la(l,fr(u,0,-1))}function zL(l,u){for(var m=l.length,M=Qn(u.length,m),R=Mi(l);M--;){var L=u[M];l[M]=As(L,m)?R[L]:t}return l}function jg(l,u){if(!(u==="constructor"&&typeof l[u]=="function")&&u!="__proto__")return l[u]}var Iw=Dw(tw),du=eP||function(l,u){return Hn.setTimeout(l,u)},Xg=Dw(lL);function Fw(l,u,m){var M=u+"";return Xg(l,PL(M,UL(AL(M),m)))}function Dw(l){var u=0,m=0;return function(){var M=rP(),R=re-(M-m);if(m=M,R>0){if(++u>=ne)return arguments[0]}else u=0;return l.apply(t,arguments)}}function Fd(l,u){var m=-1,M=l.length,R=M-1;for(u=u===t?M:u;++m<u;){var L=Rg(m,R),B=l[L];l[L]=l[m],l[m]=B}return l.length=u,l}var Nw=NL(function(l){var u=[];return l.charCodeAt(0)===46&&u.push(""),l.replace(td,function(m,M,R,L){u.push(R?L.replace(et,"$1"):M||m)}),u});function ts(l){if(typeof l=="string"||Ui(l))return l;var u=l+"";return u=="0"&&1/l==-ae?"-0":u}function ua(l){if(l!=null){try{return ld.call(l)}catch{}try{return l+""}catch{}}return""}function UL(l,u){return ar(De,function(m){var M="_."+m[0];u&m[1]&&!id(l,M)&&l.push(M)}),l.sort()}function Ow(l){if(l instanceof ht)return l.clone();var u=new cr(l.__wrapped__,l.__chain__);return u.__actions__=Mi(l.__actions__),u.__index__=l.__index__,u.__values__=l.__values__,u}function HL(l,u,m){(m?li(l,u,m):u===t)?u=1:u=Mn(rt(u),0);var M=l==null?0:l.length;if(!M||u<1)return[];for(var R=0,L=0,B=ee(md(M/u));R<M;)B[L++]=fr(l,R,R+=u);return B}function GL(l){for(var u=-1,m=l==null?0:l.length,M=0,R=[];++u<m;){var L=l[u];L&&(R[M++]=L)}return R}function WL(){var l=arguments.length;if(!l)return[];for(var u=ee(l-1),m=arguments[0],M=l;M--;)u[M-1]=arguments[M];return ao(tt(m)?Mi(m):[m],Gn(u,1))}var VL=at(function(l,u){return un(l)?ou(l,Gn(u,1,un,!0)):[]}),$L=at(function(l,u){var m=dr(u);return un(m)&&(m=t),un(l)?ou(l,Gn(u,1,un,!0),Ve(m,2)):[]}),jL=at(function(l,u){var m=dr(u);return un(m)&&(m=t),un(l)?ou(l,Gn(u,1,un,!0),t,m):[]});function XL(l,u,m){var M=l==null?0:l.length;return M?(u=m||u===t?1:rt(u),fr(l,u<0?0:u,M)):[]}function qL(l,u,m){var M=l==null?0:l.length;return M?(u=m||u===t?1:rt(u),u=M-u,fr(l,0,u<0?0:u)):[]}function YL(l,u){return l&&l.length?Td(l,Ve(u,3),!0,!0):[]}function KL(l,u){return l&&l.length?Td(l,Ve(u,3),!0):[]}function ZL(l,u,m,M){var R=l==null?0:l.length;return R?(m&&typeof m!="number"&&li(l,u,m)&&(m=0,M=R),WP(l,u,m,M)):[]}function kw(l,u,m){var M=l==null?0:l.length;if(!M)return-1;var R=m==null?0:rt(m);return R<0&&(R=Mn(M+R,0)),rd(l,Ve(u,3),R)}function Bw(l,u,m){var M=l==null?0:l.length;if(!M)return-1;var R=M-1;return m!==t&&(R=rt(m),R=m<0?Mn(M+R,0):Qn(R,M-1)),rd(l,Ve(u,3),R,!0)}function zw(l){var u=l==null?0:l.length;return u?Gn(l,1):[]}function QL(l){var u=l==null?0:l.length;return u?Gn(l,ae):[]}function JL(l,u){var m=l==null?0:l.length;return m?(u=u===t?1:rt(u),Gn(l,u)):[]}function eI(l){for(var u=-1,m=l==null?0:l.length,M={};++u<m;){var R=l[u];M[R[0]]=R[1]}return M}function Uw(l){return l&&l.length?l[0]:t}function tI(l,u,m){var M=l==null?0:l.length;if(!M)return-1;var R=m==null?0:rt(m);return R<0&&(R=Mn(M+R,0)),el(l,u,R)}function nI(l){var u=l==null?0:l.length;return u?fr(l,0,-1):[]}var iI=at(function(l){var u=Yt(l,Dg);return u.length&&u[0]===l[0]?bg(u):[]}),rI=at(function(l){var u=dr(l),m=Yt(l,Dg);return u===dr(m)?u=t:m.pop(),m.length&&m[0]===l[0]?bg(m,Ve(u,2)):[]}),sI=at(function(l){var u=dr(l),m=Yt(l,Dg);return u=typeof u=="function"?u:t,u&&m.pop(),m.length&&m[0]===l[0]?bg(m,t,u):[]});function oI(l,u){return l==null?"":nP.call(l,u)}function dr(l){var u=l==null?0:l.length;return u?l[u-1]:t}function aI(l,u,m){var M=l==null?0:l.length;if(!M)return-1;var R=M;return m!==t&&(R=rt(m),R=R<0?Mn(M+R,0):Qn(R,M-1)),u===u?U3(l,u,R):rd(l,_1,R,!0)}function lI(l,u){return l&&l.length?Z1(l,rt(u)):t}var cI=at(Hw);function Hw(l,u){return l&&l.length&&u&&u.length?Cg(l,u):l}function uI(l,u,m){return l&&l.length&&u&&u.length?Cg(l,u,Ve(m,2)):l}function fI(l,u,m){return l&&l.length&&u&&u.length?Cg(l,u,t,m):l}var dI=Es(function(l,u){var m=l==null?0:l.length,M=_g(l,u);return ew(l,Yt(u,function(R){return As(R,m)?+R:R}).sort(uw)),M});function hI(l,u){var m=[];if(!(l&&l.length))return m;var M=-1,R=[],L=l.length;for(u=Ve(u,3);++M<L;){var B=l[M];u(B,M,l)&&(m.push(B),R.push(M))}return ew(l,R),m}function qg(l){return l==null?l:oP.call(l)}function pI(l,u,m){var M=l==null?0:l.length;return M?(m&&typeof m!="number"&&li(l,u,m)?(u=0,m=M):(u=u==null?0:rt(u),m=m===t?M:rt(m)),fr(l,u,m)):[]}function mI(l,u){return bd(l,u)}function gI(l,u,m){return Lg(l,u,Ve(m,2))}function vI(l,u){var m=l==null?0:l.length;if(m){var M=bd(l,u);if(M<m&&Pr(l[M],u))return M}return-1}function yI(l,u){return bd(l,u,!0)}function xI(l,u,m){return Lg(l,u,Ve(m,2),!0)}function _I(l,u){var m=l==null?0:l.length;if(m){var M=bd(l,u,!0)-1;if(Pr(l[M],u))return M}return-1}function wI(l){return l&&l.length?nw(l):[]}function SI(l,u){return l&&l.length?nw(l,Ve(u,2)):[]}function MI(l){var u=l==null?0:l.length;return u?fr(l,1,u):[]}function bI(l,u,m){return l&&l.length?(u=m||u===t?1:rt(u),fr(l,0,u<0?0:u)):[]}function TI(l,u,m){var M=l==null?0:l.length;return M?(u=m||u===t?1:rt(u),u=M-u,fr(l,u<0?0:u,M)):[]}function EI(l,u){return l&&l.length?Td(l,Ve(u,3),!1,!0):[]}function AI(l,u){return l&&l.length?Td(l,Ve(u,3)):[]}var CI=at(function(l){return fo(Gn(l,1,un,!0))}),RI=at(function(l){var u=dr(l);return un(u)&&(u=t),fo(Gn(l,1,un,!0),Ve(u,2))}),PI=at(function(l){var u=dr(l);return u=typeof u=="function"?u:t,fo(Gn(l,1,un,!0),t,u)});function LI(l){return l&&l.length?fo(l):[]}function II(l,u){return l&&l.length?fo(l,Ve(u,2)):[]}function FI(l,u){return u=typeof u=="function"?u:t,l&&l.length?fo(l,t,u):[]}function Yg(l){if(!(l&&l.length))return[];var u=0;return l=oo(l,function(m){if(un(m))return u=Mn(m.length,u),!0}),dg(u,function(m){return Yt(l,cg(m))})}function Gw(l,u){if(!(l&&l.length))return[];var m=Yg(l);return u==null?m:Yt(m,function(M){return ki(u,t,M)})}var DI=at(function(l,u){return un(l)?ou(l,u):[]}),NI=at(function(l){return Fg(oo(l,un))}),OI=at(function(l){var u=dr(l);return un(u)&&(u=t),Fg(oo(l,un),Ve(u,2))}),kI=at(function(l){var u=dr(l);return u=typeof u=="function"?u:t,Fg(oo(l,un),t,u)}),BI=at(Yg);function zI(l,u){return ow(l||[],u||[],su)}function UI(l,u){return ow(l||[],u||[],cu)}var HI=at(function(l){var u=l.length,m=u>1?l[u-1]:t;return m=typeof m=="function"?(l.pop(),m):t,Gw(l,m)});function Ww(l){var u=P(l);return u.__chain__=!0,u}function GI(l,u){return u(l),l}function Dd(l,u){return u(l)}var WI=Es(function(l){var u=l.length,m=u?l[0]:0,M=this.__wrapped__,R=function(L){return _g(L,l)};return u>1||this.__actions__.length||!(M instanceof ht)||!As(m)?this.thru(R):(M=M.slice(m,+m+(u?1:0)),M.__actions__.push({func:Dd,args:[R],thisArg:t}),new cr(M,this.__chain__).thru(function(L){return u&&!L.length&&L.push(t),L}))});function VI(){return Ww(this)}function $I(){return new cr(this.value(),this.__chain__)}function jI(){this.__values__===t&&(this.__values__=iS(this.value()));var l=this.__index__>=this.__values__.length,u=l?t:this.__values__[this.__index__++];return{done:l,value:u}}function XI(){return this}function qI(l){for(var u,m=this;m instanceof xd;){var M=Ow(m);M.__index__=0,M.__values__=t,u?R.__wrapped__=M:u=M;var R=M;m=m.__wrapped__}return R.__wrapped__=l,u}function YI(){var l=this.__wrapped__;if(l instanceof ht){var u=l;return this.__actions__.length&&(u=new ht(this)),u=u.reverse(),u.__actions__.push({func:Dd,args:[qg],thisArg:t}),new cr(u,this.__chain__)}return this.thru(qg)}function KI(){return sw(this.__wrapped__,this.__actions__)}var ZI=Ed(function(l,u,m){Dt.call(l,m)?++l[m]:bs(l,m,1)});function QI(l,u,m){var M=tt(l)?y1:GP;return m&&li(l,u,m)&&(u=t),M(l,Ve(u,3))}function JI(l,u){var m=tt(l)?oo:G1;return m(l,Ve(u,3))}var eF=gw(kw),tF=gw(Bw);function nF(l,u){return Gn(Nd(l,u),1)}function iF(l,u){return Gn(Nd(l,u),ae)}function rF(l,u,m){return m=m===t?1:rt(m),Gn(Nd(l,u),m)}function Vw(l,u){var m=tt(l)?ar:uo;return m(l,Ve(u,3))}function $w(l,u){var m=tt(l)?M3:H1;return m(l,Ve(u,3))}var sF=Ed(function(l,u,m){Dt.call(l,m)?l[m].push(u):bs(l,m,[u])});function oF(l,u,m,M){l=bi(l)?l:dl(l),m=m&&!M?rt(m):0;var R=l.length;return m<0&&(m=Mn(R+m,0)),Ud(l)?m<=R&&l.indexOf(u,m)>-1:!!R&&el(l,u,m)>-1}var aF=at(function(l,u,m){var M=-1,R=typeof u=="function",L=bi(l)?ee(l.length):[];return uo(l,function(B){L[++M]=R?ki(u,B,m):au(B,u,m)}),L}),lF=Ed(function(l,u,m){bs(l,m,u)});function Nd(l,u){var m=tt(l)?Yt:q1;return m(l,Ve(u,3))}function cF(l,u,m,M){return l==null?[]:(tt(u)||(u=u==null?[]:[u]),m=M?t:m,tt(m)||(m=m==null?[]:[m]),Q1(l,u,m))}var uF=Ed(function(l,u,m){l[m?0:1].push(u)},function(){return[[],[]]});function fF(l,u,m){var M=tt(l)?ag:S1,R=arguments.length<3;return M(l,Ve(u,4),m,R,uo)}function dF(l,u,m){var M=tt(l)?b3:S1,R=arguments.length<3;return M(l,Ve(u,4),m,R,H1)}function hF(l,u){var m=tt(l)?oo:G1;return m(l,Bd(Ve(u,3)))}function pF(l){var u=tt(l)?k1:oL;return u(l)}function mF(l,u,m){(m?li(l,u,m):u===t)?u=1:u=rt(u);var M=tt(l)?kP:aL;return M(l,u)}function gF(l){var u=tt(l)?BP:cL;return u(l)}function vF(l){if(l==null)return 0;if(bi(l))return Ud(l)?nl(l):l.length;var u=Jn(l);return u==Tt||u==Xt?l.size:Eg(l).length}function yF(l,u,m){var M=tt(l)?lg:uL;return m&&li(l,u,m)&&(u=t),M(l,Ve(u,3))}var xF=at(function(l,u){if(l==null)return[];var m=u.length;return m>1&&li(l,u[0],u[1])?u=[]:m>2&&li(u[0],u[1],u[2])&&(u=[u[0]]),Q1(l,Gn(u,1),[])}),Od=J3||function(){return Hn.Date.now()};function _F(l,u){if(typeof u!="function")throw new lr(o);return l=rt(l),function(){if(--l<1)return u.apply(this,arguments)}}function jw(l,u,m){return u=m?t:u,u=l&&u==null?l.length:u,Ts(l,C,t,t,t,t,u)}function Xw(l,u){var m;if(typeof u!="function")throw new lr(o);return l=rt(l),function(){return--l>0&&(m=u.apply(this,arguments)),l<=1&&(u=t),m}}var Kg=at(function(l,u,m){var M=x;if(m.length){var R=lo(m,ul(Kg));M|=b}return Ts(l,M,u,m,R)}),qw=at(function(l,u,m){var M=x|v;if(m.length){var R=lo(m,ul(qw));M|=b}return Ts(u,M,l,m,R)});function Yw(l,u,m){u=m?t:u;var M=Ts(l,S,t,t,t,t,t,u);return M.placeholder=Yw.placeholder,M}function Kw(l,u,m){u=m?t:u;var M=Ts(l,E,t,t,t,t,t,u);return M.placeholder=Kw.placeholder,M}function Zw(l,u,m){var M,R,L,B,G,X,de=0,pe=!1,ye=!1,Le=!0;if(typeof l!="function")throw new lr(o);u=hr(u)||0,Jt(m)&&(pe=!!m.leading,ye="maxWait"in m,L=ye?Mn(hr(m.maxWait)||0,u):L,Le="trailing"in m?!!m.trailing:Le);function ze(fn){var Lr=M,Ps=R;return M=R=t,de=fn,B=l.apply(Ps,Lr),B}function $e(fn){return de=fn,G=du(lt,u),pe?ze(fn):B}function ot(fn){var Lr=fn-X,Ps=fn-de,gS=u-Lr;return ye?Qn(gS,L-Ps):gS}function je(fn){var Lr=fn-X,Ps=fn-de;return X===t||Lr>=u||Lr<0||ye&&Ps>=L}function lt(){var fn=Od();if(je(fn))return vt(fn);G=du(lt,ot(fn))}function vt(fn){return G=t,Le&&M?ze(fn):(M=R=t,B)}function Hi(){G!==t&&aw(G),de=0,M=X=R=G=t}function ci(){return G===t?B:vt(Od())}function Gi(){var fn=Od(),Lr=je(fn);if(M=arguments,R=this,X=fn,Lr){if(G===t)return $e(X);if(ye)return aw(G),G=du(lt,u),ze(X)}return G===t&&(G=du(lt,u)),B}return Gi.cancel=Hi,Gi.flush=ci,Gi}var wF=at(function(l,u){return U1(l,1,u)}),SF=at(function(l,u,m){return U1(l,hr(u)||0,m)});function MF(l){return Ts(l,F)}function kd(l,u){if(typeof l!="function"||u!=null&&typeof u!="function")throw new lr(o);var m=function(){var M=arguments,R=u?u.apply(this,M):M[0],L=m.cache;if(L.has(R))return L.get(R);var B=l.apply(this,M);return m.cache=L.set(R,B)||L,B};return m.cache=new(kd.Cache||Ms),m}kd.Cache=Ms;function Bd(l){if(typeof l!="function")throw new lr(o);return function(){var u=arguments;switch(u.length){case 0:return!l.call(this);case 1:return!l.call(this,u[0]);case 2:return!l.call(this,u[0],u[1]);case 3:return!l.call(this,u[0],u[1],u[2])}return!l.apply(this,u)}}function bF(l){return Xw(2,l)}var TF=fL(function(l,u){u=u.length==1&&tt(u[0])?Yt(u[0],Bi(Ve())):Yt(Gn(u,1),Bi(Ve()));var m=u.length;return at(function(M){for(var R=-1,L=Qn(M.length,m);++R<L;)M[R]=u[R].call(this,M[R]);return ki(l,this,M)})}),Zg=at(function(l,u){var m=lo(u,ul(Zg));return Ts(l,b,t,u,m)}),Qw=at(function(l,u){var m=lo(u,ul(Qw));return Ts(l,T,t,u,m)}),EF=Es(function(l,u){return Ts(l,A,t,t,t,u)});function AF(l,u){if(typeof l!="function")throw new lr(o);return u=u===t?u:rt(u),at(l,u)}function CF(l,u){if(typeof l!="function")throw new lr(o);return u=u==null?0:Mn(rt(u),0),at(function(m){var M=m[u],R=po(m,0,u);return M&&ao(R,M),ki(l,this,R)})}function RF(l,u,m){var M=!0,R=!0;if(typeof l!="function")throw new lr(o);return Jt(m)&&(M="leading"in m?!!m.leading:M,R="trailing"in m?!!m.trailing:R),Zw(l,u,{leading:M,maxWait:u,trailing:R})}function PF(l){return jw(l,1)}function LF(l,u){return Zg(Ng(u),l)}function IF(){if(!arguments.length)return[];var l=arguments[0];return tt(l)?l:[l]}function FF(l){return ur(l,g)}function DF(l,u){return u=typeof u=="function"?u:t,ur(l,g,u)}function NF(l){return ur(l,d|g)}function OF(l,u){return u=typeof u=="function"?u:t,ur(l,d|g,u)}function kF(l,u){return u==null||z1(l,u,Ln(u))}function Pr(l,u){return l===u||l!==l&&u!==u}var BF=Pd(Mg),zF=Pd(function(l,u){return l>=u}),fa=$1(function(){return arguments}())?$1:function(l){return on(l)&&Dt.call(l,"callee")&&!L1.call(l,"callee")},tt=ee.isArray,UF=d1?Bi(d1):qP;function bi(l){return l!=null&&zd(l.length)&&!Cs(l)}function un(l){return on(l)&&bi(l)}function HF(l){return l===!0||l===!1||on(l)&&ai(l)==qe}var mo=tP||l0,GF=h1?Bi(h1):YP;function WF(l){return on(l)&&l.nodeType===1&&!hu(l)}function VF(l){if(l==null)return!0;if(bi(l)&&(tt(l)||typeof l=="string"||typeof l.splice=="function"||mo(l)||fl(l)||fa(l)))return!l.length;var u=Jn(l);if(u==Tt||u==Xt)return!l.size;if(fu(l))return!Eg(l).length;for(var m in l)if(Dt.call(l,m))return!1;return!0}function $F(l,u){return lu(l,u)}function jF(l,u,m){m=typeof m=="function"?m:t;var M=m?m(l,u):t;return M===t?lu(l,u,t,m):!!M}function Qg(l){if(!on(l))return!1;var u=ai(l);return u==dt||u==Ne||typeof l.message=="string"&&typeof l.name=="string"&&!hu(l)}function XF(l){return typeof l=="number"&&F1(l)}function Cs(l){if(!Jt(l))return!1;var u=ai(l);return u==nt||u==Ye||u==yt||u==Et}function Jw(l){return typeof l=="number"&&l==rt(l)}function zd(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=$}function Jt(l){var u=typeof l;return l!=null&&(u=="object"||u=="function")}function on(l){return l!=null&&typeof l=="object"}var eS=p1?Bi(p1):ZP;function qF(l,u){return l===u||Tg(l,u,Gg(u))}function YF(l,u,m){return m=typeof m=="function"?m:t,Tg(l,u,Gg(u),m)}function KF(l){return tS(l)&&l!=+l}function ZF(l){if(DL(l))throw new Je(s);return j1(l)}function QF(l){return l===null}function JF(l){return l==null}function tS(l){return typeof l=="number"||on(l)&&ai(l)==jt}function hu(l){if(!on(l)||ai(l)!=Qt)return!1;var u=dd(l);if(u===null)return!0;var m=Dt.call(u,"constructor")&&u.constructor;return typeof m=="function"&&m instanceof m&&ld.call(m)==Y3}var Jg=m1?Bi(m1):QP;function eD(l){return Jw(l)&&l>=-$&&l<=$}var nS=g1?Bi(g1):JP;function Ud(l){return typeof l=="string"||!tt(l)&&on(l)&&ai(l)==k}function Ui(l){return typeof l=="symbol"||on(l)&&ai(l)==I}var fl=v1?Bi(v1):eL;function tD(l){return l===t}function nD(l){return on(l)&&Jn(l)==xe}function iD(l){return on(l)&&ai(l)==Ee}var rD=Pd(Ag),sD=Pd(function(l,u){return l<=u});function iS(l){if(!l)return[];if(bi(l))return Ud(l)?Cr(l):Mi(l);if(eu&&l[eu])return k3(l[eu]());var u=Jn(l),m=u==Tt?pg:u==Xt?sd:dl;return m(l)}function Rs(l){if(!l)return l===0?l:0;if(l=hr(l),l===ae||l===-ae){var u=l<0?-1:1;return u*Y}return l===l?l:0}function rt(l){var u=Rs(l),m=u%1;return u===u?m?u-m:u:0}function rS(l){return l?aa(rt(l),0,he):0}function hr(l){if(typeof l=="number")return l;if(Ui(l))return Z;if(Jt(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=Jt(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=M1(l);var m=mt.test(l);return m||qt.test(l)?_3(l.slice(2),m?2:8):At.test(l)?Z:+l}function sS(l){return es(l,Ti(l))}function oD(l){return l?aa(rt(l),-$,$):l===0?l:0}function It(l){return l==null?"":zi(l)}var aD=ll(function(l,u){if(fu(u)||bi(u)){es(u,Ln(u),l);return}for(var m in u)Dt.call(u,m)&&su(l,m,u[m])}),oS=ll(function(l,u){es(u,Ti(u),l)}),Hd=ll(function(l,u,m,M){es(u,Ti(u),l,M)}),lD=ll(function(l,u,m,M){es(u,Ln(u),l,M)}),cD=Es(_g);function uD(l,u){var m=al(l);return u==null?m:B1(m,u)}var fD=at(function(l,u){l=Bt(l);var m=-1,M=u.length,R=M>2?u[2]:t;for(R&&li(u[0],u[1],R)&&(M=1);++m<M;)for(var L=u[m],B=Ti(L),G=-1,X=B.length;++G<X;){var de=B[G],pe=l[de];(pe===t||Pr(pe,rl[de])&&!Dt.call(l,de))&&(l[de]=L[de])}return l}),dD=at(function(l){return l.push(t,Mw),ki(aS,t,l)});function hD(l,u){return x1(l,Ve(u,3),Jr)}function pD(l,u){return x1(l,Ve(u,3),Sg)}function mD(l,u){return l==null?l:wg(l,Ve(u,3),Ti)}function gD(l,u){return l==null?l:W1(l,Ve(u,3),Ti)}function vD(l,u){return l&&Jr(l,Ve(u,3))}function yD(l,u){return l&&Sg(l,Ve(u,3))}function xD(l){return l==null?[]:Sd(l,Ln(l))}function _D(l){return l==null?[]:Sd(l,Ti(l))}function e0(l,u,m){var M=l==null?t:la(l,u);return M===t?m:M}function wD(l,u){return l!=null&&Ew(l,u,VP)}function t0(l,u){return l!=null&&Ew(l,u,$P)}var SD=yw(function(l,u,m){u!=null&&typeof u.toString!="function"&&(u=cd.call(u)),l[u]=m},i0(Ei)),MD=yw(function(l,u,m){u!=null&&typeof u.toString!="function"&&(u=cd.call(u)),Dt.call(l,u)?l[u].push(m):l[u]=[m]},Ve),bD=at(au);function Ln(l){return bi(l)?O1(l):Eg(l)}function Ti(l){return bi(l)?O1(l,!0):tL(l)}function TD(l,u){var m={};return u=Ve(u,3),Jr(l,function(M,R,L){bs(m,u(M,R,L),M)}),m}function ED(l,u){var m={};return u=Ve(u,3),Jr(l,function(M,R,L){bs(m,R,u(M,R,L))}),m}var AD=ll(function(l,u,m){Md(l,u,m)}),aS=ll(function(l,u,m,M){Md(l,u,m,M)}),CD=Es(function(l,u){var m={};if(l==null)return m;var M=!1;u=Yt(u,function(L){return L=ho(L,l),M||(M=L.length>1),L}),es(l,Ug(l),m),M&&(m=ur(m,d|p|g,SL));for(var R=u.length;R--;)Ig(m,u[R]);return m});function RD(l,u){return lS(l,Bd(Ve(u)))}var PD=Es(function(l,u){return l==null?{}:iL(l,u)});function lS(l,u){if(l==null)return{};var m=Yt(Ug(l),function(M){return[M]});return u=Ve(u),J1(l,m,function(M,R){return u(M,R[0])})}function LD(l,u,m){u=ho(u,l);var M=-1,R=u.length;for(R||(R=1,l=t);++M<R;){var L=l==null?t:l[ts(u[M])];L===t&&(M=R,L=m),l=Cs(L)?L.call(l):L}return l}function ID(l,u,m){return l==null?l:cu(l,u,m)}function FD(l,u,m,M){return M=typeof M=="function"?M:t,l==null?l:cu(l,u,m,M)}var cS=ww(Ln),uS=ww(Ti);function DD(l,u,m){var M=tt(l),R=M||mo(l)||fl(l);if(u=Ve(u,4),m==null){var L=l&&l.constructor;R?m=M?new L:[]:Jt(l)?m=Cs(L)?al(dd(l)):{}:m={}}return(R?ar:Jr)(l,function(B,G,X){return u(m,B,G,X)}),m}function ND(l,u){return l==null?!0:Ig(l,u)}function OD(l,u,m){return l==null?l:rw(l,u,Ng(m))}function kD(l,u,m,M){return M=typeof M=="function"?M:t,l==null?l:rw(l,u,Ng(m),M)}function dl(l){return l==null?[]:hg(l,Ln(l))}function BD(l){return l==null?[]:hg(l,Ti(l))}function zD(l,u,m){return m===t&&(m=u,u=t),m!==t&&(m=hr(m),m=m===m?m:0),u!==t&&(u=hr(u),u=u===u?u:0),aa(hr(l),u,m)}function UD(l,u,m){return u=Rs(u),m===t?(m=u,u=0):m=Rs(m),l=hr(l),jP(l,u,m)}function HD(l,u,m){if(m&&typeof m!="boolean"&&li(l,u,m)&&(u=m=t),m===t&&(typeof u=="boolean"?(m=u,u=t):typeof l=="boolean"&&(m=l,l=t)),l===t&&u===t?(l=0,u=1):(l=Rs(l),u===t?(u=l,l=0):u=Rs(u)),l>u){var M=l;l=u,u=M}if(m||l%1||u%1){var R=D1();return Qn(l+R*(u-l+x3("1e-"+((R+"").length-1))),u)}return Rg(l,u)}var GD=cl(function(l,u,m){return u=u.toLowerCase(),l+(m?fS(u):u)});function fS(l){return n0(It(l).toLowerCase())}function dS(l){return l=It(l),l&&l.replace(io,I3).replace(c3,"")}function WD(l,u,m){l=It(l),u=zi(u);var M=l.length;m=m===t?M:aa(rt(m),0,M);var R=m;return m-=u.length,m>=0&&l.slice(m,R)==u}function VD(l){return l=It(l),l&&nr.test(l)?l.replace(Mt,F3):l}function $D(l){return l=It(l),l&&Qm.test(l)?l.replace(Kc,"\\$&"):l}var jD=cl(function(l,u,m){return l+(m?"-":"")+u.toLowerCase()}),XD=cl(function(l,u,m){return l+(m?" ":"")+u.toLowerCase()}),qD=mw("toLowerCase");function YD(l,u,m){l=It(l),u=rt(u);var M=u?nl(l):0;if(!u||M>=u)return l;var R=(u-M)/2;return Rd(gd(R),m)+l+Rd(md(R),m)}function KD(l,u,m){l=It(l),u=rt(u);var M=u?nl(l):0;return u&&M<u?l+Rd(u-M,m):l}function ZD(l,u,m){l=It(l),u=rt(u);var M=u?nl(l):0;return u&&M<u?Rd(u-M,m)+l:l}function QD(l,u,m){return m||u==null?u=0:u&&(u=+u),sP(It(l).replace(Zc,""),u||0)}function JD(l,u,m){return(m?li(l,u,m):u===t)?u=1:u=rt(u),Pg(It(l),u)}function eN(){var l=arguments,u=It(l[0]);return l.length<3?u:u.replace(l[1],l[2])}var tN=cl(function(l,u,m){return l+(m?"_":"")+u.toLowerCase()});function nN(l,u,m){return m&&typeof m!="number"&&li(l,u,m)&&(u=m=t),m=m===t?he:m>>>0,m?(l=It(l),l&&(typeof u=="string"||u!=null&&!Jg(u))&&(u=zi(u),!u&&tl(l))?po(Cr(l),0,m):l.split(u,m)):[]}var iN=cl(function(l,u,m){return l+(m?" ":"")+n0(u)});function rN(l,u,m){return l=It(l),m=m==null?0:aa(rt(m),0,l.length),u=zi(u),l.slice(m,m+u.length)==u}function sN(l,u,m){var M=P.templateSettings;m&&li(l,u,m)&&(u=t),l=It(l),u=Hd({},u,M,Sw);var R=Hd({},u.imports,M.imports,Sw),L=Ln(R),B=hg(R,L),G,X,de=0,pe=u.interpolate||Er,ye="__p += '",Le=mg((u.escape||Er).source+"|"+pe.source+"|"+(pe===ta?st:Er).source+"|"+(u.evaluate||Er).source+"|$","g"),ze="//# sourceURL="+(Dt.call(u,"sourceURL")?(u.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++p3+"]")+`
`;l.replace(Le,function(je,lt,vt,Hi,ci,Gi){return vt||(vt=Hi),ye+=l.slice(de,Gi).replace(ir,D3),lt&&(G=!0,ye+=`' +
__e(`+lt+`) +
'`),ci&&(X=!0,ye+=`';
`+ci+`;
__p += '`),vt&&(ye+=`' +
((__t = (`+vt+`)) == null ? '' : __t) +
'`),de=Gi+je.length,je}),ye+=`';
`;var $e=Dt.call(u,"variable")&&u.variable;if(!$e)ye=`with (obj) {
`+ye+`
}
`;else if(Ke.test($e))throw new Je(a);ye=(X?ye.replace(He,""):ye).replace(Te,"$1").replace(Qe,"$1;"),ye="function("+($e||"obj")+`) {
`+($e?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(G?", __e = _.escape":"")+(X?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ye+`return __p
}`;var ot=pS(function(){return Ct(L,ze+"return "+ye).apply(t,B)});if(ot.source=ye,Qg(ot))throw ot;return ot}function oN(l){return It(l).toLowerCase()}function aN(l){return It(l).toUpperCase()}function lN(l,u,m){if(l=It(l),l&&(m||u===t))return M1(l);if(!l||!(u=zi(u)))return l;var M=Cr(l),R=Cr(u),L=b1(M,R),B=T1(M,R)+1;return po(M,L,B).join("")}function cN(l,u,m){if(l=It(l),l&&(m||u===t))return l.slice(0,A1(l)+1);if(!l||!(u=zi(u)))return l;var M=Cr(l),R=T1(M,Cr(u))+1;return po(M,0,R).join("")}function uN(l,u,m){if(l=It(l),l&&(m||u===t))return l.replace(Zc,"");if(!l||!(u=zi(u)))return l;var M=Cr(l),R=b1(M,Cr(u));return po(M,R).join("")}function fN(l,u){var m=U,M=W;if(Jt(u)){var R="separator"in u?u.separator:R;m="length"in u?rt(u.length):m,M="omission"in u?zi(u.omission):M}l=It(l);var L=l.length;if(tl(l)){var B=Cr(l);L=B.length}if(m>=L)return l;var G=m-nl(M);if(G<1)return M;var X=B?po(B,0,G).join(""):l.slice(0,G);if(R===t)return X+M;if(B&&(G+=X.length-G),Jg(R)){if(l.slice(G).search(R)){var de,pe=X;for(R.global||(R=mg(R.source,It(it.exec(R))+"g")),R.lastIndex=0;de=R.exec(pe);)var ye=de.index;X=X.slice(0,ye===t?G:ye)}}else if(l.indexOf(zi(R),G)!=G){var Le=X.lastIndexOf(R);Le>-1&&(X=X.slice(0,Le))}return X+M}function dN(l){return l=It(l),l&&zn.test(l)?l.replace(St,H3):l}var hN=cl(function(l,u,m){return l+(m?" ":"")+u.toUpperCase()}),n0=mw("toUpperCase");function hS(l,u,m){return l=It(l),u=m?t:u,u===t?O3(l)?V3(l):A3(l):l.match(u)||[]}var pS=at(function(l,u){try{return ki(l,t,u)}catch(m){return Qg(m)?m:new Je(m)}}),pN=Es(function(l,u){return ar(u,function(m){m=ts(m),bs(l,m,Kg(l[m],l))}),l});function mN(l){var u=l==null?0:l.length,m=Ve();return l=u?Yt(l,function(M){if(typeof M[1]!="function")throw new lr(o);return[m(M[0]),M[1]]}):[],at(function(M){for(var R=-1;++R<u;){var L=l[R];if(ki(L[0],this,M))return ki(L[1],this,M)}})}function gN(l){return HP(ur(l,d))}function i0(l){return function(){return l}}function vN(l,u){return l==null||l!==l?u:l}var yN=vw(),xN=vw(!0);function Ei(l){return l}function r0(l){return X1(typeof l=="function"?l:ur(l,d))}function _N(l){return Y1(ur(l,d))}function wN(l,u){return K1(l,ur(u,d))}var SN=at(function(l,u){return function(m){return au(m,l,u)}}),MN=at(function(l,u){return function(m){return au(l,m,u)}});function s0(l,u,m){var M=Ln(u),R=Sd(u,M);m==null&&!(Jt(u)&&(R.length||!M.length))&&(m=u,u=l,l=this,R=Sd(u,Ln(u)));var L=!(Jt(m)&&"chain"in m)||!!m.chain,B=Cs(l);return ar(R,function(G){var X=u[G];l[G]=X,B&&(l.prototype[G]=function(){var de=this.__chain__;if(L||de){var pe=l(this.__wrapped__),ye=pe.__actions__=Mi(this.__actions__);return ye.push({func:X,args:arguments,thisArg:l}),pe.__chain__=de,pe}return X.apply(l,ao([this.value()],arguments))})}),l}function bN(){return Hn._===this&&(Hn._=K3),this}function o0(){}function TN(l){return l=rt(l),at(function(u){return Z1(u,l)})}var EN=kg(Yt),AN=kg(y1),CN=kg(lg);function mS(l){return Vg(l)?cg(ts(l)):rL(l)}function RN(l){return function(u){return l==null?t:la(l,u)}}var PN=xw(),LN=xw(!0);function a0(){return[]}function l0(){return!1}function IN(){return{}}function FN(){return""}function DN(){return!0}function NN(l,u){if(l=rt(l),l<1||l>$)return[];var m=he,M=Qn(l,he);u=Ve(u),l-=he;for(var R=dg(M,u);++m<l;)u(m);return R}function ON(l){return tt(l)?Yt(l,ts):Ui(l)?[l]:Mi(Nw(It(l)))}function kN(l){var u=++q3;return It(l)+u}var BN=Cd(function(l,u){return l+u},0),zN=Bg("ceil"),UN=Cd(function(l,u){return l/u},1),HN=Bg("floor");function GN(l){return l&&l.length?wd(l,Ei,Mg):t}function WN(l,u){return l&&l.length?wd(l,Ve(u,2),Mg):t}function VN(l){return w1(l,Ei)}function $N(l,u){return w1(l,Ve(u,2))}function jN(l){return l&&l.length?wd(l,Ei,Ag):t}function XN(l,u){return l&&l.length?wd(l,Ve(u,2),Ag):t}var qN=Cd(function(l,u){return l*u},1),YN=Bg("round"),KN=Cd(function(l,u){return l-u},0);function ZN(l){return l&&l.length?fg(l,Ei):0}function QN(l,u){return l&&l.length?fg(l,Ve(u,2)):0}return P.after=_F,P.ary=jw,P.assign=aD,P.assignIn=oS,P.assignInWith=Hd,P.assignWith=lD,P.at=cD,P.before=Xw,P.bind=Kg,P.bindAll=pN,P.bindKey=qw,P.castArray=IF,P.chain=Ww,P.chunk=HL,P.compact=GL,P.concat=WL,P.cond=mN,P.conforms=gN,P.constant=i0,P.countBy=ZI,P.create=uD,P.curry=Yw,P.curryRight=Kw,P.debounce=Zw,P.defaults=fD,P.defaultsDeep=dD,P.defer=wF,P.delay=SF,P.difference=VL,P.differenceBy=$L,P.differenceWith=jL,P.drop=XL,P.dropRight=qL,P.dropRightWhile=YL,P.dropWhile=KL,P.fill=ZL,P.filter=JI,P.flatMap=nF,P.flatMapDeep=iF,P.flatMapDepth=rF,P.flatten=zw,P.flattenDeep=QL,P.flattenDepth=JL,P.flip=MF,P.flow=yN,P.flowRight=xN,P.fromPairs=eI,P.functions=xD,P.functionsIn=_D,P.groupBy=sF,P.initial=nI,P.intersection=iI,P.intersectionBy=rI,P.intersectionWith=sI,P.invert=SD,P.invertBy=MD,P.invokeMap=aF,P.iteratee=r0,P.keyBy=lF,P.keys=Ln,P.keysIn=Ti,P.map=Nd,P.mapKeys=TD,P.mapValues=ED,P.matches=_N,P.matchesProperty=wN,P.memoize=kd,P.merge=AD,P.mergeWith=aS,P.method=SN,P.methodOf=MN,P.mixin=s0,P.negate=Bd,P.nthArg=TN,P.omit=CD,P.omitBy=RD,P.once=bF,P.orderBy=cF,P.over=EN,P.overArgs=TF,P.overEvery=AN,P.overSome=CN,P.partial=Zg,P.partialRight=Qw,P.partition=uF,P.pick=PD,P.pickBy=lS,P.property=mS,P.propertyOf=RN,P.pull=cI,P.pullAll=Hw,P.pullAllBy=uI,P.pullAllWith=fI,P.pullAt=dI,P.range=PN,P.rangeRight=LN,P.rearg=EF,P.reject=hF,P.remove=hI,P.rest=AF,P.reverse=qg,P.sampleSize=mF,P.set=ID,P.setWith=FD,P.shuffle=gF,P.slice=pI,P.sortBy=xF,P.sortedUniq=wI,P.sortedUniqBy=SI,P.split=nN,P.spread=CF,P.tail=MI,P.take=bI,P.takeRight=TI,P.takeRightWhile=EI,P.takeWhile=AI,P.tap=GI,P.throttle=RF,P.thru=Dd,P.toArray=iS,P.toPairs=cS,P.toPairsIn=uS,P.toPath=ON,P.toPlainObject=sS,P.transform=DD,P.unary=PF,P.union=CI,P.unionBy=RI,P.unionWith=PI,P.uniq=LI,P.uniqBy=II,P.uniqWith=FI,P.unset=ND,P.unzip=Yg,P.unzipWith=Gw,P.update=OD,P.updateWith=kD,P.values=dl,P.valuesIn=BD,P.without=DI,P.words=hS,P.wrap=LF,P.xor=NI,P.xorBy=OI,P.xorWith=kI,P.zip=BI,P.zipObject=zI,P.zipObjectDeep=UI,P.zipWith=HI,P.entries=cS,P.entriesIn=uS,P.extend=oS,P.extendWith=Hd,s0(P,P),P.add=BN,P.attempt=pS,P.camelCase=GD,P.capitalize=fS,P.ceil=zN,P.clamp=zD,P.clone=FF,P.cloneDeep=NF,P.cloneDeepWith=OF,P.cloneWith=DF,P.conformsTo=kF,P.deburr=dS,P.defaultTo=vN,P.divide=UN,P.endsWith=WD,P.eq=Pr,P.escape=VD,P.escapeRegExp=$D,P.every=QI,P.find=eF,P.findIndex=kw,P.findKey=hD,P.findLast=tF,P.findLastIndex=Bw,P.findLastKey=pD,P.floor=HN,P.forEach=Vw,P.forEachRight=$w,P.forIn=mD,P.forInRight=gD,P.forOwn=vD,P.forOwnRight=yD,P.get=e0,P.gt=BF,P.gte=zF,P.has=wD,P.hasIn=t0,P.head=Uw,P.identity=Ei,P.includes=oF,P.indexOf=tI,P.inRange=UD,P.invoke=bD,P.isArguments=fa,P.isArray=tt,P.isArrayBuffer=UF,P.isArrayLike=bi,P.isArrayLikeObject=un,P.isBoolean=HF,P.isBuffer=mo,P.isDate=GF,P.isElement=WF,P.isEmpty=VF,P.isEqual=$F,P.isEqualWith=jF,P.isError=Qg,P.isFinite=XF,P.isFunction=Cs,P.isInteger=Jw,P.isLength=zd,P.isMap=eS,P.isMatch=qF,P.isMatchWith=YF,P.isNaN=KF,P.isNative=ZF,P.isNil=JF,P.isNull=QF,P.isNumber=tS,P.isObject=Jt,P.isObjectLike=on,P.isPlainObject=hu,P.isRegExp=Jg,P.isSafeInteger=eD,P.isSet=nS,P.isString=Ud,P.isSymbol=Ui,P.isTypedArray=fl,P.isUndefined=tD,P.isWeakMap=nD,P.isWeakSet=iD,P.join=oI,P.kebabCase=jD,P.last=dr,P.lastIndexOf=aI,P.lowerCase=XD,P.lowerFirst=qD,P.lt=rD,P.lte=sD,P.max=GN,P.maxBy=WN,P.mean=VN,P.meanBy=$N,P.min=jN,P.minBy=XN,P.stubArray=a0,P.stubFalse=l0,P.stubObject=IN,P.stubString=FN,P.stubTrue=DN,P.multiply=qN,P.nth=lI,P.noConflict=bN,P.noop=o0,P.now=Od,P.pad=YD,P.padEnd=KD,P.padStart=ZD,P.parseInt=QD,P.random=HD,P.reduce=fF,P.reduceRight=dF,P.repeat=JD,P.replace=eN,P.result=LD,P.round=YN,P.runInContext=j,P.sample=pF,P.size=vF,P.snakeCase=tN,P.some=yF,P.sortedIndex=mI,P.sortedIndexBy=gI,P.sortedIndexOf=vI,P.sortedLastIndex=yI,P.sortedLastIndexBy=xI,P.sortedLastIndexOf=_I,P.startCase=iN,P.startsWith=rN,P.subtract=KN,P.sum=ZN,P.sumBy=QN,P.template=sN,P.times=NN,P.toFinite=Rs,P.toInteger=rt,P.toLength=rS,P.toLower=oN,P.toNumber=hr,P.toSafeInteger=oD,P.toString=It,P.toUpper=aN,P.trim=lN,P.trimEnd=cN,P.trimStart=uN,P.truncate=fN,P.unescape=dN,P.uniqueId=kN,P.upperCase=hN,P.upperFirst=n0,P.each=Vw,P.eachRight=$w,P.first=Uw,s0(P,function(){var l={};return Jr(P,function(u,m){Dt.call(P.prototype,m)||(l[m]=u)}),l}(),{chain:!1}),P.VERSION=i,ar(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){P[l].placeholder=P}),ar(["drop","take"],function(l,u){ht.prototype[l]=function(m){m=m===t?1:Mn(rt(m),0);var M=this.__filtered__&&!u?new ht(this):this.clone();return M.__filtered__?M.__takeCount__=Qn(m,M.__takeCount__):M.__views__.push({size:Qn(m,he),type:l+(M.__dir__<0?"Right":"")}),M},ht.prototype[l+"Right"]=function(m){return this.reverse()[l](m).reverse()}}),ar(["filter","map","takeWhile"],function(l,u){var m=u+1,M=m==V||m==K;ht.prototype[l]=function(R){var L=this.clone();return L.__iteratees__.push({iteratee:Ve(R,3),type:m}),L.__filtered__=L.__filtered__||M,L}}),ar(["head","last"],function(l,u){var m="take"+(u?"Right":"");ht.prototype[l]=function(){return this[m](1).value()[0]}}),ar(["initial","tail"],function(l,u){var m="drop"+(u?"":"Right");ht.prototype[l]=function(){return this.__filtered__?new ht(this):this[m](1)}}),ht.prototype.compact=function(){return this.filter(Ei)},ht.prototype.find=function(l){return this.filter(l).head()},ht.prototype.findLast=function(l){return this.reverse().find(l)},ht.prototype.invokeMap=at(function(l,u){return typeof l=="function"?new ht(this):this.map(function(m){return au(m,l,u)})}),ht.prototype.reject=function(l){return this.filter(Bd(Ve(l)))},ht.prototype.slice=function(l,u){l=rt(l);var m=this;return m.__filtered__&&(l>0||u<0)?new ht(m):(l<0?m=m.takeRight(-l):l&&(m=m.drop(l)),u!==t&&(u=rt(u),m=u<0?m.dropRight(-u):m.take(u-l)),m)},ht.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},ht.prototype.toArray=function(){return this.take(he)},Jr(ht.prototype,function(l,u){var m=/^(?:filter|find|map|reject)|While$/.test(u),M=/^(?:head|last)$/.test(u),R=P[M?"take"+(u=="last"?"Right":""):u],L=M||/^find/.test(u);!R||(P.prototype[u]=function(){var B=this.__wrapped__,G=M?[1]:arguments,X=B instanceof ht,de=G[0],pe=X||tt(B),ye=function(lt){var vt=R.apply(P,ao([lt],G));return M&&Le?vt[0]:vt};pe&&m&&typeof de=="function"&&de.length!=1&&(X=pe=!1);var Le=this.__chain__,ze=!!this.__actions__.length,$e=L&&!Le,ot=X&&!ze;if(!L&&pe){B=ot?B:new ht(this);var je=l.apply(B,G);return je.__actions__.push({func:Dd,args:[ye],thisArg:t}),new cr(je,Le)}return $e&&ot?l.apply(this,G):(je=this.thru(ye),$e?M?je.value()[0]:je.value():je)})}),ar(["pop","push","shift","sort","splice","unshift"],function(l){var u=od[l],m=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",M=/^(?:pop|shift)$/.test(l);P.prototype[l]=function(){var R=arguments;if(M&&!this.__chain__){var L=this.value();return u.apply(tt(L)?L:[],R)}return this[m](function(B){return u.apply(tt(B)?B:[],R)})}}),Jr(ht.prototype,function(l,u){var m=P[u];if(m){var M=m.name+"";Dt.call(ol,M)||(ol[M]=[]),ol[M].push({name:u,func:m})}}),ol[Ad(t,v).name]=[{name:"wrapper",func:t}],ht.prototype.clone=dP,ht.prototype.reverse=hP,ht.prototype.value=pP,P.prototype.at=WI,P.prototype.chain=VI,P.prototype.commit=$I,P.prototype.next=jI,P.prototype.plant=qI,P.prototype.reverse=YI,P.prototype.toJSON=P.prototype.valueOf=P.prototype.value=KI,P.prototype.first=P.prototype.head,eu&&(P.prototype[eu]=XI),P},il=$3();ia?((ia.exports=il)._=il,rg._=il):Hn._=il}).call(Ma)})(Gr,Gr.exports);var Sa=(n=>(n.NumberInput="NumberInput",n.StringInput="StringInput",n.Select="Select",n.MinMax="MinMax",n.BooleanCheckbox="BooleanCheckbox",n.Color="Color",n))(Sa||{});const cW=n=>({__type:"BooleanCheckbox",initialValue:n}),uW=n=>({__type:"StringInput",initialValue:n}),fW=n=>({__type:"NumberInput",initialValue:n}),xv=n=>({__type:"Color",initialValue:n}),dW=(n,e,t,i=1)=>({__type:"MinMax",initialValue:n,min:e,max:t,step:i}),op={},hW=n=>{const e=Gr.exports.cloneDeep(n),t=Z2("config",e),i={...e,...t.get()},r=vT(i,e);return{config:r,saveConfig:()=>{t.set(r)},resetConfig:()=>{Object.assign(r,vT(n)),t.remove()}}},vT=(n,e=n)=>{for(let t in e)if(!!e.hasOwnProperty(t))for(let i in e[t]){if(!e.hasOwnProperty(t))continue;const r=e[t][i];if(r&&typeof r=="object"&&"__type"in r){const s=n[t][i];Iu(t,i,r);const a=typeof s=="object"&&"__type"in s?s.initialValue:s;n[t][i]=a}typeof r=="boolean"&&Iu(t,i,cW(r)),typeof r=="string"&&Iu(t,i,uW(r)),typeof r=="number"&&(i.toLowerCase().includes("hp")?Iu(t,i,dW(r,1,r*3)):Iu(t,i,fW(r)))}return n},Iu=(n,e,t)=>{op[n]||(op[n]={}),op[n][e]=t},{config:se,resetConfig:pW,saveConfig:mW}=hW({core:{tickTime:250,orbitalControls:!1,unfocusedFpsLimit:5},camera:{fov:60,far:350,near:.1,minHeight:2,maxHeight:8},debug:{logSelected:!0,wireModel:!1,groundWireframe:!1},renderer:{exposure:1,tileSize:.1,texture:!0,fog:!0,fogTransparency:3,dayAndNightMode:!0,dayAndNightTimeScale:600,dayAndNightTimeStart:1,shadow:!0,treeWaving:!0,light:!1,diagonals:"random"},postProcessing:{postprocessingEnabled:!0,bloomEnabled:!0,bloomStrength:1.25,bloomThreshold:.45,bloomRadius:.45,outlineEnabled:!0,outlineEdgeStrength:2,outlineEdgeGlow:0,outlineEdgeThickness:.2,outlinePulsePeriod:0,FXAAEnabled:!0,bokehEnable:!0,bokehAperture:.002,bokehMaxBlur:.01,gammaCorrectionShader:!0},walkableRenderer:{movementSmoothness:5,rotationSmoothness:10},barracks:{hp:1e3},wall:{hp:1e3},guildhall:{hp:1e3},house:{hp:1e3,newChildCountMin:10,newChildCountMax:30},tree:{hp:300,removeTickCount:10,newTreeTicksMin:50,newTreeTicksMax:1e4,newTreeRange:[-3,-2,2,3]},boar:{hp:80,randomWalkChance:.01,attackDistance:1.5,lookEnemyDistance:8,attackDamage:3},human:{hp:100,randomWalkChance:.01,walkAroundHomeDistance:7,attackDistance:1.5,attackDamage:5,color:xv(6509116)},woodcutter:{hp:100,choppingDamage:20,gatheringSpeed:30,capacity:50,attackDamage:15,color:xv(1263380)},guardian:{hp:100,attackDamage:25,color:xv(2251843)}});var _t=(n=>(n.Empty="Empty",n.Human="Human",n.Guildhall="Guildhall",n.House="House",n.WoodCamp="WoodCamp",n.Barracks="Barracks",n.Stakewall="Stakewall",n.Tree="Tree",n.Boar="Boar",n))(_t||{});const gW={Unit:["Human","Boar"],Building:["Guildhall","House","WoodCamp","Barracks","Stakewall"],Other:["Tree"]};Object.values(_t).filter(n=>n!=="Empty");class w_{constructor(e,t,i=[0,0]){O(this,"id",Qx());O(this,"type",_t.Empty);O(this,"selectImportance",3);O(this,"maxHp",100);O(this,"hp",this.maxHp);O(this,"hpRegen",1);O(this,"seed",y_());O(this,"rotation",0);this.game=e,this.player=t,this.position=i}tick(){this.hp<this.maxHp&&(this.hp=Math.min(this.hp+this.hpRegen,this.maxHp))}death(){this.game.removeActor(this)}hitBy(e){}hit(e,t){if(this.isDead())return 0;const i=q2(this.hp,e);return this.hp-=i,this.hp||this.death(),this.hitBy(t),i}isDead(){return this.hp<=0}interact(e){return!1}getSelectedImportance(){return this.selectImportance}setRotation(e){this.rotation=e}toJSON(){return{id:this.id,type:this.type,playerId:this.player.id,position:this.position,hp:this.hp,maxHp:this.maxHp,hpRegen:this.hpRegen,selectImportance:this.selectImportance,seed:this.seed,rotation:this.rotation}}fromJSON(e){Object.assign(this,e)}}class ky extends w_{constructor(){super(...arguments);O(this,"type",_t.Tree);O(this,"selectImportance",2);O(this,"maxHp",se.tree.hp);O(this,"hp",se.tree.hp);O(this,"seed",y_());O(this,"newTreeCount",this.treeCount());O(this,"removeCount",se.tree.removeTickCount)}tick(){this.newTreeCount--,this.newTreeCount<=0&&(this.newTreeCount=this.treeCount(),this.spawnNewTree()),this.isDead()&&(this.removeCount--,this.removeCount<=0&&this.game.removeActor(this))}death(){const t=this.game.world.getTile(this.position);t.previousTile&&this.game.world.setTile(this.position,t.previousTile)}spawnNewTree(){const t=this.position.map(s=>EB(se.tree.newTreeRange)+s);if(!this.game.world.hasTile(t))return;const i=this.game.world.getTile(t);new iC(this.game,this.player).spawnNewTree(i,t)}treeCount(){return Kr(se.tree.newTreeTicksMin,se.tree.newTreeTicksMax)}}var an=(n=>(n.Empty="Empty",n.Forest="Forest",n.Meadow="Meadow",n.Step="Step",n.Water="Water",n.Wall="Wall",n.Inside="Inside",n.Footpath="Footpath",n.ImportantFootpath="ImportantFootpath",n.Overgrown="Overgrown",n))(an||{});class Zr{constructor(e){O(this,"type",an.Empty);O(this,"canBuild",!0);O(this,"canWalk",!0);O(this,"walkCost",0);O(this,"color",0);O(this,"height",0);O(this,"treeChance",0);this.previousTile=e}toJSON(){var i;const e=vW(this.type),t=Gr.exports.omitBy(this.getData(),(r,s)=>e[s]===r);return{type:this.type,...t,previousTile:(i=this.previousTile)==null?void 0:i.toJSON()}}getData(){return{canBuild:this.canBuild,canWalk:this.canWalk,walkCost:this.walkCost,color:this.color,height:this.height,treeChance:this.treeChance}}fromJSON({previousTile:e,...t}){Object.assign(this,t),this.previousTile=e?nC(e):void 0}}class By extends Zr{constructor(){super(...arguments);O(this,"type",an.Forest);O(this,"color",qs(2831882,10));O(this,"height",Kr(0,.5));O(this,"treeChance",.1)}}class yT extends Zr{constructor(){super(...arguments);O(this,"type",an.Meadow);O(this,"color",qs(6449480,6));O(this,"height",Kr(-.15,.4));O(this,"treeChance",.001)}}class zy extends Zr{constructor(){super(...arguments);O(this,"type",an.Meadow);O(this,"color",qs(2573591,4));O(this,"height",Kr(0,.2));O(this,"treeChance",.004)}}class Uy extends Zr{constructor(){super(...arguments);O(this,"type",an.Step);O(this,"color",qs(6052696,20,!0));O(this,"canBuild",!1);O(this,"treeChance",.005);O(this,"height",Kr(1,2)+.2)}}class Hy extends Zr{constructor(){super(...arguments);O(this,"type",an.Water);O(this,"color",qs(12433013,10));O(this,"canWalk",!1);O(this,"canBuild",!1);O(this,"height",Kr(0,-1)-.5)}}class Gy extends Zr{constructor(){super(...arguments);O(this,"type",an.Wall);O(this,"color",2236962);O(this,"canBuild",!1);O(this,"canWalk",!1)}}class Wy extends Zr{constructor(){super(...arguments);O(this,"type",an.Inside);O(this,"color",4671288);O(this,"canBuild",!1);O(this,"walkCost",3)}}class Vy extends Zr{constructor(){super(...arguments);O(this,"type",an.ImportantFootpath);O(this,"color",4671288)}}class $y extends Zr{constructor(t){super(t);O(this,"type",an.Footpath);O(this,"color",6774888);this.previousTile=t,t&&(this.color=Iy(t.color,!1,.3))}}class Vp extends Zr{constructor(){super(...arguments);O(this,"type",an.Overgrown);O(this,"color",qs(337159,4));O(this,"canBuild",!1);O(this,"treeChance",.1);O(this,"walkCost",3)}}const tC={[an.Empty]:Zr,[an.Forest]:By,[an.Meadow]:zy,[an.Step]:Uy,[an.Water]:Hy,[an.Wall]:Gy,[an.Inside]:Wy,[an.Footpath]:$y,[an.ImportantFootpath]:Vy,[an.Overgrown]:Vp},vW=n=>{const e=tC[n];return new e().getData()},nC=n=>{const e=tC[n.type],t=new e;return t.fromJSON(n),t};class iC{constructor(e,t){O(this,"rng",K2());this.game=e,this.player=t}bulkSpawnTrees(){const e=[];this.game.world.forEachTile((t,i)=>{if(!this.shouldSpawnTree(t,i))return;e.push(i);const s=new ky(this.game,this.player,i);this.game.addActor(s)}),this.game.world.setMultipleTiles((t,i)=>{e.forEach(r=>{const s=i(r);t(r,new Vp(s))})})}spawnNewTree(e,t){this.shouldSpawnTree(e,t)&&this.game.spawnActor(ky,this.player,t)}shouldSpawnTree(e,t){return!(e.treeChance===0||this.rng()>e.treeChance||this.game.findActorsByPosition(t,1).length>0)}}const To=new WeakMap,ap=new WeakMap,af=new WeakMap,jy=Symbol("anyProducer"),xT=Promise.resolve(),$p=Symbol("listenerAdded"),jp=Symbol("listenerRemoved"),Hs=Symbol("metaEventsAllowed");let _v=!1;function Fl(n,e){if(typeof n!="string"&&typeof n!="symbol"&&typeof n!="number")throw new TypeError("`eventName` must be a string, symbol, or number");if(lp(n)&&e!==Hs)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`")}function kh(n){if(typeof n!="function")throw new TypeError("listener must be a function")}function Dl(n,e){const t=ap.get(n);return t.has(e)||t.set(e,new Set),t.get(e)}function lf(n,e){const t=typeof e=="string"||typeof e=="symbol"||typeof e=="number"?e:jy,i=af.get(n);return i.has(t)||i.set(t,new Set),i.get(t)}function yW(n,e,t){const i=af.get(n);if(i.has(e))for(const r of i.get(e))r.enqueue(t);if(i.has(jy)){const r=Promise.all([e,t]);for(const s of i.get(jy))s.enqueue(r)}}function _T(n,e){e=Array.isArray(e)?e:[e];let t=!1,i=()=>{},r=[];const s={enqueue(o){r.push(o),i()},finish(){t=!0,i()}};for(const o of e)lf(n,o).add(s);return{async next(){return r?r.length===0?t?(r=void 0,this.next()):(await new Promise(o=>{i=o}),this.next()):{done:!1,value:await r.shift()}:{done:!0}},async return(o){r=void 0;for(const a of e)lf(n,a).delete(s);return i(),arguments.length>0?{done:!0,value:await o}:{done:!0}},[Symbol.asyncIterator](){return this}}}function wT(n){if(n===void 0)return ST;if(!Array.isArray(n))throw new TypeError("`methodNames` must be an array of strings");for(const e of n)if(!ST.includes(e))throw typeof e!="string"?new TypeError("`methodNames` element must be a string"):new Error(`${e} is not Emittery method`);return n}const lp=n=>n===$p||n===jp;class Va{static mixin(e,t){return t=wT(t),i=>{if(typeof i!="function")throw new TypeError("`target` must be function");for(const o of t)if(i.prototype[o]!==void 0)throw new Error(`The property \`${o}\` already exists on \`target\``);function r(){return Object.defineProperty(this,e,{enumerable:!1,value:new Va}),this[e]}Object.defineProperty(i.prototype,e,{enumerable:!1,get:r});const s=o=>function(...a){return this[e][o](...a)};for(const o of t)Object.defineProperty(i.prototype,o,{enumerable:!1,value:s(o)});return i}}static get isDebugEnabled(){if(typeof process!="object")return _v;const{env:e}=process||{env:{}};return e.DEBUG==="emittery"||e.DEBUG==="*"||_v}static set isDebugEnabled(e){_v=e}constructor(e={}){To.set(this,new Set),ap.set(this,new Map),af.set(this,new Map),this.debug=e.debug||{},this.debug.enabled===void 0&&(this.debug.enabled=!1),this.debug.logger||(this.debug.logger=(t,i,r,s)=>{try{s=JSON.stringify(s)}catch{s=`Object with the following keys failed to stringify: ${Object.keys(s).join(",")}`}(typeof r=="symbol"||typeof r=="number")&&(r=r.toString());const o=new Date,a=`${o.getHours()}:${o.getMinutes()}:${o.getSeconds()}.${o.getMilliseconds()}`;console.log(`[${a}][emittery:${t}][${i}] Event Name: ${r}
	data: ${s}`)})}logIfDebugEnabled(e,t,i){(Va.isDebugEnabled||this.debug.enabled)&&this.debug.logger(e,this.debug.name,t,i)}on(e,t){kh(t),e=Array.isArray(e)?e:[e];for(const i of e)Fl(i,Hs),Dl(this,i).add(t),this.logIfDebugEnabled("subscribe",i,void 0),lp(i)||this.emit($p,{eventName:i,listener:t},Hs);return this.off.bind(this,e,t)}off(e,t){kh(t),e=Array.isArray(e)?e:[e];for(const i of e)Fl(i,Hs),Dl(this,i).delete(t),this.logIfDebugEnabled("unsubscribe",i,void 0),lp(i)||this.emit(jp,{eventName:i,listener:t},Hs)}once(e){return new Promise(t=>{const i=this.on(e,r=>{i(),t(r)})})}events(e){e=Array.isArray(e)?e:[e];for(const t of e)Fl(t,Hs);return _T(this,e)}async emit(e,t,i){Fl(e,i),this.logIfDebugEnabled("emit",e,t),yW(this,e,t);const r=Dl(this,e),s=To.get(this),o=[...r],a=lp(e)?[]:[...s];await xT,await Promise.all([...o.map(async c=>{if(r.has(c))return c(t)}),...a.map(async c=>{if(s.has(c))return c(e,t)})])}async emitSerial(e,t,i){Fl(e,i),this.logIfDebugEnabled("emitSerial",e,t);const r=Dl(this,e),s=To.get(this),o=[...r],a=[...s];await xT;for(const c of o)r.has(c)&&await c(t);for(const c of a)s.has(c)&&await c(e,t)}onAny(e){return kh(e),this.logIfDebugEnabled("subscribeAny",void 0,void 0),To.get(this).add(e),this.emit($p,{listener:e},Hs),this.offAny.bind(this,e)}anyEvent(){return _T(this)}offAny(e){kh(e),this.logIfDebugEnabled("unsubscribeAny",void 0,void 0),this.emit(jp,{listener:e},Hs),To.get(this).delete(e)}clearListeners(e){e=Array.isArray(e)?e:[e];for(const t of e)if(this.logIfDebugEnabled("clear",t,void 0),typeof t=="string"||typeof t=="symbol"||typeof t=="number"){Dl(this,t).clear();const i=lf(this,t);for(const r of i)r.finish();i.clear()}else{To.get(this).clear();for(const i of ap.get(this).values())i.clear();for(const i of af.get(this).values()){for(const r of i)r.finish();i.clear()}}}listenerCount(e){e=Array.isArray(e)?e:[e];let t=0;for(const i of e){if(typeof i=="string"){t+=To.get(this).size+Dl(this,i).size+lf(this,i).size+lf(this).size;continue}typeof i!="undefined"&&Fl(i,Hs),t+=To.get(this).size;for(const r of ap.get(this).values())t+=r.size;for(const r of af.get(this).values())t+=r.size}return t}bindMethods(e,t){if(typeof e!="object"||e===null)throw new TypeError("`target` must be an object");t=wT(t);for(const i of t){if(e[i]!==void 0)throw new Error(`The property \`${i}\` already exists on \`target\``);Object.defineProperty(e,i,{enumerable:!1,value:this[i].bind(this)})}}}const ST=Object.getOwnPropertyNames(Va.prototype).filter(n=>n!=="constructor");Object.defineProperty(Va,"listenerAdded",{value:$p,writable:!1,enumerable:!0,configurable:!1});Object.defineProperty(Va,"listenerRemoved",{value:jp,writable:!1,enumerable:!0,configurable:!1});var xW=Va;class S_ extends xW{constructor(e,t=!1,i=!1,r=""){super({debug:{name:e,enabled:t,logger:_W(i,r)}})}}const _W=(n=!1,e)=>(t,i,r,s)=>{typeof r=="symbol"&&(r=r.toString());const o=new Date,a=o.getHours(),c=o.getMinutes().toString().padEnd(2,"0"),f=o.getSeconds().toString().padEnd(2,"0"),h=o.getMilliseconds().toString().padEnd(3,"0"),d=t!=="emit"?`(${t})`:"",p=`${a}:${c}:${f}.${h} [${i}:${r}] ${d}`;e&&!(r!=null&&r.includes(e))||(n&&s?console.log(p,s):console.log(p))};class M_ extends w_{constructor(){super(...arguments);O(this,"selectImportance",4);O(this,"path",[])}async setPathTo(t,i=!1){const r=await this.game.pf.findPath(this.position,t);return r&&(this.path=r),i&&this.clipPath(),r}cancelPath(){this.path=[]}clipPath(){return this.path.pop()}getDistanceToTarget(){const t=this.path[this.path.length-1];return t?Pa(this.position,[t.x,t.y]):0}hasPath(){return this.path.length>0}move(){const t=this.path.shift();t&&(this.position=[t.x,t.y])}toJSON(){return{...super.toJSON(),path:this.path}}fromJSON({path:t,...i}){super.fromJSON(i),this.path=t}}const rC="actorModel";var Ys=(n=>(n.Empty="Empty",n.Guardian="Guardian",n.Woodcutter="Woodcutter",n))(Ys||{});class sC{constructor(e,t){O(this,"type",Ys.Empty);O(this,"selectImportance",4);O(this,"isPristine",!0);this.game=e,this.actor=t}getAttackDamage(){return 0}getModel(){const e=new Xi;return e.name=rC,e}async tick(){this.isPristine&&(this.isPristine=!1)}reset(){this.isPristine=!0}toJSON(){return{type:this.type,selectImportance:this.selectImportance,isPristine:this.isPristine}}fromJSON(e){Object.assign(this,e)}}class oC extends sC{constructor(){super(...arguments);O(this,"type",Ys.Guardian);O(this,"selectImportance",5);O(this,"material",new Yn({color:se.guardian.color}));O(this,"geometry",new Uc(.5,5,5))}async tick(){super.tick(),this.actor.move()}getAttackDamage(){return se.guardian.attackDamage}getModel(){const t=super.getModel(),i=new cn(this.geometry,this.material),r=new cn(this.geometry,new Yn({color:13421772}));return i.castShadow=!0,i.receiveShadow=!0,i.scale.y=2,i.scale.z=.5,i.position.y=.5,r.position.z=.25,r.position.y=1,r.position.x=-.25,r.scale.x=.1,r.scale.y=-.01,r.scale.z=2,r.rotation.x=Math.PI/-4,r.name="weapon",t.add(i),t.add(r),t}}class wW{constructor(e,t={},i={}){O(this,"currentState");O(this,"locked",!1);this.machine=e,this.actions=t,this.conditions=i,this.currentState=e.initial}async send(e){var s;if(this.locked)return;const t=this.machine.states[this.currentState];if(!t)throw new Error(`[Machine] State ${this.currentState} not found`);const i=(s=t.on)==null?void 0:s[e],r=EM(i);for(const o of r){if(o.cond&&!this.callCondition(o.cond))continue;const a=EM(o.actions);for(const c of a)this.locked=!0,await this.callAction(c),this.locked=!1;if(o.target){this.currentState=o.target;return}break}}reset(){this.currentState=this.machine.initial,this.locked=!1}setState(e){this.currentState=e}callAction(e){const t=this.actions[e];if(!t)throw new Error(`[Machine] Action ${e} not found`);return t()}callCondition(e){const t=this.conditions[e];if(!t)throw new Error(`[Machine] Condition ${e} not found`);return t()}}const SW=n=>n,MW=SW({id:"woodcutter",initial:"Idle",states:{Idle:{on:{TICK:[{cond:"isFull",target:"HaveWood"},{target:"WoodNeeded"}]}},ChoppingTree:{on:{TICK:[{cond:"isFull",target:"Idle"},{actions:"chopTree",target:"WoodNeeded"}]}},Walking:{on:{TICK:[{actions:"move",cond:"hasPath"},{target:"Idle"}]}},HaveWood:{on:{TICK:[{cond:"hasPath",target:"Walking"},{cond:"nearCamp",target:"NearCamp"},{actions:"findCamp",target:"Walking"}]}},WoodNeeded:{on:{TICK:[{cond:"hasPath",target:"Walking"},{cond:"nearTree",target:"ChoppingTree"},{actions:"findTree",target:"Wait"}]}},NearCamp:{on:{TICK:[{cond:"isEmpty",target:"Idle"},{actions:"gatherWood",target:"HaveWood"}]}},Wait:{on:{TICK:{target:"Walking"}}}}});class aC extends sC{constructor(t,i){super(t,i);O(this,"type",Ys.Woodcutter);O(this,"selectImportance",4);O(this,"treeId");O(this,"campId");O(this,"collectedTreeHP",0);O(this,"material",new Yn({color:se.woodcutter.color}));O(this,"geometry",new Uc(.5,5,5));O(this,"actions",{move:this.move.bind(this),findTree:this.findTree.bind(this),chopTree:this.chopTree.bind(this),putWood:this.putWood.bind(this),findCamp:this.findCamp.bind(this),gatherWood:this.gatherWood.bind(this)});O(this,"guards",{hasPath:this.hasPath.bind(this),isEmpty:this.isEmpty.bind(this),isFull:this.isFull.bind(this),nearTree:this.nearTree.bind(this),nearCamp:this.nearCamp.bind(this),reachedCamp:this.reachedCamp.bind(this)});O(this,"machine",new wW(MW,this.actions,this.guards));this.game=t,this.actor=i}getAttackDamage(){return se.woodcutter.attackDamage}async tick(){super.tick(),await this.machine.send("TICK")}reset(){super.reset(),this.machine.reset()}setCamp(t){this.campId=t.id}getModel(){const t=super.getModel();this.material.depthFunc=e_;const i=new cn(this.geometry,this.material);return i.renderOrder=1,i.castShadow=!0,i.receiveShadow=!0,i.scale.y=2,i.scale.z=.5,i.position.y=.5,t.add(i),t}toJSON(){return{...super.toJSON(),collectedTreeHP:this.collectedTreeHP,machineState:this.machine.currentState,treeId:this.treeId,campId:this.campId}}fromJSON({machineState:t,collectedTreeHP:i,treeId:r,campId:s,...o}){super.fromJSON(o),this.machine.setState(t),Object.assign(this,{collectedTreeHP:i,treeId:r,campId:s})}getTree(){if(!!this.treeId)return this.game.getActorById(this.treeId)}getCamp(){if(!!this.campId)return this.game.getActorById(this.campId)}move(){this.actor.move()}findTree(){const t=this.game.findClosestActorByType(_t.Tree,this.actor.position);if(!!t)return this.actor.cancelPath(),this.treeId=t.id,this.actor.setPathTo(t.position,!1,!0)}chopTree(){const t=this.getTree();if(!t)return;const i=Math.round(se.woodcutter.choppingDamage*Math.random());this.collectedTreeHP+=t.hit(i)}putWood(){const t=this.getCamp();if(!t)return;const i=q2(this.collectedTreeHP,se.woodcutter.gatheringSpeed);this.collectedTreeHP-=i,t.collectTree(i)}findCamp(){const t=this.getCamp();!t||this.actor.setPathTo(t.getDeliveryPosition())}gatherWood(){const t=se.woodcutter.gatheringSpeed,i=this.collectedTreeHP<t?this.collectedTreeHP:t;this.collectedTreeHP-=i}hasPath(){return this.actor.hasPath()}isEmpty(){return this.collectedTreeHP===0}isFull(){return this.collectedTreeHP>=se.woodcutter.capacity}nearTree(){return this.game.findActorsByPosition(this.actor.position,1.7).some(i=>i.type===_t.Tree)}nearCamp(){const t=this.getCamp();return t?cT(this.actor.position,t.getDeliveryPosition()):!1}reachedCamp(){const t=this.getCamp();return t?cT(t.getDeliveryPosition(),this.actor.position):!1}}const bW=()=>{throw new Error("[professionByType] Don't use empty profession")},TW={[Ys.Empty]:bW,[Ys.Guardian]:oC,[Ys.Woodcutter]:aC};class b_ extends M_{constructor(){super(...arguments);O(this,"type",_t.Human);O(this,"maxHp",se.human.hp);O(this,"profession");O(this,"target");O(this,"home");O(this,"animationMixer");O(this,"actorAnimationState","idle")}tick(){super.tick(),this.target?(this.cancelProfession(),this.fight()):this.profession?this.profession.tick():this.walkAround()}setHome(t){this.home=t}setProfession(t){this.profession=t,this.selectImportance=t.selectImportance}setTarget(t){this.target=t}hitBy(t){super.hitBy(t),t&&!this.target&&this.setTarget(t)}getAttackDamage(){let t=se.human.attackDamage;return this.profession&&(t+=this.profession.getAttackDamage()),t}setPathTo(t,i=!0,r=!1){return i&&(this.target=void 0),super.setPathTo(t,r)}getSelectedImportance(){return this.profession?this.profession.selectImportance:super.getSelectedImportance()}toJSON(){var i;return{...super.toJSON(),profession:(i=this.profession)==null?void 0:i.toJSON()}}fromJSON(t){if(super.fromJSON(t),t.profession){const i=TW[t.profession.type],r=new i(this.game,this);r.fromJSON(t.profession),this.setProfession(r)}}cancelProfession(){!this.profession||this.profession.isPristine||this.profession.reset()}walkAround(){if(this.move(),this.hasPath()||Math.random()>se.human.randomWalkChance||!this.home)return;const t=se.human.walkAroundHomeDistance,i=[Kr(t,-t,!0),Kr(t,-t,!0)],r=Ff(this.home.position,i);this.game.world.hasTile(r)&&this.setPathTo(r)}fight(){if(!this.target)return;if(this.move(),Pa(this.position,this.target.position)<se.human.attackDistance){this.cancelPath();const i=this.getAttackDamage();this.target.hit(i,this),this.target.isDead()&&(this.target=void 0)}else{if(this.hasPath())return;this.setPathTo(this.target.position,!1,!0)}}}var T_=(n=>(n.Residence="Residence",n))(T_||{});const EW={residentsLimit:5,spawnPosition:[0,0]};class E_{constructor(e,t=EW){O(this,"type",T_.Residence);O(this,"newHumanCountdown",this.childCount());this.buildingActor=e,this.config=t}tick(){this.newHumanCountdown--,this.newHumanCountdown<=0&&(this.newHumanCountdown=this.childCount(),this.spawnNewHuman())}toJSON(){return{type:this.type,newChildCount:this.newHumanCountdown,config:this.config}}fromJSON(e){this.newHumanCountdown=e.newChildCount,this.config=e.config}spawnNewHuman(){if(this.findResidents().length>=this.config.residentsLimit)return;const t=this.buildingActor.game.spawnActor(b_,this.buildingActor.player,this.config.spawnPosition);!t||t.setHome(this.buildingActor)}findResidents(){return this.buildingActor.game.findActorsByType(_t.Human).filter(t=>t.home===this.buildingActor)}childCount(){return Kr(se.house.newChildCountMin,se.house.newChildCountMax,!0)}}const AW={[T_.Residence]:E_},CW=(n,e)=>{const t=AW[n.type];if(!t)throw new Error(`[BuildingActor] Unknown trait type: ${n.type}`);const i=new t(e);return i.fromJSON(n),i};class Vc extends w_{constructor(){super(...arguments);O(this,"selectImportance",1);O(this,"blueprint",{});O(this,"traits",[])}tick(){super.tick(),this.traits.forEach(t=>t.tick())}getSize(){const t=this.blueprint.getGrid(),i=this.blueprint.height;if(!t[0])throw new Error("[BuildingActor] Grid is empty");return[t[0].length,t.length,i]}getGlobalPosition(){const[t,i]=this.getSize(),[r,s]=this.position;return[r-Math.floor(t/2),s-Math.floor(i/2)]}getGlobalPositionOfLocalPoint(t){const i=EG(t,this.getSize(),this.rotation);return Ff(this.getGlobalPosition(),i)}toJSON(){return{...super.toJSON(),traits:this.traits.map(t=>t.toJSON())}}fromJSON(t){super.fromJSON(t),this.traits=t.traits.map(i=>CW(i,this))}}const lc=n=>n instanceof b_,lC=n=>n instanceof Vc,cC=n=>n instanceof M_;class RW extends Vc{constructor(){super(...arguments);O(this,"type",_t.Barracks);O(this,"blueprint",Xo[this.type].blueprint);O(this,"maxHp",se.barracks.hp);O(this,"hp",this.maxHp)}tick(){}interact(t){let i=!1;for(const r of t)if(lc(r)){const s=new oC(this.game,r);r.setProfession(s),i=!0}return i}}var PW="/Medieval/assets/barracks.46d83c4c.gltf";const LW=Zf(PW);class IW{constructor(){O(this,"grid",[["\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F6D6}","\u{1F9B6}\u{1F3FD}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F7E2}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F6D6}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F7E2}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F6D6}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F6D6}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F9F1}","\u{1F9B6}\u{1F3FD}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"],["\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"]]);O(this,"height",4);O(this,"model",this.loadModel().model)}getModel(){return this.model}getPlaceholder(){return this.loadModel()}getGrid(){return this.grid}loadModel(){const e=new a_,t=LW.then(i=>{i.children.forEach((r,s)=>{e.addLevel(r.clone(),(i.children.length-s-1)*80)})});return Wc(e),{model:e,promise:t}}}class wm{constructor(){O(this,"group",new Xi)}render(e){}}class $c extends wm{constructor(t,i){super();O(this,"actorType",_t.Empty);O(this,"hpMaterial",new of({color:16715264}));O(this,"hpBgMaterial",new of({color:0,transparent:!0,opacity:.5}));O(this,"actorGroupMap",new Map);O(this,"actorInteractionShapeMap",new Map);O(this,"handleActorAdded",t=>{t.type===this.actorType&&this.onAddActor(t)});O(this,"handleActorRemoved",t=>{t.type===this.actorType&&this.onRemoveActor(t)});this.game=t,this.player=i}init(){this.game.emitter.on("actorAdded",this.handleActorAdded),this.game.emitter.on("actorRemoved",this.handleActorRemoved),this.game.findActorsByType(this.actorType).forEach(i=>{this.onAddActor(i)})}destroy(){this.game.emitter.off("actorAdded",this.handleActorAdded),this.game.emitter.off("actorRemoved",this.handleActorRemoved)}createActorModel(t,i){const r=new Xi,s=new kb(this.hpMaterial.clone()),o=new kb(this.hpBgMaterial);o.renderOrder=1,s.renderOrder=2,s.scale.x=2*se.renderer.tileSize,s.scale.y=.2*se.renderer.tileSize,o.scale.x=2.1*se.renderer.tileSize,o.scale.y=.3*se.renderer.tileSize,s.name="hp",o.name="hpBg",s.position.y=3*se.renderer.tileSize,o.position.y=s.position.y,r.add(o),r.add(s);const a=this.createInteractionMesh(t);return r.add(a),Wp(r,t.position,i.height),r.rotation.y=Y2(t.rotation),{group:r,interactionShape:a}}render(t){this.updatePosition(t),this.updateHP(),this.updateSelect()}getSelectedGroups(){const t=[];return this.actorGroupMap.forEach((i,r)=>{this.player.selectedActors.includes(r)&&t.push(i)}),t}getInteractionShapes(){return Array.from(this.actorInteractionShapeMap.keys())}onAddActor(t){const i=this.game.world.getTile(t.position),{group:r,interactionShape:s}=this.createActorModel(t,i);this.actorGroupMap.set(t,r),this.actorInteractionShapeMap.set(s,t),this.group.add(r)}onRemoveActor(t){const i=this.actorGroupMap.get(t);if(!i)throw new Error(`[ActorRenderer] Unable to remove actor ${t.id}`);this.group.remove(i),this.actorGroupMap.delete(t)}createInteractionMesh(t){let i=1,r=1,s=1;const o=se.renderer.tileSize;lC(t)&&([i,s,r]=t.getSize()),i*=o,r*=o,s*=o;const a=new cn(new kc(i,r,s),new wr({color:16777215,wireframe:!0,visible:se.debug.wireModel}));a.position.y=r/2,a.userData={actor:t};const c=new zH(new d_((i+r/2.2)/2.2,64));c.rotateX(Math.PI/2);const f=new u_(c,new zc({color:6225764,linewidth:2*window.devicePixelRatio,depthFunc:e_})),h=.2*o;return f.position.x=0,f.position.z=0,f.position.y=h-r/2,a.add(f),a}updatePosition(t){this.actorGroupMap.forEach((i,r)=>{const s=this.game.world.getTile(r.position);Wp(i,r.position,s.height)})}updateHP(){this.actorGroupMap.forEach((t,i)=>{const r=t.getObjectByName("hp"),s=t.getObjectByName("hpBg");if(r.scale.x=i.hp/i.maxHp*2*se.renderer.tileSize,r.material instanceof of){const o=i.hp/i.maxHp,a=1*(1-o)*2,c=1*o-.5,f=.2*o;r.material.color.setRGB(a,c,f)}r.visible=i.hp<i.maxHp,s.visible=r.visible})}updateSelect(){this.actorInteractionShapeMap.forEach((t,i)=>{i.visible=this.player.selectedActors.includes(t)})}}class FW extends $c{constructor(){super(...arguments);O(this,"actorType",_t.Barracks)}createActorModel(t,i){const{group:r,interactionShape:s}=super.createActorModel(t,i),o=t.blueprint.getModel();r.add(o.clone());const a=se.renderer.tileSize;if(se.renderer.light){const c=new Yf(16417806,5,15*a);c.position.set(3*a,7*a,3*a),c.castShadow=!0,r.add(c)}if(se.debug.wireModel){const c=new Tc(a*5);r.add(c)}return{group:r,interactionShape:s}}}class DW extends Vc{constructor(){super(...arguments);O(this,"type",_t.Guildhall);O(this,"blueprint",Xo[this.type].blueprint);O(this,"maxHp",se.guildhall.hp);O(this,"hp",this.maxHp);O(this,"traits",[new E_(this,{residentsLimit:5,spawnPosition:this.position})])}}var NW="/Medieval/assets/guildhallv3.6b143002.gltf";const OW=Zf(NW);class kW{constructor(){O(this,"grid",[["\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F6D6}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F6D6}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F9F1}","\u{1F9B6}\u{1F3FD}","\u{1F9F1}","\u{1F9B6}\u{1F3FD}","\u{1F9F1}","\u{1F6D6}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F9F1}","\u{1F9B6}\u{1F3FD}","\u{1F9F1}","\u{1F9B6}\u{1F3FD}","\u{1F9F1}","\u{1F6D6}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F7E2}"],["\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"]]);O(this,"height",6);O(this,"model",this.loadModel().model)}getModel(){return this.model}getPlaceholder(){return this.loadModel()}getGrid(){return this.grid}loadModel(){const e=new Xi,t=OW.then(i=>{i.children.forEach((r,s)=>{e.add(r.clone())})});return Wc(e),{model:e,promise:t}}}class BW extends $c{constructor(){super(...arguments);O(this,"actorType",_t.Guildhall)}createActorModel(t,i){const{group:r,interactionShape:s}=super.createActorModel(t,i),o=t.blueprint.getModel();r.add(o.clone());const a=se.renderer.tileSize,c=new Yf(16417806,5,20*a);if(c.position.set(0*a,1*a,3*a),c.castShadow=!0,c.shadow.mapSize.width=128*5,c.shadow.mapSize.height=128*5,c.shadow.camera.near=1*a,c.shadow.camera.far=20*a,c.shadow.bias=-1e-4*se.renderer.tileSize,c.shadow.normalBias=.27*se.renderer.tileSize,se.debug.wireModel){const f=new Tc(a);f.position.copy(c.position),r.add(f);const h=new Tc(a*5);r.add(h)}return r.add(c),{group:r,interactionShape:s}}}class zW extends Vc{constructor(){super(...arguments);O(this,"type",_t.House);O(this,"blueprint",Xo[this.type].blueprint);O(this,"maxHp",se.house.hp);O(this,"hp",this.maxHp);O(this,"traits",[new E_(this,{residentsLimit:3,spawnPosition:this.getSpawnPosition()})])}getSpawnPosition(){return this.getGlobalPositionOfLocalPoint(this.blueprint.config.spawnPoint)}}var UW="/Medieval/assets/house.de12a52c.gltf";const HW=Zf(UW);class GW{constructor(){O(this,"grid",[["\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9B6}\u{1F3FD}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F9F1}","\u{1F9F1}","\u{1F9B6}\u{1F3FD}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F6D6}","\u{1F9F1}","\u{1F9F1}","\u{1F9B6}\u{1F3FD}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F6D6}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9B6}\u{1F3FD}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F6D6}","\u{1F9F1}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F7E2}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F6D6}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F6D6}","\u{1F6D6}","\u{1F9F1}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9B6}\u{1F3FD}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"],["\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"]]);O(this,"height",3);O(this,"config",{spawnPoint:[3,4]});O(this,"model",this.loadModel().model)}getModel(){return this.model}getPlaceholder(){return this.loadModel()}getGrid(){return this.grid}loadModel(){const e=new a_,t=HW.then(i=>{i.children.forEach((r,s)=>{e.addLevel(r.clone(),(i.children.length-s-1)*80)})});return Wc(e),{model:e,promise:t}}}class WW extends $c{constructor(){super(...arguments);O(this,"actorType",_t.House)}createActorModel(t,i){const{group:r,interactionShape:s}=super.createActorModel(t,i),o=t.blueprint.getModel();r.add(o.clone());const a=se.renderer.tileSize;if(se.renderer.light){const c=new Yf(16417806,5,15*a);c.position.set(1*a,2*a,1*a),c.castShadow=!0,r.add(c)}if(se.debug.wireModel){const c=new Tc(a*5);r.add(c)}return{group:r,interactionShape:s}}}class VW extends Vc{constructor(){super(...arguments);O(this,"type",_t.Stakewall);O(this,"blueprint",Xo[this.type].blueprint);O(this,"maxHp",se.wall.hp);O(this,"hp",this.maxHp)}}var $W="/Medieval/assets/wall.2bc55ed2.gltf";const jW=Zf($W);class XW{constructor(){O(this,"grid",[["\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"]]);O(this,"height",4);O(this,"model",this.loadModel().model)}loadModel(){const e=new Xi,t=jW.then(i=>{i.children.forEach(r=>{(!r.name.includes("alt")||Math.random()>.5)&&e.add(r.clone())})});return Wc(e),e.rotateY(Math.random()*Math.PI),{model:e,promise:t}}getModel(){return this.model}getPlaceholder(){return this.loadModel()}getGrid(){return this.grid}}class qW extends $c{constructor(){super(...arguments);O(this,"actorType",_t.Stakewall)}createActorModel(t,i){const{group:r,interactionShape:s}=super.createActorModel(t,i),o=t.blueprint.getModel();if(r.add(o.clone()),se.debug.wireModel){const a=se.renderer.tileSize,c=new Tc(a*2);r.add(c)}return{group:r,interactionShape:s}}}class YW extends Vc{constructor(){super(...arguments);O(this,"type",_t.WoodCamp);O(this,"blueprint",Xo[this.type].blueprint);O(this,"collectedTreeHP",0)}getDeliveryPosition(){return this.getGlobalPositionOfLocalPoint(this.blueprint.config.deliveryPoint)}collectTree(t){this.collectedTreeHP+=t}interact(t){let i=!1;for(const r of t)if(lc(r)){const s=new aC(this.game,r);s.setCamp(this),r.setProfession(s),i=!0}return i}}var KW="/Medieval/assets/woodCamp.d73837f2.gltf";const ZW=Zf(KW);class QW{constructor(){O(this,"grid",[["\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F6D6}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F6D6}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9B6}\u{1F3FD}","\u{1F9F1}","\u{1F6D6}","\u{1F9F1}","\u{1F7E2}"],["\u{1F9F1}","\u{1F9F1}","\u{1F9F1}","\u{1F9B6}\u{1F3FD}","\u{1F9F1}","\u{1F6D6}","\u{1F9F1}","\u{1F7E2}"],["\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}","\u{1F7E2}"]]);O(this,"height",3);O(this,"config",{deliveryPoint:[2,5]});O(this,"model",this.loadModel().model)}getModel(){return this.model}getPlaceholder(){return this.loadModel()}getGrid(){return this.grid}loadModel(){const e=new a_,t=ZW.then(i=>{i.children.forEach((r,s)=>{e.addLevel(r.clone(),(i.children.length-s-1)*80)})});return Wc(e),{model:e,promise:t}}}class JW extends $c{constructor(){super(...arguments);O(this,"actorType",_t.WoodCamp)}createActorModel(t,i){const{group:r,interactionShape:s}=super.createActorModel(t,i),o=se.renderer.tileSize;if(se.renderer.light){const c=new Yf(16417806,5,15*o);c.position.set(1*o,2*o,1*o),c.castShadow=!0,r.add(c)}if(se.debug.wireModel){const c=new Tc(o*5);r.add(c)}const a=t.blueprint.getModel();return r.add(a.clone()),{group:r,interactionShape:s}}}class eV{constructor(e){O(this,"actorType",_t.Tree);O(this,"boughGeometry",new h_(.2,.4,3,3));O(this,"boughMaterial",new Yn({color:3024421,metalness:.8,roughness:1}));O(this,"coronaGeometry",new Uc(1.5,5,4));O(this,"coronaMaterial",new Yn({color:2900491,metalness:.8,roughness:.9,flatShading:!0}));O(this,"group",new Xi);O(this,"boughInstanceMesh",new Xb(this.boughGeometry,this.boughMaterial,3e3));O(this,"coronaInstanceMesh",new Xb(this.coronaGeometry,this.coronaMaterial,3e3));O(this,"actorCount",0);this.game=e,this.boughInstanceMesh.instanceMatrix.setUsage(JM),this.boughInstanceMesh.castShadow=!0,this.boughInstanceMesh.receiveShadow=!0,this.coronaInstanceMesh.instanceMatrix.setUsage(JM),this.coronaInstanceMesh.castShadow=!0,this.coronaInstanceMesh.receiveShadow=!0,this.group.add(this.boughInstanceMesh),this.boughInstanceMesh.translateY(1.8*se.renderer.tileSize),this.group.add(this.coronaInstanceMesh),this.coronaInstanceMesh.translateY(4.5*se.renderer.tileSize)}render(e){const t=e.elapsedTime*5,i=this.game.findActorsByType(this.actorType),r=new $t;for(let s=0;s<Math.max(this.actorCount,i.length);s++){const o=i[s];if(o){const a=K2(o.seed),c=this.game.world.getTile(o.position);if(Wp(r,o.position,c.height),r.scale.set(a(.8,1.5)*se.renderer.tileSize,a(1,1.5)*se.renderer.tileSize,a(.8,1.5)*se.renderer.tileSize),r.rotation.set(a(-.5,.5)/Math.PI,a(-.5,.5)/Math.PI,a(-.5,.5)/Math.PI),se.renderer.treeWaving){const f=r.scale.z*a(-.5,.5),h=r.scale.z*a(-.5,.5);r.rotation.z+=Math.sin(f+t*.2*(f*(Math.PI/1)))/15,r.position.x+=Math.sin(f+t*.2*(f*(Math.PI/1)))/-8,r.rotation.x+=Math.sin(h+t*.2*(h*(Math.PI/1)))/15,r.position.z+=Math.sin(h+t*.2*(h*(Math.PI/1)))/8}}else r.position.set(0,0,0),r.scale.set(0,0,0);r.updateMatrix(),this.boughInstanceMesh.setMatrixAt(s,r.matrix),this.coronaInstanceMesh.setMatrixAt(s,r.matrix)}this.boughInstanceMesh.instanceMatrix.needsUpdate=!0,this.coronaInstanceMesh.instanceMatrix.needsUpdate=!0,this.actorCount=i.length}}class tV extends M_{constructor(){super(...arguments);O(this,"type",_t.Boar);O(this,"maxHp",se.boar.hp);O(this,"hp",this.maxHp);O(this,"target")}tick(){super.tick();const t=this.game.findActorByRange(this.position,se.boar.lookEnemyDistance,i=>i.type===_t.Human);t&&this.setTarget(t),this.target?this.fight():this.walkAround()}hitBy(t){t&&!this.target&&this.setTarget(t)}setTarget(t){this.target=t}walkAround(){if(this.move(),this.hasPath()||Math.random()>.1)return;const t=5,i=[Kr(t,-t,!0),Kr(t,-t,!0)],r=Ff(this.position,i);this.game.world.hasTile(r)&&this.setPathTo(r)}fight(){if(!this.target)return;this.move(),Pa(this.position,this.target.position)<se.boar.attackDistance?(this.cancelPath(),this.target.hit(se.boar.attackDamage,this),this.target.isDead()&&(this.target=void 0)):this.setPathTo(this.target.position,!0)}interact(t){const i=t.filter(lc);for(const r of i)r.setTarget(this);return!1}}class uC extends $c{render(e){super.render(e),this.updateRotation(e)}updatePosition(e){this.actorGroupMap.forEach((t,i)=>{const r=Math.min(e.deltaTime*se.walkableRenderer.movementSmoothness,1),[s,o]=i.position,a=this.game.world.getTile(i.position),c=s*se.renderer.tileSize,f=o*se.renderer.tileSize,h=a.height*se.renderer.tileSize;t.position.x+=(c-t.position.x)*r,t.position.z+=(f-t.position.z)*r,t.position.y+=(h-t.position.y)*r})}updateRotation(e){this.actorGroupMap.forEach((t,i)=>{const[r,s]=i.position,o=this.game.world.getTile(i.position),a=r*se.renderer.tileSize,c=s*se.renderer.tileSize,f=t.position,h=new z(a,o.height,c);if(h.distanceTo(f)>.1){const p=h.clone().sub(f),g=p.angleTo(new z(0,0,1));let _=p.x>0?g:g*-1;const y=new qn().setFromAxisAngle(new z(0,1,0),_);if(!t.quaternion.equals(y)){const x=e.deltaTime*se.walkableRenderer.rotationSmoothness;t.quaternion.rotateTowards(y,x)}}})}}class nV extends uC{constructor(){super(...arguments);O(this,"actorType",_t.Boar);O(this,"material",new Yn({color:4859141}));O(this,"geometry",new Uc(.7*se.renderer.tileSize,5,5))}createActorModel(t,i){const{group:r,interactionShape:s}=super.createActorModel(t,i),o=new cn(this.geometry,this.material);return o.castShadow=!0,o.receiveShadow=!0,o.scale.y=.5,o.scale.x=.5,o.scale.z=1,o.position.y=.5*se.renderer.tileSize,r.add(o),{group:r,interactionShape:s}}}var iV="/Medieval/assets/human.31341ceb.gltf";class rV extends uC{constructor(){super(...arguments);O(this,"actorType",_t.Human);O(this,"animationList");O(this,"actorPreviousProfession",new WeakMap)}createActorModel(t,i){const{group:r,interactionShape:s}=super.createActorModel(t,i);return aW(iV).then(o=>{if(this.animationList=o.animations,t.animationMixer=new wG(o.scene),this.animationList&&t.animationMixer.clipAction(this.animationList[0]).play(),o.scene){o.scene.name=rC,Wc(o.scene);const a=o.scene.getObjectByName("Cube001_1");a&&a.material&&(a.material=new Yn({color:Iy(qs(2568225,20),!1,.25),roughness:1,metalness:0})),o.scene.position.y=.025*se.renderer.tileSize,r.add(o.scene)}}),{group:r,interactionShape:s}}swapToProfessionActorModel(t){const i=this.actorGroupMap.get(t);if(!t.profession)return;const r=i.getObjectByName("Cube001_1");r&&r.material&&(t.profession.type===Ys.Woodcutter&&(r.material=new Yn({color:Iy(qs(se.woodcutter.color,6),!1,.25),roughness:1,metalness:0})),t.profession.type===Ys.Guardian&&(r.material=new Yn({color:qs(10066329,10,!0),roughness:.1,metalness:.9})))}render(t){super.render(t),this.actorGroupMap.forEach((i,r)=>{r.animationMixer&&this.animationList&&(r.hasPath()&&r.actorAnimationState!="walking"&&(r.animationMixer.stopAllAction(),r.animationMixer.clipAction(this.animationList[1]).play(),r.actorAnimationState="walking"),!r.hasPath()&&r.actorAnimationState!="idle"&&(r.animationMixer.stopAllAction(),r.animationMixer.clipAction(this.animationList[0]).play(),r.actorAnimationState="idle"),r.animationMixer.update(t.deltaTime))}),this.updateProfession()}updateProfession(){this.actorGroupMap.forEach((t,i)=>{!i.profession||this.actorPreviousProfession.get(i)!==i.profession&&(this.actorPreviousProfession.set(i,i.profession),this.swapToProfessionActorModel(i))})}}const sV=[BW,WW,rV,JW,FW,qW,nV],oV=[eV],aV=()=>{throw new Error("[actorByType] Don't use empty actor")},Xo={[_t.Empty]:aV,[_t.Guildhall]:{actorClass:DW,blueprint:new kW},[_t.House]:{actorClass:zW,blueprint:new GW},[_t.WoodCamp]:{actorClass:YW,blueprint:new QW},[_t.Barracks]:{actorClass:RW,blueprint:new IW},[_t.Stakewall]:{actorClass:VW,blueprint:new XW},[_t.Human]:{actorClass:b_},[_t.Tree]:{actorClass:ky},[_t.Boar]:{actorClass:tV}},lV=(n,e,t)=>{const i=Xo[n.type].actorClass,r=new i(e,t);return r.fromJSON(n),r};var cV=function(){this.pointsToAvoid={},this.startX,this.callback,this.startY,this.endX,this.endY,this.nodeHash={},this.openList},uV=function(n,e,t,i,r){this.parent=n,this.x=e,this.y=t,this.costSoFar=i,this.simpleDistanceToTarget=r,this.bestGuessDistance=function(){return this.costSoFar+this.simpleDistanceToTarget}},fC={exports:{}};(function(n,e){(function(){var t,i,r,s,o,a,c,f,h,d,p,g,_,y,x;r=Math.floor,d=Math.min,i=function(v,w){return v<w?-1:v>w?1:0},h=function(v,w,S,E,b){var T;if(S==null&&(S=0),b==null&&(b=i),S<0)throw new Error("lo must be non-negative");for(E==null&&(E=v.length);S<E;)T=r((S+E)/2),b(w,v[T])<0?E=T:S=T+1;return[].splice.apply(v,[S,S-S].concat(w)),w},a=function(v,w,S){return S==null&&(S=i),v.push(w),y(v,0,v.length-1,S)},o=function(v,w){var S,E;return w==null&&(w=i),S=v.pop(),v.length?(E=v[0],v[0]=S,x(v,0,w)):E=S,E},f=function(v,w,S){var E;return S==null&&(S=i),E=v[0],v[0]=w,x(v,0,S),E},c=function(v,w,S){var E;return S==null&&(S=i),v.length&&S(v[0],w)<0&&(E=[v[0],w],w=E[0],v[0]=E[1],x(v,0,S)),w},s=function(v,w){var S,E,b,T,C,A;for(w==null&&(w=i),T=function(){A=[];for(var F=0,U=r(v.length/2);0<=U?F<U:F>U;0<=U?F++:F--)A.push(F);return A}.apply(this).reverse(),C=[],E=0,b=T.length;E<b;E++)S=T[E],C.push(x(v,S,w));return C},_=function(v,w,S){var E;if(S==null&&(S=i),E=v.indexOf(w),E!==-1)return y(v,0,E,S),x(v,E,S)},p=function(v,w,S){var E,b,T,C,A;if(S==null&&(S=i),b=v.slice(0,w),!b.length)return b;for(s(b,S),A=v.slice(w),T=0,C=A.length;T<C;T++)E=A[T],c(b,E,S);return b.sort(S).reverse()},g=function(v,w,S){var E,b,T,C,A,F,U,W,ne;if(S==null&&(S=i),w*10<=v.length){if(T=v.slice(0,w).sort(S),!T.length)return T;for(b=T[T.length-1],U=v.slice(w),C=0,F=U.length;C<F;C++)E=U[C],S(E,b)<0&&(h(T,E,0,null,S),T.pop(),b=T[T.length-1]);return T}for(s(v,S),ne=[],A=0,W=d(w,v.length);0<=W?A<W:A>W;0<=W?++A:--A)ne.push(o(v,S));return ne},y=function(v,w,S,E){var b,T,C;for(E==null&&(E=i),b=v[S];S>w;){if(C=S-1>>1,T=v[C],E(b,T)<0){v[S]=T,S=C;continue}break}return v[S]=b},x=function(v,w,S){var E,b,T,C,A;for(S==null&&(S=i),b=v.length,A=w,T=v[w],E=2*w+1;E<b;)C=E+1,C<b&&!(S(v[E],v[C])<0)&&(E=C),v[w]=v[E],w=E,E=2*w+1;return v[w]=T,y(v,A,w,S)},t=function(){v.push=a,v.pop=o,v.replace=f,v.pushpop=c,v.heapify=s,v.updateItem=_,v.nlargest=p,v.nsmallest=g;function v(w){this.cmp=w!=null?w:i,this.nodes=[]}return v.prototype.push=function(w){return a(this.nodes,w,this.cmp)},v.prototype.pop=function(){return o(this.nodes,this.cmp)},v.prototype.peek=function(){return this.nodes[0]},v.prototype.contains=function(w){return this.nodes.indexOf(w)!==-1},v.prototype.replace=function(w){return f(this.nodes,w,this.cmp)},v.prototype.pushpop=function(w){return c(this.nodes,w,this.cmp)},v.prototype.heapify=function(){return s(this.nodes,this.cmp)},v.prototype.updateItem=function(w){return _(this.nodes,w,this.cmp)},v.prototype.clear=function(){return this.nodes=[]},v.prototype.empty=function(){return this.nodes.length===0},v.prototype.size=function(){return this.nodes.length},v.prototype.clone=function(){var w;return w=new v,w.nodes=this.nodes.slice(0),w},v.prototype.toArray=function(){return this.nodes.slice(0)},v.prototype.insert=v.prototype.push,v.prototype.top=v.prototype.peek,v.prototype.front=v.prototype.peek,v.prototype.has=v.prototype.contains,v.prototype.copy=v.prototype.clone,v}(),function(v,w){return n.exports=w()}(this,function(){return t})}).call(Ma)})(fC);var fV=fC.exports,Fn={},dV=cV,hV=uV,pV=fV;const mV=0,gV=1;var vV=Fn,yV=1;Fn.js=function(){var n=1,e=1.4,t=!1,i={},r,s={},o={},a={},c=!0,f,h={},d=[],p=Number.MAX_VALUE,g,_=!1;this.setAcceptableTiles=function(b){b instanceof Array?g=b:!isNaN(parseFloat(b))&&isFinite(b)&&(g=[b])},this.enableSync=function(){t=!0},this.disableSync=function(){t=!1},this.enableDiagonals=function(){_=!0},this.disableDiagonals=function(){_=!1},this.setGrid=function(b){r=b;for(var T=0;T<r.length;T++)for(var C=0;C<r[0].length;C++)s[r[T][C]]||(s[r[T][C]]=1)},this.setTileCost=function(b,T){s[b]=T},this.setAdditionalPointCost=function(b,T,C){o[T]===void 0&&(o[T]={}),o[T][b]=C},this.removeAdditionalPointCost=function(b,T){o[T]!==void 0&&delete o[T][b]},this.removeAllAdditionalPointCosts=function(){o={}},this.setDirectionalCondition=function(b,T,C){a[T]===void 0&&(a[T]={}),a[T][b]=C},this.removeAllDirectionalConditions=function(){a={}},this.setIterationsPerCalculation=function(b){p=b},this.avoidAdditionalPoint=function(b,T){i[T]===void 0&&(i[T]={}),i[T][b]=1},this.stopAvoidingAdditionalPoint=function(b,T){i[T]!==void 0&&delete i[T][b]},this.enableCornerCutting=function(){c=!0},this.disableCornerCutting=function(){c=!1},this.stopAvoidingAllAdditionalPoints=function(){i={}},this.findPath=function(b,T,C,A,F){var U=function(K){t?F(K):setTimeout(function(){F(K)})};if(g===void 0)throw new Error("You can't set a path without first calling setAcceptableTiles() on EasyStar.");if(r===void 0)throw new Error("You can't set a path without first calling setGrid() on EasyStar.");if(b<0||T<0||C<0||A<0||b>r[0].length-1||T>r.length-1||C>r[0].length-1||A>r.length-1)throw new Error("Your start or end point is outside the scope of your grid.");if(b===C&&T===A){U([]);return}for(var W=r[A][C],ne=!1,re=0;re<g.length;re++)if(W===g[re]){ne=!0;break}if(ne===!1){U(null);return}var V=new dV;V.openList=new pV(function(K,ae){return K.bestGuessDistance()-ae.bestGuessDistance()}),V.isDoneCalculating=!1,V.nodeHash={},V.startX=b,V.startY=T,V.endX=C,V.endY=A,V.callback=U,V.openList.push(S(V,V.startX,V.startY,null,n));var ie=yV++;return h[ie]=V,d.push(ie),ie},this.cancelPath=function(b){return b in h?(delete h[b],!0):!1},this.calculate=function(){if(!(d.length===0||r===void 0||g===void 0))for(f=0;f<p;f++){if(d.length===0)return;t&&(f=0);var b=d[0],T=h[b];if(typeof T=="undefined"){d.shift();continue}if(T.openList.size()===0){T.callback(null),delete h[b],d.shift();continue}var C=T.openList.pop();if(T.endX===C.x&&T.endY===C.y){var A=[];A.push({x:C.x,y:C.y});for(var F=C.parent;F!=null;)A.push({x:F.x,y:F.y}),F=F.parent;A.reverse();var U=A;T.callback(U),delete h[b],d.shift();continue}C.list=mV,C.y>0&&y(T,C,0,-1,n*w(C.x,C.y-1)),C.x<r[0].length-1&&y(T,C,1,0,n*w(C.x+1,C.y)),C.y<r.length-1&&y(T,C,0,1,n*w(C.x,C.y+1)),C.x>0&&y(T,C,-1,0,n*w(C.x-1,C.y)),_&&(C.x>0&&C.y>0&&(c||x(r,g,C.x,C.y-1,C)&&x(r,g,C.x-1,C.y,C))&&y(T,C,-1,-1,e*w(C.x-1,C.y-1)),C.x<r[0].length-1&&C.y<r.length-1&&(c||x(r,g,C.x,C.y+1,C)&&x(r,g,C.x+1,C.y,C))&&y(T,C,1,1,e*w(C.x+1,C.y+1)),C.x<r[0].length-1&&C.y>0&&(c||x(r,g,C.x,C.y-1,C)&&x(r,g,C.x+1,C.y,C))&&y(T,C,1,-1,e*w(C.x+1,C.y-1)),C.x>0&&C.y<r.length-1&&(c||x(r,g,C.x,C.y+1,C)&&x(r,g,C.x-1,C.y,C))&&y(T,C,-1,1,e*w(C.x-1,C.y+1)))}};var y=function(b,T,C,A,F){var U=T.x+C,W=T.y+A;if((i[W]===void 0||i[W][U]===void 0)&&x(r,g,U,W,T)){var ne=S(b,U,W,T,F);ne.list===void 0?(ne.list=gV,b.openList.push(ne)):T.costSoFar+F<ne.costSoFar&&(ne.costSoFar=T.costSoFar+F,ne.parent=T,b.openList.updateItem(ne))}},x=function(b,T,C,A,F){var U=a[A]&&a[A][C];if(U){var W=v(F.x-C,F.y-A),ne=function(){for(var V=0;V<U.length;V++)if(U[V]===W)return!0;return!1};if(!ne())return!1}for(var re=0;re<T.length;re++)if(b[A][C]===T[re])return!0;return!1},v=function(b,T){if(b===0&&T===-1)return Fn.TOP;if(b===1&&T===-1)return Fn.TOP_RIGHT;if(b===1&&T===0)return Fn.RIGHT;if(b===1&&T===1)return Fn.BOTTOM_RIGHT;if(b===0&&T===1)return Fn.BOTTOM;if(b===-1&&T===1)return Fn.BOTTOM_LEFT;if(b===-1&&T===0)return Fn.LEFT;if(b===-1&&T===-1)return Fn.TOP_LEFT;throw new Error("These differences are not valid: "+b+", "+T)},w=function(b,T){return o[T]&&o[T][b]||s[r[T][b]]},S=function(b,T,C,A,F){if(b.nodeHash[C]!==void 0){if(b.nodeHash[C][T]!==void 0)return b.nodeHash[C][T]}else b.nodeHash[C]={};var U=E(T,C,b.endX,b.endY);if(A!==null)var W=A.costSoFar+F;else W=0;var ne=new hV(A,T,C,W,U);return b.nodeHash[C][T]=ne,ne},E=function(b,T,C,A){if(_){var F=Math.abs(b-C),U=Math.abs(T-A);return F<U?e*F+U:e*U+F}else{var F=Math.abs(b-C),U=Math.abs(T-A);return F+U}}};Fn.TOP="TOP";Fn.TOP_RIGHT="TOP_RIGHT";Fn.RIGHT="RIGHT";Fn.BOTTOM_RIGHT="BOTTOM_RIGHT";Fn.BOTTOM="BOTTOM";Fn.BOTTOM_LEFT="BOTTOM_LEFT";Fn.LEFT="LEFT";Fn.TOP_LEFT="TOP_LEFT";class xV{constructor(e){O(this,"easyStar",new vV.js);O(this,"instanceId");this.word=e,this.loadTilesGrid()}tick(){this.easyStar.calculate()}update(){this.loadTilesGrid()}findPath([e,t],[i,r]){return new Promise((s,o)=>{try{const a=this.easyStar.findPath(e,t,i,r,c=>{if(this.instanceId=void 0,!c)return s(void 0);c.shift(),s(c)});this.instanceId=a}catch(a){o(a)}})}cancelPath(){this.isFinding()&&this.easyStar.cancelPath(this.instanceId),this.instanceId=void 0}isFinding(){return this.instanceId!==void 0}loadTilesGrid(){const e=this.word.tiles.map(t=>t.map(i=>i.canWalk?1:0));this.easyStar.removeAllAdditionalPointCosts(),this.word.forEachTile((t,[i,r])=>{!t.walkCost||this.easyStar.setAdditionalPointCost(i,r,t.walkCost)}),this.easyStar.setGrid(e),this.easyStar.setAcceptableTiles([1]),this.easyStar.enableDiagonals(),this.easyStar.setIterationsPerCalculation(1e3)}}var Ec=(n=>(n.Human="Human",n.Nature="Nature",n))(Ec||{});class dC{constructor(){O(this,"id",Qx());O(this,"type",Ec.Human);O(this,"name","Unnamed player");O(this,"selectedActors",[]);O(this,"selectedBuilding");O(this,"selectedBuildingRotation",0);O(this,"emitter",new S_("Player"))}selectActors(e){se.debug.logSelected&&console.log("Selected actors",e),this.emitter.emit("selectActors",e),this.selectedActors=e}unselectActor(){!this.selectedActors||(this.emitter.emit("unselectActors",this.selectedActors),this.selectedActors=[])}selectBuilding(e){this.emitter.emit("selectBuilding",e),this.selectedBuilding=e}unselectBuilding(){!this.selectedBuilding||(this.emitter.emit("unselectBuilding",this.selectedBuilding),this.selectedBuilding=void 0)}rotateBuilding(){!this.selectedBuilding||(this.selectedBuildingRotation=(this.selectedBuildingRotation+1)%4,this.emitter.emit("rotateBuilding",this.selectedBuildingRotation))}toJSON(){return{id:this.id,type:this.type,name:this.name}}fromJSON(e){Object.assign(this,e)}}class hC{constructor(){O(this,"id",Qx());O(this,"type",Ec.Nature);O(this,"name","Nature")}toJSON(){return{id:this.id,name:this.name,type:this.type}}fromJSON(e){Object.assign(this,e)}}const _V={[Ec.Human]:dC,[Ec.Nature]:hC},wV=n=>{const e=_V[n.type],t=new e;return t.fromJSON(n),t},SV={["\u{1F3DC}\uFE0F"]:yT,_:yT,["\u{1F331}"]:zy,["."]:zy,["\u{1F332}"]:By,F:By,["\u{1F33F}"]:Vp,["~"]:Vp,["\u{1F33E}"]:Uy,["#"]:Uy,["\u{1F30A}"]:Hy,W:Hy,["\u{1F6D6}"]:Wy,["!"]:Wy,["\u{1F9F1}"]:Gy,["="]:Gy,["\u{1F7E2}"]:$y,[" "]:$y,["\u{1F9B6}\u{1F3FD}"]:Vy,[","]:Vy},pC=n=>{const e=SV[n];if(!e)throw new Error(`Unknown tile code: ${n}`);return e},mC=(n,e=0)=>{if(e===0)return n;const t=[];for(let i=0;i<n[0].length;i++){t.push([]);for(let r=0;r<n.length;r++)t[i].push(n[n.length-1-r][i])}return e>0?mC(t,e-1):t},MV=(n,e,t=0)=>{const i=mC(n,t),r=i[0].length,s=i.length;let o=Math.floor(r/2),a=Math.floor(s/2);const[c,f]=AG(r,s,[o,a],t);i.forEach((h,d)=>{h.forEach((p,g)=>{e([g,d],pC(p),[c,f])})})},bV=n=>n.map(e=>e.map(t=>{const i=pC(t);return new i}));class Sm{constructor(e){O(this,"emitter",new S_("Word"));this.tiles=e}hasTile([e,t]){var i,r;return(r=(i=this.tiles)==null?void 0:i[t])==null?void 0:r[e]}getTile([e,t]){var r,s;const i=(s=(r=this.tiles)==null?void 0:r[t])==null?void 0:s[e];if(!i)throw new Error(`[Word:getTile] No tile at ${e}, ${t}`);return i}setTile(e,t){this.setTileAt(e,t),this.emitter.emit("tailUpdate")}setMultipleTiles(e){e(this.setTileAt.bind(this),this.getTile.bind(this),this.tiles),this.emitter.emit("tailUpdate")}getSize(){return[this.tiles[0].length,this.tiles.length]}getRealSize(){return this.getSize().map(e=>e*se.renderer.tileSize)}forEachTile(e){this.tiles.forEach((t,i)=>{t.forEach((r,s)=>{e(r,[s,i])})})}toJSON(){return{tiles:this.tiles.map(e=>e.map(t=>t.toJSON()))}}static fromJSON(e){const t=e.tiles.map(i=>i.map(nC));return new Sm(t)}setTileAt([e,t],i){var s,o;if(!((o=(s=this.tiles)==null?void 0:s[t])==null?void 0:o[e]))throw new Error(`[Word:setTile] No tile at ${e}, ${t}`);this.tiles[t][e]=i}}class Xp{constructor(e,t){O(this,"pf");O(this,"actors",[]);O(this,"loop");O(this,"emitter",new S_("Game"));O(this,"handleTailUpdate",()=>{this.pf.update()});this.world=e,this.players=t,this.pf=new xV(e)}start(){this.emitter.emit("started"),this.loop=setInterval(()=>{this.tick()},se.core.tickTime),this.world.emitter.on("tailUpdate",this.handleTailUpdate)}stop(){this.emitter.emit("stopped"),clearInterval(this.loop),this.loop=void 0,this.world.emitter.off("tailUpdate",this.handleTailUpdate)}tick(){this.pf.tick(),this.actors.forEach(e=>{e.tick()}),this.emitter.emit("tick")}addActor(e){this.actors.push(e),this.emitter.emit("actorAdded",e)}removeActor(e){CB(this.actors,e),this.pf.update(),this.emitter.emit("actorRemoved",e)}getActorById(e){return this.actors.find(t=>t.id===e)}findActorByRange(e,t,i){return this.actors.find(r=>{var s;return Pa(r.position,e)>t?!1:(s=i==null?void 0:i(r))!=null?s:!0})}findActorsByType(e,t=!0){return this.actors.filter(i=>t&&i.isDead()?!1:i.type===e)}findActorsByPosition(e,t,i=!0){return this.actors.filter(r=>i&&r.hp<=0?!1:Pa(r.position,e)<=t)}findClosestActorByType(e,t,i=!0){const r=this.findActorsByType(e,i);if(!!r[0])return r.reduce((s,o)=>{const a=Pa(s.position,t);return Pa(o.position,t)<a?o:s},r[0])}spawnActor(e,t,i,r=0){const s=new e(this,t,i),o=this.world.getTile(i);if(!(cC(s)&&!o.canWalk)){if(lC(s)){if(s.setRotation(r),!o.canBuild)return;const[a,c]=i;this.world.setMultipleTiles((f,h)=>{MV(s.blueprint.getGrid(),([d,p],g,[_,y])=>{const x=[a+d-_,c+p-y],v=new g(h(x));v.height=o.height,f(x,v)},r)})}return this.addActor(s),s}}toJSON(){return{world:this.world.toJSON(),players:this.players.map(e=>e.toJSON()),actors:this.actors.map(e=>e.toJSON())}}static fromJSON(e){const t=Sm.fromJSON(e.world),i=e.players.map(s=>wV(s)),r=new Xp(t,i);return r.actors=e.actors.map(s=>{const o=i.find(a=>a.id===s.playerId);if(!o)throw new Error(`Player not found [ID: ${s.playerId}]`);return lV(s,r,o)}),r}}const q=312,MT=0,TV=3,EV=.7,bT=.4,vr=.03,AV=2,CV=5,Xu=300,RV=0,PV=25,LV=20,IV=50,TT=.03,ET=.02,Ze="W",No=".",gC="F",hi="#",$a="_",Eo=12,qu=20,Bh=.1,zh=4,vC=8,Uh=2.5,yC=.5,FV=1,DV=.7,NV=10,OV=5,AT=.7,kV=1,BV=22,zV=.25,UV=15,HV=40,Fu=12,GV=.8,CT=.4,RT=.08,PT=.2,LT=.5,WV=20,VV=.4,$V=3,jV=.15;function Nf(n,e,t){const i=Math.floor(e/t*100),r="#".repeat(Math.floor(i/5))+"-".repeat(20-Math.floor(i/5));console.log(`[${r}] ${i}% - ${n}`)}class pi{constructor(e=Math.random()*1e4){O(this,"seeds",[]);for(let t=0;t<4;t++)this.seeds.push(e*(t+1)*1.5)}simpleNoise(e,t,i){const r=Math.floor(e)&255,s=Math.floor(t)&255,o=Math.sin(r*12.9898+s*78.233+i)*43758.5453;return(o-Math.floor(o))*2-1}noise(e,t){let i=0,r=1,s=1,o=0;for(let a=0;a<this.seeds.length;a++)i+=this.simpleNoise(e*s,t*s,this.seeds[a])*r,o+=r,r*=.5,s*=2;return i/o}terrainNoise(e,t,i,r=3){let s=0,o=1,a=1,c=0;for(let f=0;f<Math.min(r,this.seeds.length);f++)s+=this.simpleNoise(e*a*i,t*a*i,this.seeds[f])*o,c+=o,o*=.5,a*=2;return s/c}ridgedNoise(e,t,i){let r=this.terrainNoise(e,t,i);return r=1-Math.abs(r),r=r*r,r}}function XV(){console.log("Starting map generation..."),console.log("Creating base map...");const n=Array(q).fill(0).map(()=>Array(q).fill(No));console.log("Generating base terrain...");const e=new pi(Math.random()*1e4),t=new pi(Math.random()*2e4);console.log("Adding natural border..."),t9(n,e),console.log("Generating river system..."),i9(n,e),console.log("Adding sandy plains..."),l9(n,e),console.log("Adding random sand patches..."),h9(n,t);const i=Ue(AV,CV);console.log(`Adding ${i} lakes...`);for(let h=0;h<i;h++)Nf("Creating lake",h+1,i),wC(n,Ue(RV,PV),e,!1,Math.random()<VV);console.log("Pre-placing stone formations..."),xC(n,t),console.log("Adding terrain features...");const r=new pi(Math.random()*3e4),s=new pi(Math.random()*4e4),o=q*q;let a=0,c=0;const f=Array(q).fill(0).map(()=>Array(q).fill(0));for(let h=0;h<q;h++)for(let d=0;d<q;d++){if(n[h][d]===Ze)continue;const p=e.noise(d*ET,h*ET)*.6,g=t.noise(d*vr,h*vr)*.3,_=t.noise(d*TT,h*TT)*.1;f[h][d]=p+g+_}for(let h=0;h<q;h++)for(let d=0;d<q;d++){a++;const p=Math.floor(a/o*100);if(p%10===0&&p!==c&&(Nf("Generating terrain",a,o),c=p),n[h][d]===Ze||n[h][d]===hi||d===0||d===q-1||h===0||h===q-1)continue;const g=f[h][d];let _=100;for(let E=-10;E<=10;E++)for(let b=-10;b<=10;b++){const T=d+b,C=h+E;if(T>=0&&T<q&&C>=0&&C<q&&n[C][T]===Ze){const A=Math.sqrt(b*b+E*E);_=Math.min(_,A)}}const y=_<2?0:_<6?.3:.1,x=r.terrainNoise(d*vr*.7,h*vr*.7,1,4),v=s.terrainNoise(d*vr*1.2,h*vr*1.2,1,3),w=x*.6+g*.3+y;v*.7+g*.2+(1-y)*.1>.85?n[h][d]=hi:w>1-EV&&(n[h][d]=gC)}return console.log("Adding feature transitions..."),YV(n,t),console.log("Refining shorelines..."),JV(n,t),console.log("Adding natural stone formations..."),s9(n,e,s),console.log("Refining terrain transitions..."),f9(n,t),console.log("Map generation complete!"),n}function xC(n,e){console.log(`Ensuring at least ${Xu} stones appear on the map...`);let t=0,i=0;for(;t<Xu&&i<Xu*2;){i++;const r=Ue(20,q-20),s=Ue(20,q-20);if(n[s][r]!==Ze){const o=Ue(5,15);t+=qV(n,r,s,o,e)}i%50===0&&Nf("Placing stones",t,Xu)}console.log(`Placed ${t} stones in ${i} attempts`)}function qV(n,e,t,i,r){let s=0;for(let o=-i;o<=i;o++)for(let a=-i;a<=i;a++){const c=e+a,f=t+o;if(c<0||c>=q||f<0||f>=q||n[f][c]===Ze)continue;const h=Math.sqrt(a*a+o*o);if(h>i)continue;const d=r.noise(c*.2,f*.2)*.5;(h<i*.5||.7-h/i>d)&&(n[f][c]=hi,s++)}for(let o=0;o<i*2;o++){const a=Math.random()*Math.PI*2,c=i*(1+Math.random()*.5),f=Math.floor(e+Math.cos(a)*c),h=Math.floor(t+Math.sin(a)*c);f>=0&&f<q&&h>=0&&h<q&&n[h][f]!==Ze&&(n[h][f]=hi,s++)}return s}function YV(n,e){const t=[];for(let r=1;r<q-1;r++)for(let s=1;s<q-1;s++)if(n[r][s]===gC||n[r][s]===hi){let o=!1;for(let a=-1;a<=1;a++){for(let c=-1;c<=1;c++)if(!(c===0&&a===0)&&n[r+a][s+c]!==n[r][s]){o=!0;break}if(o)break}o&&t.push({x:s,y:r,type:n[r][s]})}for(const r of t){const{x:s,y:o,type:a}=r;for(let c=-2;c<=2;c++)for(let f=-2;f<=2;f++){if(f===0&&c===0)continue;const h=s+f,d=o+c;if(h<=0||h>=q-1||d<=0||d>=q-1||n[d][h]===Ze)continue;const p=Math.sqrt(f*f+c*c);if(p>2.5)continue;const g=e.noise(h*.3,d*.3),_=p/2.5*.6+.2;n[d][h]===No&&g>_?n[d][h]=a:n[d][h]===a&&g<-_&&(n[d][h]=No)}}console.log("Enhancing stone formations...");let i=0;for(let r=0;r<q;r++)for(let s=0;s<q;s++)n[r][s]===hi&&i++;console.log(`Map has ${i} stone tiles`),i<Xu/2&&(console.log("Not enough stones, adding more..."),xC(n,e))}function KV(){const n=[],e=Ue(0,2);let t,i,r,s;if(e===0)t=0,r=q-1,i=Ue(q*.3,q*.7),s=Ue(q*.3,q*.7);else if(e===1)i=0,s=q-1,t=Ue(q*.3,q*.7),r=Ue(q*.3,q*.7);else{const a=Ue(0,3);a===0?(t=0,i=0,r=q-1,s=q-1):a===1?(t=0,i=q-1,r=q-1,s=0):a===2?(t=q-1,i=0,r=0,s=q-1):(t=q-1,i=q-1,r=0,s=0)}n.push({x:t,y:i});const o=Ue(LV,IV);for(let a=1;a<o-1;a++){const c=a/(o-1),f=t+(r-t)*c,h=i+(s-i)*c;let d,p;e===0?(d=0,p=Math.sin(c*Math.PI*2)*q*.15*Uh,p+=(Math.random()-.5)*q*.1):e===1?(d=Math.sin(c*Math.PI*2)*q*.15*Uh,p=0,d+=(Math.random()-.5)*q*.1):(d=Math.sin(c*Math.PI*2)*q*.1*Uh,p=Math.cos(c*Math.PI*2)*q*.1*Uh,d+=(Math.random()-.5)*q*.05,p+=(Math.random()-.5)*q*.05);const g={x:f+d,y:h+p};g.x=Math.max(5,Math.min(q-5,g.x)),g.y=Math.max(5,Math.min(q-5,g.y)),n.push(g)}return n.push({x:r,y:s}),_C(n,vC,yC)}function _C(n,e,t=.5){if(n.length<2)return n;const i=[];i.push(n[0]);for(let r=0;r<n.length-1;r++){const s=r>0?n[r-1]:n[r],o=n[r],a=n[r+1],c=r<n.length-2?n[r+2]:a;for(let f=1;f<=e;f++){const h=f/e,d=h*h,p=d*h;let g=.5*(2*o.x+(-s.x+a.x)*h+(2*s.x-5*o.x+4*a.x-c.x)*d+(-s.x+3*o.x-3*a.x+c.x)*p),_=.5*(2*o.y+(-s.y+a.y)*h+(2*s.y-5*o.y+4*a.y-c.y)*d+(-s.y+3*o.y-3*a.y+c.y)*p);g=o.x+(g-o.x)*t,_=o.y+(_-o.y)*t,g=Math.max(0,Math.min(q-1,g)),_=Math.max(0,Math.min(q-1,_)),i.push({x:g,y:_})}}return i.push(n[n.length-1]),i}function IT(n,e,t=!1){console.log(`Drawing ${t?"branch":"main"} river...`);const i=[],r=Math.max(2,Math.floor(e.length/20));for(let o=0;o<r;o++)i.push(Ue(0,e.length-1));i.sort((o,a)=>o-a);const s=[];for(let o=0;o<r;o++)t?s.push(.3+Math.random()*.5*CT):s.push(.5+Math.random()*GV);for(let o=0;o<e.length-1;o++){const a=e[o],c=e[o+1];o%10===0&&Nf(`Drawing ${t?"branch":"main"} river segment`,o+1,e.length-1);const f=o/(e.length-1);let h=Math.sin(f*Math.PI)*.5+.5;for(let p=0;p<i.length-1;p++)if(o>=i[p]&&o<=i[p+1]){const g=(o-i[p])/(i[p+1]-i[p]);h*=s[p]*(1-g)+s[p+1]*g;break}t&&(h*=CT);const d=MT+(TV-MT)*h+Math.sin(f*Math.PI*8)*.5;ZV(n,Math.floor(a.x),Math.floor(a.y),Math.floor(c.x),Math.floor(c.y),d)}}function ZV(n,e,t,i,r,s){const o=Math.abs(i-e),a=Math.abs(r-t),c=e<i?1:-1,f=t<r?1:-1;let h=o-a;const d=new pi(e*1e3+t);let p=e,g=t,_=0;const y=q*2;for(;_<y;){if(_++,p>=0&&p<q&&g>=0&&g<q){n[g][p]=Ze;for(let v=-Math.ceil(s);v<=Math.ceil(s);v++)for(let w=-Math.ceil(s);w<=Math.ceil(s);w++){const S=p+v,E=g+w;if(S>=0&&S<q&&E>=0&&E<q){const b=Math.sqrt(v*v+w*w),T=d.noise(S*.1,E*.1)*.5+.5;b<s*(1+T*.5)&&(n[E][S]=Ze)}}}if(p===i&&g===r)break;const x=2*h;x>-a&&(h-=a,p+=c),x<o&&(h+=o,g+=f)}}function wC(n,e,t,i=!1,r=!1){let s,o,a=0;do s=Math.floor(Ue(Math.floor(q*.1),Math.floor(q*.9))),o=Math.floor(Ue(Math.floor(q*.1),Math.floor(q*.9))),a++,s<0||s>=q||o<0||o>=q;while(n[o][s]===Ze&&a<100);if(a>=100)return;const c=e,f=.8+Math.random()*.4,h=.8+Math.random()*.4;for(let d=-c*1.5;d<=c*1.5;d++)for(let p=-c*1.5;p<=c*1.5;p++){const g=Math.floor(s+p),_=Math.floor(o+d);if(g>=0&&g<q&&_>=0&&_<q){const y=p/h,x=d/f,v=Math.sqrt(y*y+x*x)/c;if(v>1.5)continue;const w=Math.atan2(d,p),S=Math.sin(w*3)*.15,E=t.noise(g*.1,_*.1)*.2,b=t.noise(g*.2,_*.2)*.1,T=t.noise(g*.4,_*.4)*.05,C=E+b+T+S;v<.9+C&&(n[_][g]=Ze)}}r&&(console.log("Adding sandy shores to lake..."),d9(n,s,o,c*1.2)),Math.random()<.7&&QV(n,s,o,c)}function QV(n,e,t,i){const r=i*3;let s=-1,o=-1,a=r*r;for(let c=i+1;c<=r;c++){for(let f=0;f<c*8;f++){const h=f/(c*8)*2*Math.PI,d=Math.floor(Math.cos(h)*c),p=Math.floor(Math.sin(h)*c),g=e+d,_=t+p;if(g>=0&&g<q&&_>=0&&_<q&&n[_][g]===Ze){const y=d*d+p*p;if(y<a){a=y,s=g,o=_;break}}}if(s!==-1)break}if(s!==-1&&o!==-1){const c=Ue(1,2),f=new pi(e*3.7+t*1.5),h=[];h.push({x:e,y:t});const d=Ue(3,5);for(let p=1;p<d;p++){const g=p/d,_=e+g*(s-e),y=t+g*(o-t),x=5,v=f.noise(g*10,0)*x,w=f.noise(0,g*10)*x;h.push({x:Math.floor(_+v),y:Math.floor(y+w)})}h.push({x:s,y:o});for(let p=0;p<h.length-1;p++)e9(n,h[p].x,h[p].y,h[p+1].x,h[p+1].y,c)}}function JV(n,e){const t=[];for(let i=1;i<q-1;i++)for(let r=1;r<q-1;r++)if(n[i][r]!==Ze){let s=!1;for(let o=-1;o<=1;o++){for(let a=-1;a<=1;a++)if(!(a===0&&o===0)&&n[i+o]&&n[i+o][r+a]===Ze){s=!0;break}if(s)break}s&&t.push({x:r,y:i})}for(const i of t){const{x:r,y:s}=i,o=e.terrainNoise(r*.2,s*.2,1)*.6+e.terrainNoise(r*.4,s*.4,1)*.3+e.terrainNoise(r*.8,s*.8,1)*.1,a=e.ridgedNoise(r*.3,s*.3,1);let c=1;for(let h=-3;h<=3;h++)for(let d=-3;d<=3;d++)if(!(d===0&&h===0)&&!(s+h<0||s+h>=q||r+d<0||r+d>=q)&&n[s+h][r+d]===Ze){const p=Math.sqrt(d*d+h*h);p<c&&(c=p)}const f=(1.1-Math.min(1,c/1.5))*.4;o+f+a*.2>.4&&(n[s][r]=Ze)}}function e9(n,e,t,i,r,s){const o=Math.abs(i-e),a=Math.abs(r-t),c=e<i?1:-1,f=t<r?1:-1;let h=o-a,d=0;const p=q*2;for(;d<p;){d++;for(let _=-s;_<=s;_++)for(let y=-s;y<=s;y++){const x=e+_,v=t+y;_*_+y*y<=s*s&&x>=0&&x<q&&v>=0&&v<q&&(n[v][x]=Ze)}if(e===i&&t===r)break;const g=2*h;g>-a&&(h-=a,e+=c),g<o&&(h+=o,t+=f)}}function t9(n,e){for(let t=0;t<q;t++)n[0][t]=Ze,n[q-1][t]=Ze,n[t][0]=Ze,n[t][q-1]=Ze;console.log("Creating natural border with varying width...");for(let t=0;t<q;t++){const i=e.noise(t*Bh,0)*zh,r=Math.floor(Eo+(qu-Eo)*(.5+i));for(let s=0;s<r;s++){const o=e.noise(t*.2,s*.5)*3,a=Math.floor(o),c=r-s+a;c>0&&s<q&&(n[s][t]=Ze,c<3&&Math.random()<.05&&(n[s][t]=No))}}for(let t=0;t<q;t++){const i=e.noise(t*Bh,1e3)*zh,r=Math.floor(Eo+(qu-Eo)*(.5+i));for(let s=0;s<r;s++){const o=e.noise((q-t)*.2,s*.5)*3,a=Math.floor(o),c=r-s+a;if(c>0){const f=q-1-s;f>=0&&(n[f][t]=Ze,c<3&&Math.random()<.05&&(n[f][t]=No))}}}for(let t=0;t<q;t++){const i=e.noise(0,t*Bh)*zh,r=Math.floor(Eo+(qu-Eo)*(.5+i));for(let s=0;s<r;s++){const o=e.noise(s*.5,t*.2)*3,a=Math.floor(o),c=r-s+a;c>0&&s<q&&(n[t][s]=Ze,c<3&&Math.random()<.05&&(n[t][s]=No))}}for(let t=0;t<q;t++){const i=e.noise(1e3,t*Bh)*zh,r=Math.floor(Eo+(qu-Eo)*(.5+i));for(let s=0;s<r;s++){const o=e.noise(s*.5,(q-t)*.2)*3,a=Math.floor(o),c=r-s+a;if(c>0){const f=q-1-s;f>=0&&(n[t][f]=Ze,c<3&&Math.random()<.05&&(n[t][f]=No))}}}n9(n,e)}function n9(n,e){const t=Math.max(qu+5,Math.floor(q*.1)),i=Ue(3,7);for(let s=0;s<i;s++){const o=Ue(0,3);let a,c;o===0?(a=Ue(t,q-t),c=Ue(5,t)):o===1?(a=Ue(q-t,q-5),c=Ue(t,q-t)):o===2?(a=Ue(t,q-t),c=Ue(q-t,q-5)):(a=Ue(5,t),c=Ue(t,q-t));const f=Ue(5,15),h=new pi(Math.random()*5e4);for(let d=-f;d<=f;d++)for(let p=-f;p<=f;p++){const g=a+p,_=c+d;if(g<0||g>=q||_<0||_>=q)continue;const y=Math.sqrt(p*p+d*d)/f;if(y>1)continue;const x=h.noise(g*.1,_*.1)*.5;n[_][g]===Ze&&y<.7+x&&(n[_][g]=No)}}const r=Ue(4,8);for(let s=0;s<r;s++){const o=Ue(0,3);o===0?(Ue(t,q-t),Ue(5,t*.7)):o===1?(Ue(q-t*.7,q-5),Ue(t,q-t)):o===2?(Ue(t,q-t),Ue(q-t*.7,q-5)):(Ue(5,t*.7),Ue(t,q-t));const a=Ue(3,8);wC(n,a,e,!0)}}function Ue(n,e){return n=Math.floor(n),e=Math.floor(e),Math.floor(Math.random()*(e-n+1))+n}function i9(n,e){const t=Math.max(1,FV);for(let i=0;i<t;i++){console.log(`Generating river ${i+1} of ${t}...`);const r=KV();if(IT(n,r,!1),Math.random()<DV){const s=Ue(1,NV);console.log(`Adding ${s} branches to river ${i+1}...`);for(let o=0;o<s;o++){const a=Ue(Math.floor(r.length*.2),Math.floor(r.length*.8)),c=r[a],f=r9(c,r,a,e);IT(n,f,!0)}}}}function r9(n,e,t,i){let r=0,s=0;if(t>0&&t<e.length-1){const d=e[t-1],p=e[t+1],g=p.x-d.x;r=-(p.y-d.y),s=g}else{const d=Math.random()*Math.PI*2;r=Math.cos(d),s=Math.sin(d)}const o=Math.sqrt(r*r+s*s);o>0&&(r/=o,s/=o),Math.random()<.5&&(r=-r,s=-s);const a=q*.1*(.5+Math.random()*.5)*OV,c={x:Math.max(0,Math.min(q-1,n.x+r*a)),y:Math.max(0,Math.min(q-1,n.y+s*a))},f=[];f.push(n);const h=Ue(3,6);for(let d=1;d<h;d++){const p=d/h,g=n.x+(c.x-n.x)*p,_=n.y+(c.y-n.y)*p,y=-s,x=r,v=i.noise(g*.01,_*.01)*a*.3,w={x:g+y*v,y:_+x*v};w.x=Math.max(0,Math.min(q-1,w.x)),w.y=Math.max(0,Math.min(q-1,w.y)),f.push(w)}return f.push(c),_C(f,vC,yC)}function s9(n,e,t,i){const r=Array(q).fill(0).map(()=>Array(q).fill(0));for(let s=0;s<q;s++)for(let o=0;o<q;o++)n[s][o]!==Ze&&(r[s][o]=t.terrainNoise(o*vr*.5,s*vr*.5,1,2)*.6+t.terrainNoise(o*vr*1.5,s*vr*1.5,1,3)*.3+t.terrainNoise(o*vr*4,s*vr*4,1,1)*.1);for(let s=0;s<q;s++)for(let o=0;o<q;o++)if(!(n[s][o]===Ze||n[s][o]===hi))if(r[s][o]>1-bT*.8){const a=Ue(kV,BV);o9(n,o,s,a,t)}else r[s][o]>1-bT&&(n[s][o]=hi);a9(n,t)}function o9(n,e,t,i,r){const s=i;for(let o=-s;o<=s;o++)for(let a=-s;a<=s;a++){const c=e+a,f=t+o;if(c<0||c>=q||f<0||f>=q||n[f][c]===Ze)continue;const h=Math.sqrt(a*a+o*o);if(h>s)continue;const d=r.noise(c*.2,f*.2)*.5+r.noise(c*.5,f*.5)*.3+r.noise(c*1,f*1)*.2,p=(1-h/s)*AT;(p+d*(1-AT)>.5||p+d>.45&&Math.random()<zV)&&(n[f][c]=hi)}}function a9(n,e){const t=[];for(let i=1;i<q-1;i++)for(let r=1;r<q-1;r++)if(n[i][r]===hi){let s=!1;for(let o=-1;o<=1;o++){for(let a=-1;a<=1;a++)if(n[i+o][r+a]!==hi&&n[i+o][r+a]!==Ze){s=!0;break}if(s)break}s&&t.push({x:r,y:i})}for(const i of t){const{x:r,y:s}=i;for(let o=-2;o<=2;o++)for(let a=-2;a<=2;a++){if(a===0&&o===0)continue;const c=r+a,f=s+o;if(c<=0||c>=q-1||f<=0||f>=q-1||n[f][c]===Ze||n[f][c]===hi)continue;const h=Math.sqrt(a*a+o*o);if(h>2)continue;const d=e.noise(c*.3,f*.3),p=Math.max(0,1-h/2);d*.6+p*.4>.65&&(n[f][c]=hi)}}}function l9(n,e){console.log(`Creating ${Fu} sandy regions...`);let t=0,i=0;const r=Fu*2;for(;t<Fu&&i<r;){i++;try{let s=Ue(30,q-30),o=Ue(30,q-30);if(s<0||s>=q||o<0||o>=q||n[o][s]===Ze)continue;const a=Ue(UV,HV);c9(n,s,o,a,e),t++,Nf("Creating sandy region",t,Fu)}catch(s){console.warn("Error creating sand region:",s)}}console.log(`Created ${t}/${Fu} sandy regions after ${i} attempts`),u9(n)}function c9(n,e,t,i,r){e=Math.min(Math.max(Math.floor(e),0),q-1),t=Math.min(Math.max(Math.floor(t),0),q-1);const s=.7+Math.random()*.6,o=.7+Math.random()*.6,a=Math.random()*Math.PI*2,c=Math.random()*1e3,f=Math.random()*1e3,h=new pi(c),d=new pi(f),p=Math.min(i*1.5,q/4);for(let g=-p;g<=p;g++)for(let _=-p;_<=p;_++){const y=Math.floor(e+_),x=Math.floor(t+g);if(!(y<0||y>=q||x<0||x>=q)&&!(n[x]===void 0||n[x][y]===void 0)&&n[x][y]!==Ze)try{const v=_*Math.cos(a)-g*Math.sin(a),w=_*Math.sin(a)+g*Math.cos(a),S=v/s,E=w/o;if(Math.sqrt(S*S+E*E)>p)continue;const T=h.noise(y*RT,x*RT)*.5,C=d.noise(y*PT,x*PT)*.3,A=r.noise(y*LT,x*LT)*.2}catch(v){console.warn(`Error processing sand tile at [${y}, ${x}]:`,v);continue}}}function u9(n,e){const t=new pi(Math.random()*5e3),i=new pi(Math.random()*7e3);for(let r=1;r<q-1;r++)for(let s=1;s<q-1;s++)if(n[r][s]!==Ze){if(n[r][s]===$a)continue;let o=999,a=0,c={dx:0,dy:0};const f=4;for(let h=-f;h<=f;h++)for(let d=-f;d<=f;d++){const p=s+d,g=r+h;if(!(p<0||p>=q||g<0||g>=q)&&n[g][p]===Ze){a++;const _=Math.sqrt(d*d+h*h);_<o&&(o=_,c={dx:d,dy:h})}}if(o<f){const h=t.noise(s*.1,r*.1)*.5,d=i.noise(s*.3,r*.3)*.3,p=Math.sin(s*.07+r*.05)*.2,g=h+d+p,_=Math.max(0,(f-o)/f),y=Math.atan2(c.dy,c.dx),x=Math.sin(y*3)*.2,v=Math.min(1,a/10)*.3;(.3+_*.4+g*.3+x+v>.55||o<=1&&g>-.2)&&(n[r][s]=$a)}}}function f9(n,e){for(let t=1;t<q-1;t++)for(let i=1;i<q-1;i++){const r=n[t][i];if(r!==Ze)for(let s=-1;s<=1;s++)for(let o=-1;o<=1;o++){if(o===0&&s===0)continue;const a=i+o,c=t+s;if(a<0||a>=q||c<0||c>=q)continue;const f=n[c][a];f!==r&&f!==Ze&&e.noise(i*.3+t*.1,t*.3)>.6&&(n[t][i]=f)}}}function d9(n,e,t,i,r){const s=new pi(Math.random()*8e3),o=Math.floor(i*.4)+1;for(let a=-i-o;a<=i+o;a++)for(let c=-i-o;c<=i+o;c++){const f=Math.floor(e+c),h=Math.floor(t+a);if(f<0||f>=q||h<0||h>=q)continue;if(n[h][f]===Ze){if(Math.random()<.05){const p=Ue(1,3);for(let g=-p;g<=p;g++)for(let _=-p;_<=p;_++){const y=f+_,x=h+g;y>=0&&y<q&&x>=0&&x<q&&n[x][y]===Ze&&Math.random()<.7&&(n[x][y]=$a)}}continue}let d=999;for(let p=-3;p<=3;p++)for(let g=-3;g<=3;g++){const _=f+g,y=h+p;if(_>=0&&_<q&&y>=0&&y<q&&n[y][_]===Ze){const x=Math.sqrt(g*g+p*p);d=Math.min(d,x)}}if(d<999){const p=1-d/o,g=s.noise(f*.2,h*.2)*.5;(p+g>.5||d<=1&&Math.random()<.7)&&(n[h][f]=$a)}}}function h9(n,e){for(let t=0;t<WV;t++){const i=Ue(20,q-20),r=Ue(20,q-20);if(n[r][i]===Ze)continue;const s=Ue(2,7);SC(n,i,r,s)}if(Math.random()<jV){const t=Ue(q*.2,q*.8),i=Ue(q*.2,q*.8);console.log("Creating desert-like area..."),p9(n,t,i,Ue(40,70))}for(let t=0;t<$V;t++)if(Math.random()<.7){const i=Ue(q*.2,q*.8),r=Ue(q*.2,q*.8);if(n[r][i]===Ze)continue;m9(n,i,r,e)}}function SC(n,e,t,i,r){const s=new pi(e*t+Math.random()*1e3);for(let o=-i;o<=i;o++)for(let a=-i;a<=i;a++){const c=e+a,f=t+o;if(c<0||c>=q||f<0||f>=q||n[f][c]===Ze)continue;const h=Math.sqrt(a*a+o*o);if(h>i)continue;const d=s.noise(c*.5,f*.5)*.5;(h<i*.5||h<i&&d>0)&&(n[f][c]=$a)}}function p9(n,e,t,i,r){const s=new pi(Math.random()*9e3),o=new pi(Math.random()*5e3),a=Math.random()*Math.PI*2,c=.05+Math.random()*.1;for(let f=-i;f<=i;f++)for(let h=-i;h<=i;h++){const d=e+h,p=t+f;if(d<0||d>=q||p<0||p>=q||n[p][d]===Ze)continue;const g=1+Math.random()*.5,_=1+Math.random()*.5,y=Math.sqrt(h/g*(h/g)+f/_*(f/_));if(y>i)continue;const x=s.noise(d*.02,p*.02),v=Math.cos(a)*d+Math.sin(a)*p,w=Math.sin(v*c)*.5,S=o.noise(d*.1,p*.1)*.3,E=x+w+S;(y<i*.7||y<i&&E>-.2)&&(n[p][d]=$a)}}function m9(n,e,t,i){const r=Ue(8,15);SC(n,e,t,r);const s=Ue(2,4);for(let o=-s;o<=s;o++)for(let a=-s;a<=s;a++){const c=e+a,f=t+o;if(c<0||c>=q||f<0||f>=q)continue;const h=Math.sqrt(a*a+o*o),d=i.noise(c*.5,f*.5)*.3;(h<s*.7||h<s&&d>0)&&(n[f][c]=Ze)}for(let o=-s-3;o<=s+3;o++)for(let a=-s-3;a<=s+3;a++){const c=e+a,f=t+o;if(c<0||c>=q||f<0||f>=q||n[f][c]===Ze)continue;let h=!1;for(let d=-1;d<=1;d++){for(let p=-1;p<=1;p++){const g=c+p,_=f+d;if(g>=0&&g<q&&_>=0&&_<q&&n[_][g]===Ze){h=!0;break}}if(h)break}h&&(n[f][c]=$a)}}console.log("Starting de_river map generation...");const g9=XV();console.log("Finished de_river map generation!");class MC{constructor(e,t){O(this,"findPositionByMouseEvent",e=>{var h;const t=new oT,i=new Ce(e.clientX/window.innerWidth*2-1,-(e.clientY/window.innerHeight)*2+1);t.setFromCamera(i,this.renderer.rtsCamera.camera);const s=(h=t.intersectObjects(this.renderer.getGroundChildren())[0])==null?void 0:h.point;if(!s)return;const[o,a]=this.game.world.getRealSize(),c=Math.round((s.x+o/2)/se.renderer.tileSize),f=Math.round((s.z+a/2)/se.renderer.tileSize);return[c,f]});O(this,"findActorsByMouseEvent",e=>{const t=new oT,i=new Ce(e.clientX/window.innerWidth*2-1,-(e.clientY/window.innerHeight)*2+1);t.setFromCamera(i,this.renderer.rtsCamera.camera);const r=this.renderer.getInteractionObjectList(),s=t.intersectObjects(r,!1),o=s.map(c=>c.object.userData.actor).filter(c=>!!c),a=[];return s.forEach(c=>{c&&c.object&&c.object.parent&&a.push(c.object.parent)}),o.sort((c,f)=>f.getSelectedImportance()-c.getSelectedImportance()),o});this.game=e,this.renderer=t}findSingleActorByMouseEvent(e){const t=this.findActorsByMouseEvent(e);if(!!t.length)return t.reduce((i,r)=>i?i.getSelectedImportance()<r.getSelectedImportance()?r:i:r)}}class v9{constructor(e,t,i){O(this,"finder");O(this,"placeholder",new $t);O(this,"placeholderModel");O(this,"el");O(this,"placeHolderMaterial",new wr({color:6225764,opacity:.5,transparent:!0}));O(this,"rotatePlaceholder",e=>{this.placeholder.rotation.y=Y2(e)});O(this,"subscriptions",[]);O(this,"setPlaceholder",async e=>{var s;this.removePlaceholder();const t=Xo[e].blueprint;if(!t)return;const{model:i,promise:r}=t.getPlaceholder();this.placeholderModel=i,this.placeholder.add(this.placeholderModel),await r,(s=this.placeholderModel)==null||s.traverse(o=>{o instanceof cn&&(o.castShadow=!1,o.receiveShadow=!1,o.material=this.placeHolderMaterial)})});O(this,"removePlaceholder",()=>{!this.placeholderModel||(this.placeholder.remove(this.placeholderModel),this.placeholderModel=void 0)});O(this,"handleClick",e=>{e.preventDefault();const t=this.player.selectedBuilding;if(!t)return;const i=this.finder.findPositionByMouseEvent(e);if(!i)return;const r=Xo[t].actorClass;this.game.spawnActor(r,this.player,i,this.player.selectedBuildingRotation)});O(this,"handleMove",e=>{if(!this.placeholderModel)return;const t=this.finder.findPositionByMouseEvent(e);if(!t)return;const i=this.game.world.getTile(t),r=this.game.world.getSize(),s=[t[0]-r[0]/2,t[1]-r[1]/2];Wp(this.placeholder,s,i.height),this.placeHolderMaterial.color.setHex(i.canBuild?6225764:16711680)});O(this,"handleContextmenu",e=>{e.preventDefault(),this.player.unselectBuilding()});this.game=e,this.renderer=t,this.player=i,this.el=this.renderer.webGLRenderer.domElement,this.finder=new MC(e,t)}enable(){this.player.selectedBuilding&&this.setPlaceholder(this.player.selectedBuilding),this.subscriptions=[this.player.emitter.on("selectBuilding",this.setPlaceholder),this.player.emitter.on("unselectBuilding",this.removePlaceholder),this.player.emitter.on("rotateBuilding",this.rotatePlaceholder)],this.el.addEventListener("click",this.handleClick),this.el.addEventListener("pointermove",this.handleMove),this.el.addEventListener("contextmenu",this.handleContextmenu),this.renderer.scene.add(this.placeholder)}disable(){this.subscriptions.forEach(e=>e()),this.el.removeEventListener("click",this.handleClick),this.el.removeEventListener("pointermove",this.handleMove),this.el.removeEventListener("contextmenu",this.handleContextmenu),this.renderer.scene.remove(this.placeholder)}}class y9{constructor(e,t,i){O(this,"isHoldingSpaceBar",!1);O(this,"handleKeyDown",e=>{e.key===" "&&(this.isHoldingSpaceBar=!0)});O(this,"handleKeyUp",e=>{switch(PG(e.key)){case" ":this.isHoldingSpaceBar=!1;break;case"Escape":this.player.unselectActor(),this.player.unselectBuilding();break;case"r":this.player.rotateBuilding();break}});this.game=e,this.renderer=t,this.player=i}enable(){window.addEventListener("keyup",this.handleKeyUp),window.addEventListener("keydown",this.handleKeyDown)}disable(){window.removeEventListener("keyup",this.handleKeyUp),window.removeEventListener("keydown",this.handleKeyDown)}}const x9=[[0,1],[0,-1],[-1,0],[1,0],[1,1],[1,-1],[-1,1],[-1,-1]],FT=[[0,1],[0,-1],[-1,0],[1,0],[1,1],[1,-1],[-1,1],[-1,-1]],_9=(n,e,t)=>{if(e<1)return[];const i={};let r=e;const s=[],o=h=>{const d=h.toString();return i[d]?!1:(i[d]=!0,t(h))},a=h=>{o(h)&&(s.push(h),r--)};a(n);for(const h of x9){if(r===0)break;const d=Ff(n,h);a(d)}if(!s.length)return[];let c=0,f=1e5;for(;r>0&&f>0;){const h=FT[c%FT.length],d=s.length;for(let p=0;p<d;p++){const g=Ff(s[p],h);if(a(g),r===0)break}f--,c++}return f===0&&console.warn("[squareFloodFill] Max iterations reached!"),s};class w9{constructor(e){O(this,"startPoint",new Ce);O(this,"pointTopLeft",new Ce);O(this,"pointBottomRight",new Ce);O(this,"element",document.createElement("div"));this.renderer=e,this.element.classList.add("selectBox"),this.element.style.pointerEvents="none"}onDown(e){var t;(t=this.renderer.domElement.parentElement)==null||t.appendChild(this.element),this.element.style.left=e.clientX+"px",this.element.style.top=e.clientY+"px",this.element.style.width="0px",this.element.style.height="0px",this.startPoint.x=e.clientX,this.startPoint.y=e.clientY}onMove(e){this.pointTopLeft.x=Math.min(this.startPoint.x,e.clientX),this.pointTopLeft.y=Math.min(this.startPoint.y,e.clientY),this.pointBottomRight.x=Math.max(this.startPoint.x,e.clientX),this.pointBottomRight.y=Math.max(this.startPoint.y,e.clientY),this.element.style.left=this.pointTopLeft.x+"px",this.element.style.top=this.pointTopLeft.y+"px",this.element.style.width=this.pointBottomRight.x-this.pointTopLeft.x+"px",this.element.style.height=this.pointBottomRight.y-this.pointTopLeft.y+"px"}onUp(){var e;(e=this.element.parentElement)==null||e.removeChild(this.element)}}const wv=new vm,Nl=new z,Ol=new z,kr=new z,Bs=new z,ss=new z,zs=new z,Us=new z,Du=new z,Nu=new z,Ou=new z,Hh=new z,ku=new z,Bu=new z,zu=new z,DT=new pt,S9=new qn,M9=new z;class b9{constructor(e,t,i=Number.MAX_VALUE){this.camera=e,this.scene=t,this.startPoint=new z,this.endPoint=new z,this.collection=[],this.instances={},this.deep=i}select(e,t){return this.startPoint=e||this.startPoint,this.endPoint=t||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(wv,this.scene),this.collection}updateFrustum(e,t){if(e=e||this.startPoint,t=t||this.endPoint,e.x===t.x&&(t.x+=Number.EPSILON),e.y===t.y&&(t.y+=Number.EPSILON),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),this.camera.isPerspectiveCamera){Ol.copy(e),Ol.x=Math.min(e.x,t.x),Ol.y=Math.max(e.y,t.y),t.x=Math.max(e.x,t.x),t.y=Math.min(e.y,t.y),kr.setFromMatrixPosition(this.camera.matrixWorld),Bs.copy(Ol),ss.set(t.x,Ol.y,0),zs.copy(t),Us.set(Ol.x,t.y,0),Bs.unproject(this.camera),ss.unproject(this.camera),zs.unproject(this.camera),Us.unproject(this.camera),ku.copy(Bs).sub(kr),Bu.copy(ss).sub(kr),zu.copy(zs).sub(kr),ku.normalize(),Bu.normalize(),zu.normalize(),ku.multiplyScalar(this.deep),Bu.multiplyScalar(this.deep),zu.multiplyScalar(this.deep),ku.add(kr),Bu.add(kr),zu.add(kr);const i=wv.planes;i[0].setFromCoplanarPoints(kr,Bs,ss),i[1].setFromCoplanarPoints(kr,ss,zs),i[2].setFromCoplanarPoints(zs,Us,kr),i[3].setFromCoplanarPoints(Us,Bs,kr),i[4].setFromCoplanarPoints(ss,zs,Us),i[5].setFromCoplanarPoints(zu,Bu,ku),i[5].normal.multiplyScalar(-1)}else if(this.camera.isOrthographicCamera){const i=Math.min(e.x,t.x),r=Math.max(e.y,t.y),s=Math.max(e.x,t.x),o=Math.min(e.y,t.y);Bs.set(i,r,-1),ss.set(s,r,-1),zs.set(s,o,-1),Us.set(i,o,-1),Du.set(i,r,1),Nu.set(s,r,1),Ou.set(s,o,1),Hh.set(i,o,1),Bs.unproject(this.camera),ss.unproject(this.camera),zs.unproject(this.camera),Us.unproject(this.camera),Du.unproject(this.camera),Nu.unproject(this.camera),Ou.unproject(this.camera),Hh.unproject(this.camera);const a=wv.planes;a[0].setFromCoplanarPoints(Bs,Du,Nu),a[1].setFromCoplanarPoints(ss,Nu,Ou),a[2].setFromCoplanarPoints(Ou,Hh,Us),a[3].setFromCoplanarPoints(Hh,Du,Bs),a[4].setFromCoplanarPoints(ss,zs,Us),a[5].setFromCoplanarPoints(Ou,Nu,Du),a[5].normal.multiplyScalar(-1)}else console.error("THREE.SelectionBox: Unsupported camera type.")}searchChildInFrustum(e,t){if(t.isMesh||t.isLine||t.isPoints)if(t.isInstancedMesh){this.instances[t.uuid]=[];for(let i=0;i<t.count;i++)t.getMatrixAt(i,DT),DT.decompose(Nl,S9,M9),Nl.applyMatrix4(t.matrixWorld),e.containsPoint(Nl)&&this.instances[t.uuid].push(i)}else t.geometry.boundingSphere===null&&t.geometry.computeBoundingSphere(),Nl.copy(t.geometry.boundingSphere.center),Nl.applyMatrix4(t.matrixWorld),e.containsPoint(Nl)&&this.collection.push(t);if(t.children.length>0)for(let i=0;i<t.children.length;i++)this.searchChildInFrustum(e,t.children[i])}}const T9=0,E9=2;class A9{constructor(e,t,i){O(this,"finder");O(this,"selectionBox");O(this,"selectionDiv");O(this,"el");O(this,"down",!1);O(this,"distance",0);O(this,"handlePointerDown",e=>{const t=this.player.selectedBuilding;this.down=!0,!(e.button!==T9||t)&&(this.selectionDiv.onDown(e),this.selectionBox.startPoint.set(e.clientX/window.innerWidth*2-1,-(e.clientY/window.innerHeight)*2+1,0))});O(this,"handlePointerMove",e=>{!this.down||(this.selectionDiv.onMove(e),this.distance+=1,this.selectionBox.endPoint.set(e.clientX/window.innerWidth*2-1,-(e.clientY/window.innerHeight)*2+1,0))});O(this,"handlePointerUp",e=>{if(!!this.down){if(this.down=!1,e.button===E9){this.handleRightClick(e);return}if(this.selectionDiv.onUp(),this.distance<10){this.handleClick(e);return}this.distance=0,this.selectionBox.endPoint.set(e.clientX/window.innerWidth*2-1,-(e.clientY/window.innerHeight)*2+1,.5),this.boxSelect(e.shiftKey||e.ctrlKey)}});O(this,"handleClick",e=>{const t=this.player.selectedActors,i=e.shiftKey||e.ctrlKey,r=this.finder.findSingleActorByMouseEvent(e);if(!r){if(i)return;this.player.unselectActor();return}i?t.includes(r)?this.player.selectActors(t.filter(s=>s!==r)):this.player.selectActors(Gr.exports.uniq([r,...t])):this.player.selectActors([r])});O(this,"handleContextmenu",e=>{e.preventDefault()});O(this,"handleRightClick",e=>{e.preventDefault();const t=this.player.selectedActors,i=this.finder.findPositionByMouseEvent(e);if(!i||!t.length)return;const r=this.finder.findActorsByMouseEvent(e);for(const a of r)if(a.interact(t))return;const s=t.filter(cC),o=_9(i,s.length,a=>this.game.world.hasTile(a)?this.game.world.getTile(a).canWalk:!1);s.forEach((a,c)=>{const f=o[c];f&&a.setPathTo(f)})});O(this,"handleDoubleClick",()=>{const e=Gr.exports.first(this.player.selectedActors);if(!e)return;const t=this.game.findActorsByType(e.type);this.player.selectActors(t)});this.game=e,this.renderer=t,this.player=i,this.el=this.renderer.webGLRenderer.domElement,this.selectionDiv=new w9(t.webGLRenderer),this.finder=new MC(e,t),this.selectionBox=new b9(this.renderer.rtsCamera.camera,this.renderer.scene)}enable(){this.el.addEventListener("contextmenu",this.handleContextmenu),this.el.addEventListener("pointerdown",this.handlePointerDown),document.addEventListener("pointermove",this.handlePointerMove),document.addEventListener("pointerup",this.handlePointerUp),this.el.addEventListener("dblclick",this.handleDoubleClick)}disable(){this.el.removeEventListener("contextmenu",this.handleContextmenu),this.el.removeEventListener("pointerdown",this.handlePointerDown),document.removeEventListener("pointermove",this.handlePointerMove),document.removeEventListener("pointerup",this.handlePointerUp)}boxSelect(e=!1){const t=this.player.selectedActors,r=this.selectionBox.select().map(a=>a.userData.actor).filter(a=>!!a),s=r.reduce((a,c)=>Math.max(a,c.getSelectedImportance()),0),o=r.filter(a=>a.getSelectedImportance()===s);e?o.every(a=>t.includes(a))?this.player.selectActors(Gr.exports.xor(t,o)):this.player.selectActors(Gr.exports.uniq([...o,...t])):this.player.selectActors(o)}}class C9{constructor(e,t,i){O(this,"keyboard");O(this,"select");O(this,"build");O(this,"selectMode",()=>{this.select.enable(),this.build.disable()});O(this,"buildMode",()=>{this.select.disable(),this.build.enable()});this.game=e,this.renderer=t,this.player=i,this.keyboard=new y9(e,t,i),this.select=new A9(e,t,i),this.build=new v9(e,t,i),this.player.emitter.on("selectBuilding",this.buildMode),this.player.emitter.on("unselectBuilding",this.selectMode)}init(){this.keyboard.enable(),this.selectMode()}destroy(){this.keyboard.disable(),this.build.disable(),this.select.disable(),this.player.emitter.off("selectBuilding",this.buildMode),this.player.emitter.off("unselectBuilding",this.selectMode)}}var bC={exports:{}};(function(n,e){(function(t,i){n.exports=i()})(Ma,function(){var t=function(){function i(g){return o.appendChild(g.dom),g}function r(g){for(var _=0;_<o.children.length;_++)o.children[_].style.display=_===g?"block":"none";s=g}var s=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(g){g.preventDefault(),r(++s%o.children.length)},!1);var a=(performance||Date).now(),c=a,f=0,h=i(new t.Panel("FPS","#0ff","#002")),d=i(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var p=i(new t.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:o,addPanel:i,showPanel:r,begin:function(){a=(performance||Date).now()},end:function(){f++;var g=(performance||Date).now();if(d.update(g-a,200),g>c+1e3&&(h.update(1e3*f/(g-c),100),c=g,f=0,p)){var _=performance.memory;p.update(_.usedJSHeapSize/1048576,_.jsHeapSizeLimit/1048576)}return g},update:function(){a=this.end()},domElement:o,setMode:r}};return t.Panel=function(i,r,s){var o=1/0,a=0,c=Math.round,f=c(window.devicePixelRatio||1),h=80*f,d=48*f,p=3*f,g=2*f,_=3*f,y=15*f,x=74*f,v=30*f,w=document.createElement("canvas");w.width=h,w.height=d,w.style.cssText="width:80px;height:48px";var S=w.getContext("2d");return S.font="bold "+9*f+"px Helvetica,Arial,sans-serif",S.textBaseline="top",S.fillStyle=s,S.fillRect(0,0,h,d),S.fillStyle=r,S.fillText(i,p,g),S.fillRect(_,y,x,v),S.fillStyle=s,S.globalAlpha=.9,S.fillRect(_,y,x,v),{dom:w,update:function(E,b){o=Math.min(o,E),a=Math.max(a,E),S.fillStyle=s,S.globalAlpha=1,S.fillRect(0,0,h,y),S.fillStyle=r,S.fillText(c(E)+" "+i+" ("+c(o)+"-"+c(a)+")",p,g),S.drawImage(w,_+f,y,x-f,v,_,y,x-f,v),S.fillRect(_+x-f,y,f,v),S.fillStyle=s,S.globalAlpha=.9,S.fillRect(_+x-f,y,f,c((1-E/b)*v))}}},t})})(bC);var R9=bC.exports;class Ya{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const P9=new jf(-1,1,1,-1,0,1),A_=new Rn;A_.setAttribute("position",new kt([-1,3,0,-1,-1,0,3,-1,0],3));A_.setAttribute("uv",new kt([0,2,0,0,2,0],2));class Mm{constructor(e){this._mesh=new cn(A_,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,P9)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}const NT={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:.01},nearClip:{value:1},farClip:{value:1e3}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		#include <common>

		varying vec2 vUv;

		uniform sampler2D tColor;
		uniform sampler2D tDepth;

		uniform float maxblur; // max blur amount
		uniform float aperture; // aperture - bigger values for shallower depth of field

		uniform float nearClip;
		uniform float farClip;

		uniform float focus;
		uniform float aspect;

		#include <packing>

		float getDepth( const in vec2 screenPosition ) {
			#if DEPTH_PACKING == 1
			return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );
			#else
			return texture2D( tDepth, screenPosition ).x;
			#endif
		}

		float getViewZ( const in float depth ) {
			#if PERSPECTIVE_CAMERA == 1
			return perspectiveDepthToViewZ( depth, nearClip, farClip );
			#else
			return orthographicDepthToViewZ( depth, nearClip, farClip );
			#endif
		}


		void main() {

			vec2 aspectcorrect = vec2( 1.0, aspect );

			float viewZ = getViewZ( getDepth( vUv ) );

			float factor = ( focus + viewZ ); // viewZ is <= 0, so this is a difference equation

			vec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );

			vec2 dofblur9 = dofblur * 0.9;
			vec2 dofblur7 = dofblur * 0.7;
			vec2 dofblur4 = dofblur * 0.4;

			vec4 col = vec4( 0.0 );

			col += texture2D( tColor, vUv.xy );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );

			col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );

			col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );

			col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );

			gl_FragColor = col / 41.0;
			gl_FragColor.a = 1.0;

		}`};class L9 extends Ya{constructor(e,t,i){super(),this.scene=e,this.camera=t;const r=i.focus!==void 0?i.focus:1,s=i.aspect!==void 0?i.aspect:t.aspect,o=i.aperture!==void 0?i.aperture:.025,a=i.maxblur!==void 0?i.maxblur:1,c=i.width||window.innerWidth||1,f=i.height||window.innerHeight||1;this.renderTargetDepth=new gn(c,f,{minFilter:En,magFilter:En}),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new xm,this.materialDepth.depthPacking=n_,this.materialDepth.blending=jr,NT===void 0&&console.error("THREE.BokehPass relies on BokehShader");const h=NT,d=Mc.clone(h.uniforms);d.tDepth.value=this.renderTargetDepth.texture,d.focus.value=r,d.aspect.value=s,d.aperture.value=o,d.maxblur.value=a,d.nearClip.value=t.near,d.farClip.value=t.far,this.materialBokeh=new pn({defines:Object.assign({},h.defines),uniforms:d,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader}),this.uniforms=d,this.needsSwap=!1,this.fsQuad=new Mm(this.materialBokeh),this._oldClearColor=new Fe}render(e,t,i){this.scene.overrideMaterial=this.materialDepth,e.getClearColor(this._oldClearColor);const r=e.getClearAlpha(),s=e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.setRenderTarget(this.renderTargetDepth),e.clear(),e.render(this.scene,this.camera),this.uniforms.tColor.value=i.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),e.clear(),this.fsQuad.render(e)),this.scene.overrideMaterial=null,e.setClearColor(this._oldClearColor),e.setClearAlpha(r),e.autoClear=s}}const Ac={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			gl_FragColor = texture2D( tDiffuse, vUv );
			gl_FragColor.a *= opacity;


		}`};class qp extends Ya{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof pn?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Mc.clone(e.uniforms),this.material=new pn({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Mm(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}class OT extends Ya{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,i){const r=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let o,a;this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class I9 extends Ya{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class F9{constructor(e,t){if(this.renderer=e,t===void 0){const i=e.getSize(new Ce);this._pixelRatio=e.getPixelRatio(),this._width=i.width,this._height=i.height,t=new gn(this._width*this._pixelRatio,this._height*this._pixelRatio),t.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],Ac===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),qp===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new qp(Ac),this.clock=new j2}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let i=!1;for(let r=0,s=this.passes.length;r<s;r++){const o=this.passes[r];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),o.needsSwap){if(i){const a=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),c.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}OT!==void 0&&(o instanceof OT?i=!0:o instanceof I9&&(i=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new Ce);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(i,r),this.renderTarget2.setSize(i,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(i,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}new jf(-1,1,1,-1,0,1);const TC=new Rn;TC.setAttribute("position",new kt([-1,3,0,-1,-1,0,3,-1,0],3));TC.setAttribute("uv",new kt([0,2,0,0,2,0],2));class Oo extends Ya{constructor(e,t,i,r){super(),this.renderScene=t,this.renderCamera=i,this.selectedObjects=r!==void 0?r:[],this.visibleEdgeColor=new Fe(1,1,1),this.hiddenEdgeColor=new Fe(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this.resolution=e!==void 0?new Ce(e.x,e.y):new Ce(256,256);const s=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new gn(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new xm,this.depthMaterial.side=xs,this.depthMaterial.depthPacking=n_,this.depthMaterial.blending=jr,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=xs,this.prepareMaskMaterial.fragmentShader=h(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new gn(this.resolution.x,this.resolution.y),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new gn(s,o),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new gn(s,o),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new gn(Math.round(s/2),Math.round(o/2)),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new gn(s,o),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new gn(Math.round(s/2),Math.round(o/2)),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;const a=4,c=4;this.separableBlurMaterial1=this.getSeperableBlurMaterial(a),this.separableBlurMaterial1.uniforms.texSize.value.set(s,o),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(c),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(s/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=c,this.overlayMaterial=this.getOverlayMaterial(),Ac===void 0&&console.error("THREE.OutlinePass relies on CopyShader");const f=Ac;this.copyUniforms=Mc.clone(f.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new pn({uniforms:this.copyUniforms,vertexShader:f.vertexShader,fragmentShader:f.fragmentShader,blending:jr,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Fe,this.oldClearAlpha=1,this.fsQuad=new Mm(null),this.tempPulseColor1=new Fe,this.tempPulseColor2=new Fe,this.textureMatrix=new pt;function h(d,p){const g=p.isPerspectiveCamera?"perspective":"orthographic";return d.replace(/DEPTH_TO_VIEW_Z/g,g+"DepthToViewZ")}}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let i=Math.round(e/this.downSampleRatio),r=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(i,r),this.renderTargetBlurBuffer1.setSize(i,r),this.renderTargetEdgeBuffer1.setSize(i,r),this.separableBlurMaterial1.uniforms.texSize.value.set(i,r),i=Math.round(i/2),r=Math.round(r/2),this.renderTargetBlurBuffer2.setSize(i,r),this.renderTargetEdgeBuffer2.setSize(i,r),this.separableBlurMaterial2.uniforms.texSize.value.set(i,r)}changeVisibilityOfSelectedObjects(e){const t=this._visibilityCache;function i(r){r.isMesh&&(e===!0?r.visible=t.get(r):(t.set(r,r.visible),r.visible=e))}for(let r=0;r<this.selectedObjects.length;r++)this.selectedObjects[r].traverse(i)}changeVisibilityOfNonSelectedObjects(e){const t=this._visibilityCache,i=[];function r(o){o.isMesh&&i.push(o)}for(let o=0;o<this.selectedObjects.length;o++)this.selectedObjects[o].traverse(r);function s(o){if(o.isMesh||o.isSprite){let a=!1;for(let c=0;c<i.length;c++)if(i[c].id===o.id){a=!0;break}if(a===!1){const c=o.visible;(e===!1||t.get(o)===!0)&&(o.visible=e),t.set(o,c)}}else(o.isPoints||o.isLine)&&(e===!0?o.visible=t.get(o):(t.set(o,o.visible),o.visible=e))}this.renderScene.traverse(s)}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,i,r,s){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,s&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);const a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this.renderScene.background=a,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){const c=.625+Math.cos(performance.now()*.01/this.pulsePeriod)*.75/2;this.tempPulseColor1.multiplyScalar(c),this.tempPulseColor2.multiplyScalar(c)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=Oo.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=Oo.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=Oo.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=Oo.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(i),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=i.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new pn({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new Ce(.5,.5)},textureMatrix:{value:null}},vertexShader:`#include <morphtarget_pars_vertex>
				#include <skinning_pars_vertex>

				varying vec4 projTexCoord;
				varying vec4 vPosition;
				uniform mat4 textureMatrix;

				void main() {

					#include <skinbase_vertex>
					#include <begin_vertex>
					#include <morphtarget_vertex>
					#include <skinning_vertex>
					#include <project_vertex>

					vPosition = mvPosition;
					vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );
					projTexCoord = textureMatrix * worldPosition;

				}`,fragmentShader:`#include <packing>
				varying vec4 vPosition;
				varying vec4 projTexCoord;
				uniform sampler2D depthTexture;
				uniform vec2 cameraNearFar;

				void main() {

					float depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));
					float viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );
					float depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;
					gl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);

				}`})}getEdgeDetectionMaterial(){return new pn({uniforms:{maskTexture:{value:null},texSize:{value:new Ce(.5,.5)},visibleEdgeColor:{value:new z(1,1,1)},hiddenEdgeColor:{value:new z(1,1,1)}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;

				uniform sampler2D maskTexture;
				uniform vec2 texSize;
				uniform vec3 visibleEdgeColor;
				uniform vec3 hiddenEdgeColor;

				void main() {
					vec2 invSize = 1.0 / texSize;
					vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);
					vec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);
					vec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);
					vec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);
					vec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);
					float diff1 = (c1.r - c2.r)*0.5;
					float diff2 = (c3.r - c4.r)*0.5;
					float d = length( vec2(diff1, diff2) );
					float a1 = min(c1.g, c2.g);
					float a2 = min(c3.g, c4.g);
					float visibilityFactor = min(a1, a2);
					vec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;
					gl_FragColor = vec4(edgeColor, 1.0) * vec4(d);
				}`})}getSeperableBlurMaterial(e){return new pn({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new Ce(.5,.5)},direction:{value:new Ce(.5,.5)},kernelRadius:{value:1}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;
				uniform float kernelRadius;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}

				void main() {
					vec2 invSize = 1.0 / texSize;
					float weightSum = gaussianPdf(0.0, kernelRadius);
					vec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;
					vec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);
					vec2 uvOffset = delta;
					for( int i = 1; i <= MAX_RADIUS; i ++ ) {
						float w = gaussianPdf(uvOffset.x, kernelRadius);
						vec4 sample1 = texture2D( colorTexture, vUv + uvOffset);
						vec4 sample2 = texture2D( colorTexture, vUv - uvOffset);
						diffuseSum += ((sample1 + sample2) * w);
						weightSum += (2.0 * w);
						uvOffset += delta;
					}
					gl_FragColor = diffuseSum/weightSum;
				}`})}getOverlayMaterial(){return new pn({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;

				uniform sampler2D maskTexture;
				uniform sampler2D edgeTexture1;
				uniform sampler2D edgeTexture2;
				uniform sampler2D patternTexture;
				uniform float edgeStrength;
				uniform float edgeGlow;
				uniform bool usePatternTexture;

				void main() {
					vec4 edgeValue1 = texture2D(edgeTexture1, vUv);
					vec4 edgeValue2 = texture2D(edgeTexture2, vUv);
					vec4 maskColor = texture2D(maskTexture, vUv);
					vec4 patternColor = texture2D(patternTexture, 6.0 * vUv);
					float visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;
					vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;
					vec4 finalColor = edgeStrength * maskColor.r * edgeValue;
					if(usePatternTexture)
						finalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);
					gl_FragColor = finalColor;
				}`,blending:kp,depthTest:!1,depthWrite:!1,transparent:!0})}}Oo.BlurDirectionX=new Ce(1,0);Oo.BlurDirectionY=new Ce(0,1);class D9 extends Ya{constructor(e,t,i,r,s){super(),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=r,this.clearAlpha=s!==void 0?s:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Fe}render(e,t,i){const r=e.autoClear;e.autoClear=!1;let s,o;this.overrideMaterial!==void 0&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),s=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,s),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=o),e.autoClear=r}}const kT={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Fe(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			vec3 luma = vec3( 0.299, 0.587, 0.114 );

			float v = dot( texel.xyz, luma );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class Cc extends Ya{constructor(e,t,i,r){super(),this.strength=t!==void 0?t:1,this.radius=i,this.threshold=r,this.resolution=e!==void 0?new Ce(e.x,e.y):new Ce(256,256),this.clearColor=new Fe(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);this.renderTargetBright=new gn(s,o),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let d=0;d<this.nMips;d++){const p=new gn(s,o);p.texture.name="UnrealBloomPass.h"+d,p.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(p);const g=new gn(s,o);g.texture.name="UnrealBloomPass.v"+d,g.texture.generateMipmaps=!1,this.renderTargetsVertical.push(g),s=Math.round(s/2),o=Math.round(o/2)}kT===void 0&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const a=kT;this.highPassUniforms=Mc.clone(a.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new pn({uniforms:this.highPassUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const c=[3,5,7,9,11];s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);for(let d=0;d<this.nMips;d++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(c[d])),this.separableBlurMaterials[d].uniforms.texSize.value=new Ce(s,o),s=Math.round(s/2),o=Math.round(o/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;const f=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=f,this.bloomTintColors=[new z(1,1,1),new z(1,1,1),new z(1,1,1),new z(1,1,1),new z(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,Ac===void 0&&console.error("THREE.UnrealBloomPass relies on CopyShader");const h=Ac;this.copyUniforms=Mc.clone(h.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new pn({uniforms:this.copyUniforms,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,blending:kp,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Fe,this.oldClearAlpha=1,this.basic=new wr,this.fsQuad=new Mm(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}setSize(e,t){let i=Math.round(e/2),r=Math.round(t/2);this.renderTargetBright.setSize(i,r);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(i,r),this.renderTargetsVertical[s].setSize(i,r),this.separableBlurMaterials[s].uniforms.texSize.value=new Ce(i,r),i=Math.round(i/2),r=Math.round(r/2)}render(e,t,i,r,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=i.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let a=this.renderTargetBright;for(let c=0;c<this.nMips;c++)this.fsQuad.material=this.separableBlurMaterials[c],this.separableBlurMaterials[c].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[c].uniforms.direction.value=Cc.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[c]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[c].uniforms.colorTexture.value=this.renderTargetsHorizontal[c].texture,this.separableBlurMaterials[c].uniforms.direction.value=Cc.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[c]),e.clear(),this.fsQuad.render(e),a=this.renderTargetsVertical[c];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(i),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}getSeperableBlurMaterial(e){return new pn({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new Ce(.5,.5)},direction:{value:new Ce(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}
				void main() {
					vec2 invSize = 1.0 / texSize;
					float fSigma = float(SIGMA);
					float weightSum = gaussianPdf(0.0, fSigma);
					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianPdf(x, fSigma);
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new pn({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}Cc.BlurDirectionX=new Ce(1,0);Cc.BlurDirectionY=new Ce(0,1);const N9={uniforms:{tDiffuse:{value:null},resolution:{value:new Ce(1/1024,1/512)}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`
	precision highp float;

	uniform sampler2D tDiffuse;

	uniform vec2 resolution;

	varying vec2 vUv;

	// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)

	//----------------------------------------------------------------------------------
	// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag
	// SDK Version: v3.00
	// Email:       gameworks@nvidia.com
	// Site:        http://developer.nvidia.com/
	//
	// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.
	//
	// Redistribution and use in source and binary forms, with or without
	// modification, are permitted provided that the following conditions
	// are met:
	//  * Redistributions of source code must retain the above copyright
	//    notice, this list of conditions and the following disclaimer.
	//  * Redistributions in binary form must reproduce the above copyright
	//    notice, this list of conditions and the following disclaimer in the
	//    documentation and/or other materials provided with the distribution.
	//  * Neither the name of NVIDIA CORPORATION nor the names of its
	//    contributors may be used to endorse or promote products derived
	//    from this software without specific prior written permission.
	//
	// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ''AS IS'' AND ANY
	// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
	// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
	// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
	// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
	// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
	// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
	// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
	// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
	// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
	// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	//
	//----------------------------------------------------------------------------------

	#ifndef FXAA_DISCARD
			//
			// Only valid for PC OpenGL currently.
			// Probably will not work when FXAA_GREEN_AS_LUMA = 1.
			//
			// 1 = Use discard on pixels which don't need AA.
			//     For APIs which enable concurrent TEX+ROP from same surface.
			// 0 = Return unchanged color on pixels which don't need AA.
			//
			#define FXAA_DISCARD 0
	#endif

	/*--------------------------------------------------------------------------*/
	#define FxaaTexTop(t, p) texture2D(t, p, -100.0)
	#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), -100.0)
	/*--------------------------------------------------------------------------*/

	#define NUM_SAMPLES 5

	// assumes colors have premultipliedAlpha, so that the calculated color contrast is scaled by alpha
	float contrast( vec4 a, vec4 b ) {
			vec4 diff = abs( a - b );
			return max( max( max( diff.r, diff.g ), diff.b ), diff.a );
	}

	/*============================================================================

									FXAA3 QUALITY - PC

	============================================================================*/

	/*--------------------------------------------------------------------------*/
	vec4 FxaaPixelShader(
			vec2 posM,
			sampler2D tex,
			vec2 fxaaQualityRcpFrame,
			float fxaaQualityEdgeThreshold,
			float fxaaQualityinvEdgeThreshold
	) {
			vec4 rgbaM = FxaaTexTop(tex, posM);
			vec4 rgbaS = FxaaTexOff(tex, posM, vec2( 0.0, 1.0), fxaaQualityRcpFrame.xy);
			vec4 rgbaE = FxaaTexOff(tex, posM, vec2( 1.0, 0.0), fxaaQualityRcpFrame.xy);
			vec4 rgbaN = FxaaTexOff(tex, posM, vec2( 0.0,-1.0), fxaaQualityRcpFrame.xy);
			vec4 rgbaW = FxaaTexOff(tex, posM, vec2(-1.0, 0.0), fxaaQualityRcpFrame.xy);
			// . S .
			// W M E
			// . N .

			bool earlyExit = max( max( max(
					contrast( rgbaM, rgbaN ),
					contrast( rgbaM, rgbaS ) ),
					contrast( rgbaM, rgbaE ) ),
					contrast( rgbaM, rgbaW ) )
					< fxaaQualityEdgeThreshold;
			// . 0 .
			// 0 0 0
			// . 0 .

			#if (FXAA_DISCARD == 1)
					if(earlyExit) FxaaDiscard;
			#else
					if(earlyExit) return rgbaM;
			#endif

			float contrastN = contrast( rgbaM, rgbaN );
			float contrastS = contrast( rgbaM, rgbaS );
			float contrastE = contrast( rgbaM, rgbaE );
			float contrastW = contrast( rgbaM, rgbaW );

			float relativeVContrast = ( contrastN + contrastS ) - ( contrastE + contrastW );
			relativeVContrast *= fxaaQualityinvEdgeThreshold;

			bool horzSpan = relativeVContrast > 0.;
			// . 1 .
			// 0 0 0
			// . 1 .

			// 45 deg edge detection and corners of objects, aka V/H contrast is too similar
			if( abs( relativeVContrast ) < .3 ) {
					// locate the edge
					vec2 dirToEdge;
					dirToEdge.x = contrastE > contrastW ? 1. : -1.;
					dirToEdge.y = contrastS > contrastN ? 1. : -1.;
					// . 2 .      . 1 .
					// 1 0 2  ~=  0 0 1
					// . 1 .      . 0 .

					// tap 2 pixels and see which ones are "outside" the edge, to
					// determine if the edge is vertical or horizontal

					vec4 rgbaAlongH = FxaaTexOff(tex, posM, vec2( dirToEdge.x, -dirToEdge.y ), fxaaQualityRcpFrame.xy);
					float matchAlongH = contrast( rgbaM, rgbaAlongH );
					// . 1 .
					// 0 0 1
					// . 0 H

					vec4 rgbaAlongV = FxaaTexOff(tex, posM, vec2( -dirToEdge.x, dirToEdge.y ), fxaaQualityRcpFrame.xy);
					float matchAlongV = contrast( rgbaM, rgbaAlongV );
					// V 1 .
					// 0 0 1
					// . 0 .

					relativeVContrast = matchAlongV - matchAlongH;
					relativeVContrast *= fxaaQualityinvEdgeThreshold;

					if( abs( relativeVContrast ) < .3 ) { // 45 deg edge
							// 1 1 .
							// 0 0 1
							// . 0 1

							// do a simple blur
							return mix(
									rgbaM,
									(rgbaN + rgbaS + rgbaE + rgbaW) * .25,
									.4
							);
					}

					horzSpan = relativeVContrast > 0.;
			}

			if(!horzSpan) rgbaN = rgbaW;
			if(!horzSpan) rgbaS = rgbaE;
			// . 0 .      1
			// 1 0 1  ->  0
			// . 0 .      1

			bool pairN = contrast( rgbaM, rgbaN ) > contrast( rgbaM, rgbaS );
			if(!pairN) rgbaN = rgbaS;

			vec2 offNP;
			offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;
			offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;

			bool doneN = false;
			bool doneP = false;

			float nDist = 0.;
			float pDist = 0.;

			vec2 posN = posM;
			vec2 posP = posM;

			int iterationsUsed = 0;
			int iterationsUsedN = 0;
			int iterationsUsedP = 0;
			for( int i = 0; i < NUM_SAMPLES; i++ ) {
					iterationsUsed = i;

					float increment = float(i + 1);

					if(!doneN) {
							nDist += increment;
							posN = posM + offNP * nDist;
							vec4 rgbaEndN = FxaaTexTop(tex, posN.xy);
							doneN = contrast( rgbaEndN, rgbaM ) > contrast( rgbaEndN, rgbaN );
							iterationsUsedN = i;
					}

					if(!doneP) {
							pDist += increment;
							posP = posM - offNP * pDist;
							vec4 rgbaEndP = FxaaTexTop(tex, posP.xy);
							doneP = contrast( rgbaEndP, rgbaM ) > contrast( rgbaEndP, rgbaN );
							iterationsUsedP = i;
					}

					if(doneN || doneP) break;
			}


			if ( !doneP && !doneN ) return rgbaM; // failed to find end of edge

			float dist = min(
					doneN ? float( iterationsUsedN ) / float( NUM_SAMPLES - 1 ) : 1.,
					doneP ? float( iterationsUsedP ) / float( NUM_SAMPLES - 1 ) : 1.
			);

			// hacky way of reduces blurriness of mostly diagonal edges
			// but reduces AA quality
			dist = pow(dist, .5);

			dist = 1. - dist;

			return mix(
					rgbaM,
					rgbaN,
					dist * .5
			);
	}

	void main() {
			const float edgeDetectionQuality = .2;
			const float invEdgeDetectionQuality = 1. / edgeDetectionQuality;

			gl_FragColor = FxaaPixelShader(
					vUv,
					tDiffuse,
					resolution,
					edgeDetectionQuality, // [0,1] contrast needed, otherwise early discard
					invEdgeDetectionQuality
			);

	}
	`},O9={uniforms:{tDiffuse:{value:null}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 tex = texture2D( tDiffuse, vUv );

			gl_FragColor = LinearTosRGB( tex );

		}`},BT={type:"change"},Sv={type:"start"},zT={type:"end"};class k9 extends Qo{constructor(e,t){super(),t===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new z,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Ro.ROTATE,MIDDLE:Ro.DOLLY,RIGHT:Ro.PAN},this.touches={ONE:pl.ROTATE,TWO:pl.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(D){D.addEventListener("keydown",Xt),this._domElementKeyEvents=D},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(BT),i.update(),s=r.NONE},this.update=function(){const D=new z,ve=new qn().setFromUnitVectors(e.up,new z(0,1,0)),Ae=ve.clone().invert(),Me=new z,H=new qn,be=2*Math.PI;return function(){const We=i.object.position;D.copy(We).sub(i.target),D.applyQuaternion(ve),a.setFromVector3(D),i.autoRotate&&s===r.NONE&&F(C()),i.enableDamping?(a.theta+=c.theta*i.dampingFactor,a.phi+=c.phi*i.dampingFactor):(a.theta+=c.theta,a.phi+=c.phi);let Pe=i.minAzimuthAngle,He=i.maxAzimuthAngle;return isFinite(Pe)&&isFinite(He)&&(Pe<-Math.PI?Pe+=be:Pe>Math.PI&&(Pe-=be),He<-Math.PI?He+=be:He>Math.PI&&(He-=be),Pe<=He?a.theta=Math.max(Pe,Math.min(He,a.theta)):a.theta=a.theta>(Pe+He)/2?Math.max(Pe,a.theta):Math.min(He,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=f,a.radius=Math.max(i.minDistance,Math.min(i.maxDistance,a.radius)),i.enableDamping===!0?i.target.addScaledVector(h,i.dampingFactor):i.target.add(h),D.setFromSpherical(a),D.applyQuaternion(Ae),We.copy(i.target).add(D),i.object.lookAt(i.target),i.enableDamping===!0?(c.theta*=1-i.dampingFactor,c.phi*=1-i.dampingFactor,h.multiplyScalar(1-i.dampingFactor)):(c.set(0,0,0),h.set(0,0,0)),f=1,d||Me.distanceToSquared(i.object.position)>o||8*(1-H.dot(i.object.quaternion))>o?(i.dispatchEvent(BT),Me.copy(i.object.position),H.copy(i.object.quaternion),d=!1,!0):!1}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",fe),i.domElement.removeEventListener("pointerdown",Tt),i.domElement.removeEventListener("pointercancel",Qt),i.domElement.removeEventListener("wheel",Pn),i.domElement.removeEventListener("pointermove",jt),i.domElement.removeEventListener("pointerup",wn),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",Xt)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new lT,c=new lT;let f=1;const h=new z;let d=!1;const p=new Ce,g=new Ce,_=new Ce,y=new Ce,x=new Ce,v=new Ce,w=new Ce,S=new Ce,E=new Ce,b=[],T={};function C(){return 2*Math.PI/60/60*i.autoRotateSpeed}function A(){return Math.pow(.95,i.zoomSpeed)}function F(D){c.theta-=D}function U(D){c.phi-=D}const W=function(){const D=new z;return function(Ae,Me){D.setFromMatrixColumn(Me,0),D.multiplyScalar(-Ae),h.add(D)}}(),ne=function(){const D=new z;return function(Ae,Me){i.screenSpacePanning===!0?D.setFromMatrixColumn(Me,1):(D.setFromMatrixColumn(Me,0),D.crossVectors(i.object.up,D)),D.multiplyScalar(Ae),h.add(D)}}(),re=function(){const D=new z;return function(Ae,Me){const H=i.domElement;if(i.object.isPerspectiveCamera){const be=i.object.position;D.copy(be).sub(i.target);let Se=D.length();Se*=Math.tan(i.object.fov/2*Math.PI/180),W(2*Ae*Se/H.clientHeight,i.object.matrix),ne(2*Me*Se/H.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(W(Ae*(i.object.right-i.object.left)/i.object.zoom/H.clientWidth,i.object.matrix),ne(Me*(i.object.top-i.object.bottom)/i.object.zoom/H.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function V(D){i.object.isPerspectiveCamera?f/=D:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*D)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function ie(D){i.object.isPerspectiveCamera?f*=D:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/D)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function K(D){p.set(D.clientX,D.clientY)}function ae(D){w.set(D.clientX,D.clientY)}function $(D){y.set(D.clientX,D.clientY)}function Y(D){g.set(D.clientX,D.clientY),_.subVectors(g,p).multiplyScalar(i.rotateSpeed);const ve=i.domElement;F(2*Math.PI*_.x/ve.clientHeight),U(2*Math.PI*_.y/ve.clientHeight),p.copy(g),i.update()}function Z(D){S.set(D.clientX,D.clientY),E.subVectors(S,w),E.y>0?V(A()):E.y<0&&ie(A()),w.copy(S),i.update()}function he(D){x.set(D.clientX,D.clientY),v.subVectors(x,y).multiplyScalar(i.panSpeed),re(v.x,v.y),y.copy(x),i.update()}function me(D){D.deltaY<0?ie(A()):D.deltaY>0&&V(A()),i.update()}function we(D){let ve=!1;switch(D.code){case i.keys.UP:re(0,i.keyPanSpeed),ve=!0;break;case i.keys.BOTTOM:re(0,-i.keyPanSpeed),ve=!0;break;case i.keys.LEFT:re(i.keyPanSpeed,0),ve=!0;break;case i.keys.RIGHT:re(-i.keyPanSpeed,0),ve=!0;break}ve&&(D.preventDefault(),i.update())}function De(){if(b.length===1)p.set(b[0].pageX,b[0].pageY);else{const D=.5*(b[0].pageX+b[1].pageX),ve=.5*(b[0].pageY+b[1].pageY);p.set(D,ve)}}function Be(){if(b.length===1)y.set(b[0].pageX,b[0].pageY);else{const D=.5*(b[0].pageX+b[1].pageX),ve=.5*(b[0].pageY+b[1].pageY);y.set(D,ve)}}function ce(){const D=b[0].pageX-b[1].pageX,ve=b[0].pageY-b[1].pageY,Ae=Math.sqrt(D*D+ve*ve);w.set(0,Ae)}function yt(){i.enableZoom&&ce(),i.enablePan&&Be()}function qe(){i.enableZoom&&ce(),i.enableRotate&&De()}function Xe(D){if(b.length==1)g.set(D.pageX,D.pageY);else{const Ae=Ge(D),Me=.5*(D.pageX+Ae.x),H=.5*(D.pageY+Ae.y);g.set(Me,H)}_.subVectors(g,p).multiplyScalar(i.rotateSpeed);const ve=i.domElement;F(2*Math.PI*_.x/ve.clientHeight),U(2*Math.PI*_.y/ve.clientHeight),p.copy(g)}function Ne(D){if(b.length===1)x.set(D.pageX,D.pageY);else{const ve=Ge(D),Ae=.5*(D.pageX+ve.x),Me=.5*(D.pageY+ve.y);x.set(Ae,Me)}v.subVectors(x,y).multiplyScalar(i.panSpeed),re(v.x,v.y),y.copy(x)}function dt(D){const ve=Ge(D),Ae=D.pageX-ve.x,Me=D.pageY-ve.y,H=Math.sqrt(Ae*Ae+Me*Me);S.set(0,H),E.set(0,Math.pow(S.y/w.y,i.zoomSpeed)),V(E.y),w.copy(S)}function nt(D){i.enableZoom&&dt(D),i.enablePan&&Ne(D)}function Ye(D){i.enableZoom&&dt(D),i.enableRotate&&Xe(D)}function Tt(D){i.enabled!==!1&&(b.length===0&&(i.domElement.setPointerCapture(D.pointerId),i.domElement.addEventListener("pointermove",jt),i.domElement.addEventListener("pointerup",wn)),xe(D),D.pointerType==="touch"?k(D):rn(D))}function jt(D){i.enabled!==!1&&(D.pointerType==="touch"?I(D):Et(D))}function wn(D){Ee(D),b.length===0&&(i.domElement.releasePointerCapture(D.pointerId),i.domElement.removeEventListener("pointermove",jt),i.domElement.removeEventListener("pointerup",wn)),i.dispatchEvent(zT),s=r.NONE}function Qt(D){Ee(D)}function rn(D){let ve;switch(D.button){case 0:ve=i.mouseButtons.LEFT;break;case 1:ve=i.mouseButtons.MIDDLE;break;case 2:ve=i.mouseButtons.RIGHT;break;default:ve=-1}switch(ve){case Ro.DOLLY:if(i.enableZoom===!1)return;ae(D),s=r.DOLLY;break;case Ro.ROTATE:if(D.ctrlKey||D.metaKey||D.shiftKey){if(i.enablePan===!1)return;$(D),s=r.PAN}else{if(i.enableRotate===!1)return;K(D),s=r.ROTATE}break;case Ro.PAN:if(D.ctrlKey||D.metaKey||D.shiftKey){if(i.enableRotate===!1)return;K(D),s=r.ROTATE}else{if(i.enablePan===!1)return;$(D),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(Sv)}function Et(D){if(i.enabled!==!1)switch(s){case r.ROTATE:if(i.enableRotate===!1)return;Y(D);break;case r.DOLLY:if(i.enableZoom===!1)return;Z(D);break;case r.PAN:if(i.enablePan===!1)return;he(D);break}}function Pn(D){i.enabled===!1||i.enableZoom===!1||s!==r.NONE||(D.preventDefault(),i.dispatchEvent(Sv),me(D),i.dispatchEvent(zT))}function Xt(D){i.enabled===!1||i.enablePan===!1||we(D)}function k(D){switch(Re(D),b.length){case 1:switch(i.touches.ONE){case pl.ROTATE:if(i.enableRotate===!1)return;De(),s=r.TOUCH_ROTATE;break;case pl.PAN:if(i.enablePan===!1)return;Be(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case pl.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;yt(),s=r.TOUCH_DOLLY_PAN;break;case pl.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;qe(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(Sv)}function I(D){switch(Re(D),s){case r.TOUCH_ROTATE:if(i.enableRotate===!1)return;Xe(D),i.update();break;case r.TOUCH_PAN:if(i.enablePan===!1)return;Ne(D),i.update();break;case r.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;nt(D),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;Ye(D),i.update();break;default:s=r.NONE}}function fe(D){i.enabled!==!1&&D.preventDefault()}function xe(D){b.push(D)}function Ee(D){delete T[D.pointerId];for(let ve=0;ve<b.length;ve++)if(b[ve].pointerId==D.pointerId){b.splice(ve,1);return}}function Re(D){let ve=T[D.pointerId];ve===void 0&&(ve=new Ce,T[D.pointerId]=ve),ve.set(D.pageX,D.pageY)}function Ge(D){const ve=D.pointerId===b[0].pointerId?b[1]:b[0];return T[ve.pointerId]}i.domElement.addEventListener("contextmenu",fe),i.domElement.addEventListener("pointerdown",Tt),i.domElement.addEventListener("pointercancel",Qt),i.domElement.addEventListener("wheel",Pn,{passive:!1}),this.update()}}const B9=se.renderer.tileSize*2;class z9{constructor(e){O(this,"camera",new di(se.camera.fov,window.innerWidth/window.innerHeight,se.camera.near,se.camera.far));O(this,"keyPressed",{});O(this,"handleKeyDown",e=>{this.keyPressed[e.code]||(this.keyPressed[e.code]=new Date().getTime())});O(this,"handleKeyUp",e=>{delete this.keyPressed[e.code]});O(this,"handleWheel",e=>{let t=e.wheelDelta;t=t/240,t=-t,t<=0?t-=this.camera.position.y*.01:t+=this.camera.position.y*.01;const i=new z(0,0,1);i.applyQuaternion(this.camera.quaternion);const r=this.camera.position.clone();r.add(i.multiplyScalar(t)),r.y<se.camera.minHeight||r.y>se.camera.maxHeight||this.camera.translateZ(t)});this.domElement=e,this.camera.position.x=0,this.camera.position.y=5,this.camera.position.z=5,this.camera.rotation.x=-Math.PI/3,this.camera.rotation.order="YXZ"}init(){se.core.orbitalControls&&this.orbitalControls(),window.document.addEventListener("keydown",this.handleKeyDown),window.document.addEventListener("keyup",this.handleKeyUp),this.domElement.addEventListener("wheel",this.handleWheel)}render({deltaTime:e}){const t=new Date().getTime();Object.entries(this.keyPressed).forEach(([i,r])=>{const s=this.getMomentum(t,r,e),o=this.camera.position.y*se.renderer.tileSize,a=this.camera.rotation.x;let c=(s+o)*B9;switch((this.keyPressed.ShiftLeft||this.keyPressed.ShiftRight)&&(c*=2),i){case"KeyW":case"ArrowUp":this.camera.translateY(c*-a),this.camera.translateZ(c*(-a-Math.PI/2));break;case"KeyS":case"ArrowDown":this.camera.translateY(-c*-a),this.camera.translateZ(-c*(-a-Math.PI/2));break;case"KeyD":case"ArrowRight":this.camera.translateX(c);break;case"KeyA":case"ArrowLeft":this.camera.translateX(-c);break;case"KeyQ":this.rotateCameraY(-s);break;case"KeyE":this.rotateCameraY(s);break;case"KeyZ":this.rotateCameraX(s);break;case"KeyX":this.rotateCameraX(-s);break}})}getMomentum(e,t,i){const r=e-t;return Math.sqrt(r+800)*.01*i/.016}rotateCameraY(e){const t=new qn,i=new z(0,1,0);t.setFromAxisAngle(i,e*.1),this.camera.applyQuaternion(t),this.camera.translateX(e*this.camera.position.y/8*(this.camera.rotation.x+Math.PI/2)),this.camera.position.y=Math.max(se.camera.minHeight,Math.min(se.camera.maxHeight,this.camera.position.y))}rotateCameraX(e){this.camera.rotateX(e*.1),this.camera.translateY(-e*this.camera.position.y/8),this.camera.position.y=Math.max(se.camera.minHeight,Math.min(se.camera.maxHeight,this.camera.position.y))}orbitalControls(){const e=new k9(this.camera,this.domElement);e.enableZoom=!1,e.mouseButtons={LEFT:void 0,MIDDLE:Ro.ROTATE,RIGHT:Ro.PAN},e.center}}var U9="/Medieval/assets/bg.5743e7a1.jpg";const Gh=3;class H9 extends wm{constructor(t,i,r){super();O(this,"sun",new $2(16773831,3.2));O(this,"sunTarget",new $t);O(this,"ambient",new aG(14345960,.1));if(this.game=t,this.scene=i,this.camera=r,se.renderer.fog){const o=new Gp(new Fe(10671080),0,150);this.scene.fog=o}this.scene.background=new Fe(10671080),se.renderer.shadow&&(this.sun.castShadow=!0,this.sun.shadow.mapSize.width=128*10,this.sun.shadow.mapSize.height=128*10,this.sun.shadow.camera.near=.5,this.sun.shadow.camera.far=200,this.sun.shadow.camera.left=-100,this.sun.shadow.camera.right=100,this.sun.shadow.camera.top=100,this.sun.shadow.camera.bottom=-100,this.sun.shadow.bias=-1e-4*se.renderer.tileSize,this.sun.shadow.normalBias=.27*se.renderer.tileSize),this.sun.position.set(4,10,1),this.sun.target=this.sunTarget,new p_().load(U9,o=>{o.mapping=Bp,this.scene.environment=o}),this.scene.add(this.sun),this.scene.add(this.sunTarget),this.scene.add(this.ambient)}render({elapsedTime:t}){if(!se.renderer.dayAndNightMode)return;const i=t/se.renderer.dayAndNightTimeScale+se.renderer.dayAndNightTimeStart;if(this.sun.position.x=this.camera.position.x+Math.sin(i*1)*50,this.sun.position.y=20+Math.cos(i*1)*50,this.sun.position.z=this.camera.position.z+Math.cos(i*1)*50*-1,this.sunTarget.position.copy(this.camera.position),this.sunTarget.position.y=0,this.sun.target=this.sunTarget,this.sun.shadow.camera.left=-Gh*this.camera.position.y,this.sun.shadow.camera.right=Gh*this.camera.position.y,this.sun.shadow.camera.top=Gh*this.camera.position.y,this.sun.shadow.camera.bottom=-Gh*this.camera.position.y,this.sun.color.setHSL(10+Math.sin(i*1)*.1,Math.sin(i*1),Math.sin(i*1+1.9)*.5+.12),this.ambient.color.setHSL(10+Math.sin(i*1)*.1,Math.sin(i*1),(Math.sin(i*1+1.9)*.5+.6)/4),this.scene.background=new Fe().setHSL(10+Math.sin(i*1)*.1,Math.sin(i*1)/2,.3),se.renderer.fog){const r=new Fe().setHSL(10+Math.sin(i*1)*.1,Math.sin(i*1)/2,.3);this.scene.fog=new Gp(r,se.renderer.fogTransparency,(Math.sin(i*1)+se.renderer.fogTransparency*1.5*50+400)*se.renderer.tileSize)}}}const EC=(n,e,t=1)=>{const[i,r]=n.getSize(),s=(i-1)*se.renderer.tileSize,o=(r-1)*se.renderer.tileSize,a=new lW(s,o,t*i-1,t*r-1,e);return a.translate(s/2,0,o/2),a};var G9="/Medieval/assets/test4color.6ff55567.png",W9="/Medieval/assets/test4height.08e47797.png";class V9 extends wm{constructor(t){super();O(this,"groundMesh");O(this,"groundMaterial");O(this,"geometry");this.game=t,this.geometry=EC(this.game.world,se.renderer.diagonals);const i=this.geometry.attributes.position.count;this.geometry.setAttribute("color",new vi(new Float32Array(i*3),3)),this.groundMaterial=new Yn({side:xs,metalness:.1,roughness:.9,vertexColors:!0,flatShading:!0});const r=new p_,s=50,[o,a]=this.game.world.getSize();if(se.renderer.texture&&(r.load(G9,c=>{c.wrapS=hs,c.wrapT=hs,c.repeat.set(o/s,a/s),this.groundMaterial.map=c}),r.load(W9,c=>{c.wrapS=hs,c.wrapT=hs,c.repeat.set(o/s,a/s),this.groundMaterial.bumpMap=c,this.groundMaterial.bumpScale=.005})),this.groundMesh=new cn(this.geometry,this.groundMaterial),this.groundMesh.receiveShadow=!0,this.group.add(this.groundMesh),se.debug.groundWireframe){const c=new Yn({color:0,wireframe:!0,transparent:!0,opacity:.05,depthWrite:!1}),f=new cn(this.groundMesh.geometry,c);f.renderOrder=1,f.receiveShadow=!0,f.position.y=.01,this.group.add(f)}this.game.world.emitter.on("tailUpdate",()=>{this.render()})}init(){this.render()}render(){if(!this.groundMesh||!this.geometry)return;const[t]=this.game.world.getSize(),i=this.groundMesh.geometry.attributes.position,r=this.geometry.attributes.color,s=new Fe;for(let o=0;o<i.count;o++){const a=this.game.world.getTile(AB(o,t));i.setY(o,a.height*se.renderer.tileSize),s.setHex(a.color),r.setXYZ(o,s.r,s.g,s.b),r.needsUpdate=!0}i.needsUpdate=!0}}class $9 extends wm{constructor(t){super();O(this,"mesh");this.game=t;const i=EC(this.game.world,"random",.8),r=new Yn({color:10671080,transparent:!0,opacity:.6,roughness:0,metalness:1,flatShading:!0,depthTest:!0,depthWrite:!1});this.mesh=new cn(i,r),this.mesh.position.y=-.5*se.renderer.tileSize,this.mesh.renderOrder=0,this.group.add(this.mesh)}render({elapsedTime:t}){const i=t*10;if(!this.mesh)return;const r=this.mesh.geometry.attributes.position;for(let s=0;s<r.count;s++){let o=.15*Math.sin(s/2+(i+s)/8)+.15*Math.sin(s/1.2+(i/10+s)/8);r.setY(s,o*se.renderer.tileSize)}r.needsUpdate=!0}}const ma=new R9;class j9{constructor(e,t,i){O(this,"webGLRenderer",new B2({antialias:!0,powerPreference:"high-performance"}));O(this,"composer",new F9(this.webGLRenderer));O(this,"outlinePass");O(this,"FXAAPass");O(this,"GammaCorrectionPass");O(this,"bokehPass");O(this,"rtsCamera",new z9(this.webGLRenderer.domElement));O(this,"scene",new IH);O(this,"clock",new j2);O(this,"ground");O(this,"environment");O(this,"water");O(this,"basicRendererList",[]);O(this,"actorRendererList",[]);O(this,"isWindowFocused",window.document.hasFocus());O(this,"handleSelectChange",()=>{this.outlinePass&&(this.outlinePass.selectedObjects=this.getSelectedGroupList())});O(this,"handleWindowFocus",()=>{this.isWindowFocused=!0,this.throttledTimeoutId&&(window.clearTimeout(this.throttledTimeoutId),this.throttledTimeoutId=null),this.animate()});O(this,"handleWindowBlur",()=>{this.isWindowFocused=!1,this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=null),this.throttledAnimate()});O(this,"resize",()=>{const e=window.innerWidth,t=window.innerHeight,i=e/t,r=window.devicePixelRatio;this.rtsCamera.camera.aspect=i,this.rtsCamera.camera.updateProjectionMatrix(),this.webGLRenderer.setPixelRatio(r),this.webGLRenderer.setSize(e,t),se.postProcessing.postprocessingEnabled&&(this.composer.setSize(e,t),this.composer.setPixelRatio(r)),this.FXAAPass&&(this.FXAAPass.material.uniforms.resolution.value.x=1/(e*r),this.FXAAPass.material.uniforms.resolution.value.y=1/(t*r)),this.bokehPass&&this.bokehPass.setSize(e,t)});O(this,"rafId",null);O(this,"animate",()=>{!this.isWindowFocused||(ma.begin(),this.render(),ma.end(),this.rafId=window.requestAnimationFrame(this.animate))});O(this,"throttledTimeoutId",null);O(this,"throttledAnimate",()=>{if(this.isWindowFocused)return;ma.begin(),this.render(),ma.end();const e=1e3/se.core.unfocusedFpsLimit;this.throttledTimeoutId=window.setTimeout(this.throttledAnimate,e)});this.game=e,this.player=t,this.rootEl=i,this.webGLRenderer.outputEncoding=Lt,this.webGLRenderer.toneMapping=vs,this.webGLRenderer.toneMapping=m2,this.webGLRenderer.toneMappingExposure=Math.pow(se.renderer.exposure,4),this.webGLRenderer.shadowMap.enabled=!0,this.webGLRenderer.shadowMap.type=d2,this.webGLRenderer.xr.enabled=!0,this.environment=new H9(this.game,this.scene,this.rtsCamera.camera),this.ground=new V9(this.game),this.water=new $9(this.game)}init(){se.postProcessing.postprocessingEnabled&&this.addComposerPasses(),this.rootEl.append(this.webGLRenderer.domElement),ma.showPanel(0),this.rootEl.append(ma.dom),this.loadRenderers(),this.rtsCamera.init(),this.ground.init(),this.animate(),this.resize(),window.addEventListener("resize",this.resize),window.addEventListener("focus",this.handleWindowFocus),window.addEventListener("blur",this.handleWindowBlur),this.player.emitter.on(["selectActors","unselectActors"],this.handleSelectChange);const e=window;e.logStats=()=>{console.log("Device pixel ratio",window.devicePixelRatio),console.log("Scene polycount:",this.webGLRenderer.info.render.triangles),console.log("Active drawcalls:",this.webGLRenderer.info.render.calls),console.log("Textures in Memory",this.webGLRenderer.info.memory.textures),console.log("Geometries in Memory",this.webGLRenderer.info.memory.geometries)}}destroy(){this.player.emitter.off(["selectActors","unselectActors"],this.handleSelectChange),this.actorRendererList.forEach(e=>{e.destroy()}),this.webGLRenderer.dispose(),this.rootEl.removeChild(this.webGLRenderer.domElement),this.rootEl.removeChild(ma.dom),window.removeEventListener("resize",this.resize),window.removeEventListener("focus",this.handleWindowFocus),window.removeEventListener("blur",this.handleWindowBlur),this.throttledTimeoutId&&window.clearTimeout(this.throttledTimeoutId),this.rafId&&window.cancelAnimationFrame(this.rafId)}getGroundChildren(){return this.ground.group.children}getInteractionObjectList(){return this.actorRendererList.flatMap(e=>e.getInteractionShapes())}getSelectedGroupList(){return this.actorRendererList.flatMap(e=>e.getSelectedGroups())}addComposerPasses(){const e=window.innerWidth,t=window.innerHeight,i=this.rtsCamera.camera,r=new D9(this.scene,i);if(se.postProcessing.outlineEnabled){const s={edgeStrength:se.postProcessing.outlineEdgeStrength,edgeGlow:se.postProcessing.outlineEdgeGlow,edgeThickness:se.postProcessing.outlineEdgeThickness,pulsePeriod:se.postProcessing.outlinePulsePeriod};this.outlinePass=new Oo(new Ce(e,t),this.scene,i),this.outlinePass.edgeStrength=s.edgeStrength,this.outlinePass.edgeGlow=s.edgeGlow,this.outlinePass.edgeThickness=s.edgeThickness,this.outlinePass.pulsePeriod=s.pulsePeriod,this.outlinePass.visibleEdgeColor.set(6225764),this.outlinePass.hiddenEdgeColor.set(6225764),this.composer.addPass(r),this.composer.addPass(this.outlinePass)}if(se.postProcessing.bloomEnabled){const s=new Cc(new Ce(e,t),1.5,.4,.85);s.strength=se.postProcessing.bloomStrength,s.threshold=se.postProcessing.bloomThreshold,s.radius=se.postProcessing.bloomRadius,this.composer.addPass(s)}se.postProcessing.gammaCorrectionShader&&(this.GammaCorrectionPass=new qp(O9),this.composer.addPass(this.GammaCorrectionPass)),se.postProcessing.FXAAEnabled&&(this.FXAAPass=new qp(N9),this.composer.addPass(this.FXAAPass)),se.postProcessing.bokehEnable&&(this.bokehPass=new L9(this.scene,i,{focus:5,aperture:se.postProcessing.bokehAperture,maxblur:se.postProcessing.bokehMaxBlur,width:e,height:t}),this.composer.addPass(this.bokehPass))}loadRenderers(){this.addBasicRenderer(this.ground,!1),this.addBasicRenderer(this.environment),this.addBasicRenderer(this.water),oV.forEach(e=>{this.addBasicRenderer(new e(this.game))}),sV.forEach(e=>{const t=new e(this.game,this.player);this.addActorRenderer(t),t.init()})}addBasicRenderer(e,t=!0){this.centerRenderer(e),t&&this.basicRendererList.push(e),this.scene.add(e.group)}addActorRenderer(e){this.centerRenderer(e),this.actorRendererList.push(e),this.scene.add(e.group)}centerRenderer(e){const[t,i]=this.game.world.getRealSize();e.group.position.x=-t/2,e.group.position.z=-i/2}render(){const e=this.clock.getDelta(),t=this.clock.elapsedTime,i={deltaTime:e,elapsedTime:t};if(this.basicRendererList.forEach(r=>r.render(i)),this.actorRendererList.forEach(r=>r.render(i)),this.rtsCamera.render(i),se.postProcessing.postprocessingEnabled){if(this.bokehPass){const r=this.rtsCamera.camera.position.y,s=(this.rtsCamera.camera.rotation.x+Math.PI/2)*1.5*(r*.2),o=this.bokehPass.uniforms;o.focus.value=r+s,o.aperture.value=(10-r+s)*se.postProcessing.bokehAperture*.2,this.composer.render()}}else this.webGLRenderer.render(this.scene,this.rtsCamera.camera)}}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var UT=Object.getOwnPropertySymbols,X9=Object.prototype.hasOwnProperty,q9=Object.prototype.propertyIsEnumerable;function Y9(n){if(n==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(n)}function K9(){try{if(!Object.assign)return!1;var n=new String("abc");if(n[5]="de",Object.getOwnPropertyNames(n)[0]==="5")return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;var i=Object.getOwnPropertyNames(e).map(function(s){return e[s]});if(i.join("")!=="0123456789")return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(s){r[s]=s}),Object.keys(Object.assign({},r)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var qr=K9()?Object.assign:function(n,e){for(var t,i=Y9(n),r,s=1;s<arguments.length;s++){t=Object(arguments[s]);for(var o in t)X9.call(t,o)&&(i[o]=t[o]);if(UT){r=UT(t);for(var a=0;a<r.length;a++)q9.call(t,r[a])&&(i[r[a]]=t[r[a]])}}return i},HT=function(e,t){var i=qr({},e,t);for(var r in e){var s;!e[r]||typeof t[r]!="object"||qr(i,(s={},s[r]=qr(e[r],t[r]),s))}return i},Z9=function(e){var t={};return Object.keys(e).sort(function(i,r){return i.localeCompare(r,void 0,{numeric:!0,sensitivity:"base"})}).forEach(function(i){t[i]=e[i]}),t},Q9={breakpoints:[40,52,64].map(function(n){return n+"em"})},AC=function(e){return"@media screen and (min-width: "+e+")"},J9=function(e,t){return qo(t,e,e)},qo=function(e,t,i,r,s){for(t=t&&t.split?t.split("."):[t],r=0;r<t.length;r++)e=e?e[t[r]]:s;return e===s?i:e},C_=function n(e){var t={},i=function(o){var a={},c=!1,f=o.theme&&o.theme.disableStyledSystemCache;for(var h in o)if(!!e[h]){var d=e[h],p=o[h],g=qo(o.theme,d.scale,d.defaults);if(typeof p=="object"){if(t.breakpoints=!f&&t.breakpoints||qo(o.theme,"breakpoints",Q9.breakpoints),Array.isArray(p)){t.media=!f&&t.media||[null].concat(t.breakpoints.map(AC)),a=HT(a,e8(t.media,d,g,p,o));continue}p!==null&&(a=HT(a,t8(t.breakpoints,d,g,p,o)),c=!0);continue}qr(a,d(p,g,o))}return c&&(a=Z9(a)),a};i.config=e,i.propNames=Object.keys(e),i.cache=t;var r=Object.keys(e).filter(function(s){return s!=="config"});return r.length>1&&r.forEach(function(s){var o;i[s]=n((o={},o[s]=e[s],o))}),i},e8=function(e,t,i,r,s){var o={};return r.slice(0,e.length).forEach(function(a,c){var f=e[c],h=t(a,i,s);if(!f)qr(o,h);else{var d;qr(o,(d={},d[f]=qr({},o[f],h),d))}}),o},t8=function(e,t,i,r,s){var o={};for(var a in r){var c=e[a],f=r[a],h=t(f,i,s);if(!c)qr(o,h);else{var d,p=AC(c);qr(o,(d={},d[p]=qr({},o[p],h),d))}}return o},GT=function(e){var t=e.properties,i=e.property,r=e.scale,s=e.transform,o=s===void 0?J9:s,a=e.defaultScale;t=t||[i];var c=function(h,d,p){var g={},_=o(h,d,p);if(_!==null)return t.forEach(function(y){g[y]=_}),g};return c.scale=r,c.defaults=a,c},Tr=function(e){e===void 0&&(e={});var t={};Object.keys(e).forEach(function(r){var s=e[r];if(s===!0){t[r]=GT({property:r,scale:r});return}if(typeof s=="function"){t[r]=s;return}t[r]=GT(s)});var i=C_(t);return i},CC=function(){for(var e={},t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];i.forEach(function(o){!o||!o.config||qr(e,o.config)});var s=C_(e);return s},n8=function(e){return typeof e=="number"&&!isNaN(e)},i8=function(e,t){return qo(t,e,!n8(e)||e>1?e:e*100+"%")},r8={width:{property:"width",scale:"sizes",transform:i8},height:{property:"height",scale:"sizes"},minWidth:{property:"minWidth",scale:"sizes"},minHeight:{property:"minHeight",scale:"sizes"},maxWidth:{property:"maxWidth",scale:"sizes"},maxHeight:{property:"maxHeight",scale:"sizes"},size:{properties:["width","height"],scale:"sizes"},overflow:!0,overflowX:!0,overflowY:!0,display:!0,verticalAlign:!0},Ji=Tr(r8),Xy={color:{property:"color",scale:"colors"},backgroundColor:{property:"backgroundColor",scale:"colors"},opacity:!0};Xy.bg=Xy.backgroundColor;var RC=Tr(Xy),s8={fontSizes:[12,14,16,20,24,32,48,64,72]},o8={fontFamily:{property:"fontFamily",scale:"fonts"},fontSize:{property:"fontSize",scale:"fontSizes",defaultScale:s8.fontSizes},fontWeight:{property:"fontWeight",scale:"fontWeights"},lineHeight:{property:"lineHeight",scale:"lineHeights"},letterSpacing:{property:"letterSpacing",scale:"letterSpacings"},textAlign:!0,fontStyle:!0},ea=Tr(o8),a8={alignItems:!0,alignContent:!0,justifyItems:!0,justifyContent:!0,flexWrap:!0,flexDirection:!0,flex:!0,flexGrow:!0,flexShrink:!0,flexBasis:!0,justifySelf:!0,alignSelf:!0,order:!0},Oi=Tr(a8),Mv={space:[0,4,8,16,32,64,128,256,512]},l8={gridGap:{property:"gridGap",scale:"space",defaultScale:Mv.space},gridColumnGap:{property:"gridColumnGap",scale:"space",defaultScale:Mv.space},gridRowGap:{property:"gridRowGap",scale:"space",defaultScale:Mv.space},gridColumn:!0,gridRow:!0,gridAutoFlow:!0,gridAutoColumns:!0,gridAutoRows:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridArea:!0},er=Tr(l8),Zn={border:{property:"border",scale:"borders"},borderWidth:{property:"borderWidth",scale:"borderWidths"},borderStyle:{property:"borderStyle",scale:"borderStyles"},borderColor:{property:"borderColor",scale:"colors"},borderRadius:{property:"borderRadius",scale:"radii"},borderTop:{property:"borderTop",scale:"borders"},borderTopLeftRadius:{property:"borderTopLeftRadius",scale:"radii"},borderTopRightRadius:{property:"borderTopRightRadius",scale:"radii"},borderRight:{property:"borderRight",scale:"borders"},borderBottom:{property:"borderBottom",scale:"borders"},borderBottomLeftRadius:{property:"borderBottomLeftRadius",scale:"radii"},borderBottomRightRadius:{property:"borderBottomRightRadius",scale:"radii"},borderLeft:{property:"borderLeft",scale:"borders"},borderX:{properties:["borderLeft","borderRight"],scale:"borders"},borderY:{properties:["borderTop","borderBottom"],scale:"borders"}};Zn.borderTopWidth={property:"borderTopWidth",scale:"borderWidths"};Zn.borderTopColor={property:"borderTopColor",scale:"colors"};Zn.borderTopStyle={property:"borderTopStyle",scale:"borderStyles"};Zn.borderTopLeftRadius={property:"borderTopLeftRadius",scale:"radii"};Zn.borderTopRightRadius={property:"borderTopRightRadius",scale:"radii"};Zn.borderBottomWidth={property:"borderBottomWidth",scale:"borderWidths"};Zn.borderBottomColor={property:"borderBottomColor",scale:"colors"};Zn.borderBottomStyle={property:"borderBottomStyle",scale:"borderStyles"};Zn.borderBottomLeftRadius={property:"borderBottomLeftRadius",scale:"radii"};Zn.borderBottomRightRadius={property:"borderBottomRightRadius",scale:"radii"};Zn.borderLeftWidth={property:"borderLeftWidth",scale:"borderWidths"};Zn.borderLeftColor={property:"borderLeftColor",scale:"colors"};Zn.borderLeftStyle={property:"borderLeftStyle",scale:"borderStyles"};Zn.borderRightWidth={property:"borderRightWidth",scale:"borderWidths"};Zn.borderRightColor={property:"borderRightColor",scale:"colors"};Zn.borderRightStyle={property:"borderRightStyle",scale:"borderStyles"};var no=Tr(Zn),eo={background:!0,backgroundImage:!0,backgroundSize:!0,backgroundPosition:!0,backgroundRepeat:!0};eo.bgImage=eo.backgroundImage;eo.bgSize=eo.backgroundSize;eo.bgPosition=eo.backgroundPosition;eo.bgRepeat=eo.backgroundRepeat;var bm=Tr(eo),Wh={space:[0,4,8,16,32,64,128,256,512]},c8={position:!0,zIndex:{property:"zIndex",scale:"zIndices"},top:{property:"top",scale:"space",defaultScale:Wh.space},right:{property:"right",scale:"space",defaultScale:Wh.space},bottom:{property:"bottom",scale:"space",defaultScale:Wh.space},left:{property:"left",scale:"space",defaultScale:Wh.space}},jc=Tr(c8),Ai={space:[0,4,8,16,32,64,128,256,512]},WT=function(e){return typeof e=="number"&&!isNaN(e)},ga=function(e,t){if(!WT(e))return qo(t,e,e);var i=e<0,r=Math.abs(e),s=qo(t,r,r);return WT(s)?s*(i?-1:1):i?"-"+s:s},bt={};bt.margin={margin:{property:"margin",scale:"space",transform:ga,defaultScale:Ai.space},marginTop:{property:"marginTop",scale:"space",transform:ga,defaultScale:Ai.space},marginRight:{property:"marginRight",scale:"space",transform:ga,defaultScale:Ai.space},marginBottom:{property:"marginBottom",scale:"space",transform:ga,defaultScale:Ai.space},marginLeft:{property:"marginLeft",scale:"space",transform:ga,defaultScale:Ai.space},marginX:{properties:["marginLeft","marginRight"],scale:"space",transform:ga,defaultScale:Ai.space},marginY:{properties:["marginTop","marginBottom"],scale:"space",transform:ga,defaultScale:Ai.space}};bt.margin.m=bt.margin.margin;bt.margin.mt=bt.margin.marginTop;bt.margin.mr=bt.margin.marginRight;bt.margin.mb=bt.margin.marginBottom;bt.margin.ml=bt.margin.marginLeft;bt.margin.mx=bt.margin.marginX;bt.margin.my=bt.margin.marginY;bt.padding={padding:{property:"padding",scale:"space",defaultScale:Ai.space},paddingTop:{property:"paddingTop",scale:"space",defaultScale:Ai.space},paddingRight:{property:"paddingRight",scale:"space",defaultScale:Ai.space},paddingBottom:{property:"paddingBottom",scale:"space",defaultScale:Ai.space},paddingLeft:{property:"paddingLeft",scale:"space",defaultScale:Ai.space},paddingX:{properties:["paddingLeft","paddingRight"],scale:"space",defaultScale:Ai.space},paddingY:{properties:["paddingTop","paddingBottom"],scale:"space",defaultScale:Ai.space}};bt.padding.p=bt.padding.padding;bt.padding.pt=bt.padding.paddingTop;bt.padding.pr=bt.padding.paddingRight;bt.padding.pb=bt.padding.paddingBottom;bt.padding.pl=bt.padding.paddingLeft;bt.padding.px=bt.padding.paddingX;bt.padding.py=bt.padding.paddingY;var Tm=Tr(bt.margin),u8=Tr(bt.padding),f8=CC(Tm,u8);Tr({boxShadow:{property:"boxShadow",scale:"shadows"},textShadow:{property:"textShadow",scale:"shadows"}});function Of(){return Of=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Of.apply(this,arguments)}var as=function(e,t,i,r,s){for(t=t&&t.split?t.split("."):[t],r=0;r<t.length;r++)e=e?e[t[r]]:s;return e===s?i:e},d8=[40,52,64].map(function(n){return n+"em"}),h8={space:[0,4,8,16,32,64,128,256,512],fontSizes:[12,14,16,20,24,32,48,64,72]},p8={bg:"backgroundColor",m:"margin",mt:"marginTop",mr:"marginRight",mb:"marginBottom",ml:"marginLeft",mx:"marginX",my:"marginY",p:"padding",pt:"paddingTop",pr:"paddingRight",pb:"paddingBottom",pl:"paddingLeft",px:"paddingX",py:"paddingY"},VT={marginX:["marginLeft","marginRight"],marginY:["marginTop","marginBottom"],paddingX:["paddingLeft","paddingRight"],paddingY:["paddingTop","paddingBottom"],size:["width","height"]},m8={color:"colors",backgroundColor:"colors",borderColor:"colors",margin:"space",marginTop:"space",marginRight:"space",marginBottom:"space",marginLeft:"space",marginX:"space",marginY:"space",padding:"space",paddingTop:"space",paddingRight:"space",paddingBottom:"space",paddingLeft:"space",paddingX:"space",paddingY:"space",top:"space",right:"space",bottom:"space",left:"space",gridGap:"space",gridColumnGap:"space",gridRowGap:"space",gap:"space",columnGap:"space",rowGap:"space",fontFamily:"fonts",fontSize:"fontSizes",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",border:"borders",borderTop:"borders",borderRight:"borders",borderBottom:"borders",borderLeft:"borders",borderWidth:"borderWidths",borderStyle:"borderStyles",borderRadius:"radii",borderTopRightRadius:"radii",borderTopLeftRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",borderTopWidth:"borderWidths",borderTopColor:"colors",borderTopStyle:"borderStyles",borderBottomWidth:"borderWidths",borderBottomColor:"colors",borderBottomStyle:"borderStyles",borderLeftWidth:"borderWidths",borderLeftColor:"colors",borderLeftStyle:"borderStyles",borderRightWidth:"borderWidths",borderRightColor:"colors",borderRightStyle:"borderStyles",outlineColor:"colors",boxShadow:"shadows",textShadow:"shadows",zIndex:"zIndices",width:"sizes",minWidth:"sizes",maxWidth:"sizes",height:"sizes",minHeight:"sizes",maxHeight:"sizes",flexBasis:"sizes",size:"sizes",fill:"colors",stroke:"colors"},g8=function(e,t){if(typeof t!="number"||t>=0)return as(e,t,t);var i=Math.abs(t),r=as(e,i,i);return typeof r=="string"?"-"+r:r*-1},v8=["margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","top","bottom","left","right"].reduce(function(n,e){var t;return Of({},n,(t={},t[e]=g8,t))},{}),y8=function(e){return function(t){var i={},r=as(t,"breakpoints",d8),s=[null].concat(r.map(function(h){return"@media screen and (min-width: "+h+")"}));for(var o in e){var a=typeof e[o]=="function"?e[o](t):e[o];if(a!=null){if(!Array.isArray(a)){i[o]=a;continue}for(var c=0;c<a.slice(0,s.length).length;c++){var f=s[c];if(!f){i[o]=a[c];continue}i[f]=i[f]||{},a[c]!=null&&(i[f][o]=a[c])}}}return i}},x8=function n(e){return function(t){t===void 0&&(t={});var i=Of({},h8,{},t.theme||t),r={},s=typeof e=="function"?e(i):e,o=y8(s)(i);for(var a in o){var c=o[a],f=typeof c=="function"?c(i):c;if(a==="variant"){var h=n(as(i,f))(i);r=Of({},r,{},h);continue}if(f&&typeof f=="object"){r[a]=n(f)(i);continue}var d=as(p8,a,a),p=as(m8,d),g=as(i,p,as(i,d,{})),_=as(v8,d,as),y=_(g,f,f);if(VT[d])for(var x=VT[d],v=0;v<x.length;v++)r[x[v]]=y;else r[d]=y}return r}},_8=x8,R_=function(e){var t,i=e.scale,r=e.prop,s=r===void 0?"variant":r,o=e.variants,a=o===void 0?{}:o,c=e.key,f;Object.keys(a).length?f=function(g,_,y){return _8(qo(_,g,null))(y.theme)}:f=function(g,_){return qo(_,g,null)},f.scale=i||c,f.defaults=a;var h=(t={},t[s]=f,t),d=C_(h);return d};R_({key:"buttons"});R_({key:"textStyles",prop:"textStyle"});R_({key:"colorStyles",prop:"colors"});Ji.width;Ji.height;Ji.minWidth;Ji.minHeight;Ji.maxWidth;Ji.maxHeight;Ji.size;Ji.verticalAlign;Ji.display;Ji.overflow;Ji.overflowX;Ji.overflowY;RC.opacity;ea.fontSize;ea.fontFamily;ea.fontWeight;ea.lineHeight;ea.textAlign;ea.fontStyle;ea.letterSpacing;Oi.alignItems;Oi.alignContent;Oi.justifyItems;Oi.justifyContent;Oi.flexWrap;Oi.flexDirection;Oi.flex;Oi.flexGrow;Oi.flexShrink;Oi.flexBasis;Oi.justifySelf;Oi.alignSelf;Oi.order;er.gridGap;er.gridColumnGap;er.gridRowGap;er.gridColumn;er.gridRow;er.gridAutoFlow;er.gridAutoColumns;er.gridAutoRows;er.gridTemplateColumns;er.gridTemplateRows;er.gridTemplateAreas;er.gridArea;no.borderWidth;no.borderStyle;no.borderColor;no.borderTop;no.borderRight;no.borderBottom;no.borderLeft;no.borderRadius;bm.backgroundImage;bm.backgroundSize;bm.backgroundPosition;bm.backgroundRepeat;jc.zIndex;jc.top;jc.right;jc.bottom;jc.left;const w8=Tr({columnGap:{property:"columnGap",scale:"space"},rowGap:{property:"rowGap",scale:"space"}});function Yp(){return Yp=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Yp.apply(null,arguments)}var S8=!1;function M8(n){if(n.sheet)return n.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===n)return document.styleSheets[e]}function b8(n){var e=document.createElement("style");return e.setAttribute("data-emotion",n.key),n.nonce!==void 0&&e.setAttribute("nonce",n.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var T8=function(){function n(t){var i=this;this._insertTag=function(r){var s;i.tags.length===0?i.insertionPoint?s=i.insertionPoint.nextSibling:i.prepend?s=i.container.firstChild:s=i.before:s=i.tags[i.tags.length-1].nextSibling,i.container.insertBefore(r,s),i.tags.push(r)},this.isSpeedy=t.speedy===void 0?!S8:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var e=n.prototype;return e.hydrate=function(i){i.forEach(this._insertTag)},e.insert=function(i){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(b8(this));var r=this.tags[this.tags.length-1];if(this.isSpeedy){var s=M8(r);try{s.insertRule(i,s.cssRules.length)}catch{}}else r.appendChild(document.createTextNode(i));this.ctr++},e.flush=function(){this.tags.forEach(function(i){var r;return(r=i.parentNode)==null?void 0:r.removeChild(i)}),this.tags=[],this.ctr=0},n}(),ni="-ms-",Kp="-moz-",Rt="-webkit-",PC="comm",P_="rule",L_="decl",E8="@import",LC="@keyframes",A8="@layer",C8=Math.abs,Em=String.fromCharCode,R8=Object.assign;function P8(n,e){return jn(n,0)^45?(((e<<2^jn(n,0))<<2^jn(n,1))<<2^jn(n,2))<<2^jn(n,3):0}function IC(n){return n.trim()}function L8(n,e){return(n=e.exec(n))?n[0]:n}function Pt(n,e,t){return n.replace(e,t)}function qy(n,e){return n.indexOf(e)}function jn(n,e){return n.charCodeAt(e)|0}function kf(n,e,t){return n.slice(e,t)}function cs(n){return n.length}function I_(n){return n.length}function Vh(n,e){return e.push(n),n}function I8(n,e){return n.map(e).join("")}var Am=1,Rc=1,FC=0,Di=0,vn=0,Xc="";function Cm(n,e,t,i,r,s,o){return{value:n,root:e,parent:t,type:i,props:r,children:s,line:Am,column:Rc,length:o,return:""}}function Uu(n,e){return R8(Cm("",null,null,"",null,null,0),n,{length:-n.length},e)}function F8(){return vn}function D8(){return vn=Di>0?jn(Xc,--Di):0,Rc--,vn===10&&(Rc=1,Am--),vn}function Yi(){return vn=Di<FC?jn(Xc,Di++):0,Rc++,vn===10&&(Rc=1,Am++),vn}function ys(){return jn(Xc,Di)}function cp(){return Di}function Qf(n,e){return kf(Xc,n,e)}function Bf(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function DC(n){return Am=Rc=1,FC=cs(Xc=n),Di=0,[]}function NC(n){return Xc="",n}function up(n){return IC(Qf(Di-1,Yy(n===91?n+2:n===40?n+1:n)))}function N8(n){for(;(vn=ys())&&vn<33;)Yi();return Bf(n)>2||Bf(vn)>3?"":" "}function O8(n,e){for(;--e&&Yi()&&!(vn<48||vn>102||vn>57&&vn<65||vn>70&&vn<97););return Qf(n,cp()+(e<6&&ys()==32&&Yi()==32))}function Yy(n){for(;Yi();)switch(vn){case n:return Di;case 34:case 39:n!==34&&n!==39&&Yy(vn);break;case 40:n===41&&Yy(n);break;case 92:Yi();break}return Di}function k8(n,e){for(;Yi()&&n+vn!==47+10;)if(n+vn===42+42&&ys()===47)break;return"/*"+Qf(e,Di-1)+"*"+Em(n===47?n:Yi())}function B8(n){for(;!Bf(ys());)Yi();return Qf(n,Di)}function z8(n){return NC(fp("",null,null,null,[""],n=DC(n),0,[0],n))}function fp(n,e,t,i,r,s,o,a,c){for(var f=0,h=0,d=o,p=0,g=0,_=0,y=1,x=1,v=1,w=0,S="",E=r,b=s,T=i,C=S;x;)switch(_=w,w=Yi()){case 40:if(_!=108&&jn(C,d-1)==58){qy(C+=Pt(up(w),"&","&\f"),"&\f")!=-1&&(v=-1);break}case 34:case 39:case 91:C+=up(w);break;case 9:case 10:case 13:case 32:C+=N8(_);break;case 92:C+=O8(cp()-1,7);continue;case 47:switch(ys()){case 42:case 47:Vh(U8(k8(Yi(),cp()),e,t),c);break;default:C+="/"}break;case 123*y:a[f++]=cs(C)*v;case 125*y:case 59:case 0:switch(w){case 0:case 125:x=0;case 59+h:v==-1&&(C=Pt(C,/\f/g,"")),g>0&&cs(C)-d&&Vh(g>32?jT(C+";",i,t,d-1):jT(Pt(C," ","")+";",i,t,d-2),c);break;case 59:C+=";";default:if(Vh(T=$T(C,e,t,f,h,r,a,S,E=[],b=[],d),s),w===123)if(h===0)fp(C,e,T,T,E,s,d,a,b);else switch(p===99&&jn(C,3)===110?100:p){case 100:case 108:case 109:case 115:fp(n,T,T,i&&Vh($T(n,T,T,0,0,r,a,S,r,E=[],d),b),r,b,d,a,i?E:b);break;default:fp(C,T,T,T,[""],b,0,a,b)}}f=h=g=0,y=v=1,S=C="",d=o;break;case 58:d=1+cs(C),g=_;default:if(y<1){if(w==123)--y;else if(w==125&&y++==0&&D8()==125)continue}switch(C+=Em(w),w*y){case 38:v=h>0?1:(C+="\f",-1);break;case 44:a[f++]=(cs(C)-1)*v,v=1;break;case 64:ys()===45&&(C+=up(Yi())),p=ys(),h=d=cs(S=C+=B8(cp())),w++;break;case 45:_===45&&cs(C)==2&&(y=0)}}return s}function $T(n,e,t,i,r,s,o,a,c,f,h){for(var d=r-1,p=r===0?s:[""],g=I_(p),_=0,y=0,x=0;_<i;++_)for(var v=0,w=kf(n,d+1,d=C8(y=o[_])),S=n;v<g;++v)(S=IC(y>0?p[v]+" "+w:Pt(w,/&\f/g,p[v])))&&(c[x++]=S);return Cm(n,e,t,r===0?P_:a,c,f,h)}function U8(n,e,t){return Cm(n,e,t,PC,Em(F8()),kf(n,2,-2),0)}function jT(n,e,t,i){return Cm(n,e,t,L_,kf(n,0,i),kf(n,i+1,-1),i)}function cc(n,e){for(var t="",i=I_(n),r=0;r<i;r++)t+=e(n[r],r,n,e)||"";return t}function H8(n,e,t,i){switch(n.type){case A8:if(n.children.length)break;case E8:case L_:return n.return=n.return||n.value;case PC:return"";case LC:return n.return=n.value+"{"+cc(n.children,i)+"}";case P_:n.value=n.props.join(",")}return cs(t=cc(n.children,i))?n.return=n.value+"{"+t+"}":""}function G8(n){var e=I_(n);return function(t,i,r,s){for(var o="",a=0;a<e;a++)o+=n[a](t,i,r,s)||"";return o}}function W8(n){return function(e){e.root||(e=e.return)&&n(e)}}var XT=function(e){var t=new WeakMap;return function(i){if(t.has(i))return t.get(i);var r=e(i);return t.set(i,r),r}};function OC(n){var e=Object.create(null);return function(t){return e[t]===void 0&&(e[t]=n(t)),e[t]}}var V8=function(e,t,i){for(var r=0,s=0;r=s,s=ys(),r===38&&s===12&&(t[i]=1),!Bf(s);)Yi();return Qf(e,Di)},$8=function(e,t){var i=-1,r=44;do switch(Bf(r)){case 0:r===38&&ys()===12&&(t[i]=1),e[i]+=V8(Di-1,t,i);break;case 2:e[i]+=up(r);break;case 4:if(r===44){e[++i]=ys()===58?"&\f":"",t[i]=e[i].length;break}default:e[i]+=Em(r)}while(r=Yi());return e},j8=function(e,t){return NC($8(DC(e),t))},qT=new WeakMap,X8=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var t=e.value,i=e.parent,r=e.column===i.column&&e.line===i.line;i.type!=="rule";)if(i=i.parent,!i)return;if(!(e.props.length===1&&t.charCodeAt(0)!==58&&!qT.get(i))&&!r){qT.set(e,!0);for(var s=[],o=j8(t,s),a=i.props,c=0,f=0;c<o.length;c++)for(var h=0;h<a.length;h++,f++)e.props[f]=s[c]?o[c].replace(/&\f/g,a[h]):a[h]+" "+o[c]}}},q8=function(e){if(e.type==="decl"){var t=e.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(e.return="",e.value="")}};function kC(n,e){switch(P8(n,e)){case 5103:return Rt+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Rt+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return Rt+n+Kp+n+ni+n+n;case 6828:case 4268:return Rt+n+ni+n+n;case 6165:return Rt+n+ni+"flex-"+n+n;case 5187:return Rt+n+Pt(n,/(\w+).+(:[^]+)/,Rt+"box-$1$2"+ni+"flex-$1$2")+n;case 5443:return Rt+n+ni+"flex-item-"+Pt(n,/flex-|-self/,"")+n;case 4675:return Rt+n+ni+"flex-line-pack"+Pt(n,/align-content|flex-|-self/,"")+n;case 5548:return Rt+n+ni+Pt(n,"shrink","negative")+n;case 5292:return Rt+n+ni+Pt(n,"basis","preferred-size")+n;case 6060:return Rt+"box-"+Pt(n,"-grow","")+Rt+n+ni+Pt(n,"grow","positive")+n;case 4554:return Rt+Pt(n,/([^-])(transform)/g,"$1"+Rt+"$2")+n;case 6187:return Pt(Pt(Pt(n,/(zoom-|grab)/,Rt+"$1"),/(image-set)/,Rt+"$1"),n,"")+n;case 5495:case 3959:return Pt(n,/(image-set\([^]*)/,Rt+"$1$`$1");case 4968:return Pt(Pt(n,/(.+:)(flex-)?(.*)/,Rt+"box-pack:$3"+ni+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Rt+n+n;case 4095:case 3583:case 4068:case 2532:return Pt(n,/(.+)-inline(.+)/,Rt+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(cs(n)-1-e>6)switch(jn(n,e+1)){case 109:if(jn(n,e+4)!==45)break;case 102:return Pt(n,/(.+:)(.+)-([^]+)/,"$1"+Rt+"$2-$3$1"+Kp+(jn(n,e+3)==108?"$3":"$2-$3"))+n;case 115:return~qy(n,"stretch")?kC(Pt(n,"stretch","fill-available"),e)+n:n}break;case 4949:if(jn(n,e+1)!==115)break;case 6444:switch(jn(n,cs(n)-3-(~qy(n,"!important")&&10))){case 107:return Pt(n,":",":"+Rt)+n;case 101:return Pt(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Rt+(jn(n,14)===45?"inline-":"")+"box$3$1"+Rt+"$2$3$1"+ni+"$2box$3")+n}break;case 5936:switch(jn(n,e+11)){case 114:return Rt+n+ni+Pt(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return Rt+n+ni+Pt(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return Rt+n+ni+Pt(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return Rt+n+ni+n+n}return n}var Y8=function(e,t,i,r){if(e.length>-1&&!e.return)switch(e.type){case L_:e.return=kC(e.value,e.length);break;case LC:return cc([Uu(e,{value:Pt(e.value,"@","@"+Rt)})],r);case P_:if(e.length)return I8(e.props,function(s){switch(L8(s,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return cc([Uu(e,{props:[Pt(s,/:(read-\w+)/,":"+Kp+"$1")]})],r);case"::placeholder":return cc([Uu(e,{props:[Pt(s,/:(plac\w+)/,":"+Rt+"input-$1")]}),Uu(e,{props:[Pt(s,/:(plac\w+)/,":"+Kp+"$1")]}),Uu(e,{props:[Pt(s,/:(plac\w+)/,ni+"input-$1")]})],r)}return""})}},K8=[Y8],Z8=function(e){var t=e.key;if(t==="css"){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,function(y){var x=y.getAttribute("data-emotion");x.indexOf(" ")!==-1&&(document.head.appendChild(y),y.setAttribute("data-s",""))})}var r=e.stylisPlugins||K8,s={},o,a=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(y){for(var x=y.getAttribute("data-emotion").split(" "),v=1;v<x.length;v++)s[x[v]]=!0;a.push(y)});var c,f=[X8,q8];{var h,d=[H8,W8(function(y){h.insert(y)})],p=G8(f.concat(r,d)),g=function(x){return cc(z8(x),p)};c=function(x,v,w,S){h=w,g(x?x+"{"+v.styles+"}":v.styles),S&&(_.inserted[v.name]=!0)}}var _={key:t,sheet:new T8({key:t,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:c};return _.sheet.hydrate(a),_},BC={exports:{}},Ot={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kn=typeof Symbol=="function"&&Symbol.for,F_=kn?Symbol.for("react.element"):60103,D_=kn?Symbol.for("react.portal"):60106,Rm=kn?Symbol.for("react.fragment"):60107,Pm=kn?Symbol.for("react.strict_mode"):60108,Lm=kn?Symbol.for("react.profiler"):60114,Im=kn?Symbol.for("react.provider"):60109,Fm=kn?Symbol.for("react.context"):60110,N_=kn?Symbol.for("react.async_mode"):60111,Dm=kn?Symbol.for("react.concurrent_mode"):60111,Nm=kn?Symbol.for("react.forward_ref"):60112,Om=kn?Symbol.for("react.suspense"):60113,Q8=kn?Symbol.for("react.suspense_list"):60120,km=kn?Symbol.for("react.memo"):60115,Bm=kn?Symbol.for("react.lazy"):60116,J8=kn?Symbol.for("react.block"):60121,e7=kn?Symbol.for("react.fundamental"):60117,t7=kn?Symbol.for("react.responder"):60118,n7=kn?Symbol.for("react.scope"):60119;function tr(n){if(typeof n=="object"&&n!==null){var e=n.$$typeof;switch(e){case F_:switch(n=n.type,n){case N_:case Dm:case Rm:case Lm:case Pm:case Om:return n;default:switch(n=n&&n.$$typeof,n){case Fm:case Nm:case Bm:case km:case Im:return n;default:return e}}case D_:return e}}}function zC(n){return tr(n)===Dm}Ot.AsyncMode=N_;Ot.ConcurrentMode=Dm;Ot.ContextConsumer=Fm;Ot.ContextProvider=Im;Ot.Element=F_;Ot.ForwardRef=Nm;Ot.Fragment=Rm;Ot.Lazy=Bm;Ot.Memo=km;Ot.Portal=D_;Ot.Profiler=Lm;Ot.StrictMode=Pm;Ot.Suspense=Om;Ot.isAsyncMode=function(n){return zC(n)||tr(n)===N_};Ot.isConcurrentMode=zC;Ot.isContextConsumer=function(n){return tr(n)===Fm};Ot.isContextProvider=function(n){return tr(n)===Im};Ot.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===F_};Ot.isForwardRef=function(n){return tr(n)===Nm};Ot.isFragment=function(n){return tr(n)===Rm};Ot.isLazy=function(n){return tr(n)===Bm};Ot.isMemo=function(n){return tr(n)===km};Ot.isPortal=function(n){return tr(n)===D_};Ot.isProfiler=function(n){return tr(n)===Lm};Ot.isStrictMode=function(n){return tr(n)===Pm};Ot.isSuspense=function(n){return tr(n)===Om};Ot.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===Rm||n===Dm||n===Lm||n===Pm||n===Om||n===Q8||typeof n=="object"&&n!==null&&(n.$$typeof===Bm||n.$$typeof===km||n.$$typeof===Im||n.$$typeof===Fm||n.$$typeof===Nm||n.$$typeof===e7||n.$$typeof===t7||n.$$typeof===n7||n.$$typeof===J8)};Ot.typeOf=tr;BC.exports=Ot;var UC=BC.exports,i7={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},r7={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},HC={};HC[UC.ForwardRef]=i7;HC[UC.Memo]=r7;var s7=!0;function GC(n,e,t){var i="";return t.split(" ").forEach(function(r){n[r]!==void 0?e.push(n[r]+";"):r&&(i+=r+" ")}),i}var O_=function(e,t,i){var r=e.key+"-"+t.name;(i===!1||s7===!1)&&e.registered[r]===void 0&&(e.registered[r]=t.styles)},WC=function(e,t,i){O_(e,t,i);var r=e.key+"-"+t.name;if(e.inserted[t.name]===void 0){var s=t;do e.insert(t===s?"."+r:"",s,e.sheet,!0),s=s.next;while(s!==void 0)}};function o7(n){for(var e=0,t,i=0,r=n.length;r>=4;++i,r-=4)t=n.charCodeAt(i)&255|(n.charCodeAt(++i)&255)<<8|(n.charCodeAt(++i)&255)<<16|(n.charCodeAt(++i)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,e=(t&65535)*1540483477+((t>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(r){case 3:e^=(n.charCodeAt(i+2)&255)<<16;case 2:e^=(n.charCodeAt(i+1)&255)<<8;case 1:e^=n.charCodeAt(i)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var a7={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},l7=!1,c7=/[A-Z]|^ms/g,u7=/_EMO_([^_]+?)_([^]*?)_EMO_/g,VC=function(e){return e.charCodeAt(1)===45},YT=function(e){return e!=null&&typeof e!="boolean"},bv=OC(function(n){return VC(n)?n:n.replace(c7,"-$&").toLowerCase()}),KT=function(e,t){switch(e){case"animation":case"animationName":if(typeof t=="string")return t.replace(u7,function(i,r,s){return us={name:r,styles:s,next:us},r})}return a7[e]!==1&&!VC(e)&&typeof t=="number"&&t!==0?t+"px":t},f7="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function zf(n,e,t){if(t==null)return"";var i=t;if(i.__emotion_styles!==void 0)return i;switch(typeof t){case"boolean":return"";case"object":{var r=t;if(r.anim===1)return us={name:r.name,styles:r.styles,next:us},r.name;var s=t;if(s.styles!==void 0){var o=s.next;if(o!==void 0)for(;o!==void 0;)us={name:o.name,styles:o.styles,next:us},o=o.next;var a=s.styles+";";return a}return d7(n,e,t)}case"function":{if(n!==void 0){var c=us,f=t(n);return us=c,zf(n,e,f)}break}}var h=t;if(e==null)return h;var d=e[h];return d!==void 0?d:h}function d7(n,e,t){var i="";if(Array.isArray(t))for(var r=0;r<t.length;r++)i+=zf(n,e,t[r])+";";else for(var s in t){var o=t[s];if(typeof o!="object"){var a=o;e!=null&&e[a]!==void 0?i+=s+"{"+e[a]+"}":YT(a)&&(i+=bv(s)+":"+KT(s,a)+";")}else{if(s==="NO_COMPONENT_SELECTOR"&&l7)throw new Error(f7);if(Array.isArray(o)&&typeof o[0]=="string"&&(e==null||e[o[0]]===void 0))for(var c=0;c<o.length;c++)YT(o[c])&&(i+=bv(s)+":"+KT(s,o[c])+";");else{var f=zf(n,e,o);switch(s){case"animation":case"animationName":{i+=bv(s)+":"+f+";";break}default:i+=s+"{"+f+"}"}}}}return i}var ZT=/label:\s*([^\s;{]+)\s*(;|$)/g,us;function k_(n,e,t){if(n.length===1&&typeof n[0]=="object"&&n[0]!==null&&n[0].styles!==void 0)return n[0];var i=!0,r="";us=void 0;var s=n[0];if(s==null||s.raw===void 0)i=!1,r+=zf(t,e,s);else{var o=s;r+=o[0]}for(var a=1;a<n.length;a++)if(r+=zf(t,e,n[a]),i){var c=s;r+=c[a]}ZT.lastIndex=0;for(var f="",h;(h=ZT.exec(r))!==null;)f+="-"+h[1];var d=o7(r)+f;return{name:d,styles:r,next:us}}var h7=function(e){return e()},p7=dp["useInsertionEffect"]?dp["useInsertionEffect"]:!1,$C=p7||h7,m7=!1,jC=J.exports.createContext(typeof HTMLElement!="undefined"?Z8({key:"css"}):null);jC.Provider;var XC=function(e){return J.exports.forwardRef(function(t,i){var r=J.exports.useContext(jC);return e(t,r,i)})},Zp=J.exports.createContext({}),g7=function(e,t){if(typeof t=="function"){var i=t(e);return i}return Yp({},e,t)},v7=XT(function(n){return XT(function(e){return g7(n,e)})}),y7=function(e){var t=J.exports.useContext(Zp);return e.theme!==t&&(t=v7(t)(e.theme)),J.exports.createElement(Zp.Provider,{value:t},e.children)},B_={}.hasOwnProperty,Ky="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",x7=function(e,t){var i={};for(var r in t)B_.call(t,r)&&(i[r]=t[r]);return i[Ky]=e,i},_7=function(e){var t=e.cache,i=e.serialized,r=e.isStringTag;return O_(t,i,r),$C(function(){return WC(t,i,r)}),null},w7=XC(function(n,e,t){var i=n.css;typeof i=="string"&&e.registered[i]!==void 0&&(i=e.registered[i]);var r=n[Ky],s=[i],o="";typeof n.className=="string"?o=GC(e.registered,s,n.className):n.className!=null&&(o=n.className+" ");var a=k_(s,void 0,J.exports.useContext(Zp));o+=e.key+"-"+a.name;var c={};for(var f in n)B_.call(n,f)&&f!=="css"&&f!==Ky&&!m7&&(c[f]=n[f]);return c.className=o,t&&(c.ref=t),J.exports.createElement(J.exports.Fragment,null,J.exports.createElement(_7,{cache:e,serialized:a,isStringTag:typeof r=="string"}),J.exports.createElement(r,c))}),S7=w7,QT=function(e,t){var i=arguments;if(t==null||!B_.call(t,"css"))return J.exports.createElement.apply(void 0,i);var r=i.length,s=new Array(r);s[0]=S7,s[1]=x7(e,t);for(var o=2;o<r;o++)s[o]=i[o];return J.exports.createElement.apply(null,s)};(function(n){var e;(function(t){})(e||(e=n.JSX||(n.JSX={})))})(QT||(QT={}));function qC(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return k_(e)}function YC(){var n=qC.apply(void 0,arguments),e="animation-"+n.name;return{name:e,styles:"@keyframes "+e+"{"+n.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var M7=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,b7=OC(function(n){return M7.test(n)||n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)<91}),T7=!1,E7=b7,A7=function(e){return e!=="theme"},JT=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?E7:A7},eE=function(e,t,i){var r;if(t){var s=t.shouldForwardProp;r=e.__emotion_forwardProp&&s?function(o){return e.__emotion_forwardProp(o)&&s(o)}:s}return typeof r!="function"&&i&&(r=e.__emotion_forwardProp),r},C7=function(e){var t=e.cache,i=e.serialized,r=e.isStringTag;return O_(t,i,r),$C(function(){return WC(t,i,r)}),null},R7=function n(e,t){var i=e.__emotion_real===e,r=i&&e.__emotion_base||e,s,o;t!==void 0&&(s=t.label,o=t.target);var a=eE(e,t,i),c=a||JT(r),f=!c("as");return function(){var h=arguments,d=i&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(s!==void 0&&d.push("label:"+s+";"),h[0]==null||h[0].raw===void 0)d.push.apply(d,h);else{var p=h[0];d.push(p[0]);for(var g=h.length,_=1;_<g;_++)d.push(h[_],p[_])}var y=XC(function(x,v,w){var S=f&&x.as||r,E="",b=[],T=x;if(x.theme==null){T={};for(var C in x)T[C]=x[C];T.theme=J.exports.useContext(Zp)}typeof x.className=="string"?E=GC(v.registered,b,x.className):x.className!=null&&(E=x.className+" ");var A=k_(d.concat(b),v.registered,T);E+=v.key+"-"+A.name,o!==void 0&&(E+=" "+o);var F=f&&a===void 0?JT(S):c,U={};for(var W in x)f&&W==="as"||F(W)&&(U[W]=x[W]);return U.className=E,w&&(U.ref=w),J.exports.createElement(J.exports.Fragment,null,J.exports.createElement(C7,{cache:v,serialized:A,isStringTag:typeof S=="string"}),J.exports.createElement(S,U))});return y.displayName=s!==void 0?s:"Styled("+(typeof r=="string"?r:r.displayName||r.name||"Component")+")",y.defaultProps=e.defaultProps,y.__emotion_real=y,y.__emotion_base=r,y.__emotion_styles=d,y.__emotion_forwardProp=a,Object.defineProperty(y,"toString",{value:function(){return o===void 0&&T7?"NO_COMPONENT_SELECTOR":"."+o}}),y.withComponent=function(x,v){var w=n(x,Yp({},t,v,{shouldForwardProp:eE(y,v,!0)}));return w.apply(void 0,d)},y}},P7=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],_n=R7.bind(null);P7.forEach(function(n){_n[n]=_n(n)});const L7=CC(Ji,er,Oi,w8,jc,f8,no,ea,RC),mi=_n.div(L7);var zm={exports:{}},Um={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I7=J.exports,F7=Symbol.for("react.element"),D7=Symbol.for("react.fragment"),N7=Object.prototype.hasOwnProperty,O7=I7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,k7={key:!0,ref:!0,__self:!0,__source:!0};function KC(n,e,t){var i,r={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)N7.call(e,i)&&!k7.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:F7,type:n,key:s,ref:o,props:r,_owner:O7.current}}Um.Fragment=D7;Um.jsx=KC;Um.jsxs=KC;zm.exports=Um;const le=zm.exports.jsx,An=zm.exports.jsxs,Hm=zm.exports.Fragment,ds=({label:n,onClick:e,submit:t,...i})=>le(B7,{onClick:e,type:t?"submit":"button",...i,children:n}),B7=_n.button(Tm,({theme:n})=>({backgroundColor:n.colors.black70,color:n.colors.text,border:"2px solid",borderColor:n.colors.primary,borderRadius:n.borderRadius.small,padding:n.space[2],paddingLeft:n.space[3],paddingRight:n.space[3],userSelect:"none",":hover, :focus-visible":{backgroundColor:n.colors.primary,color:n.colors.black}})),Tv=({children:n})=>le(Hm,{children:n}),ZC=qC({font:"inherit",color:"inherit",background:"none",cursor:"inherit",outline:"none",border:"none",margin:0,padding:0,width:"auto",overflow:"visible",lineHeight:"inherit",textAlign:"left"});function Nn(n,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(n==null||n(r),t===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function Ka(n,e=[]){let t=[];function i(s,o){const a=J.exports.createContext(o),c=t.length;t=[...t,o];const f=d=>{var v;const{scope:p,children:g,..._}=d,y=((v=p==null?void 0:p[n])==null?void 0:v[c])||a,x=J.exports.useMemo(()=>_,Object.values(_));return le(y.Provider,{value:x,children:g})};f.displayName=s+"Provider";function h(d,p){var y;const g=((y=p==null?void 0:p[n])==null?void 0:y[c])||a,_=J.exports.useContext(g);if(_)return _;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[f,h]}const r=()=>{const s=t.map(o=>J.exports.createContext(o));return function(a){const c=(a==null?void 0:a[n])||s;return J.exports.useMemo(()=>({[`__scope${n}`]:{...a,[n]:c}}),[a,c])}};return r.scopeName=n,[i,z7(r,...e)]}function z7(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const i=n.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const o=i.reduce((a,{useScope:c,scopeName:f})=>{const d=c(s)[`__scope${f}`];return{...a,...d}},{});return J.exports.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}function tE(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function QC(...n){return e=>{let t=!1;const i=n.map(r=>{const s=tE(r,e);return!t&&typeof s=="function"&&(t=!0),s});if(t)return()=>{for(let r=0;r<i.length;r++){const s=i[r];typeof s=="function"?s():tE(n[r],null)}}}}function Ni(...n){return J.exports.useCallback(QC(...n),n)}function Zy(n){const e=U7(n),t=J.exports.forwardRef((i,r)=>{const{children:s,...o}=i,a=J.exports.Children.toArray(s),c=a.find(G7);if(c){const f=c.props.children,h=a.map(d=>d===c?J.exports.Children.count(f)>1?J.exports.Children.only(null):J.exports.isValidElement(f)?f.props.children:null:d);return le(e,{...o,ref:r,children:J.exports.isValidElement(f)?J.exports.cloneElement(f,void 0,h):null})}return le(e,{...o,ref:r,children:s})});return t.displayName=`${n}.Slot`,t}function U7(n){const e=J.exports.forwardRef((t,i)=>{const{children:r,...s}=t;if(J.exports.isValidElement(r)){const o=V7(r),a=W7(s,r.props);return r.type!==J.exports.Fragment&&(a.ref=i?QC(i,o):o),J.exports.cloneElement(r,a)}return J.exports.Children.count(r)>1?J.exports.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var H7=Symbol("radix.slottable");function G7(n){return J.exports.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===H7}function W7(n,e){const t={...e};for(const i in e){const r=n[i],s=e[i];/^on[A-Z]/.test(i)?r&&s?t[i]=(...a)=>{const c=s(...a);return r(...a),c}:r&&(t[i]=r):i==="style"?t[i]={...r,...s}:i==="className"&&(t[i]=[r,s].filter(Boolean).join(" "))}return{...n,...t}}function V7(n){var i,r;let e=(i=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(r=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function z_(n){const e=n+"CollectionProvider",[t,i]=Ka(e),[r,s]=t(e,{collectionRef:{current:null},itemMap:new Map}),o=y=>{const{scope:x,children:v}=y,w=dn.useRef(null),S=dn.useRef(new Map).current;return le(r,{scope:x,itemMap:S,collectionRef:w,children:v})};o.displayName=e;const a=n+"CollectionSlot",c=Zy(a),f=dn.forwardRef((y,x)=>{const{scope:v,children:w}=y,S=s(a,v),E=Ni(x,S.collectionRef);return le(c,{ref:E,children:w})});f.displayName=a;const h=n+"CollectionItemSlot",d="data-radix-collection-item",p=Zy(h),g=dn.forwardRef((y,x)=>{const{scope:v,children:w,...S}=y,E=dn.useRef(null),b=Ni(x,E),T=s(h,v);return dn.useEffect(()=>(T.itemMap.set(E,{ref:E,...S}),()=>void T.itemMap.delete(E))),le(p,{[d]:"",ref:b,children:w})});g.displayName=h;function _(y){const x=s(n+"CollectionConsumer",y);return dn.useCallback(()=>{const w=x.collectionRef.current;if(!w)return[];const S=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(x.itemMap.values()).sort((T,C)=>S.indexOf(T.ref.current)-S.indexOf(C.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:o,Slot:f,ItemSlot:g},_,i]}var Pc=globalThis!=null&&globalThis.document?J.exports.useLayoutEffect:()=>{},$7=dp[" useId ".trim().toString()]||(()=>{}),j7=0;function Gm(n){const[e,t]=J.exports.useState($7());return Pc(()=>{n||t(i=>i!=null?i:String(j7++))},[n]),n||(e?`radix-${e}`:"")}var X7=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Bn=X7.reduce((n,e)=>{const t=Zy(`Primitive.${e}`),i=J.exports.forwardRef((r,s)=>{const{asChild:o,...a}=r,c=o?t:e;return typeof window!="undefined"&&(window[Symbol.for("radix-ui")]=!0),le(c,{...a,ref:s})});return i.displayName=`Primitive.${e}`,{...n,[e]:i}},{});function q7(n){const e=J.exports.useRef(n);return J.exports.useEffect(()=>{e.current=n}),J.exports.useMemo(()=>(...t)=>{var i;return(i=e.current)==null?void 0:i.call(e,...t)},[])}var Y7=dp[" useInsertionEffect ".trim().toString()]||Pc;function Za({prop:n,defaultProp:e,onChange:t=()=>{},caller:i}){const[r,s,o]=K7({defaultProp:e,onChange:t}),a=n!==void 0,c=a?n:r;{const h=J.exports.useRef(n!==void 0);J.exports.useEffect(()=>{const d=h.current;d!==a&&console.warn(`${i} is changing from ${d?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=a},[a,i])}const f=J.exports.useCallback(h=>{var d;if(a){const p=Z7(h)?h(n):h;p!==n&&((d=o.current)==null||d.call(o,p))}else s(h)},[a,n,s,o]);return[c,f]}function K7({defaultProp:n,onChange:e}){const[t,i]=J.exports.useState(n),r=J.exports.useRef(t),s=J.exports.useRef(e);return Y7(()=>{s.current=e},[e]),J.exports.useEffect(()=>{var o;r.current!==t&&((o=s.current)==null||o.call(s,t),r.current=t)},[t,r]),[t,i,s]}function Z7(n){return typeof n=="function"}var Q7=J.exports.createContext(void 0);function Wm(n){const e=J.exports.useContext(Q7);return n||e||"ltr"}var Ev="rovingFocusGroup.onEntryFocus",J7={bubbles:!1,cancelable:!0},Jf="RovingFocusGroup",[Qy,JC,e$]=z_(Jf),[t$,eR]=Ka(Jf,[e$]),[n$,i$]=t$(Jf),tR=J.exports.forwardRef((n,e)=>le(Qy.Provider,{scope:n.__scopeRovingFocusGroup,children:le(Qy.Slot,{scope:n.__scopeRovingFocusGroup,children:le(r$,{...n,ref:e})})}));tR.displayName=Jf;var r$=J.exports.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,orientation:i,loop:r=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:c,onEntryFocus:f,preventScrollOnEntryFocus:h=!1,...d}=n,p=J.exports.useRef(null),g=Ni(e,p),_=Wm(s),[y,x]=Za({prop:o,defaultProp:a!=null?a:null,onChange:c,caller:Jf}),[v,w]=J.exports.useState(!1),S=q7(f),E=JC(t),b=J.exports.useRef(!1),[T,C]=J.exports.useState(0);return J.exports.useEffect(()=>{const A=p.current;if(A)return A.addEventListener(Ev,S),()=>A.removeEventListener(Ev,S)},[S]),le(n$,{scope:t,orientation:i,dir:_,loop:r,currentTabStopId:y,onItemFocus:J.exports.useCallback(A=>x(A),[x]),onItemShiftTab:J.exports.useCallback(()=>w(!0),[]),onFocusableItemAdd:J.exports.useCallback(()=>C(A=>A+1),[]),onFocusableItemRemove:J.exports.useCallback(()=>C(A=>A-1),[]),children:le(Bn.div,{tabIndex:v||T===0?-1:0,"data-orientation":i,...d,ref:g,style:{outline:"none",...n.style},onMouseDown:Nn(n.onMouseDown,()=>{b.current=!0}),onFocus:Nn(n.onFocus,A=>{const F=!b.current;if(A.target===A.currentTarget&&F&&!v){const U=new CustomEvent(Ev,J7);if(A.currentTarget.dispatchEvent(U),!U.defaultPrevented){const W=E().filter(K=>K.focusable),ne=W.find(K=>K.active),re=W.find(K=>K.id===y),ie=[ne,re,...W].filter(Boolean).map(K=>K.ref.current);rR(ie,h)}}b.current=!1}),onBlur:Nn(n.onBlur,()=>w(!1))})})}),nR="RovingFocusGroupItem",iR=J.exports.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,focusable:i=!0,active:r=!1,tabStopId:s,children:o,...a}=n,c=Gm(),f=s||c,h=i$(nR,t),d=h.currentTabStopId===f,p=JC(t),{onFocusableItemAdd:g,onFocusableItemRemove:_,currentTabStopId:y}=h;return J.exports.useEffect(()=>{if(i)return g(),()=>_()},[i,g,_]),le(Qy.ItemSlot,{scope:t,id:f,focusable:i,active:r,children:le(Bn.span,{tabIndex:d?0:-1,"data-orientation":h.orientation,...a,ref:e,onMouseDown:Nn(n.onMouseDown,x=>{i?h.onItemFocus(f):x.preventDefault()}),onFocus:Nn(n.onFocus,()=>h.onItemFocus(f)),onKeyDown:Nn(n.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){h.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const v=a$(x,h.orientation,h.dir);if(v!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let S=p().filter(E=>E.focusable).map(E=>E.ref.current);if(v==="last")S.reverse();else if(v==="prev"||v==="next"){v==="prev"&&S.reverse();const E=S.indexOf(x.currentTarget);S=h.loop?l$(S,E+1):S.slice(E+1)}setTimeout(()=>rR(S))}}),children:typeof o=="function"?o({isCurrentTabStop:d,hasTabStop:y!=null}):o})})});iR.displayName=nR;var s$={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function o$(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function a$(n,e,t){const i=o$(n.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return s$[i]}function rR(n,e=!1){const t=document.activeElement;for(const i of n)if(i===t||(i.focus({preventScroll:e}),document.activeElement!==t))return}function l$(n,e){return n.map((t,i)=>n[(e+i)%n.length])}var c$=tR,u$=iR;function f$(n,e){return J.exports.useReducer((t,i)=>{const r=e[t][i];return r!=null?r:t},n)}var U_=n=>{const{present:e,children:t}=n,i=d$(e),r=typeof t=="function"?t({present:i.isPresent}):J.exports.Children.only(t),s=Ni(i.ref,h$(r));return typeof t=="function"||i.isPresent?J.exports.cloneElement(r,{ref:s}):null};U_.displayName="Presence";function d$(n){const[e,t]=J.exports.useState(),i=J.exports.useRef(null),r=J.exports.useRef(n),s=J.exports.useRef("none"),o=n?"mounted":"unmounted",[a,c]=f$(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return J.exports.useEffect(()=>{const f=$h(i.current);s.current=a==="mounted"?f:"none"},[a]),Pc(()=>{const f=i.current,h=r.current;if(h!==n){const p=s.current,g=$h(f);n?c("MOUNT"):g==="none"||(f==null?void 0:f.display)==="none"?c("UNMOUNT"):c(h&&p!==g?"ANIMATION_OUT":"UNMOUNT"),r.current=n}},[n,c]),Pc(()=>{var f;if(e){let h;const d=(f=e.ownerDocument.defaultView)!=null?f:window,p=_=>{const x=$h(i.current).includes(CSS.escape(_.animationName));if(_.target===e&&x&&(c("ANIMATION_END"),!r.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",h=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},g=_=>{_.target===e&&(s.current=$h(i.current))};return e.addEventListener("animationstart",g),e.addEventListener("animationcancel",p),e.addEventListener("animationend",p),()=>{d.clearTimeout(h),e.removeEventListener("animationstart",g),e.removeEventListener("animationcancel",p),e.removeEventListener("animationend",p)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:J.exports.useCallback(f=>{i.current=f?getComputedStyle(f):null,t(f)},[])}}function $h(n){return(n==null?void 0:n.animationName)||"none"}function h$(n){var i,r;let e=(i=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(r=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var Vm="Tabs",[p$,tX]=Ka(Vm,[eR]),sR=eR(),[m$,H_]=p$(Vm),oR=J.exports.forwardRef((n,e)=>{const{__scopeTabs:t,value:i,onValueChange:r,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:c="automatic",...f}=n,h=Wm(a),[d,p]=Za({prop:i,onChange:r,defaultProp:s!=null?s:"",caller:Vm});return le(m$,{scope:t,baseId:Gm(),value:d,onValueChange:p,orientation:o,dir:h,activationMode:c,children:le(Bn.div,{dir:h,"data-orientation":o,...f,ref:e})})});oR.displayName=Vm;var aR="TabsList",lR=J.exports.forwardRef((n,e)=>{const{__scopeTabs:t,loop:i=!0,...r}=n,s=H_(aR,t),o=sR(t);return le(c$,{asChild:!0,...o,orientation:s.orientation,dir:s.dir,loop:i,children:le(Bn.div,{role:"tablist","aria-orientation":s.orientation,...r,ref:e})})});lR.displayName=aR;var cR="TabsTrigger",uR=J.exports.forwardRef((n,e)=>{const{__scopeTabs:t,value:i,disabled:r=!1,...s}=n,o=H_(cR,t),a=sR(t),c=hR(o.baseId,i),f=pR(o.baseId,i),h=i===o.value;return le(u$,{asChild:!0,...a,focusable:!r,active:h,children:le(Bn.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":f,"data-state":h?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:c,...s,ref:e,onMouseDown:Nn(n.onMouseDown,d=>{!r&&d.button===0&&d.ctrlKey===!1?o.onValueChange(i):d.preventDefault()}),onKeyDown:Nn(n.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(i)}),onFocus:Nn(n.onFocus,()=>{const d=o.activationMode!=="manual";!h&&!r&&d&&o.onValueChange(i)})})})});uR.displayName=cR;var fR="TabsContent",dR=J.exports.forwardRef((n,e)=>{const{__scopeTabs:t,value:i,forceMount:r,children:s,...o}=n,a=H_(fR,t),c=hR(a.baseId,i),f=pR(a.baseId,i),h=i===a.value,d=J.exports.useRef(h);return J.exports.useEffect(()=>{const p=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(p)},[]),le(U_,{present:r||h,children:({present:p})=>le(Bn.div,{"data-state":h?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":c,hidden:!p,id:f,tabIndex:0,...o,ref:e,style:{...n.style,animationDuration:d.current?"0s":void 0},children:p&&s})})});dR.displayName=fR;function hR(n,e){return`${n}-trigger-${e}`}function pR(n,e){return`${n}-content-${e}`}var g$=oR,v$=lR,y$=uR,x$=dR;const _$=n=>{const e=J.exports.Children.toArray(n.children),t=e.findIndex(r=>r.props.isActive);return An(g$,{defaultValue:(t!==-1?t:0).toString(),children:[le(w$,{children:e.map((r,s)=>le(S$,{value:s.toString(),children:r.props.label},s))}),e.map((r,s)=>le(x$,{value:s.toString(),children:r.props.children},s))]})},w$=_n(v$)({display:"grid",gridAutoColumns:"1fr",gridAutoFlow:"column"}),S$=_n(y$)(ZC,({theme:n})=>({cursor:"pointer",display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",borderBottom:"2px solid",borderColor:n.colors.black10,textAlign:"center",padding:n.space[3],":hover, :focus-visible":{borderColor:n.colors.black70},'&[data-state="active"]':{borderColor:n.colors.primary}})),M$=(n,e,t=!1)=>{const r=(t?RG:Z2)(n,e),[s,o]=J.exports.useState(()=>r.get());return[s,a=>{r.set(a),o(a)},()=>{r.remove(),o(e)}]};var $m="Collapsible",[b$,mR]=Ka($m),[T$,G_]=b$($m),gR=J.exports.forwardRef((n,e)=>{const{__scopeCollapsible:t,open:i,defaultOpen:r,disabled:s,onOpenChange:o,...a}=n,[c,f]=Za({prop:i,defaultProp:r!=null?r:!1,onChange:o,caller:$m});return le(T$,{scope:t,disabled:s,contentId:Gm(),open:c,onOpenToggle:J.exports.useCallback(()=>f(h=>!h),[f]),children:le(Bn.div,{"data-state":V_(c),"data-disabled":s?"":void 0,...a,ref:e})})});gR.displayName=$m;var vR="CollapsibleTrigger",yR=J.exports.forwardRef((n,e)=>{const{__scopeCollapsible:t,...i}=n,r=G_(vR,t);return le(Bn.button,{type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":V_(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled,...i,ref:e,onClick:Nn(n.onClick,r.onOpenToggle)})});yR.displayName=vR;var W_="CollapsibleContent",xR=J.exports.forwardRef((n,e)=>{const{forceMount:t,...i}=n,r=G_(W_,n.__scopeCollapsible);return le(U_,{present:t||r.open,children:({present:s})=>le(E$,{...i,ref:e,present:s})})});xR.displayName=W_;var E$=J.exports.forwardRef((n,e)=>{const{__scopeCollapsible:t,present:i,children:r,...s}=n,o=G_(W_,t),[a,c]=J.exports.useState(i),f=J.exports.useRef(null),h=Ni(e,f),d=J.exports.useRef(0),p=d.current,g=J.exports.useRef(0),_=g.current,y=o.open||a,x=J.exports.useRef(y),v=J.exports.useRef(void 0);return J.exports.useEffect(()=>{const w=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(w)},[]),Pc(()=>{const w=f.current;if(w){v.current=v.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const S=w.getBoundingClientRect();d.current=S.height,g.current=S.width,x.current||(w.style.transitionDuration=v.current.transitionDuration,w.style.animationName=v.current.animationName),c(i)}},[o.open,i]),le(Bn.div,{"data-state":V_(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!y,...s,ref:h,style:{["--radix-collapsible-content-height"]:p?`${p}px`:void 0,["--radix-collapsible-content-width"]:_?`${_}px`:void 0,...n.style},children:y&&r})});function V_(n){return n?"open":"closed"}var A$=gR,C$=yR,R$=xR,Qr="Accordion",P$=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[$_,L$,I$]=z_(Qr),[jm,nX]=Ka(Qr,[I$,mR]),j_=mR(),_R=dn.forwardRef((n,e)=>{const{type:t,...i}=n,r=i,s=i;return le($_.Provider,{scope:n.__scopeAccordion,children:t==="multiple"?le(O$,{...s,ref:e}):le(N$,{...r,ref:e})})});_R.displayName=Qr;var[wR,F$]=jm(Qr),[SR,D$]=jm(Qr,{collapsible:!1}),N$=dn.forwardRef((n,e)=>{const{value:t,defaultValue:i,onValueChange:r=()=>{},collapsible:s=!1,...o}=n,[a,c]=Za({prop:t,defaultProp:i!=null?i:"",onChange:r,caller:Qr});return le(wR,{scope:n.__scopeAccordion,value:dn.useMemo(()=>a?[a]:[],[a]),onItemOpen:c,onItemClose:dn.useCallback(()=>s&&c(""),[s,c]),children:le(SR,{scope:n.__scopeAccordion,collapsible:s,children:le(MR,{...o,ref:e})})})}),O$=dn.forwardRef((n,e)=>{const{value:t,defaultValue:i,onValueChange:r=()=>{},...s}=n,[o,a]=Za({prop:t,defaultProp:i!=null?i:[],onChange:r,caller:Qr}),c=dn.useCallback(h=>a((d=[])=>[...d,h]),[a]),f=dn.useCallback(h=>a((d=[])=>d.filter(p=>p!==h)),[a]);return le(wR,{scope:n.__scopeAccordion,value:o,onItemOpen:c,onItemClose:f,children:le(SR,{scope:n.__scopeAccordion,collapsible:!0,children:le(MR,{...s,ref:e})})})}),[k$,Xm]=jm(Qr),MR=dn.forwardRef((n,e)=>{const{__scopeAccordion:t,disabled:i,dir:r,orientation:s="vertical",...o}=n,a=dn.useRef(null),c=Ni(a,e),f=L$(t),d=Wm(r)==="ltr",p=Nn(n.onKeyDown,g=>{var A;if(!P$.includes(g.key))return;const _=g.target,y=f().filter(F=>{var U;return!((U=F.ref.current)!=null&&U.disabled)}),x=y.findIndex(F=>F.ref.current===_),v=y.length;if(x===-1)return;g.preventDefault();let w=x;const S=0,E=v-1,b=()=>{w=x+1,w>E&&(w=S)},T=()=>{w=x-1,w<S&&(w=E)};switch(g.key){case"Home":w=S;break;case"End":w=E;break;case"ArrowRight":s==="horizontal"&&(d?b():T());break;case"ArrowDown":s==="vertical"&&b();break;case"ArrowLeft":s==="horizontal"&&(d?T():b());break;case"ArrowUp":s==="vertical"&&T();break}const C=w%v;(A=y[C].ref.current)==null||A.focus()});return le(k$,{scope:t,disabled:i,direction:r,orientation:s,children:le($_.Slot,{scope:t,children:le(Bn.div,{...o,"data-orientation":s,ref:c,onKeyDown:i?void 0:p})})})}),Qp="AccordionItem",[B$,X_]=jm(Qp),bR=dn.forwardRef((n,e)=>{const{__scopeAccordion:t,value:i,...r}=n,s=Xm(Qp,t),o=F$(Qp,t),a=j_(t),c=Gm(),f=i&&o.value.includes(i)||!1,h=s.disabled||n.disabled;return le(B$,{scope:t,open:f,disabled:h,triggerId:c,children:le(A$,{"data-orientation":s.orientation,"data-state":PR(f),...a,...r,ref:e,disabled:h,open:f,onOpenChange:d=>{d?o.onItemOpen(i):o.onItemClose(i)}})})});bR.displayName=Qp;var TR="AccordionHeader",ER=dn.forwardRef((n,e)=>{const{__scopeAccordion:t,...i}=n,r=Xm(Qr,t),s=X_(TR,t);return le(Bn.h3,{"data-orientation":r.orientation,"data-state":PR(s.open),"data-disabled":s.disabled?"":void 0,...i,ref:e})});ER.displayName=TR;var Jy="AccordionTrigger",AR=dn.forwardRef((n,e)=>{const{__scopeAccordion:t,...i}=n,r=Xm(Qr,t),s=X_(Jy,t),o=D$(Jy,t),a=j_(t);return le($_.ItemSlot,{scope:t,children:le(C$,{"aria-disabled":s.open&&!o.collapsible||void 0,"data-orientation":r.orientation,id:s.triggerId,...a,...i,ref:e})})});AR.displayName=Jy;var CR="AccordionContent",RR=dn.forwardRef((n,e)=>{const{__scopeAccordion:t,...i}=n,r=Xm(Qr,t),s=X_(CR,t),o=j_(t);return le(R$,{role:"region","aria-labelledby":s.triggerId,"data-orientation":r.orientation,...o,...i,ref:e,style:{["--radix-accordion-content-height"]:"var(--radix-collapsible-content-height)",["--radix-accordion-content-width"]:"var(--radix-collapsible-content-width)",...n.style}})});RR.displayName=CR;function PR(n){return n?"open":"closed"}var z$=_R,U$=bR,H$=ER,G$=AR,W$=RR;const V$=({openValue:n,children:e})=>le($$,{type:"single",defaultValue:n,collapsible:!0,children:e}),$$=_n(z$)({}),j$=({value:n,label:e,children:t})=>An(Y$,{value:n,children:[le(K$,{children:le(Z$,{children:e})}),le(Q$,{children:le(mi,{p:2,children:t})})]}),X$=YC({from:{height:0},to:{height:"var(--radix-accordion-content-height)"}}),q$=YC({from:{height:"var(--radix-accordion-content-height)"},to:{height:0}}),Y$=_n(U$)({}),K$=_n(H$)({margin:0,fontWeight:"normal"}),Z$=_n(G$)(ZC,({theme:n})=>({display:"block",width:"100%",textAlign:"left",padding:n.space[2],borderLeft:"2px solid",borderColor:n.colors.black10,":hover, :focus-visible":{borderColor:n.colors.black70},'&[data-state="open"]':{borderColor:n.colors.primary,color:n.colors.primary}})),Q$=_n(W$)(({theme:n})=>({overflow:"hidden",borderLeft:"2px solid",borderColor:n.colors.black10,'&[data-state="open"]':{borderColor:n.colors.primary,animation:`${X$} 300ms cubic-bezier(0.87, 0, 0.13, 1)`},'&[data-state="closed"]':{animation:`${q$} 300ms cubic-bezier(0.87, 0, 0.13, 1)`}})),J$=(n,e=1e3)=>{const[t,i]=J.exports.useState(n),r=J.exports.useRef(),s=o=>{r.current&&(clearTimeout(r.current),r.current=void 0),i(o),r.current=setTimeout(()=>s(n),e)};return[t,s]},ej=({value:n,onChange:e,onBlur:t,name:i,type:r,placeholder:s,autoFocus:o,...a})=>r==="number"?le(ex,{value:n,onChange:c=>e(c.target.valueAsNumber.toString()),onBlur:t,name:i,step:.01,type:r,placeholder:s,autoFocus:o,...a}):le(ex,{value:n,onChange:c=>e(c.target.value),onBlur:t,name:i,type:r,placeholder:s,autoFocus:o,...a}),ex=_n.input(Tm,({theme:n,fullWidth:e})=>({background:n.colors.black,borderWidth:1,borderStyle:"solid",borderColor:n.colors.border,fontSize:n.fontSizes[2],padding:n.space[2],width:e?"100%":"280px",maxWidth:"100%",color:n.colors.text})),tj=({value:n,onChange:e,step:t=1,name:i,placeholder:r,onBlur:s,autoFocus:o,...a})=>{const c=Number.isNaN(n)?"":n;return le(ex,{value:c,onChange:({target:f})=>{e(parseFloat(f.value))},onBlur:s,name:i,step:t,placeholder:r,autoFocus:o,...a})};function LR(n){const e=J.exports.useRef({value:n,previous:n});return J.exports.useMemo(()=>(e.current.value!==n&&(e.current.previous=e.current.value,e.current.value=n),e.current.previous),[n])}function IR(n){const[e,t]=J.exports.useState(void 0);return Pc(()=>{if(n){t({width:n.offsetWidth,height:n.offsetHeight});const i=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const s=r[0];let o,a;if("borderBoxSize"in s){const c=s.borderBoxSize,f=Array.isArray(c)?c[0]:c;o=f.inlineSize,a=f.blockSize}else o=n.offsetWidth,a=n.offsetHeight;t({width:o,height:a})});return i.observe(n,{box:"border-box"}),()=>i.unobserve(n)}else t(void 0)},[n]),e}var qm="Switch",[nj,iX]=Ka(qm),[ij,rj]=nj(qm),FR=J.exports.forwardRef((n,e)=>{const{__scopeSwitch:t,name:i,checked:r,defaultChecked:s,required:o,disabled:a,value:c="on",onCheckedChange:f,form:h,...d}=n,[p,g]=J.exports.useState(null),_=Ni(e,S=>g(S)),y=J.exports.useRef(!1),x=p?h||!!p.closest("form"):!0,[v,w]=Za({prop:r,defaultProp:s!=null?s:!1,onChange:f,caller:qm});return An(ij,{scope:t,checked:v,disabled:a,children:[le(Bn.button,{type:"button",role:"switch","aria-checked":v,"aria-required":o,"data-state":kR(v),"data-disabled":a?"":void 0,disabled:a,value:c,...d,ref:_,onClick:Nn(n.onClick,S=>{w(E=>!E),x&&(y.current=S.isPropagationStopped(),y.current||S.stopPropagation())})}),x&&le(OR,{control:p,bubbles:!y.current,name:i,value:c,checked:v,required:o,disabled:a,form:h,style:{transform:"translateX(-100%)"}})]})});FR.displayName=qm;var DR="SwitchThumb",NR=J.exports.forwardRef((n,e)=>{const{__scopeSwitch:t,...i}=n,r=rj(DR,t);return le(Bn.span,{"data-state":kR(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:e})});NR.displayName=DR;var sj="SwitchBubbleInput",OR=J.exports.forwardRef(({__scopeSwitch:n,control:e,checked:t,bubbles:i=!0,...r},s)=>{const o=J.exports.useRef(null),a=Ni(o,s),c=LR(t),f=IR(e);return J.exports.useEffect(()=>{const h=o.current;if(!h)return;const d=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(d,"checked").set;if(c!==t&&g){const _=new Event("click",{bubbles:i});g.call(h,t),h.dispatchEvent(_)}},[c,t,i]),le("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...r,tabIndex:-1,ref:a,style:{...r.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});OR.displayName=sj;function kR(n){return n?"checked":"unchecked"}var oj=FR,aj=NR;const lj=({checked:n,onChange:e})=>le(cj,{defaultChecked:n,onCheckedChange:e,children:le(uj,{})}),cj=_n(oj)(({theme:n})=>({all:"unset",width:42,height:25,backgroundColor:n.colors.black70,borderRadius:"9999px",position:"relative",boxShadow:`0 2px 10px ${n.colors.black10}`,WebkitTapHighlightColor:"rgba(0, 0, 0, 0)","&:focus":{boxShadow:`0 0 0 2px ${n.colors.black70}`},'&[data-state="checked"]':{backgroundColor:n.colors.primary}})),uj=_n(aj)(({theme:n})=>({display:"block",width:21,height:21,backgroundColor:n.colors.white,borderRadius:"9999px",transition:"transform 100ms",transform:"translateX(2px)",willChange:"transform",'&[data-state="checked"]':{transform:"translateX(19px)"}})),fj=({value:n,items:e,onChange:t,getLabel:i=s=>s,...r})=>le(dj,{value:n,onChange:s=>t(s.target.value),...r,children:e.map(s=>le("option",{value:s,children:i(s)},s))}),dj=_n.select(Tm,({theme:n,fullWidth:e})=>({background:n.colors.black,borderWidth:1,borderStyle:"solid",borderColor:n.colors.border,fontSize:n.fontSizes[2],padding:n.space[2],color:n.colors.text,width:e?"100%":"auto"}));function BR(n,[e,t]){return Math.min(t,Math.max(e,n))}var zR=["PageUp","PageDown"],UR=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],HR={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},qc="Slider",[tx,hj,pj]=z_(qc),[GR,rX]=Ka(qc,[pj]),[mj,Ym]=GR(qc),WR=J.exports.forwardRef((n,e)=>{const{name:t,min:i=0,max:r=100,step:s=1,orientation:o="horizontal",disabled:a=!1,minStepsBetweenThumbs:c=0,defaultValue:f=[i],value:h,onValueChange:d=()=>{},onValueCommit:p=()=>{},inverted:g=!1,form:_,...y}=n,x=J.exports.useRef(new Set),v=J.exports.useRef(0),S=o==="horizontal"?gj:vj,[E=[],b]=Za({prop:h,defaultProp:f,onChange:W=>{var re;(re=[...x.current][v.current])==null||re.focus(),d(W)}}),T=J.exports.useRef(E);function C(W){const ne=Sj(E,W);U(W,ne)}function A(W){U(W,v.current)}function F(){const W=T.current[v.current];E[v.current]!==W&&p(E)}function U(W,ne,{commit:re}={commit:!1}){const V=Ej(s),ie=Aj(Math.round((W-i)/s)*s+i,V),K=BR(ie,[i,r]);b((ae=[])=>{const $=_j(ae,K,ne);if(Tj($,c*s)){v.current=$.indexOf(K);const Y=String($)!==String(ae);return Y&&re&&p($),Y?$:ae}else return ae})}return le(mj,{scope:n.__scopeSlider,name:t,disabled:a,min:i,max:r,valueIndexToChangeRef:v,thumbs:x.current,values:E,orientation:o,form:_,children:le(tx.Provider,{scope:n.__scopeSlider,children:le(tx.Slot,{scope:n.__scopeSlider,children:le(S,{"aria-disabled":a,"data-disabled":a?"":void 0,...y,ref:e,onPointerDown:Nn(y.onPointerDown,()=>{a||(T.current=E)}),min:i,max:r,inverted:g,onSlideStart:a?void 0:C,onSlideMove:a?void 0:A,onSlideEnd:a?void 0:F,onHomeKeyDown:()=>!a&&U(i,0,{commit:!0}),onEndKeyDown:()=>!a&&U(r,E.length-1,{commit:!0}),onStepKeyDown:({event:W,direction:ne})=>{if(!a){const ie=zR.includes(W.key)||W.shiftKey&&UR.includes(W.key)?10:1,K=v.current,ae=E[K],$=s*ie*ne;U(ae+$,K,{commit:!0})}}})})})})});WR.displayName=qc;var[VR,$R]=GR(qc,{startEdge:"left",endEdge:"right",size:"width",direction:1}),gj=J.exports.forwardRef((n,e)=>{const{min:t,max:i,dir:r,inverted:s,onSlideStart:o,onSlideMove:a,onSlideEnd:c,onStepKeyDown:f,...h}=n,[d,p]=J.exports.useState(null),g=Ni(e,S=>p(S)),_=J.exports.useRef(void 0),y=Wm(r),x=y==="ltr",v=x&&!s||!x&&s;function w(S){const E=_.current||d.getBoundingClientRect(),b=[0,E.width],C=q_(b,v?[t,i]:[i,t]);return _.current=E,C(S-E.left)}return le(VR,{scope:n.__scopeSlider,startEdge:v?"left":"right",endEdge:v?"right":"left",direction:v?1:-1,size:"width",children:le(jR,{dir:y,"data-orientation":"horizontal",...h,ref:g,style:{...h.style,["--radix-slider-thumb-transform"]:"translateX(-50%)"},onSlideStart:S=>{const E=w(S.clientX);o==null||o(E)},onSlideMove:S=>{const E=w(S.clientX);a==null||a(E)},onSlideEnd:()=>{_.current=void 0,c==null||c()},onStepKeyDown:S=>{const b=HR[v?"from-left":"from-right"].includes(S.key);f==null||f({event:S,direction:b?-1:1})}})})}),vj=J.exports.forwardRef((n,e)=>{const{min:t,max:i,inverted:r,onSlideStart:s,onSlideMove:o,onSlideEnd:a,onStepKeyDown:c,...f}=n,h=J.exports.useRef(null),d=Ni(e,h),p=J.exports.useRef(void 0),g=!r;function _(y){const x=p.current||h.current.getBoundingClientRect(),v=[0,x.height],S=q_(v,g?[i,t]:[t,i]);return p.current=x,S(y-x.top)}return le(VR,{scope:n.__scopeSlider,startEdge:g?"bottom":"top",endEdge:g?"top":"bottom",size:"height",direction:g?1:-1,children:le(jR,{"data-orientation":"vertical",...f,ref:d,style:{...f.style,["--radix-slider-thumb-transform"]:"translateY(50%)"},onSlideStart:y=>{const x=_(y.clientY);s==null||s(x)},onSlideMove:y=>{const x=_(y.clientY);o==null||o(x)},onSlideEnd:()=>{p.current=void 0,a==null||a()},onStepKeyDown:y=>{const v=HR[g?"from-bottom":"from-top"].includes(y.key);c==null||c({event:y,direction:v?-1:1})}})})}),jR=J.exports.forwardRef((n,e)=>{const{__scopeSlider:t,onSlideStart:i,onSlideMove:r,onSlideEnd:s,onHomeKeyDown:o,onEndKeyDown:a,onStepKeyDown:c,...f}=n,h=Ym(qc,t);return le(Bn.span,{...f,ref:e,onKeyDown:Nn(n.onKeyDown,d=>{d.key==="Home"?(o(d),d.preventDefault()):d.key==="End"?(a(d),d.preventDefault()):zR.concat(UR).includes(d.key)&&(c(d),d.preventDefault())}),onPointerDown:Nn(n.onPointerDown,d=>{const p=d.target;p.setPointerCapture(d.pointerId),d.preventDefault(),h.thumbs.has(p)?p.focus():i(d)}),onPointerMove:Nn(n.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&r(d)}),onPointerUp:Nn(n.onPointerUp,d=>{const p=d.target;p.hasPointerCapture(d.pointerId)&&(p.releasePointerCapture(d.pointerId),s(d))})})}),XR="SliderTrack",qR=J.exports.forwardRef((n,e)=>{const{__scopeSlider:t,...i}=n,r=Ym(XR,t);return le(Bn.span,{"data-disabled":r.disabled?"":void 0,"data-orientation":r.orientation,...i,ref:e})});qR.displayName=XR;var nx="SliderRange",YR=J.exports.forwardRef((n,e)=>{const{__scopeSlider:t,...i}=n,r=Ym(nx,t),s=$R(nx,t),o=J.exports.useRef(null),a=Ni(e,o),c=r.values.length,f=r.values.map(p=>QR(p,r.min,r.max)),h=c>1?Math.min(...f):0,d=100-Math.max(...f);return le(Bn.span,{"data-orientation":r.orientation,"data-disabled":r.disabled?"":void 0,...i,ref:a,style:{...n.style,[s.startEdge]:h+"%",[s.endEdge]:d+"%"}})});YR.displayName=nx;var ix="SliderThumb",KR=J.exports.forwardRef((n,e)=>{const t=hj(n.__scopeSlider),[i,r]=J.exports.useState(null),s=Ni(e,a=>r(a)),o=J.exports.useMemo(()=>i?t().findIndex(a=>a.ref.current===i):-1,[t,i]);return le(yj,{...n,ref:s,index:o})}),yj=J.exports.forwardRef((n,e)=>{const{__scopeSlider:t,index:i,name:r,...s}=n,o=Ym(ix,t),a=$R(ix,t),[c,f]=J.exports.useState(null),h=Ni(e,w=>f(w)),d=c?o.form||!!c.closest("form"):!0,p=IR(c),g=o.values[i],_=g===void 0?0:QR(g,o.min,o.max),y=wj(i,o.values.length),x=p==null?void 0:p[a.size],v=x?Mj(x,_,a.direction):0;return J.exports.useEffect(()=>{if(c)return o.thumbs.add(c),()=>{o.thumbs.delete(c)}},[c,o.thumbs]),An("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${_}% + ${v}px)`},children:[le(tx.ItemSlot,{scope:n.__scopeSlider,children:le(Bn.span,{role:"slider","aria-label":n["aria-label"]||y,"aria-valuemin":o.min,"aria-valuenow":g,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...s,ref:h,style:g===void 0?{display:"none"}:n.style,onFocus:Nn(n.onFocus,()=>{o.valueIndexToChangeRef.current=i})})}),d&&le(ZR,{name:r!=null?r:o.name?o.name+(o.values.length>1?"[]":""):void 0,form:o.form,value:g},i)]})});KR.displayName=ix;var xj="RadioBubbleInput",ZR=J.exports.forwardRef(({__scopeSlider:n,value:e,...t},i)=>{const r=J.exports.useRef(null),s=Ni(r,i),o=LR(e);return J.exports.useEffect(()=>{const a=r.current;if(!a)return;const c=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==e&&h){const d=new Event("input",{bubbles:!0});h.call(a,e),a.dispatchEvent(d)}},[o,e]),le(Bn.input,{style:{display:"none"},...t,ref:s,defaultValue:e})});ZR.displayName=xj;function _j(n=[],e,t){const i=[...n];return i[t]=e,i.sort((r,s)=>r-s)}function QR(n,e,t){const i=t-e,s=100/i*(n-e);return BR(s,[0,100])}function wj(n,e){return e>2?`Value ${n+1} of ${e}`:e===2?["Minimum","Maximum"][n]:void 0}function Sj(n,e){if(n.length===1)return 0;const t=n.map(r=>Math.abs(r-e)),i=Math.min(...t);return t.indexOf(i)}function Mj(n,e,t){const i=n/2,s=q_([0,50],[0,i]);return(i-s(e)*t)*t}function bj(n){return n.slice(0,-1).map((e,t)=>n[t+1]-e)}function Tj(n,e){if(e>0){const t=bj(n);return Math.min(...t)>=e}return!0}function q_(n,e){return t=>{if(n[0]===n[1]||e[0]===e[1])return e[0];const i=(e[1]-e[0])/(n[1]-n[0]);return e[0]+i*(t-n[0])}}function Ej(n){return(String(n).split(".")[1]||"").length}function Aj(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}var Cj=WR,Rj=qR,Pj=YR,Lj=KR;const Ij=({value:n,min:e,max:t,onChange:i,step:r=1})=>An(Fj,{defaultValue:[n],min:e,max:t,step:r,onValueChange:s=>i(s[0]),children:[le(Dj,{children:le(Nj,{})}),le(Oj,{})]}),Fj=_n(Cj)({position:"relative",display:"flex",alignItems:"center",userSelect:"none",touchAction:"none",width:200,'&[data-orientation="horizontal"]':{height:20},'&[data-orientation="vertical"]':{flexDirection:"column",width:20,height:100}}),Dj=_n(Rj)(({theme:n})=>({backgroundColor:n.colors.black10,position:"relative",flexGrow:1,borderRadius:"9999px",'&[data-orientation="horizontal"]':{height:3},'&[data-orientation="vertical"]':{width:3}})),Nj=_n(Pj)({position:"absolute",backgroundColor:"white",borderRadius:"9999px",height:"100%"}),Oj=_n(Lj)(({theme:n})=>({all:"unset",display:"block",width:20,height:20,backgroundColor:"white",boxShadow:`0 2px 10px ${n.colors.white}`,borderRadius:10,"&:hover":{backgroundColor:n.colors.lightGray},"&:focus":{boxShadow:`0 0 0 5px ${n.colors.black70}`}})),kj=({value:n,definition:e,onChange:t})=>{const i=Bj[e.__type];return le("div",{children:le(i,{value:n,definition:e,onChange:t})})},Bj={[Sa.BooleanCheckbox]:({value:n,onChange:e})=>le(lj,{checked:n,onChange:e}),[Sa.StringInput]:({value:n,onChange:e})=>le(ej,{type:"text",value:n,onChange:e,fullWidth:!0}),[Sa.NumberInput]:({value:n,onChange:e})=>le(tj,{value:n,onChange:e,fullWidth:!0}),[Sa.Select]:({value:n,definition:e,onChange:t})=>le(fj,{items:e.options,value:n,onChange:t,getLabel:i=>i}),[Sa.MinMax]:({value:n,definition:e,onChange:t})=>An(mi,{display:"flex",alignItems:"center",columnGap:2,children:[le(Ij,{value:n,min:e.min,max:e.max,step:e.step,onChange:t}),le("b",{children:n})]}),[Sa.Color]:({value:n,onChange:e})=>le("input",{type:"color",value:MG(n),onChange:t=>{e(bG(t.target.value))}})},zj=()=>{const[n,e]=J$(!1),[,t]=J.exports.useState(0),i=()=>t(s=>s+1),r=()=>window.location.reload();return An(Hm,{children:[le(mi,{p:2,children:le(V$,{children:Gr.exports.toPairs(op).map(([s,o])=>{const a=se[s];return le(j$,{value:s,label:s,children:Gr.exports.entries(o).map(([c,f])=>An("div",{children:[c,le(kj,{value:a[c],definition:f,onChange:h=>{a[c]=h,i()}})]},c))},s)})})}),An(mi,{display:"flex",flexDirection:"row",paddingY:2,justifyContent:"center",columnGap:2,style:{position:"sticky",bottom:0},children:[n?le(ds,{label:"Reload",onClick:r}):le(ds,{label:"Save",onClick:()=>{mW(),i(),e(!0)}}),le(ds,{label:"Reset",onClick:()=>{pW(),r()}})]})]})},Av="No profession",Uj=({humanPlayer:n})=>{var c;const[e,t]=J.exports.useState(n.selectedActors),i=J.exports.useMemo(()=>Object.entries(Gr.exports.groupBy(e,f=>f.type)),[e]);J.exports.useEffect(()=>{const f=d=>t(d),h=()=>t([]);return n.emitter.on("selectActors",f),n.emitter.on("unselectActors",h),()=>{n.emitter.off("selectActors",f),n.emitter.off("unselectActors",h)}},[n]);const r=e.length===1?e[0]:void 0;return le(Hm,{children:r?An(mi,{children:[le("h3",{children:r.type}),An("p",{children:[lc(r)&&An("b",{children:[((c=r.profession)==null?void 0:c.type)||Av,le("br",{})]}),r.hp,"/",r.maxHp," HP",le("br",{})]})]}):i.map(([f,h])=>An(mi,{children:[le(ds,{label:`${f} (${h.length})`,onClick:()=>a(f)}),le(mi,{p:2,children:o(h).map(([d,p])=>le(mi,{onClick:()=>s(h,d),children:`${d} (${p})`},d))})]},f))});function s(f,h){return n.selectActors(f.filter(lc).filter(d=>{var p;return h===Av?!d.profession:((p=d.profession)==null?void 0:p.type)===h}))}function o(f){const h=f.filter(lc).reduce((d,p)=>{var _;const g=((_=p.profession)==null?void 0:_.type)||Av;return d[g]=(d[g]||0)+1,d},{});return Object.entries(h)}function a(f){n.selectActors(e.filter(h=>h.type===f))}},Hj=Object.entries(gW),Gj=({humanPlayer:n})=>{const[e,t]=J.exports.useState(n.selectedBuilding);return J.exports.useEffect(()=>{const i=s=>t(s),r=()=>t(void 0);return n.emitter.on("selectBuilding",i),n.emitter.on("unselectBuilding",r),()=>{n.emitter.off("selectBuilding",i),n.emitter.off("unselectBuilding",r)}},[]),le(mi,{p:3,display:"flex",flexDirection:"column",rowGap:3,children:Hj.map(([i,r])=>An(mi,{display:"flex",flexDirection:"column",rowGap:2,children:[le(mi,{children:i}),r.map(s=>le(ds,{label:e===s?`\u2713 ${s}`:s,onClick:()=>n.selectBuilding(s)},s))]},i))})},Wj=document.getElementById("game-root");function Vj(){const[n,e]=J.exports.useState(),[t,i]=J.exports.useState(!1),[r,s]=J.exports.useState(0),o=()=>s(g=>g+1),[a,c]=M$("saved-game2",void 0,!0),[f,h]=J.exports.useState(),{game:d,humanPlayer:p}=J.exports.useMemo(()=>{if(f){const S=Xp.fromJSON(f),E=S.players.find(b=>b.type===Ec.Human);return{game:S,humanPlayer:E}}const g=bV(g9),_=new Sm(g),y=new dC,x=new hC,v=new Xp(_,[y,x]);return new iC(v,x).bulkSpawnTrees(),{game:v,humanPlayer:y}},[f,r]);return J.exports.useEffect(()=>{const g=new j9(d,p,Wj),_=new C9(d,g,p);g.init(),_.init();const y=()=>i(!0),x=()=>i(!1);d.emitter.on("started",y),d.emitter.on("stopped",x);const v=E=>e(E),w=()=>e(void 0);p.emitter.on("selectBuilding",v),p.emitter.on("unselectBuilding",w),d.start();const S=window;return S.game=d,()=>{d.stop(),_.destroy(),g.destroy(),d.emitter.off("started",y),d.emitter.off("stopped",x),p.emitter.off("selectBuilding",v),p.emitter.off("unselectBuilding",w)}},[d,p]),le(Hm,{children:An($j,{children:[An(mi,{p:3,display:"flex",alignItems:"center",justifyContent:"center",columnGap:2,children:[le(ds,{label:t?"Stop":"Start",onClick:()=>{t?d.stop():d.start()}}),!t&&le(ds,{label:"Tick",onClick:()=>d.tick()})]}),An(_$,{children:[An(Tv,{label:"Game",children:[An(mi,{p:3,display:"flex",alignItems:"center",justifyContent:"center",columnGap:2,children:[le(ds,{label:"Save",onClick:()=>c(d.toJSON())}),a&&le(ds,{label:"Load",onClick:()=>{h(a),o()}}),le(ds,{label:"New",onClick:()=>{h(void 0)}})]}),le(mi,{p:3,display:"flex",flexDirection:"column",rowGap:3,children:le(Uj,{humanPlayer:p})})]}),le(Tv,{label:"Spawn",children:le(Gj,{humanPlayer:p})}),le(Tv,{label:"Config",children:le(zj,{})})]})]})})}const $j=_n(mi)({position:"absolute",zIndex:10,top:0,right:0,bottom:0,overflow:"auto",backgroundColor:"rgba(0,0,0,0.5)",backdropFilter:"blur(15px)",maxWidth:280,width:"90%"}),jj={primary:"#C8A13C",text:"#EEE",textMuted:"#CCC",border:"#444",white:"#FFF",lightGray:"#CCC",black:"#0c0c0c",black70:"rgba(0,0,0,.7)",black10:"rgba(0,0,0,.1)",danger:"red",transparent:"transparent"},Xj=["40em","52em","64em"],qj=[12,14,16,20,24,32,48],Yj=[0,4,8,16,32,64,128,256,512],Kj={normal:4,small:3},Zj={transition:"all 0.2s cubic-bezier(.09,.88,.23,1)",shadowSmall:"2px 2px 8px rgba(0,0,0,0.5)",shadowLarge:"4px 4px 18px rgba(0,0,0,0.55)"},Qj={colors:jj,breakpoints:Xj,fontSizes:qj,space:Yj,values:Zj,borderRadius:Kj},Jj=()=>le(y7,{theme:Qj,children:le(Vj,{})});Cv.createRoot(document.getElementById("root")).render(le(Jj,{}));
